!function(t){function e(e){for(var n,r,o=e[0],a=e[1],s=0,l=[];s<o.length;s++)r=o[s],Object.prototype.hasOwnProperty.call(i,r)&&i[r]&&l.push(i[r][0]),i[r]=0;for(n in a)Object.prototype.hasOwnProperty.call(a,n)&&(t[n]=a[n]);for(c&&c(e);l.length;)l.shift()()}var n={},i={1:0};function r(e){if(n[e])return n[e].exports;var i=n[e]={i:e,l:!1,exports:{}};return t[e].call(i.exports,i,i.exports,r),i.l=!0,i.exports}r.e=function(t){var e=[],n=i[t];if(0!==n)if(n)e.push(n[2]);else{var o=new Promise((function(e,r){n=i[t]=[e,r]}));e.push(n[2]=o);var a,s=document.createElement("script");s.charset="utf-8",s.timeout=120,r.nc&&s.setAttribute("nonce",r.nc),s.src=function(t){return r.p+""+({}[t]||t)+".js"}(t);var c=new Error;a=function(e){s.onerror=s.onload=null,clearTimeout(l);var n=i[t];if(0!==n){if(n){var r=e&&("load"===e.type?"missing":e.type),o=e&&e.target&&e.target.src;c.message="Loading chunk "+t+" failed.\n("+r+": "+o+")",c.name="ChunkLoadError",c.type=r,c.request=o,n[1](c)}i[t]=void 0}};var l=setTimeout((function(){a({type:"timeout",target:s})}),12e4);s.onerror=s.onload=a,document.head.appendChild(s)}return Promise.all(e)},r.m=t,r.c=n,r.d=function(t,e,n){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)r.d(n,i,function(e){return t[e]}.bind(null,i));return n},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="",r.oe=function(t){throw console.error(t),t};var o=window.webpackJsonp=window.webpackJsonp||[],a=o.push.bind(o);o.push=e,o=o.slice();for(var s=0;s<o.length;s++)e(o[s]);var c=a;r(r.s=8)}([function(t,e){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(t){"object"==typeof window&&(n=window)}t.exports=n},function(t,e,n){var i;
/*!
 * jQuery JavaScript Library v3.5.1
 * https://jquery.com/
 *
 * Includes Sizzle.js
 * https://sizzlejs.com/
 *
 * Copyright JS Foundation and other contributors
 * Released under the MIT license
 * https://jquery.org/license
 *
 * Date: 2020-05-04T22:49Z
 */!function(e,n){"use strict";"object"==typeof t.exports?t.exports=e.document?n(e,!0):function(t){if(!t.document)throw new Error("jQuery requires a window with a document");return n(t)}:n(e)}("undefined"!=typeof window?window:this,(function(n,r){"use strict";var o=[],a=Object.getPrototypeOf,s=o.slice,c=o.flat?function(t){return o.flat.call(t)}:function(t){return o.concat.apply([],t)},l=o.push,h=o.indexOf,u={},d=u.toString,p=u.hasOwnProperty,f=p.toString,m=f.call(Object),g={},v=function(t){return"function"==typeof t&&"number"!=typeof t.nodeType},y=function(t){return null!=t&&t===t.window},b=n.document,x={type:!0,src:!0,nonce:!0,noModule:!0};function w(t,e,n){var i,r,o=(n=n||b).createElement("script");if(o.text=t,e)for(i in x)(r=e[i]||e.getAttribute&&e.getAttribute(i))&&o.setAttribute(i,r);n.head.appendChild(o).parentNode.removeChild(o)}function _(t){return null==t?t+"":"object"==typeof t||"function"==typeof t?u[d.call(t)]||"object":typeof t}var S=function(t,e){return new S.fn.init(t,e)};function E(t){var e=!!t&&"length"in t&&t.length,n=_(t);return!v(t)&&!y(t)&&("array"===n||0===e||"number"==typeof e&&e>0&&e-1 in t)}S.fn=S.prototype={jquery:"3.5.1",constructor:S,length:0,toArray:function(){return s.call(this)},get:function(t){return null==t?s.call(this):t<0?this[t+this.length]:this[t]},pushStack:function(t){var e=S.merge(this.constructor(),t);return e.prevObject=this,e},each:function(t){return S.each(this,t)},map:function(t){return this.pushStack(S.map(this,(function(e,n){return t.call(e,n,e)})))},slice:function(){return this.pushStack(s.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},even:function(){return this.pushStack(S.grep(this,(function(t,e){return(e+1)%2})))},odd:function(){return this.pushStack(S.grep(this,(function(t,e){return e%2})))},eq:function(t){var e=this.length,n=+t+(t<0?e:0);return this.pushStack(n>=0&&n<e?[this[n]]:[])},end:function(){return this.prevObject||this.constructor()},push:l,sort:o.sort,splice:o.splice},S.extend=S.fn.extend=function(){var t,e,n,i,r,o,a=arguments[0]||{},s=1,c=arguments.length,l=!1;for("boolean"==typeof a&&(l=a,a=arguments[s]||{},s++),"object"==typeof a||v(a)||(a={}),s===c&&(a=this,s--);s<c;s++)if(null!=(t=arguments[s]))for(e in t)i=t[e],"__proto__"!==e&&a!==i&&(l&&i&&(S.isPlainObject(i)||(r=Array.isArray(i)))?(n=a[e],o=r&&!Array.isArray(n)?[]:r||S.isPlainObject(n)?n:{},r=!1,a[e]=S.extend(l,o,i)):void 0!==i&&(a[e]=i));return a},S.extend({expando:"jQuery"+("3.5.1"+Math.random()).replace(/\D/g,""),isReady:!0,error:function(t){throw new Error(t)},noop:function(){},isPlainObject:function(t){var e,n;return!(!t||"[object Object]"!==d.call(t))&&(!(e=a(t))||"function"==typeof(n=p.call(e,"constructor")&&e.constructor)&&f.call(n)===m)},isEmptyObject:function(t){var e;for(e in t)return!1;return!0},globalEval:function(t,e,n){w(t,{nonce:e&&e.nonce},n)},each:function(t,e){var n,i=0;if(E(t))for(n=t.length;i<n&&!1!==e.call(t[i],i,t[i]);i++);else for(i in t)if(!1===e.call(t[i],i,t[i]))break;return t},makeArray:function(t,e){var n=e||[];return null!=t&&(E(Object(t))?S.merge(n,"string"==typeof t?[t]:t):l.call(n,t)),n},inArray:function(t,e,n){return null==e?-1:h.call(e,t,n)},merge:function(t,e){for(var n=+e.length,i=0,r=t.length;i<n;i++)t[r++]=e[i];return t.length=r,t},grep:function(t,e,n){for(var i=[],r=0,o=t.length,a=!n;r<o;r++)!e(t[r],r)!==a&&i.push(t[r]);return i},map:function(t,e,n){var i,r,o=0,a=[];if(E(t))for(i=t.length;o<i;o++)null!=(r=e(t[o],o,n))&&a.push(r);else for(o in t)null!=(r=e(t[o],o,n))&&a.push(r);return c(a)},guid:1,support:g}),"function"==typeof Symbol&&(S.fn[Symbol.iterator]=o[Symbol.iterator]),S.each("Boolean Number String Function Array Date RegExp Object Error Symbol".split(" "),(function(t,e){u["[object "+e+"]"]=e.toLowerCase()}));var A=
/*!
 * Sizzle CSS Selector Engine v2.3.5
 * https://sizzlejs.com/
 *
 * Copyright JS Foundation and other contributors
 * Released under the MIT license
 * https://js.foundation/
 *
 * Date: 2020-03-14
 */
function(t){var e,n,i,r,o,a,s,c,l,h,u,d,p,f,m,g,v,y,b,x="sizzle"+1*new Date,w=t.document,_=0,S=0,E=ct(),A=ct(),T=ct(),M=ct(),C=function(t,e){return t===e&&(u=!0),0},P={}.hasOwnProperty,R=[],L=R.pop,k=R.push,I=R.push,D=R.slice,O=function(t,e){for(var n=0,i=t.length;n<i;n++)if(t[n]===e)return n;return-1},F="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",N="[\\x20\\t\\r\\n\\f]",U="(?:\\\\[\\da-fA-F]{1,6}"+N+"?|\\\\[^\\r\\n\\f]|[\\w-]|[^\0-\\x7f])+",j="\\["+N+"*("+U+")(?:"+N+"*([*^$|!~]?=)"+N+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+U+"))|)"+N+"*\\]",B=":("+U+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+j+")*)|.*)\\)|)",z=new RegExp(N+"+","g"),H=new RegExp("^"+N+"+|((?:^|[^\\\\])(?:\\\\.)*)"+N+"+$","g"),G=new RegExp("^"+N+"*,"+N+"*"),V=new RegExp("^"+N+"*([>+~]|"+N+")"+N+"*"),W=new RegExp(N+"|>"),X=new RegExp(B),q=new RegExp("^"+U+"$"),Y={ID:new RegExp("^#("+U+")"),CLASS:new RegExp("^\\.("+U+")"),TAG:new RegExp("^("+U+"|[*])"),ATTR:new RegExp("^"+j),PSEUDO:new RegExp("^"+B),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+N+"*(even|odd|(([+-]|)(\\d*)n|)"+N+"*(?:([+-]|)"+N+"*(\\d+)|))"+N+"*\\)|)","i"),bool:new RegExp("^(?:"+F+")$","i"),needsContext:new RegExp("^"+N+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+N+"*((?:-\\d)?\\d*)"+N+"*\\)|)(?=[^-]|$)","i")},Z=/HTML$/i,$=/^(?:input|select|textarea|button)$/i,Q=/^h\d$/i,J=/^[^{]+\{\s*\[native \w/,K=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,tt=/[+~]/,et=new RegExp("\\\\[\\da-fA-F]{1,6}"+N+"?|\\\\([^\\r\\n\\f])","g"),nt=function(t,e){var n="0x"+t.slice(1)-65536;return e||(n<0?String.fromCharCode(n+65536):String.fromCharCode(n>>10|55296,1023&n|56320))},it=/([\0-\x1f\x7f]|^-?\d)|^-$|[^\0-\x1f\x7f-\uFFFF\w-]/g,rt=function(t,e){return e?"\0"===t?"ï¿½":t.slice(0,-1)+"\\"+t.charCodeAt(t.length-1).toString(16)+" ":"\\"+t},ot=function(){d()},at=xt((function(t){return!0===t.disabled&&"fieldset"===t.nodeName.toLowerCase()}),{dir:"parentNode",next:"legend"});try{I.apply(R=D.call(w.childNodes),w.childNodes),R[w.childNodes.length].nodeType}catch(t){I={apply:R.length?function(t,e){k.apply(t,D.call(e))}:function(t,e){for(var n=t.length,i=0;t[n++]=e[i++];);t.length=n-1}}}function st(t,e,i,r){var o,s,l,h,u,f,v,y=e&&e.ownerDocument,w=e?e.nodeType:9;if(i=i||[],"string"!=typeof t||!t||1!==w&&9!==w&&11!==w)return i;if(!r&&(d(e),e=e||p,m)){if(11!==w&&(u=K.exec(t)))if(o=u[1]){if(9===w){if(!(l=e.getElementById(o)))return i;if(l.id===o)return i.push(l),i}else if(y&&(l=y.getElementById(o))&&b(e,l)&&l.id===o)return i.push(l),i}else{if(u[2])return I.apply(i,e.getElementsByTagName(t)),i;if((o=u[3])&&n.getElementsByClassName&&e.getElementsByClassName)return I.apply(i,e.getElementsByClassName(o)),i}if(n.qsa&&!M[t+" "]&&(!g||!g.test(t))&&(1!==w||"object"!==e.nodeName.toLowerCase())){if(v=t,y=e,1===w&&(W.test(t)||V.test(t))){for((y=tt.test(t)&&vt(e.parentNode)||e)===e&&n.scope||((h=e.getAttribute("id"))?h=h.replace(it,rt):e.setAttribute("id",h=x)),s=(f=a(t)).length;s--;)f[s]=(h?"#"+h:":scope")+" "+bt(f[s]);v=f.join(",")}try{return I.apply(i,y.querySelectorAll(v)),i}catch(e){M(t,!0)}finally{h===x&&e.removeAttribute("id")}}}return c(t.replace(H,"$1"),e,i,r)}function ct(){var t=[];return function e(n,r){return t.push(n+" ")>i.cacheLength&&delete e[t.shift()],e[n+" "]=r}}function lt(t){return t[x]=!0,t}function ht(t){var e=p.createElement("fieldset");try{return!!t(e)}catch(t){return!1}finally{e.parentNode&&e.parentNode.removeChild(e),e=null}}function ut(t,e){for(var n=t.split("|"),r=n.length;r--;)i.attrHandle[n[r]]=e}function dt(t,e){var n=e&&t,i=n&&1===t.nodeType&&1===e.nodeType&&t.sourceIndex-e.sourceIndex;if(i)return i;if(n)for(;n=n.nextSibling;)if(n===e)return-1;return t?1:-1}function pt(t){return function(e){return"input"===e.nodeName.toLowerCase()&&e.type===t}}function ft(t){return function(e){var n=e.nodeName.toLowerCase();return("input"===n||"button"===n)&&e.type===t}}function mt(t){return function(e){return"form"in e?e.parentNode&&!1===e.disabled?"label"in e?"label"in e.parentNode?e.parentNode.disabled===t:e.disabled===t:e.isDisabled===t||e.isDisabled!==!t&&at(e)===t:e.disabled===t:"label"in e&&e.disabled===t}}function gt(t){return lt((function(e){return e=+e,lt((function(n,i){for(var r,o=t([],n.length,e),a=o.length;a--;)n[r=o[a]]&&(n[r]=!(i[r]=n[r]))}))}))}function vt(t){return t&&void 0!==t.getElementsByTagName&&t}for(e in n=st.support={},o=st.isXML=function(t){var e=t.namespaceURI,n=(t.ownerDocument||t).documentElement;return!Z.test(e||n&&n.nodeName||"HTML")},d=st.setDocument=function(t){var e,r,a=t?t.ownerDocument||t:w;return a!=p&&9===a.nodeType&&a.documentElement?(f=(p=a).documentElement,m=!o(p),w!=p&&(r=p.defaultView)&&r.top!==r&&(r.addEventListener?r.addEventListener("unload",ot,!1):r.attachEvent&&r.attachEvent("onunload",ot)),n.scope=ht((function(t){return f.appendChild(t).appendChild(p.createElement("div")),void 0!==t.querySelectorAll&&!t.querySelectorAll(":scope fieldset div").length})),n.attributes=ht((function(t){return t.className="i",!t.getAttribute("className")})),n.getElementsByTagName=ht((function(t){return t.appendChild(p.createComment("")),!t.getElementsByTagName("*").length})),n.getElementsByClassName=J.test(p.getElementsByClassName),n.getById=ht((function(t){return f.appendChild(t).id=x,!p.getElementsByName||!p.getElementsByName(x).length})),n.getById?(i.filter.ID=function(t){var e=t.replace(et,nt);return function(t){return t.getAttribute("id")===e}},i.find.ID=function(t,e){if(void 0!==e.getElementById&&m){var n=e.getElementById(t);return n?[n]:[]}}):(i.filter.ID=function(t){var e=t.replace(et,nt);return function(t){var n=void 0!==t.getAttributeNode&&t.getAttributeNode("id");return n&&n.value===e}},i.find.ID=function(t,e){if(void 0!==e.getElementById&&m){var n,i,r,o=e.getElementById(t);if(o){if((n=o.getAttributeNode("id"))&&n.value===t)return[o];for(r=e.getElementsByName(t),i=0;o=r[i++];)if((n=o.getAttributeNode("id"))&&n.value===t)return[o]}return[]}}),i.find.TAG=n.getElementsByTagName?function(t,e){return void 0!==e.getElementsByTagName?e.getElementsByTagName(t):n.qsa?e.querySelectorAll(t):void 0}:function(t,e){var n,i=[],r=0,o=e.getElementsByTagName(t);if("*"===t){for(;n=o[r++];)1===n.nodeType&&i.push(n);return i}return o},i.find.CLASS=n.getElementsByClassName&&function(t,e){if(void 0!==e.getElementsByClassName&&m)return e.getElementsByClassName(t)},v=[],g=[],(n.qsa=J.test(p.querySelectorAll))&&(ht((function(t){var e;f.appendChild(t).innerHTML="<a id='"+x+"'></a><select id='"+x+"-\r\\' msallowcapture=''><option selected=''></option></select>",t.querySelectorAll("[msallowcapture^='']").length&&g.push("[*^$]="+N+"*(?:''|\"\")"),t.querySelectorAll("[selected]").length||g.push("\\["+N+"*(?:value|"+F+")"),t.querySelectorAll("[id~="+x+"-]").length||g.push("~="),(e=p.createElement("input")).setAttribute("name",""),t.appendChild(e),t.querySelectorAll("[name='']").length||g.push("\\["+N+"*name"+N+"*="+N+"*(?:''|\"\")"),t.querySelectorAll(":checked").length||g.push(":checked"),t.querySelectorAll("a#"+x+"+*").length||g.push(".#.+[+~]"),t.querySelectorAll("\\\f"),g.push("[\\r\\n\\f]")})),ht((function(t){t.innerHTML="<a href='' disabled='disabled'></a><select disabled='disabled'><option/></select>";var e=p.createElement("input");e.setAttribute("type","hidden"),t.appendChild(e).setAttribute("name","D"),t.querySelectorAll("[name=d]").length&&g.push("name"+N+"*[*^$|!~]?="),2!==t.querySelectorAll(":enabled").length&&g.push(":enabled",":disabled"),f.appendChild(t).disabled=!0,2!==t.querySelectorAll(":disabled").length&&g.push(":enabled",":disabled"),t.querySelectorAll("*,:x"),g.push(",.*:")}))),(n.matchesSelector=J.test(y=f.matches||f.webkitMatchesSelector||f.mozMatchesSelector||f.oMatchesSelector||f.msMatchesSelector))&&ht((function(t){n.disconnectedMatch=y.call(t,"*"),y.call(t,"[s!='']:x"),v.push("!=",B)})),g=g.length&&new RegExp(g.join("|")),v=v.length&&new RegExp(v.join("|")),e=J.test(f.compareDocumentPosition),b=e||J.test(f.contains)?function(t,e){var n=9===t.nodeType?t.documentElement:t,i=e&&e.parentNode;return t===i||!(!i||1!==i.nodeType||!(n.contains?n.contains(i):t.compareDocumentPosition&&16&t.compareDocumentPosition(i)))}:function(t,e){if(e)for(;e=e.parentNode;)if(e===t)return!0;return!1},C=e?function(t,e){if(t===e)return u=!0,0;var i=!t.compareDocumentPosition-!e.compareDocumentPosition;return i||(1&(i=(t.ownerDocument||t)==(e.ownerDocument||e)?t.compareDocumentPosition(e):1)||!n.sortDetached&&e.compareDocumentPosition(t)===i?t==p||t.ownerDocument==w&&b(w,t)?-1:e==p||e.ownerDocument==w&&b(w,e)?1:h?O(h,t)-O(h,e):0:4&i?-1:1)}:function(t,e){if(t===e)return u=!0,0;var n,i=0,r=t.parentNode,o=e.parentNode,a=[t],s=[e];if(!r||!o)return t==p?-1:e==p?1:r?-1:o?1:h?O(h,t)-O(h,e):0;if(r===o)return dt(t,e);for(n=t;n=n.parentNode;)a.unshift(n);for(n=e;n=n.parentNode;)s.unshift(n);for(;a[i]===s[i];)i++;return i?dt(a[i],s[i]):a[i]==w?-1:s[i]==w?1:0},p):p},st.matches=function(t,e){return st(t,null,null,e)},st.matchesSelector=function(t,e){if(d(t),n.matchesSelector&&m&&!M[e+" "]&&(!v||!v.test(e))&&(!g||!g.test(e)))try{var i=y.call(t,e);if(i||n.disconnectedMatch||t.document&&11!==t.document.nodeType)return i}catch(t){M(e,!0)}return st(e,p,null,[t]).length>0},st.contains=function(t,e){return(t.ownerDocument||t)!=p&&d(t),b(t,e)},st.attr=function(t,e){(t.ownerDocument||t)!=p&&d(t);var r=i.attrHandle[e.toLowerCase()],o=r&&P.call(i.attrHandle,e.toLowerCase())?r(t,e,!m):void 0;return void 0!==o?o:n.attributes||!m?t.getAttribute(e):(o=t.getAttributeNode(e))&&o.specified?o.value:null},st.escape=function(t){return(t+"").replace(it,rt)},st.error=function(t){throw new Error("Syntax error, unrecognized expression: "+t)},st.uniqueSort=function(t){var e,i=[],r=0,o=0;if(u=!n.detectDuplicates,h=!n.sortStable&&t.slice(0),t.sort(C),u){for(;e=t[o++];)e===t[o]&&(r=i.push(o));for(;r--;)t.splice(i[r],1)}return h=null,t},r=st.getText=function(t){var e,n="",i=0,o=t.nodeType;if(o){if(1===o||9===o||11===o){if("string"==typeof t.textContent)return t.textContent;for(t=t.firstChild;t;t=t.nextSibling)n+=r(t)}else if(3===o||4===o)return t.nodeValue}else for(;e=t[i++];)n+=r(e);return n},(i=st.selectors={cacheLength:50,createPseudo:lt,match:Y,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(t){return t[1]=t[1].replace(et,nt),t[3]=(t[3]||t[4]||t[5]||"").replace(et,nt),"~="===t[2]&&(t[3]=" "+t[3]+" "),t.slice(0,4)},CHILD:function(t){return t[1]=t[1].toLowerCase(),"nth"===t[1].slice(0,3)?(t[3]||st.error(t[0]),t[4]=+(t[4]?t[5]+(t[6]||1):2*("even"===t[3]||"odd"===t[3])),t[5]=+(t[7]+t[8]||"odd"===t[3])):t[3]&&st.error(t[0]),t},PSEUDO:function(t){var e,n=!t[6]&&t[2];return Y.CHILD.test(t[0])?null:(t[3]?t[2]=t[4]||t[5]||"":n&&X.test(n)&&(e=a(n,!0))&&(e=n.indexOf(")",n.length-e)-n.length)&&(t[0]=t[0].slice(0,e),t[2]=n.slice(0,e)),t.slice(0,3))}},filter:{TAG:function(t){var e=t.replace(et,nt).toLowerCase();return"*"===t?function(){return!0}:function(t){return t.nodeName&&t.nodeName.toLowerCase()===e}},CLASS:function(t){var e=E[t+" "];return e||(e=new RegExp("(^|"+N+")"+t+"("+N+"|$)"))&&E(t,(function(t){return e.test("string"==typeof t.className&&t.className||void 0!==t.getAttribute&&t.getAttribute("class")||"")}))},ATTR:function(t,e,n){return function(i){var r=st.attr(i,t);return null==r?"!="===e:!e||(r+="","="===e?r===n:"!="===e?r!==n:"^="===e?n&&0===r.indexOf(n):"*="===e?n&&r.indexOf(n)>-1:"$="===e?n&&r.slice(-n.length)===n:"~="===e?(" "+r.replace(z," ")+" ").indexOf(n)>-1:"|="===e&&(r===n||r.slice(0,n.length+1)===n+"-"))}},CHILD:function(t,e,n,i,r){var o="nth"!==t.slice(0,3),a="last"!==t.slice(-4),s="of-type"===e;return 1===i&&0===r?function(t){return!!t.parentNode}:function(e,n,c){var l,h,u,d,p,f,m=o!==a?"nextSibling":"previousSibling",g=e.parentNode,v=s&&e.nodeName.toLowerCase(),y=!c&&!s,b=!1;if(g){if(o){for(;m;){for(d=e;d=d[m];)if(s?d.nodeName.toLowerCase()===v:1===d.nodeType)return!1;f=m="only"===t&&!f&&"nextSibling"}return!0}if(f=[a?g.firstChild:g.lastChild],a&&y){for(b=(p=(l=(h=(u=(d=g)[x]||(d[x]={}))[d.uniqueID]||(u[d.uniqueID]={}))[t]||[])[0]===_&&l[1])&&l[2],d=p&&g.childNodes[p];d=++p&&d&&d[m]||(b=p=0)||f.pop();)if(1===d.nodeType&&++b&&d===e){h[t]=[_,p,b];break}}else if(y&&(b=p=(l=(h=(u=(d=e)[x]||(d[x]={}))[d.uniqueID]||(u[d.uniqueID]={}))[t]||[])[0]===_&&l[1]),!1===b)for(;(d=++p&&d&&d[m]||(b=p=0)||f.pop())&&((s?d.nodeName.toLowerCase()!==v:1!==d.nodeType)||!++b||(y&&((h=(u=d[x]||(d[x]={}))[d.uniqueID]||(u[d.uniqueID]={}))[t]=[_,b]),d!==e)););return(b-=r)===i||b%i==0&&b/i>=0}}},PSEUDO:function(t,e){var n,r=i.pseudos[t]||i.setFilters[t.toLowerCase()]||st.error("unsupported pseudo: "+t);return r[x]?r(e):r.length>1?(n=[t,t,"",e],i.setFilters.hasOwnProperty(t.toLowerCase())?lt((function(t,n){for(var i,o=r(t,e),a=o.length;a--;)t[i=O(t,o[a])]=!(n[i]=o[a])})):function(t){return r(t,0,n)}):r}},pseudos:{not:lt((function(t){var e=[],n=[],i=s(t.replace(H,"$1"));return i[x]?lt((function(t,e,n,r){for(var o,a=i(t,null,r,[]),s=t.length;s--;)(o=a[s])&&(t[s]=!(e[s]=o))})):function(t,r,o){return e[0]=t,i(e,null,o,n),e[0]=null,!n.pop()}})),has:lt((function(t){return function(e){return st(t,e).length>0}})),contains:lt((function(t){return t=t.replace(et,nt),function(e){return(e.textContent||r(e)).indexOf(t)>-1}})),lang:lt((function(t){return q.test(t||"")||st.error("unsupported lang: "+t),t=t.replace(et,nt).toLowerCase(),function(e){var n;do{if(n=m?e.lang:e.getAttribute("xml:lang")||e.getAttribute("lang"))return(n=n.toLowerCase())===t||0===n.indexOf(t+"-")}while((e=e.parentNode)&&1===e.nodeType);return!1}})),target:function(e){var n=t.location&&t.location.hash;return n&&n.slice(1)===e.id},root:function(t){return t===f},focus:function(t){return t===p.activeElement&&(!p.hasFocus||p.hasFocus())&&!!(t.type||t.href||~t.tabIndex)},enabled:mt(!1),disabled:mt(!0),checked:function(t){var e=t.nodeName.toLowerCase();return"input"===e&&!!t.checked||"option"===e&&!!t.selected},selected:function(t){return t.parentNode&&t.parentNode.selectedIndex,!0===t.selected},empty:function(t){for(t=t.firstChild;t;t=t.nextSibling)if(t.nodeType<6)return!1;return!0},parent:function(t){return!i.pseudos.empty(t)},header:function(t){return Q.test(t.nodeName)},input:function(t){return $.test(t.nodeName)},button:function(t){var e=t.nodeName.toLowerCase();return"input"===e&&"button"===t.type||"button"===e},text:function(t){var e;return"input"===t.nodeName.toLowerCase()&&"text"===t.type&&(null==(e=t.getAttribute("type"))||"text"===e.toLowerCase())},first:gt((function(){return[0]})),last:gt((function(t,e){return[e-1]})),eq:gt((function(t,e,n){return[n<0?n+e:n]})),even:gt((function(t,e){for(var n=0;n<e;n+=2)t.push(n);return t})),odd:gt((function(t,e){for(var n=1;n<e;n+=2)t.push(n);return t})),lt:gt((function(t,e,n){for(var i=n<0?n+e:n>e?e:n;--i>=0;)t.push(i);return t})),gt:gt((function(t,e,n){for(var i=n<0?n+e:n;++i<e;)t.push(i);return t}))}}).pseudos.nth=i.pseudos.eq,{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})i.pseudos[e]=pt(e);for(e in{submit:!0,reset:!0})i.pseudos[e]=ft(e);function yt(){}function bt(t){for(var e=0,n=t.length,i="";e<n;e++)i+=t[e].value;return i}function xt(t,e,n){var i=e.dir,r=e.next,o=r||i,a=n&&"parentNode"===o,s=S++;return e.first?function(e,n,r){for(;e=e[i];)if(1===e.nodeType||a)return t(e,n,r);return!1}:function(e,n,c){var l,h,u,d=[_,s];if(c){for(;e=e[i];)if((1===e.nodeType||a)&&t(e,n,c))return!0}else for(;e=e[i];)if(1===e.nodeType||a)if(h=(u=e[x]||(e[x]={}))[e.uniqueID]||(u[e.uniqueID]={}),r&&r===e.nodeName.toLowerCase())e=e[i]||e;else{if((l=h[o])&&l[0]===_&&l[1]===s)return d[2]=l[2];if(h[o]=d,d[2]=t(e,n,c))return!0}return!1}}function wt(t){return t.length>1?function(e,n,i){for(var r=t.length;r--;)if(!t[r](e,n,i))return!1;return!0}:t[0]}function _t(t,e,n,i,r){for(var o,a=[],s=0,c=t.length,l=null!=e;s<c;s++)(o=t[s])&&(n&&!n(o,i,r)||(a.push(o),l&&e.push(s)));return a}function St(t,e,n,i,r,o){return i&&!i[x]&&(i=St(i)),r&&!r[x]&&(r=St(r,o)),lt((function(o,a,s,c){var l,h,u,d=[],p=[],f=a.length,m=o||function(t,e,n){for(var i=0,r=e.length;i<r;i++)st(t,e[i],n);return n}(e||"*",s.nodeType?[s]:s,[]),g=!t||!o&&e?m:_t(m,d,t,s,c),v=n?r||(o?t:f||i)?[]:a:g;if(n&&n(g,v,s,c),i)for(l=_t(v,p),i(l,[],s,c),h=l.length;h--;)(u=l[h])&&(v[p[h]]=!(g[p[h]]=u));if(o){if(r||t){if(r){for(l=[],h=v.length;h--;)(u=v[h])&&l.push(g[h]=u);r(null,v=[],l,c)}for(h=v.length;h--;)(u=v[h])&&(l=r?O(o,u):d[h])>-1&&(o[l]=!(a[l]=u))}}else v=_t(v===a?v.splice(f,v.length):v),r?r(null,a,v,c):I.apply(a,v)}))}function Et(t){for(var e,n,r,o=t.length,a=i.relative[t[0].type],s=a||i.relative[" "],c=a?1:0,h=xt((function(t){return t===e}),s,!0),u=xt((function(t){return O(e,t)>-1}),s,!0),d=[function(t,n,i){var r=!a&&(i||n!==l)||((e=n).nodeType?h(t,n,i):u(t,n,i));return e=null,r}];c<o;c++)if(n=i.relative[t[c].type])d=[xt(wt(d),n)];else{if((n=i.filter[t[c].type].apply(null,t[c].matches))[x]){for(r=++c;r<o&&!i.relative[t[r].type];r++);return St(c>1&&wt(d),c>1&&bt(t.slice(0,c-1).concat({value:" "===t[c-2].type?"*":""})).replace(H,"$1"),n,c<r&&Et(t.slice(c,r)),r<o&&Et(t=t.slice(r)),r<o&&bt(t))}d.push(n)}return wt(d)}return yt.prototype=i.filters=i.pseudos,i.setFilters=new yt,a=st.tokenize=function(t,e){var n,r,o,a,s,c,l,h=A[t+" "];if(h)return e?0:h.slice(0);for(s=t,c=[],l=i.preFilter;s;){for(a in n&&!(r=G.exec(s))||(r&&(s=s.slice(r[0].length)||s),c.push(o=[])),n=!1,(r=V.exec(s))&&(n=r.shift(),o.push({value:n,type:r[0].replace(H," ")}),s=s.slice(n.length)),i.filter)!(r=Y[a].exec(s))||l[a]&&!(r=l[a](r))||(n=r.shift(),o.push({value:n,type:a,matches:r}),s=s.slice(n.length));if(!n)break}return e?s.length:s?st.error(t):A(t,c).slice(0)},s=st.compile=function(t,e){var n,r=[],o=[],s=T[t+" "];if(!s){for(e||(e=a(t)),n=e.length;n--;)(s=Et(e[n]))[x]?r.push(s):o.push(s);(s=T(t,function(t,e){var n=e.length>0,r=t.length>0,o=function(o,a,s,c,h){var u,f,g,v=0,y="0",b=o&&[],x=[],w=l,S=o||r&&i.find.TAG("*",h),E=_+=null==w?1:Math.random()||.1,A=S.length;for(h&&(l=a==p||a||h);y!==A&&null!=(u=S[y]);y++){if(r&&u){for(f=0,a||u.ownerDocument==p||(d(u),s=!m);g=t[f++];)if(g(u,a||p,s)){c.push(u);break}h&&(_=E)}n&&((u=!g&&u)&&v--,o&&b.push(u))}if(v+=y,n&&y!==v){for(f=0;g=e[f++];)g(b,x,a,s);if(o){if(v>0)for(;y--;)b[y]||x[y]||(x[y]=L.call(c));x=_t(x)}I.apply(c,x),h&&!o&&x.length>0&&v+e.length>1&&st.uniqueSort(c)}return h&&(_=E,l=w),b};return n?lt(o):o}(o,r))).selector=t}return s},c=st.select=function(t,e,n,r){var o,c,l,h,u,d="function"==typeof t&&t,p=!r&&a(t=d.selector||t);if(n=n||[],1===p.length){if((c=p[0]=p[0].slice(0)).length>2&&"ID"===(l=c[0]).type&&9===e.nodeType&&m&&i.relative[c[1].type]){if(!(e=(i.find.ID(l.matches[0].replace(et,nt),e)||[])[0]))return n;d&&(e=e.parentNode),t=t.slice(c.shift().value.length)}for(o=Y.needsContext.test(t)?0:c.length;o--&&(l=c[o],!i.relative[h=l.type]);)if((u=i.find[h])&&(r=u(l.matches[0].replace(et,nt),tt.test(c[0].type)&&vt(e.parentNode)||e))){if(c.splice(o,1),!(t=r.length&&bt(c)))return I.apply(n,r),n;break}}return(d||s(t,p))(r,e,!m,n,!e||tt.test(t)&&vt(e.parentNode)||e),n},n.sortStable=x.split("").sort(C).join("")===x,n.detectDuplicates=!!u,d(),n.sortDetached=ht((function(t){return 1&t.compareDocumentPosition(p.createElement("fieldset"))})),ht((function(t){return t.innerHTML="<a href='#'></a>","#"===t.firstChild.getAttribute("href")}))||ut("type|href|height|width",(function(t,e,n){if(!n)return t.getAttribute(e,"type"===e.toLowerCase()?1:2)})),n.attributes&&ht((function(t){return t.innerHTML="<input/>",t.firstChild.setAttribute("value",""),""===t.firstChild.getAttribute("value")}))||ut("value",(function(t,e,n){if(!n&&"input"===t.nodeName.toLowerCase())return t.defaultValue})),ht((function(t){return null==t.getAttribute("disabled")}))||ut(F,(function(t,e,n){var i;if(!n)return!0===t[e]?e.toLowerCase():(i=t.getAttributeNode(e))&&i.specified?i.value:null})),st}(n);S.find=A,S.expr=A.selectors,S.expr[":"]=S.expr.pseudos,S.uniqueSort=S.unique=A.uniqueSort,S.text=A.getText,S.isXMLDoc=A.isXML,S.contains=A.contains,S.escapeSelector=A.escape;var T=function(t,e,n){for(var i=[],r=void 0!==n;(t=t[e])&&9!==t.nodeType;)if(1===t.nodeType){if(r&&S(t).is(n))break;i.push(t)}return i},M=function(t,e){for(var n=[];t;t=t.nextSibling)1===t.nodeType&&t!==e&&n.push(t);return n},C=S.expr.match.needsContext;function P(t,e){return t.nodeName&&t.nodeName.toLowerCase()===e.toLowerCase()}var R=/^<([a-z][^\/\0>:\x20\t\r\n\f]*)[\x20\t\r\n\f]*\/?>(?:<\/\1>|)$/i;function L(t,e,n){return v(e)?S.grep(t,(function(t,i){return!!e.call(t,i,t)!==n})):e.nodeType?S.grep(t,(function(t){return t===e!==n})):"string"!=typeof e?S.grep(t,(function(t){return h.call(e,t)>-1!==n})):S.filter(e,t,n)}S.filter=function(t,e,n){var i=e[0];return n&&(t=":not("+t+")"),1===e.length&&1===i.nodeType?S.find.matchesSelector(i,t)?[i]:[]:S.find.matches(t,S.grep(e,(function(t){return 1===t.nodeType})))},S.fn.extend({find:function(t){var e,n,i=this.length,r=this;if("string"!=typeof t)return this.pushStack(S(t).filter((function(){for(e=0;e<i;e++)if(S.contains(r[e],this))return!0})));for(n=this.pushStack([]),e=0;e<i;e++)S.find(t,r[e],n);return i>1?S.uniqueSort(n):n},filter:function(t){return this.pushStack(L(this,t||[],!1))},not:function(t){return this.pushStack(L(this,t||[],!0))},is:function(t){return!!L(this,"string"==typeof t&&C.test(t)?S(t):t||[],!1).length}});var k,I=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]+))$/;(S.fn.init=function(t,e,n){var i,r;if(!t)return this;if(n=n||k,"string"==typeof t){if(!(i="<"===t[0]&&">"===t[t.length-1]&&t.length>=3?[null,t,null]:I.exec(t))||!i[1]&&e)return!e||e.jquery?(e||n).find(t):this.constructor(e).find(t);if(i[1]){if(e=e instanceof S?e[0]:e,S.merge(this,S.parseHTML(i[1],e&&e.nodeType?e.ownerDocument||e:b,!0)),R.test(i[1])&&S.isPlainObject(e))for(i in e)v(this[i])?this[i](e[i]):this.attr(i,e[i]);return this}return(r=b.getElementById(i[2]))&&(this[0]=r,this.length=1),this}return t.nodeType?(this[0]=t,this.length=1,this):v(t)?void 0!==n.ready?n.ready(t):t(S):S.makeArray(t,this)}).prototype=S.fn,k=S(b);var D=/^(?:parents|prev(?:Until|All))/,O={children:!0,contents:!0,next:!0,prev:!0};function F(t,e){for(;(t=t[e])&&1!==t.nodeType;);return t}S.fn.extend({has:function(t){var e=S(t,this),n=e.length;return this.filter((function(){for(var t=0;t<n;t++)if(S.contains(this,e[t]))return!0}))},closest:function(t,e){var n,i=0,r=this.length,o=[],a="string"!=typeof t&&S(t);if(!C.test(t))for(;i<r;i++)for(n=this[i];n&&n!==e;n=n.parentNode)if(n.nodeType<11&&(a?a.index(n)>-1:1===n.nodeType&&S.find.matchesSelector(n,t))){o.push(n);break}return this.pushStack(o.length>1?S.uniqueSort(o):o)},index:function(t){return t?"string"==typeof t?h.call(S(t),this[0]):h.call(this,t.jquery?t[0]:t):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(t,e){return this.pushStack(S.uniqueSort(S.merge(this.get(),S(t,e))))},addBack:function(t){return this.add(null==t?this.prevObject:this.prevObject.filter(t))}}),S.each({parent:function(t){var e=t.parentNode;return e&&11!==e.nodeType?e:null},parents:function(t){return T(t,"parentNode")},parentsUntil:function(t,e,n){return T(t,"parentNode",n)},next:function(t){return F(t,"nextSibling")},prev:function(t){return F(t,"previousSibling")},nextAll:function(t){return T(t,"nextSibling")},prevAll:function(t){return T(t,"previousSibling")},nextUntil:function(t,e,n){return T(t,"nextSibling",n)},prevUntil:function(t,e,n){return T(t,"previousSibling",n)},siblings:function(t){return M((t.parentNode||{}).firstChild,t)},children:function(t){return M(t.firstChild)},contents:function(t){return null!=t.contentDocument&&a(t.contentDocument)?t.contentDocument:(P(t,"template")&&(t=t.content||t),S.merge([],t.childNodes))}},(function(t,e){S.fn[t]=function(n,i){var r=S.map(this,e,n);return"Until"!==t.slice(-5)&&(i=n),i&&"string"==typeof i&&(r=S.filter(i,r)),this.length>1&&(O[t]||S.uniqueSort(r),D.test(t)&&r.reverse()),this.pushStack(r)}}));var N=/[^\x20\t\r\n\f]+/g;function U(t){return t}function j(t){throw t}function B(t,e,n,i){var r;try{t&&v(r=t.promise)?r.call(t).done(e).fail(n):t&&v(r=t.then)?r.call(t,e,n):e.apply(void 0,[t].slice(i))}catch(t){n.apply(void 0,[t])}}S.Callbacks=function(t){t="string"==typeof t?function(t){var e={};return S.each(t.match(N)||[],(function(t,n){e[n]=!0})),e}(t):S.extend({},t);var e,n,i,r,o=[],a=[],s=-1,c=function(){for(r=r||t.once,i=e=!0;a.length;s=-1)for(n=a.shift();++s<o.length;)!1===o[s].apply(n[0],n[1])&&t.stopOnFalse&&(s=o.length,n=!1);t.memory||(n=!1),e=!1,r&&(o=n?[]:"")},l={add:function(){return o&&(n&&!e&&(s=o.length-1,a.push(n)),function e(n){S.each(n,(function(n,i){v(i)?t.unique&&l.has(i)||o.push(i):i&&i.length&&"string"!==_(i)&&e(i)}))}(arguments),n&&!e&&c()),this},remove:function(){return S.each(arguments,(function(t,e){for(var n;(n=S.inArray(e,o,n))>-1;)o.splice(n,1),n<=s&&s--})),this},has:function(t){return t?S.inArray(t,o)>-1:o.length>0},empty:function(){return o&&(o=[]),this},disable:function(){return r=a=[],o=n="",this},disabled:function(){return!o},lock:function(){return r=a=[],n||e||(o=n=""),this},locked:function(){return!!r},fireWith:function(t,n){return r||(n=[t,(n=n||[]).slice?n.slice():n],a.push(n),e||c()),this},fire:function(){return l.fireWith(this,arguments),this},fired:function(){return!!i}};return l},S.extend({Deferred:function(t){var e=[["notify","progress",S.Callbacks("memory"),S.Callbacks("memory"),2],["resolve","done",S.Callbacks("once memory"),S.Callbacks("once memory"),0,"resolved"],["reject","fail",S.Callbacks("once memory"),S.Callbacks("once memory"),1,"rejected"]],i="pending",r={state:function(){return i},always:function(){return o.done(arguments).fail(arguments),this},catch:function(t){return r.then(null,t)},pipe:function(){var t=arguments;return S.Deferred((function(n){S.each(e,(function(e,i){var r=v(t[i[4]])&&t[i[4]];o[i[1]]((function(){var t=r&&r.apply(this,arguments);t&&v(t.promise)?t.promise().progress(n.notify).done(n.resolve).fail(n.reject):n[i[0]+"With"](this,r?[t]:arguments)}))})),t=null})).promise()},then:function(t,i,r){var o=0;function a(t,e,i,r){return function(){var s=this,c=arguments,l=function(){var n,l;if(!(t<o)){if((n=i.apply(s,c))===e.promise())throw new TypeError("Thenable self-resolution");l=n&&("object"==typeof n||"function"==typeof n)&&n.then,v(l)?r?l.call(n,a(o,e,U,r),a(o,e,j,r)):(o++,l.call(n,a(o,e,U,r),a(o,e,j,r),a(o,e,U,e.notifyWith))):(i!==U&&(s=void 0,c=[n]),(r||e.resolveWith)(s,c))}},h=r?l:function(){try{l()}catch(n){S.Deferred.exceptionHook&&S.Deferred.exceptionHook(n,h.stackTrace),t+1>=o&&(i!==j&&(s=void 0,c=[n]),e.rejectWith(s,c))}};t?h():(S.Deferred.getStackHook&&(h.stackTrace=S.Deferred.getStackHook()),n.setTimeout(h))}}return S.Deferred((function(n){e[0][3].add(a(0,n,v(r)?r:U,n.notifyWith)),e[1][3].add(a(0,n,v(t)?t:U)),e[2][3].add(a(0,n,v(i)?i:j))})).promise()},promise:function(t){return null!=t?S.extend(t,r):r}},o={};return S.each(e,(function(t,n){var a=n[2],s=n[5];r[n[1]]=a.add,s&&a.add((function(){i=s}),e[3-t][2].disable,e[3-t][3].disable,e[0][2].lock,e[0][3].lock),a.add(n[3].fire),o[n[0]]=function(){return o[n[0]+"With"](this===o?void 0:this,arguments),this},o[n[0]+"With"]=a.fireWith})),r.promise(o),t&&t.call(o,o),o},when:function(t){var e=arguments.length,n=e,i=Array(n),r=s.call(arguments),o=S.Deferred(),a=function(t){return function(n){i[t]=this,r[t]=arguments.length>1?s.call(arguments):n,--e||o.resolveWith(i,r)}};if(e<=1&&(B(t,o.done(a(n)).resolve,o.reject,!e),"pending"===o.state()||v(r[n]&&r[n].then)))return o.then();for(;n--;)B(r[n],a(n),o.reject);return o.promise()}});var z=/^(Eval|Internal|Range|Reference|Syntax|Type|URI)Error$/;S.Deferred.exceptionHook=function(t,e){n.console&&n.console.warn&&t&&z.test(t.name)&&n.console.warn("jQuery.Deferred exception: "+t.message,t.stack,e)},S.readyException=function(t){n.setTimeout((function(){throw t}))};var H=S.Deferred();function G(){b.removeEventListener("DOMContentLoaded",G),n.removeEventListener("load",G),S.ready()}S.fn.ready=function(t){return H.then(t).catch((function(t){S.readyException(t)})),this},S.extend({isReady:!1,readyWait:1,ready:function(t){(!0===t?--S.readyWait:S.isReady)||(S.isReady=!0,!0!==t&&--S.readyWait>0||H.resolveWith(b,[S]))}}),S.ready.then=H.then,"complete"===b.readyState||"loading"!==b.readyState&&!b.documentElement.doScroll?n.setTimeout(S.ready):(b.addEventListener("DOMContentLoaded",G),n.addEventListener("load",G));var V=function(t,e,n,i,r,o,a){var s=0,c=t.length,l=null==n;if("object"===_(n))for(s in r=!0,n)V(t,e,s,n[s],!0,o,a);else if(void 0!==i&&(r=!0,v(i)||(a=!0),l&&(a?(e.call(t,i),e=null):(l=e,e=function(t,e,n){return l.call(S(t),n)})),e))for(;s<c;s++)e(t[s],n,a?i:i.call(t[s],s,e(t[s],n)));return r?t:l?e.call(t):c?e(t[0],n):o},W=/^-ms-/,X=/-([a-z])/g;function q(t,e){return e.toUpperCase()}function Y(t){return t.replace(W,"ms-").replace(X,q)}var Z=function(t){return 1===t.nodeType||9===t.nodeType||!+t.nodeType};function $(){this.expando=S.expando+$.uid++}$.uid=1,$.prototype={cache:function(t){var e=t[this.expando];return e||(e={},Z(t)&&(t.nodeType?t[this.expando]=e:Object.defineProperty(t,this.expando,{value:e,configurable:!0}))),e},set:function(t,e,n){var i,r=this.cache(t);if("string"==typeof e)r[Y(e)]=n;else for(i in e)r[Y(i)]=e[i];return r},get:function(t,e){return void 0===e?this.cache(t):t[this.expando]&&t[this.expando][Y(e)]},access:function(t,e,n){return void 0===e||e&&"string"==typeof e&&void 0===n?this.get(t,e):(this.set(t,e,n),void 0!==n?n:e)},remove:function(t,e){var n,i=t[this.expando];if(void 0!==i){if(void 0!==e){n=(e=Array.isArray(e)?e.map(Y):(e=Y(e))in i?[e]:e.match(N)||[]).length;for(;n--;)delete i[e[n]]}(void 0===e||S.isEmptyObject(i))&&(t.nodeType?t[this.expando]=void 0:delete t[this.expando])}},hasData:function(t){var e=t[this.expando];return void 0!==e&&!S.isEmptyObject(e)}};var Q=new $,J=new $,K=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,tt=/[A-Z]/g;function et(t,e,n){var i;if(void 0===n&&1===t.nodeType)if(i="data-"+e.replace(tt,"-$&").toLowerCase(),"string"==typeof(n=t.getAttribute(i))){try{n=function(t){return"true"===t||"false"!==t&&("null"===t?null:t===+t+""?+t:K.test(t)?JSON.parse(t):t)}(n)}catch(t){}J.set(t,e,n)}else n=void 0;return n}S.extend({hasData:function(t){return J.hasData(t)||Q.hasData(t)},data:function(t,e,n){return J.access(t,e,n)},removeData:function(t,e){J.remove(t,e)},_data:function(t,e,n){return Q.access(t,e,n)},_removeData:function(t,e){Q.remove(t,e)}}),S.fn.extend({data:function(t,e){var n,i,r,o=this[0],a=o&&o.attributes;if(void 0===t){if(this.length&&(r=J.get(o),1===o.nodeType&&!Q.get(o,"hasDataAttrs"))){for(n=a.length;n--;)a[n]&&0===(i=a[n].name).indexOf("data-")&&(i=Y(i.slice(5)),et(o,i,r[i]));Q.set(o,"hasDataAttrs",!0)}return r}return"object"==typeof t?this.each((function(){J.set(this,t)})):V(this,(function(e){var n;if(o&&void 0===e)return void 0!==(n=J.get(o,t))||void 0!==(n=et(o,t))?n:void 0;this.each((function(){J.set(this,t,e)}))}),null,e,arguments.length>1,null,!0)},removeData:function(t){return this.each((function(){J.remove(this,t)}))}}),S.extend({queue:function(t,e,n){var i;if(t)return e=(e||"fx")+"queue",i=Q.get(t,e),n&&(!i||Array.isArray(n)?i=Q.access(t,e,S.makeArray(n)):i.push(n)),i||[]},dequeue:function(t,e){e=e||"fx";var n=S.queue(t,e),i=n.length,r=n.shift(),o=S._queueHooks(t,e);"inprogress"===r&&(r=n.shift(),i--),r&&("fx"===e&&n.unshift("inprogress"),delete o.stop,r.call(t,(function(){S.dequeue(t,e)}),o)),!i&&o&&o.empty.fire()},_queueHooks:function(t,e){var n=e+"queueHooks";return Q.get(t,n)||Q.access(t,n,{empty:S.Callbacks("once memory").add((function(){Q.remove(t,[e+"queue",n])}))})}}),S.fn.extend({queue:function(t,e){var n=2;return"string"!=typeof t&&(e=t,t="fx",n--),arguments.length<n?S.queue(this[0],t):void 0===e?this:this.each((function(){var n=S.queue(this,t,e);S._queueHooks(this,t),"fx"===t&&"inprogress"!==n[0]&&S.dequeue(this,t)}))},dequeue:function(t){return this.each((function(){S.dequeue(this,t)}))},clearQueue:function(t){return this.queue(t||"fx",[])},promise:function(t,e){var n,i=1,r=S.Deferred(),o=this,a=this.length,s=function(){--i||r.resolveWith(o,[o])};for("string"!=typeof t&&(e=t,t=void 0),t=t||"fx";a--;)(n=Q.get(o[a],t+"queueHooks"))&&n.empty&&(i++,n.empty.add(s));return s(),r.promise(e)}});var nt=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,it=new RegExp("^(?:([+-])=|)("+nt+")([a-z%]*)$","i"),rt=["Top","Right","Bottom","Left"],ot=b.documentElement,at=function(t){return S.contains(t.ownerDocument,t)},st={composed:!0};ot.getRootNode&&(at=function(t){return S.contains(t.ownerDocument,t)||t.getRootNode(st)===t.ownerDocument});var ct=function(t,e){return"none"===(t=e||t).style.display||""===t.style.display&&at(t)&&"none"===S.css(t,"display")};function lt(t,e,n,i){var r,o,a=20,s=i?function(){return i.cur()}:function(){return S.css(t,e,"")},c=s(),l=n&&n[3]||(S.cssNumber[e]?"":"px"),h=t.nodeType&&(S.cssNumber[e]||"px"!==l&&+c)&&it.exec(S.css(t,e));if(h&&h[3]!==l){for(c/=2,l=l||h[3],h=+c||1;a--;)S.style(t,e,h+l),(1-o)*(1-(o=s()/c||.5))<=0&&(a=0),h/=o;h*=2,S.style(t,e,h+l),n=n||[]}return n&&(h=+h||+c||0,r=n[1]?h+(n[1]+1)*n[2]:+n[2],i&&(i.unit=l,i.start=h,i.end=r)),r}var ht={};function ut(t){var e,n=t.ownerDocument,i=t.nodeName,r=ht[i];return r||(e=n.body.appendChild(n.createElement(i)),r=S.css(e,"display"),e.parentNode.removeChild(e),"none"===r&&(r="block"),ht[i]=r,r)}function dt(t,e){for(var n,i,r=[],o=0,a=t.length;o<a;o++)(i=t[o]).style&&(n=i.style.display,e?("none"===n&&(r[o]=Q.get(i,"display")||null,r[o]||(i.style.display="")),""===i.style.display&&ct(i)&&(r[o]=ut(i))):"none"!==n&&(r[o]="none",Q.set(i,"display",n)));for(o=0;o<a;o++)null!=r[o]&&(t[o].style.display=r[o]);return t}S.fn.extend({show:function(){return dt(this,!0)},hide:function(){return dt(this)},toggle:function(t){return"boolean"==typeof t?t?this.show():this.hide():this.each((function(){ct(this)?S(this).show():S(this).hide()}))}});var pt,ft,mt=/^(?:checkbox|radio)$/i,gt=/<([a-z][^\/\0>\x20\t\r\n\f]*)/i,vt=/^$|^module$|\/(?:java|ecma)script/i;pt=b.createDocumentFragment().appendChild(b.createElement("div")),(ft=b.createElement("input")).setAttribute("type","radio"),ft.setAttribute("checked","checked"),ft.setAttribute("name","t"),pt.appendChild(ft),g.checkClone=pt.cloneNode(!0).cloneNode(!0).lastChild.checked,pt.innerHTML="<textarea>x</textarea>",g.noCloneChecked=!!pt.cloneNode(!0).lastChild.defaultValue,pt.innerHTML="<option></option>",g.option=!!pt.lastChild;var yt={thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};function bt(t,e){var n;return n=void 0!==t.getElementsByTagName?t.getElementsByTagName(e||"*"):void 0!==t.querySelectorAll?t.querySelectorAll(e||"*"):[],void 0===e||e&&P(t,e)?S.merge([t],n):n}function xt(t,e){for(var n=0,i=t.length;n<i;n++)Q.set(t[n],"globalEval",!e||Q.get(e[n],"globalEval"))}yt.tbody=yt.tfoot=yt.colgroup=yt.caption=yt.thead,yt.th=yt.td,g.option||(yt.optgroup=yt.option=[1,"<select multiple='multiple'>","</select>"]);var wt=/<|&#?\w+;/;function _t(t,e,n,i,r){for(var o,a,s,c,l,h,u=e.createDocumentFragment(),d=[],p=0,f=t.length;p<f;p++)if((o=t[p])||0===o)if("object"===_(o))S.merge(d,o.nodeType?[o]:o);else if(wt.test(o)){for(a=a||u.appendChild(e.createElement("div")),s=(gt.exec(o)||["",""])[1].toLowerCase(),c=yt[s]||yt._default,a.innerHTML=c[1]+S.htmlPrefilter(o)+c[2],h=c[0];h--;)a=a.lastChild;S.merge(d,a.childNodes),(a=u.firstChild).textContent=""}else d.push(e.createTextNode(o));for(u.textContent="",p=0;o=d[p++];)if(i&&S.inArray(o,i)>-1)r&&r.push(o);else if(l=at(o),a=bt(u.appendChild(o),"script"),l&&xt(a),n)for(h=0;o=a[h++];)vt.test(o.type||"")&&n.push(o);return u}var St=/^key/,Et=/^(?:mouse|pointer|contextmenu|drag|drop)|click/,At=/^([^.]*)(?:\.(.+)|)/;function Tt(){return!0}function Mt(){return!1}function Ct(t,e){return t===function(){try{return b.activeElement}catch(t){}}()==("focus"===e)}function Pt(t,e,n,i,r,o){var a,s;if("object"==typeof e){for(s in"string"!=typeof n&&(i=i||n,n=void 0),e)Pt(t,s,n,i,e[s],o);return t}if(null==i&&null==r?(r=n,i=n=void 0):null==r&&("string"==typeof n?(r=i,i=void 0):(r=i,i=n,n=void 0)),!1===r)r=Mt;else if(!r)return t;return 1===o&&(a=r,(r=function(t){return S().off(t),a.apply(this,arguments)}).guid=a.guid||(a.guid=S.guid++)),t.each((function(){S.event.add(this,e,r,i,n)}))}function Rt(t,e,n){n?(Q.set(t,e,!1),S.event.add(t,e,{namespace:!1,handler:function(t){var i,r,o=Q.get(this,e);if(1&t.isTrigger&&this[e]){if(o.length)(S.event.special[e]||{}).delegateType&&t.stopPropagation();else if(o=s.call(arguments),Q.set(this,e,o),i=n(this,e),this[e](),o!==(r=Q.get(this,e))||i?Q.set(this,e,!1):r={},o!==r)return t.stopImmediatePropagation(),t.preventDefault(),r.value}else o.length&&(Q.set(this,e,{value:S.event.trigger(S.extend(o[0],S.Event.prototype),o.slice(1),this)}),t.stopImmediatePropagation())}})):void 0===Q.get(t,e)&&S.event.add(t,e,Tt)}S.event={global:{},add:function(t,e,n,i,r){var o,a,s,c,l,h,u,d,p,f,m,g=Q.get(t);if(Z(t))for(n.handler&&(n=(o=n).handler,r=o.selector),r&&S.find.matchesSelector(ot,r),n.guid||(n.guid=S.guid++),(c=g.events)||(c=g.events=Object.create(null)),(a=g.handle)||(a=g.handle=function(e){return void 0!==S&&S.event.triggered!==e.type?S.event.dispatch.apply(t,arguments):void 0}),l=(e=(e||"").match(N)||[""]).length;l--;)p=m=(s=At.exec(e[l])||[])[1],f=(s[2]||"").split(".").sort(),p&&(u=S.event.special[p]||{},p=(r?u.delegateType:u.bindType)||p,u=S.event.special[p]||{},h=S.extend({type:p,origType:m,data:i,handler:n,guid:n.guid,selector:r,needsContext:r&&S.expr.match.needsContext.test(r),namespace:f.join(".")},o),(d=c[p])||((d=c[p]=[]).delegateCount=0,u.setup&&!1!==u.setup.call(t,i,f,a)||t.addEventListener&&t.addEventListener(p,a)),u.add&&(u.add.call(t,h),h.handler.guid||(h.handler.guid=n.guid)),r?d.splice(d.delegateCount++,0,h):d.push(h),S.event.global[p]=!0)},remove:function(t,e,n,i,r){var o,a,s,c,l,h,u,d,p,f,m,g=Q.hasData(t)&&Q.get(t);if(g&&(c=g.events)){for(l=(e=(e||"").match(N)||[""]).length;l--;)if(p=m=(s=At.exec(e[l])||[])[1],f=(s[2]||"").split(".").sort(),p){for(u=S.event.special[p]||{},d=c[p=(i?u.delegateType:u.bindType)||p]||[],s=s[2]&&new RegExp("(^|\\.)"+f.join("\\.(?:.*\\.|)")+"(\\.|$)"),a=o=d.length;o--;)h=d[o],!r&&m!==h.origType||n&&n.guid!==h.guid||s&&!s.test(h.namespace)||i&&i!==h.selector&&("**"!==i||!h.selector)||(d.splice(o,1),h.selector&&d.delegateCount--,u.remove&&u.remove.call(t,h));a&&!d.length&&(u.teardown&&!1!==u.teardown.call(t,f,g.handle)||S.removeEvent(t,p,g.handle),delete c[p])}else for(p in c)S.event.remove(t,p+e[l],n,i,!0);S.isEmptyObject(c)&&Q.remove(t,"handle events")}},dispatch:function(t){var e,n,i,r,o,a,s=new Array(arguments.length),c=S.event.fix(t),l=(Q.get(this,"events")||Object.create(null))[c.type]||[],h=S.event.special[c.type]||{};for(s[0]=c,e=1;e<arguments.length;e++)s[e]=arguments[e];if(c.delegateTarget=this,!h.preDispatch||!1!==h.preDispatch.call(this,c)){for(a=S.event.handlers.call(this,c,l),e=0;(r=a[e++])&&!c.isPropagationStopped();)for(c.currentTarget=r.elem,n=0;(o=r.handlers[n++])&&!c.isImmediatePropagationStopped();)c.rnamespace&&!1!==o.namespace&&!c.rnamespace.test(o.namespace)||(c.handleObj=o,c.data=o.data,void 0!==(i=((S.event.special[o.origType]||{}).handle||o.handler).apply(r.elem,s))&&!1===(c.result=i)&&(c.preventDefault(),c.stopPropagation()));return h.postDispatch&&h.postDispatch.call(this,c),c.result}},handlers:function(t,e){var n,i,r,o,a,s=[],c=e.delegateCount,l=t.target;if(c&&l.nodeType&&!("click"===t.type&&t.button>=1))for(;l!==this;l=l.parentNode||this)if(1===l.nodeType&&("click"!==t.type||!0!==l.disabled)){for(o=[],a={},n=0;n<c;n++)void 0===a[r=(i=e[n]).selector+" "]&&(a[r]=i.needsContext?S(r,this).index(l)>-1:S.find(r,this,null,[l]).length),a[r]&&o.push(i);o.length&&s.push({elem:l,handlers:o})}return l=this,c<e.length&&s.push({elem:l,handlers:e.slice(c)}),s},addProp:function(t,e){Object.defineProperty(S.Event.prototype,t,{enumerable:!0,configurable:!0,get:v(e)?function(){if(this.originalEvent)return e(this.originalEvent)}:function(){if(this.originalEvent)return this.originalEvent[t]},set:function(e){Object.defineProperty(this,t,{enumerable:!0,configurable:!0,writable:!0,value:e})}})},fix:function(t){return t[S.expando]?t:new S.Event(t)},special:{load:{noBubble:!0},click:{setup:function(t){var e=this||t;return mt.test(e.type)&&e.click&&P(e,"input")&&Rt(e,"click",Tt),!1},trigger:function(t){var e=this||t;return mt.test(e.type)&&e.click&&P(e,"input")&&Rt(e,"click"),!0},_default:function(t){var e=t.target;return mt.test(e.type)&&e.click&&P(e,"input")&&Q.get(e,"click")||P(e,"a")}},beforeunload:{postDispatch:function(t){void 0!==t.result&&t.originalEvent&&(t.originalEvent.returnValue=t.result)}}}},S.removeEvent=function(t,e,n){t.removeEventListener&&t.removeEventListener(e,n)},S.Event=function(t,e){if(!(this instanceof S.Event))return new S.Event(t,e);t&&t.type?(this.originalEvent=t,this.type=t.type,this.isDefaultPrevented=t.defaultPrevented||void 0===t.defaultPrevented&&!1===t.returnValue?Tt:Mt,this.target=t.target&&3===t.target.nodeType?t.target.parentNode:t.target,this.currentTarget=t.currentTarget,this.relatedTarget=t.relatedTarget):this.type=t,e&&S.extend(this,e),this.timeStamp=t&&t.timeStamp||Date.now(),this[S.expando]=!0},S.Event.prototype={constructor:S.Event,isDefaultPrevented:Mt,isPropagationStopped:Mt,isImmediatePropagationStopped:Mt,isSimulated:!1,preventDefault:function(){var t=this.originalEvent;this.isDefaultPrevented=Tt,t&&!this.isSimulated&&t.preventDefault()},stopPropagation:function(){var t=this.originalEvent;this.isPropagationStopped=Tt,t&&!this.isSimulated&&t.stopPropagation()},stopImmediatePropagation:function(){var t=this.originalEvent;this.isImmediatePropagationStopped=Tt,t&&!this.isSimulated&&t.stopImmediatePropagation(),this.stopPropagation()}},S.each({altKey:!0,bubbles:!0,cancelable:!0,changedTouches:!0,ctrlKey:!0,detail:!0,eventPhase:!0,metaKey:!0,pageX:!0,pageY:!0,shiftKey:!0,view:!0,char:!0,code:!0,charCode:!0,key:!0,keyCode:!0,button:!0,buttons:!0,clientX:!0,clientY:!0,offsetX:!0,offsetY:!0,pointerId:!0,pointerType:!0,screenX:!0,screenY:!0,targetTouches:!0,toElement:!0,touches:!0,which:function(t){var e=t.button;return null==t.which&&St.test(t.type)?null!=t.charCode?t.charCode:t.keyCode:!t.which&&void 0!==e&&Et.test(t.type)?1&e?1:2&e?3:4&e?2:0:t.which}},S.event.addProp),S.each({focus:"focusin",blur:"focusout"},(function(t,e){S.event.special[t]={setup:function(){return Rt(this,t,Ct),!1},trigger:function(){return Rt(this,t),!0},delegateType:e}})),S.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},(function(t,e){S.event.special[t]={delegateType:e,bindType:e,handle:function(t){var n,i=this,r=t.relatedTarget,o=t.handleObj;return r&&(r===i||S.contains(i,r))||(t.type=o.origType,n=o.handler.apply(this,arguments),t.type=e),n}}})),S.fn.extend({on:function(t,e,n,i){return Pt(this,t,e,n,i)},one:function(t,e,n,i){return Pt(this,t,e,n,i,1)},off:function(t,e,n){var i,r;if(t&&t.preventDefault&&t.handleObj)return i=t.handleObj,S(t.delegateTarget).off(i.namespace?i.origType+"."+i.namespace:i.origType,i.selector,i.handler),this;if("object"==typeof t){for(r in t)this.off(r,e,t[r]);return this}return!1!==e&&"function"!=typeof e||(n=e,e=void 0),!1===n&&(n=Mt),this.each((function(){S.event.remove(this,t,n,e)}))}});var Lt=/<script|<style|<link/i,kt=/checked\s*(?:[^=]|=\s*.checked.)/i,It=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g;function Dt(t,e){return P(t,"table")&&P(11!==e.nodeType?e:e.firstChild,"tr")&&S(t).children("tbody")[0]||t}function Ot(t){return t.type=(null!==t.getAttribute("type"))+"/"+t.type,t}function Ft(t){return"true/"===(t.type||"").slice(0,5)?t.type=t.type.slice(5):t.removeAttribute("type"),t}function Nt(t,e){var n,i,r,o,a,s;if(1===e.nodeType){if(Q.hasData(t)&&(s=Q.get(t).events))for(r in Q.remove(e,"handle events"),s)for(n=0,i=s[r].length;n<i;n++)S.event.add(e,r,s[r][n]);J.hasData(t)&&(o=J.access(t),a=S.extend({},o),J.set(e,a))}}function Ut(t,e){var n=e.nodeName.toLowerCase();"input"===n&&mt.test(t.type)?e.checked=t.checked:"input"!==n&&"textarea"!==n||(e.defaultValue=t.defaultValue)}function jt(t,e,n,i){e=c(e);var r,o,a,s,l,h,u=0,d=t.length,p=d-1,f=e[0],m=v(f);if(m||d>1&&"string"==typeof f&&!g.checkClone&&kt.test(f))return t.each((function(r){var o=t.eq(r);m&&(e[0]=f.call(this,r,o.html())),jt(o,e,n,i)}));if(d&&(o=(r=_t(e,t[0].ownerDocument,!1,t,i)).firstChild,1===r.childNodes.length&&(r=o),o||i)){for(s=(a=S.map(bt(r,"script"),Ot)).length;u<d;u++)l=r,u!==p&&(l=S.clone(l,!0,!0),s&&S.merge(a,bt(l,"script"))),n.call(t[u],l,u);if(s)for(h=a[a.length-1].ownerDocument,S.map(a,Ft),u=0;u<s;u++)l=a[u],vt.test(l.type||"")&&!Q.access(l,"globalEval")&&S.contains(h,l)&&(l.src&&"module"!==(l.type||"").toLowerCase()?S._evalUrl&&!l.noModule&&S._evalUrl(l.src,{nonce:l.nonce||l.getAttribute("nonce")},h):w(l.textContent.replace(It,""),l,h))}return t}function Bt(t,e,n){for(var i,r=e?S.filter(e,t):t,o=0;null!=(i=r[o]);o++)n||1!==i.nodeType||S.cleanData(bt(i)),i.parentNode&&(n&&at(i)&&xt(bt(i,"script")),i.parentNode.removeChild(i));return t}S.extend({htmlPrefilter:function(t){return t},clone:function(t,e,n){var i,r,o,a,s=t.cloneNode(!0),c=at(t);if(!(g.noCloneChecked||1!==t.nodeType&&11!==t.nodeType||S.isXMLDoc(t)))for(a=bt(s),i=0,r=(o=bt(t)).length;i<r;i++)Ut(o[i],a[i]);if(e)if(n)for(o=o||bt(t),a=a||bt(s),i=0,r=o.length;i<r;i++)Nt(o[i],a[i]);else Nt(t,s);return(a=bt(s,"script")).length>0&&xt(a,!c&&bt(t,"script")),s},cleanData:function(t){for(var e,n,i,r=S.event.special,o=0;void 0!==(n=t[o]);o++)if(Z(n)){if(e=n[Q.expando]){if(e.events)for(i in e.events)r[i]?S.event.remove(n,i):S.removeEvent(n,i,e.handle);n[Q.expando]=void 0}n[J.expando]&&(n[J.expando]=void 0)}}}),S.fn.extend({detach:function(t){return Bt(this,t,!0)},remove:function(t){return Bt(this,t)},text:function(t){return V(this,(function(t){return void 0===t?S.text(this):this.empty().each((function(){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||(this.textContent=t)}))}),null,t,arguments.length)},append:function(){return jt(this,arguments,(function(t){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||Dt(this,t).appendChild(t)}))},prepend:function(){return jt(this,arguments,(function(t){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var e=Dt(this,t);e.insertBefore(t,e.firstChild)}}))},before:function(){return jt(this,arguments,(function(t){this.parentNode&&this.parentNode.insertBefore(t,this)}))},after:function(){return jt(this,arguments,(function(t){this.parentNode&&this.parentNode.insertBefore(t,this.nextSibling)}))},empty:function(){for(var t,e=0;null!=(t=this[e]);e++)1===t.nodeType&&(S.cleanData(bt(t,!1)),t.textContent="");return this},clone:function(t,e){return t=null!=t&&t,e=null==e?t:e,this.map((function(){return S.clone(this,t,e)}))},html:function(t){return V(this,(function(t){var e=this[0]||{},n=0,i=this.length;if(void 0===t&&1===e.nodeType)return e.innerHTML;if("string"==typeof t&&!Lt.test(t)&&!yt[(gt.exec(t)||["",""])[1].toLowerCase()]){t=S.htmlPrefilter(t);try{for(;n<i;n++)1===(e=this[n]||{}).nodeType&&(S.cleanData(bt(e,!1)),e.innerHTML=t);e=0}catch(t){}}e&&this.empty().append(t)}),null,t,arguments.length)},replaceWith:function(){var t=[];return jt(this,arguments,(function(e){var n=this.parentNode;S.inArray(this,t)<0&&(S.cleanData(bt(this)),n&&n.replaceChild(e,this))}),t)}}),S.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},(function(t,e){S.fn[t]=function(t){for(var n,i=[],r=S(t),o=r.length-1,a=0;a<=o;a++)n=a===o?this:this.clone(!0),S(r[a])[e](n),l.apply(i,n.get());return this.pushStack(i)}}));var zt=new RegExp("^("+nt+")(?!px)[a-z%]+$","i"),Ht=function(t){var e=t.ownerDocument.defaultView;return e&&e.opener||(e=n),e.getComputedStyle(t)},Gt=function(t,e,n){var i,r,o={};for(r in e)o[r]=t.style[r],t.style[r]=e[r];for(r in i=n.call(t),e)t.style[r]=o[r];return i},Vt=new RegExp(rt.join("|"),"i");function Wt(t,e,n){var i,r,o,a,s=t.style;return(n=n||Ht(t))&&(""!==(a=n.getPropertyValue(e)||n[e])||at(t)||(a=S.style(t,e)),!g.pixelBoxStyles()&&zt.test(a)&&Vt.test(e)&&(i=s.width,r=s.minWidth,o=s.maxWidth,s.minWidth=s.maxWidth=s.width=a,a=n.width,s.width=i,s.minWidth=r,s.maxWidth=o)),void 0!==a?a+"":a}function Xt(t,e){return{get:function(){if(!t())return(this.get=e).apply(this,arguments);delete this.get}}}!function(){function t(){if(h){l.style.cssText="position:absolute;left:-11111px;width:60px;margin-top:1px;padding:0;border:0",h.style.cssText="position:relative;display:block;box-sizing:border-box;overflow:scroll;margin:auto;border:1px;padding:1px;width:60%;top:1%",ot.appendChild(l).appendChild(h);var t=n.getComputedStyle(h);i="1%"!==t.top,c=12===e(t.marginLeft),h.style.right="60%",a=36===e(t.right),r=36===e(t.width),h.style.position="absolute",o=12===e(h.offsetWidth/3),ot.removeChild(l),h=null}}function e(t){return Math.round(parseFloat(t))}var i,r,o,a,s,c,l=b.createElement("div"),h=b.createElement("div");h.style&&(h.style.backgroundClip="content-box",h.cloneNode(!0).style.backgroundClip="",g.clearCloneStyle="content-box"===h.style.backgroundClip,S.extend(g,{boxSizingReliable:function(){return t(),r},pixelBoxStyles:function(){return t(),a},pixelPosition:function(){return t(),i},reliableMarginLeft:function(){return t(),c},scrollboxSize:function(){return t(),o},reliableTrDimensions:function(){var t,e,i,r;return null==s&&(t=b.createElement("table"),e=b.createElement("tr"),i=b.createElement("div"),t.style.cssText="position:absolute;left:-11111px",e.style.height="1px",i.style.height="9px",ot.appendChild(t).appendChild(e).appendChild(i),r=n.getComputedStyle(e),s=parseInt(r.height)>3,ot.removeChild(t)),s}}))}();var qt=["Webkit","Moz","ms"],Yt=b.createElement("div").style,Zt={};function $t(t){var e=S.cssProps[t]||Zt[t];return e||(t in Yt?t:Zt[t]=function(t){for(var e=t[0].toUpperCase()+t.slice(1),n=qt.length;n--;)if((t=qt[n]+e)in Yt)return t}(t)||t)}var Qt=/^(none|table(?!-c[ea]).+)/,Jt=/^--/,Kt={position:"absolute",visibility:"hidden",display:"block"},te={letterSpacing:"0",fontWeight:"400"};function ee(t,e,n){var i=it.exec(e);return i?Math.max(0,i[2]-(n||0))+(i[3]||"px"):e}function ne(t,e,n,i,r,o){var a="width"===e?1:0,s=0,c=0;if(n===(i?"border":"content"))return 0;for(;a<4;a+=2)"margin"===n&&(c+=S.css(t,n+rt[a],!0,r)),i?("content"===n&&(c-=S.css(t,"padding"+rt[a],!0,r)),"margin"!==n&&(c-=S.css(t,"border"+rt[a]+"Width",!0,r))):(c+=S.css(t,"padding"+rt[a],!0,r),"padding"!==n?c+=S.css(t,"border"+rt[a]+"Width",!0,r):s+=S.css(t,"border"+rt[a]+"Width",!0,r));return!i&&o>=0&&(c+=Math.max(0,Math.ceil(t["offset"+e[0].toUpperCase()+e.slice(1)]-o-c-s-.5))||0),c}function ie(t,e,n){var i=Ht(t),r=(!g.boxSizingReliable()||n)&&"border-box"===S.css(t,"boxSizing",!1,i),o=r,a=Wt(t,e,i),s="offset"+e[0].toUpperCase()+e.slice(1);if(zt.test(a)){if(!n)return a;a="auto"}return(!g.boxSizingReliable()&&r||!g.reliableTrDimensions()&&P(t,"tr")||"auto"===a||!parseFloat(a)&&"inline"===S.css(t,"display",!1,i))&&t.getClientRects().length&&(r="border-box"===S.css(t,"boxSizing",!1,i),(o=s in t)&&(a=t[s])),(a=parseFloat(a)||0)+ne(t,e,n||(r?"border":"content"),o,i,a)+"px"}function re(t,e,n,i,r){return new re.prototype.init(t,e,n,i,r)}S.extend({cssHooks:{opacity:{get:function(t,e){if(e){var n=Wt(t,"opacity");return""===n?"1":n}}}},cssNumber:{animationIterationCount:!0,columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,gridArea:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnStart:!0,gridRow:!0,gridRowEnd:!0,gridRowStart:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{},style:function(t,e,n,i){if(t&&3!==t.nodeType&&8!==t.nodeType&&t.style){var r,o,a,s=Y(e),c=Jt.test(e),l=t.style;if(c||(e=$t(s)),a=S.cssHooks[e]||S.cssHooks[s],void 0===n)return a&&"get"in a&&void 0!==(r=a.get(t,!1,i))?r:l[e];"string"===(o=typeof n)&&(r=it.exec(n))&&r[1]&&(n=lt(t,e,r),o="number"),null!=n&&n==n&&("number"!==o||c||(n+=r&&r[3]||(S.cssNumber[s]?"":"px")),g.clearCloneStyle||""!==n||0!==e.indexOf("background")||(l[e]="inherit"),a&&"set"in a&&void 0===(n=a.set(t,n,i))||(c?l.setProperty(e,n):l[e]=n))}},css:function(t,e,n,i){var r,o,a,s=Y(e);return Jt.test(e)||(e=$t(s)),(a=S.cssHooks[e]||S.cssHooks[s])&&"get"in a&&(r=a.get(t,!0,n)),void 0===r&&(r=Wt(t,e,i)),"normal"===r&&e in te&&(r=te[e]),""===n||n?(o=parseFloat(r),!0===n||isFinite(o)?o||0:r):r}}),S.each(["height","width"],(function(t,e){S.cssHooks[e]={get:function(t,n,i){if(n)return!Qt.test(S.css(t,"display"))||t.getClientRects().length&&t.getBoundingClientRect().width?ie(t,e,i):Gt(t,Kt,(function(){return ie(t,e,i)}))},set:function(t,n,i){var r,o=Ht(t),a=!g.scrollboxSize()&&"absolute"===o.position,s=(a||i)&&"border-box"===S.css(t,"boxSizing",!1,o),c=i?ne(t,e,i,s,o):0;return s&&a&&(c-=Math.ceil(t["offset"+e[0].toUpperCase()+e.slice(1)]-parseFloat(o[e])-ne(t,e,"border",!1,o)-.5)),c&&(r=it.exec(n))&&"px"!==(r[3]||"px")&&(t.style[e]=n,n=S.css(t,e)),ee(0,n,c)}}})),S.cssHooks.marginLeft=Xt(g.reliableMarginLeft,(function(t,e){if(e)return(parseFloat(Wt(t,"marginLeft"))||t.getBoundingClientRect().left-Gt(t,{marginLeft:0},(function(){return t.getBoundingClientRect().left})))+"px"})),S.each({margin:"",padding:"",border:"Width"},(function(t,e){S.cssHooks[t+e]={expand:function(n){for(var i=0,r={},o="string"==typeof n?n.split(" "):[n];i<4;i++)r[t+rt[i]+e]=o[i]||o[i-2]||o[0];return r}},"margin"!==t&&(S.cssHooks[t+e].set=ee)})),S.fn.extend({css:function(t,e){return V(this,(function(t,e,n){var i,r,o={},a=0;if(Array.isArray(e)){for(i=Ht(t),r=e.length;a<r;a++)o[e[a]]=S.css(t,e[a],!1,i);return o}return void 0!==n?S.style(t,e,n):S.css(t,e)}),t,e,arguments.length>1)}}),S.Tween=re,re.prototype={constructor:re,init:function(t,e,n,i,r,o){this.elem=t,this.prop=n,this.easing=r||S.easing._default,this.options=e,this.start=this.now=this.cur(),this.end=i,this.unit=o||(S.cssNumber[n]?"":"px")},cur:function(){var t=re.propHooks[this.prop];return t&&t.get?t.get(this):re.propHooks._default.get(this)},run:function(t){var e,n=re.propHooks[this.prop];return this.options.duration?this.pos=e=S.easing[this.easing](t,this.options.duration*t,0,1,this.options.duration):this.pos=e=t,this.now=(this.end-this.start)*e+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),n&&n.set?n.set(this):re.propHooks._default.set(this),this}},re.prototype.init.prototype=re.prototype,re.propHooks={_default:{get:function(t){var e;return 1!==t.elem.nodeType||null!=t.elem[t.prop]&&null==t.elem.style[t.prop]?t.elem[t.prop]:(e=S.css(t.elem,t.prop,""))&&"auto"!==e?e:0},set:function(t){S.fx.step[t.prop]?S.fx.step[t.prop](t):1!==t.elem.nodeType||!S.cssHooks[t.prop]&&null==t.elem.style[$t(t.prop)]?t.elem[t.prop]=t.now:S.style(t.elem,t.prop,t.now+t.unit)}}},re.propHooks.scrollTop=re.propHooks.scrollLeft={set:function(t){t.elem.nodeType&&t.elem.parentNode&&(t.elem[t.prop]=t.now)}},S.easing={linear:function(t){return t},swing:function(t){return.5-Math.cos(t*Math.PI)/2},_default:"swing"},S.fx=re.prototype.init,S.fx.step={};var oe,ae,se=/^(?:toggle|show|hide)$/,ce=/queueHooks$/;function le(){ae&&(!1===b.hidden&&n.requestAnimationFrame?n.requestAnimationFrame(le):n.setTimeout(le,S.fx.interval),S.fx.tick())}function he(){return n.setTimeout((function(){oe=void 0})),oe=Date.now()}function ue(t,e){var n,i=0,r={height:t};for(e=e?1:0;i<4;i+=2-e)r["margin"+(n=rt[i])]=r["padding"+n]=t;return e&&(r.opacity=r.width=t),r}function de(t,e,n){for(var i,r=(pe.tweeners[e]||[]).concat(pe.tweeners["*"]),o=0,a=r.length;o<a;o++)if(i=r[o].call(n,e,t))return i}function pe(t,e,n){var i,r,o=0,a=pe.prefilters.length,s=S.Deferred().always((function(){delete c.elem})),c=function(){if(r)return!1;for(var e=oe||he(),n=Math.max(0,l.startTime+l.duration-e),i=1-(n/l.duration||0),o=0,a=l.tweens.length;o<a;o++)l.tweens[o].run(i);return s.notifyWith(t,[l,i,n]),i<1&&a?n:(a||s.notifyWith(t,[l,1,0]),s.resolveWith(t,[l]),!1)},l=s.promise({elem:t,props:S.extend({},e),opts:S.extend(!0,{specialEasing:{},easing:S.easing._default},n),originalProperties:e,originalOptions:n,startTime:oe||he(),duration:n.duration,tweens:[],createTween:function(e,n){var i=S.Tween(t,l.opts,e,n,l.opts.specialEasing[e]||l.opts.easing);return l.tweens.push(i),i},stop:function(e){var n=0,i=e?l.tweens.length:0;if(r)return this;for(r=!0;n<i;n++)l.tweens[n].run(1);return e?(s.notifyWith(t,[l,1,0]),s.resolveWith(t,[l,e])):s.rejectWith(t,[l,e]),this}}),h=l.props;for(!function(t,e){var n,i,r,o,a;for(n in t)if(r=e[i=Y(n)],o=t[n],Array.isArray(o)&&(r=o[1],o=t[n]=o[0]),n!==i&&(t[i]=o,delete t[n]),(a=S.cssHooks[i])&&"expand"in a)for(n in o=a.expand(o),delete t[i],o)n in t||(t[n]=o[n],e[n]=r);else e[i]=r}(h,l.opts.specialEasing);o<a;o++)if(i=pe.prefilters[o].call(l,t,h,l.opts))return v(i.stop)&&(S._queueHooks(l.elem,l.opts.queue).stop=i.stop.bind(i)),i;return S.map(h,de,l),v(l.opts.start)&&l.opts.start.call(t,l),l.progress(l.opts.progress).done(l.opts.done,l.opts.complete).fail(l.opts.fail).always(l.opts.always),S.fx.timer(S.extend(c,{elem:t,anim:l,queue:l.opts.queue})),l}S.Animation=S.extend(pe,{tweeners:{"*":[function(t,e){var n=this.createTween(t,e);return lt(n.elem,t,it.exec(e),n),n}]},tweener:function(t,e){v(t)?(e=t,t=["*"]):t=t.match(N);for(var n,i=0,r=t.length;i<r;i++)n=t[i],pe.tweeners[n]=pe.tweeners[n]||[],pe.tweeners[n].unshift(e)},prefilters:[function(t,e,n){var i,r,o,a,s,c,l,h,u="width"in e||"height"in e,d=this,p={},f=t.style,m=t.nodeType&&ct(t),g=Q.get(t,"fxshow");for(i in n.queue||(null==(a=S._queueHooks(t,"fx")).unqueued&&(a.unqueued=0,s=a.empty.fire,a.empty.fire=function(){a.unqueued||s()}),a.unqueued++,d.always((function(){d.always((function(){a.unqueued--,S.queue(t,"fx").length||a.empty.fire()}))}))),e)if(r=e[i],se.test(r)){if(delete e[i],o=o||"toggle"===r,r===(m?"hide":"show")){if("show"!==r||!g||void 0===g[i])continue;m=!0}p[i]=g&&g[i]||S.style(t,i)}if((c=!S.isEmptyObject(e))||!S.isEmptyObject(p))for(i in u&&1===t.nodeType&&(n.overflow=[f.overflow,f.overflowX,f.overflowY],null==(l=g&&g.display)&&(l=Q.get(t,"display")),"none"===(h=S.css(t,"display"))&&(l?h=l:(dt([t],!0),l=t.style.display||l,h=S.css(t,"display"),dt([t]))),("inline"===h||"inline-block"===h&&null!=l)&&"none"===S.css(t,"float")&&(c||(d.done((function(){f.display=l})),null==l&&(h=f.display,l="none"===h?"":h)),f.display="inline-block")),n.overflow&&(f.overflow="hidden",d.always((function(){f.overflow=n.overflow[0],f.overflowX=n.overflow[1],f.overflowY=n.overflow[2]}))),c=!1,p)c||(g?"hidden"in g&&(m=g.hidden):g=Q.access(t,"fxshow",{display:l}),o&&(g.hidden=!m),m&&dt([t],!0),d.done((function(){for(i in m||dt([t]),Q.remove(t,"fxshow"),p)S.style(t,i,p[i])}))),c=de(m?g[i]:0,i,d),i in g||(g[i]=c.start,m&&(c.end=c.start,c.start=0))}],prefilter:function(t,e){e?pe.prefilters.unshift(t):pe.prefilters.push(t)}}),S.speed=function(t,e,n){var i=t&&"object"==typeof t?S.extend({},t):{complete:n||!n&&e||v(t)&&t,duration:t,easing:n&&e||e&&!v(e)&&e};return S.fx.off?i.duration=0:"number"!=typeof i.duration&&(i.duration in S.fx.speeds?i.duration=S.fx.speeds[i.duration]:i.duration=S.fx.speeds._default),null!=i.queue&&!0!==i.queue||(i.queue="fx"),i.old=i.complete,i.complete=function(){v(i.old)&&i.old.call(this),i.queue&&S.dequeue(this,i.queue)},i},S.fn.extend({fadeTo:function(t,e,n,i){return this.filter(ct).css("opacity",0).show().end().animate({opacity:e},t,n,i)},animate:function(t,e,n,i){var r=S.isEmptyObject(t),o=S.speed(e,n,i),a=function(){var e=pe(this,S.extend({},t),o);(r||Q.get(this,"finish"))&&e.stop(!0)};return a.finish=a,r||!1===o.queue?this.each(a):this.queue(o.queue,a)},stop:function(t,e,n){var i=function(t){var e=t.stop;delete t.stop,e(n)};return"string"!=typeof t&&(n=e,e=t,t=void 0),e&&this.queue(t||"fx",[]),this.each((function(){var e=!0,r=null!=t&&t+"queueHooks",o=S.timers,a=Q.get(this);if(r)a[r]&&a[r].stop&&i(a[r]);else for(r in a)a[r]&&a[r].stop&&ce.test(r)&&i(a[r]);for(r=o.length;r--;)o[r].elem!==this||null!=t&&o[r].queue!==t||(o[r].anim.stop(n),e=!1,o.splice(r,1));!e&&n||S.dequeue(this,t)}))},finish:function(t){return!1!==t&&(t=t||"fx"),this.each((function(){var e,n=Q.get(this),i=n[t+"queue"],r=n[t+"queueHooks"],o=S.timers,a=i?i.length:0;for(n.finish=!0,S.queue(this,t,[]),r&&r.stop&&r.stop.call(this,!0),e=o.length;e--;)o[e].elem===this&&o[e].queue===t&&(o[e].anim.stop(!0),o.splice(e,1));for(e=0;e<a;e++)i[e]&&i[e].finish&&i[e].finish.call(this);delete n.finish}))}}),S.each(["toggle","show","hide"],(function(t,e){var n=S.fn[e];S.fn[e]=function(t,i,r){return null==t||"boolean"==typeof t?n.apply(this,arguments):this.animate(ue(e,!0),t,i,r)}})),S.each({slideDown:ue("show"),slideUp:ue("hide"),slideToggle:ue("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},(function(t,e){S.fn[t]=function(t,n,i){return this.animate(e,t,n,i)}})),S.timers=[],S.fx.tick=function(){var t,e=0,n=S.timers;for(oe=Date.now();e<n.length;e++)(t=n[e])()||n[e]!==t||n.splice(e--,1);n.length||S.fx.stop(),oe=void 0},S.fx.timer=function(t){S.timers.push(t),S.fx.start()},S.fx.interval=13,S.fx.start=function(){ae||(ae=!0,le())},S.fx.stop=function(){ae=null},S.fx.speeds={slow:600,fast:200,_default:400},S.fn.delay=function(t,e){return t=S.fx&&S.fx.speeds[t]||t,e=e||"fx",this.queue(e,(function(e,i){var r=n.setTimeout(e,t);i.stop=function(){n.clearTimeout(r)}}))},function(){var t=b.createElement("input"),e=b.createElement("select").appendChild(b.createElement("option"));t.type="checkbox",g.checkOn=""!==t.value,g.optSelected=e.selected,(t=b.createElement("input")).value="t",t.type="radio",g.radioValue="t"===t.value}();var fe,me=S.expr.attrHandle;S.fn.extend({attr:function(t,e){return V(this,S.attr,t,e,arguments.length>1)},removeAttr:function(t){return this.each((function(){S.removeAttr(this,t)}))}}),S.extend({attr:function(t,e,n){var i,r,o=t.nodeType;if(3!==o&&8!==o&&2!==o)return void 0===t.getAttribute?S.prop(t,e,n):(1===o&&S.isXMLDoc(t)||(r=S.attrHooks[e.toLowerCase()]||(S.expr.match.bool.test(e)?fe:void 0)),void 0!==n?null===n?void S.removeAttr(t,e):r&&"set"in r&&void 0!==(i=r.set(t,n,e))?i:(t.setAttribute(e,n+""),n):r&&"get"in r&&null!==(i=r.get(t,e))?i:null==(i=S.find.attr(t,e))?void 0:i)},attrHooks:{type:{set:function(t,e){if(!g.radioValue&&"radio"===e&&P(t,"input")){var n=t.value;return t.setAttribute("type",e),n&&(t.value=n),e}}}},removeAttr:function(t,e){var n,i=0,r=e&&e.match(N);if(r&&1===t.nodeType)for(;n=r[i++];)t.removeAttribute(n)}}),fe={set:function(t,e,n){return!1===e?S.removeAttr(t,n):t.setAttribute(n,n),n}},S.each(S.expr.match.bool.source.match(/\w+/g),(function(t,e){var n=me[e]||S.find.attr;me[e]=function(t,e,i){var r,o,a=e.toLowerCase();return i||(o=me[a],me[a]=r,r=null!=n(t,e,i)?a:null,me[a]=o),r}}));var ge=/^(?:input|select|textarea|button)$/i,ve=/^(?:a|area)$/i;function ye(t){return(t.match(N)||[]).join(" ")}function be(t){return t.getAttribute&&t.getAttribute("class")||""}function xe(t){return Array.isArray(t)?t:"string"==typeof t&&t.match(N)||[]}S.fn.extend({prop:function(t,e){return V(this,S.prop,t,e,arguments.length>1)},removeProp:function(t){return this.each((function(){delete this[S.propFix[t]||t]}))}}),S.extend({prop:function(t,e,n){var i,r,o=t.nodeType;if(3!==o&&8!==o&&2!==o)return 1===o&&S.isXMLDoc(t)||(e=S.propFix[e]||e,r=S.propHooks[e]),void 0!==n?r&&"set"in r&&void 0!==(i=r.set(t,n,e))?i:t[e]=n:r&&"get"in r&&null!==(i=r.get(t,e))?i:t[e]},propHooks:{tabIndex:{get:function(t){var e=S.find.attr(t,"tabindex");return e?parseInt(e,10):ge.test(t.nodeName)||ve.test(t.nodeName)&&t.href?0:-1}}},propFix:{for:"htmlFor",class:"className"}}),g.optSelected||(S.propHooks.selected={get:function(t){var e=t.parentNode;return e&&e.parentNode&&e.parentNode.selectedIndex,null},set:function(t){var e=t.parentNode;e&&(e.selectedIndex,e.parentNode&&e.parentNode.selectedIndex)}}),S.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],(function(){S.propFix[this.toLowerCase()]=this})),S.fn.extend({addClass:function(t){var e,n,i,r,o,a,s,c=0;if(v(t))return this.each((function(e){S(this).addClass(t.call(this,e,be(this)))}));if((e=xe(t)).length)for(;n=this[c++];)if(r=be(n),i=1===n.nodeType&&" "+ye(r)+" "){for(a=0;o=e[a++];)i.indexOf(" "+o+" ")<0&&(i+=o+" ");r!==(s=ye(i))&&n.setAttribute("class",s)}return this},removeClass:function(t){var e,n,i,r,o,a,s,c=0;if(v(t))return this.each((function(e){S(this).removeClass(t.call(this,e,be(this)))}));if(!arguments.length)return this.attr("class","");if((e=xe(t)).length)for(;n=this[c++];)if(r=be(n),i=1===n.nodeType&&" "+ye(r)+" "){for(a=0;o=e[a++];)for(;i.indexOf(" "+o+" ")>-1;)i=i.replace(" "+o+" "," ");r!==(s=ye(i))&&n.setAttribute("class",s)}return this},toggleClass:function(t,e){var n=typeof t,i="string"===n||Array.isArray(t);return"boolean"==typeof e&&i?e?this.addClass(t):this.removeClass(t):v(t)?this.each((function(n){S(this).toggleClass(t.call(this,n,be(this),e),e)})):this.each((function(){var e,r,o,a;if(i)for(r=0,o=S(this),a=xe(t);e=a[r++];)o.hasClass(e)?o.removeClass(e):o.addClass(e);else void 0!==t&&"boolean"!==n||((e=be(this))&&Q.set(this,"__className__",e),this.setAttribute&&this.setAttribute("class",e||!1===t?"":Q.get(this,"__className__")||""))}))},hasClass:function(t){var e,n,i=0;for(e=" "+t+" ";n=this[i++];)if(1===n.nodeType&&(" "+ye(be(n))+" ").indexOf(e)>-1)return!0;return!1}});var we=/\r/g;S.fn.extend({val:function(t){var e,n,i,r=this[0];return arguments.length?(i=v(t),this.each((function(n){var r;1===this.nodeType&&(null==(r=i?t.call(this,n,S(this).val()):t)?r="":"number"==typeof r?r+="":Array.isArray(r)&&(r=S.map(r,(function(t){return null==t?"":t+""}))),(e=S.valHooks[this.type]||S.valHooks[this.nodeName.toLowerCase()])&&"set"in e&&void 0!==e.set(this,r,"value")||(this.value=r))}))):r?(e=S.valHooks[r.type]||S.valHooks[r.nodeName.toLowerCase()])&&"get"in e&&void 0!==(n=e.get(r,"value"))?n:"string"==typeof(n=r.value)?n.replace(we,""):null==n?"":n:void 0}}),S.extend({valHooks:{option:{get:function(t){var e=S.find.attr(t,"value");return null!=e?e:ye(S.text(t))}},select:{get:function(t){var e,n,i,r=t.options,o=t.selectedIndex,a="select-one"===t.type,s=a?null:[],c=a?o+1:r.length;for(i=o<0?c:a?o:0;i<c;i++)if(((n=r[i]).selected||i===o)&&!n.disabled&&(!n.parentNode.disabled||!P(n.parentNode,"optgroup"))){if(e=S(n).val(),a)return e;s.push(e)}return s},set:function(t,e){for(var n,i,r=t.options,o=S.makeArray(e),a=r.length;a--;)((i=r[a]).selected=S.inArray(S.valHooks.option.get(i),o)>-1)&&(n=!0);return n||(t.selectedIndex=-1),o}}}}),S.each(["radio","checkbox"],(function(){S.valHooks[this]={set:function(t,e){if(Array.isArray(e))return t.checked=S.inArray(S(t).val(),e)>-1}},g.checkOn||(S.valHooks[this].get=function(t){return null===t.getAttribute("value")?"on":t.value})})),g.focusin="onfocusin"in n;var _e=/^(?:focusinfocus|focusoutblur)$/,Se=function(t){t.stopPropagation()};S.extend(S.event,{trigger:function(t,e,i,r){var o,a,s,c,l,h,u,d,f=[i||b],m=p.call(t,"type")?t.type:t,g=p.call(t,"namespace")?t.namespace.split("."):[];if(a=d=s=i=i||b,3!==i.nodeType&&8!==i.nodeType&&!_e.test(m+S.event.triggered)&&(m.indexOf(".")>-1&&(g=m.split("."),m=g.shift(),g.sort()),l=m.indexOf(":")<0&&"on"+m,(t=t[S.expando]?t:new S.Event(m,"object"==typeof t&&t)).isTrigger=r?2:3,t.namespace=g.join("."),t.rnamespace=t.namespace?new RegExp("(^|\\.)"+g.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,t.result=void 0,t.target||(t.target=i),e=null==e?[t]:S.makeArray(e,[t]),u=S.event.special[m]||{},r||!u.trigger||!1!==u.trigger.apply(i,e))){if(!r&&!u.noBubble&&!y(i)){for(c=u.delegateType||m,_e.test(c+m)||(a=a.parentNode);a;a=a.parentNode)f.push(a),s=a;s===(i.ownerDocument||b)&&f.push(s.defaultView||s.parentWindow||n)}for(o=0;(a=f[o++])&&!t.isPropagationStopped();)d=a,t.type=o>1?c:u.bindType||m,(h=(Q.get(a,"events")||Object.create(null))[t.type]&&Q.get(a,"handle"))&&h.apply(a,e),(h=l&&a[l])&&h.apply&&Z(a)&&(t.result=h.apply(a,e),!1===t.result&&t.preventDefault());return t.type=m,r||t.isDefaultPrevented()||u._default&&!1!==u._default.apply(f.pop(),e)||!Z(i)||l&&v(i[m])&&!y(i)&&((s=i[l])&&(i[l]=null),S.event.triggered=m,t.isPropagationStopped()&&d.addEventListener(m,Se),i[m](),t.isPropagationStopped()&&d.removeEventListener(m,Se),S.event.triggered=void 0,s&&(i[l]=s)),t.result}},simulate:function(t,e,n){var i=S.extend(new S.Event,n,{type:t,isSimulated:!0});S.event.trigger(i,null,e)}}),S.fn.extend({trigger:function(t,e){return this.each((function(){S.event.trigger(t,e,this)}))},triggerHandler:function(t,e){var n=this[0];if(n)return S.event.trigger(t,e,n,!0)}}),g.focusin||S.each({focus:"focusin",blur:"focusout"},(function(t,e){var n=function(t){S.event.simulate(e,t.target,S.event.fix(t))};S.event.special[e]={setup:function(){var i=this.ownerDocument||this.document||this,r=Q.access(i,e);r||i.addEventListener(t,n,!0),Q.access(i,e,(r||0)+1)},teardown:function(){var i=this.ownerDocument||this.document||this,r=Q.access(i,e)-1;r?Q.access(i,e,r):(i.removeEventListener(t,n,!0),Q.remove(i,e))}}}));var Ee=n.location,Ae={guid:Date.now()},Te=/\?/;S.parseXML=function(t){var e;if(!t||"string"!=typeof t)return null;try{e=(new n.DOMParser).parseFromString(t,"text/xml")}catch(t){e=void 0}return e&&!e.getElementsByTagName("parsererror").length||S.error("Invalid XML: "+t),e};var Me=/\[\]$/,Ce=/\r?\n/g,Pe=/^(?:submit|button|image|reset|file)$/i,Re=/^(?:input|select|textarea|keygen)/i;function Le(t,e,n,i){var r;if(Array.isArray(e))S.each(e,(function(e,r){n||Me.test(t)?i(t,r):Le(t+"["+("object"==typeof r&&null!=r?e:"")+"]",r,n,i)}));else if(n||"object"!==_(e))i(t,e);else for(r in e)Le(t+"["+r+"]",e[r],n,i)}S.param=function(t,e){var n,i=[],r=function(t,e){var n=v(e)?e():e;i[i.length]=encodeURIComponent(t)+"="+encodeURIComponent(null==n?"":n)};if(null==t)return"";if(Array.isArray(t)||t.jquery&&!S.isPlainObject(t))S.each(t,(function(){r(this.name,this.value)}));else for(n in t)Le(n,t[n],e,r);return i.join("&")},S.fn.extend({serialize:function(){return S.param(this.serializeArray())},serializeArray:function(){return this.map((function(){var t=S.prop(this,"elements");return t?S.makeArray(t):this})).filter((function(){var t=this.type;return this.name&&!S(this).is(":disabled")&&Re.test(this.nodeName)&&!Pe.test(t)&&(this.checked||!mt.test(t))})).map((function(t,e){var n=S(this).val();return null==n?null:Array.isArray(n)?S.map(n,(function(t){return{name:e.name,value:t.replace(Ce,"\r\n")}})):{name:e.name,value:n.replace(Ce,"\r\n")}})).get()}});var ke=/%20/g,Ie=/#.*$/,De=/([?&])_=[^&]*/,Oe=/^(.*?):[ \t]*([^\r\n]*)$/gm,Fe=/^(?:GET|HEAD)$/,Ne=/^\/\//,Ue={},je={},Be="*/".concat("*"),ze=b.createElement("a");function He(t){return function(e,n){"string"!=typeof e&&(n=e,e="*");var i,r=0,o=e.toLowerCase().match(N)||[];if(v(n))for(;i=o[r++];)"+"===i[0]?(i=i.slice(1)||"*",(t[i]=t[i]||[]).unshift(n)):(t[i]=t[i]||[]).push(n)}}function Ge(t,e,n,i){var r={},o=t===je;function a(s){var c;return r[s]=!0,S.each(t[s]||[],(function(t,s){var l=s(e,n,i);return"string"!=typeof l||o||r[l]?o?!(c=l):void 0:(e.dataTypes.unshift(l),a(l),!1)})),c}return a(e.dataTypes[0])||!r["*"]&&a("*")}function Ve(t,e){var n,i,r=S.ajaxSettings.flatOptions||{};for(n in e)void 0!==e[n]&&((r[n]?t:i||(i={}))[n]=e[n]);return i&&S.extend(!0,t,i),t}ze.href=Ee.href,S.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:Ee.href,type:"GET",isLocal:/^(?:about|app|app-storage|.+-extension|file|res|widget):$/.test(Ee.protocol),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":Be,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/\bxml\b/,html:/\bhtml/,json:/\bjson\b/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":JSON.parse,"text xml":S.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(t,e){return e?Ve(Ve(t,S.ajaxSettings),e):Ve(S.ajaxSettings,t)},ajaxPrefilter:He(Ue),ajaxTransport:He(je),ajax:function(t,e){"object"==typeof t&&(e=t,t=void 0),e=e||{};var i,r,o,a,s,c,l,h,u,d,p=S.ajaxSetup({},e),f=p.context||p,m=p.context&&(f.nodeType||f.jquery)?S(f):S.event,g=S.Deferred(),v=S.Callbacks("once memory"),y=p.statusCode||{},x={},w={},_="canceled",E={readyState:0,getResponseHeader:function(t){var e;if(l){if(!a)for(a={};e=Oe.exec(o);)a[e[1].toLowerCase()+" "]=(a[e[1].toLowerCase()+" "]||[]).concat(e[2]);e=a[t.toLowerCase()+" "]}return null==e?null:e.join(", ")},getAllResponseHeaders:function(){return l?o:null},setRequestHeader:function(t,e){return null==l&&(t=w[t.toLowerCase()]=w[t.toLowerCase()]||t,x[t]=e),this},overrideMimeType:function(t){return null==l&&(p.mimeType=t),this},statusCode:function(t){var e;if(t)if(l)E.always(t[E.status]);else for(e in t)y[e]=[y[e],t[e]];return this},abort:function(t){var e=t||_;return i&&i.abort(e),A(0,e),this}};if(g.promise(E),p.url=((t||p.url||Ee.href)+"").replace(Ne,Ee.protocol+"//"),p.type=e.method||e.type||p.method||p.type,p.dataTypes=(p.dataType||"*").toLowerCase().match(N)||[""],null==p.crossDomain){c=b.createElement("a");try{c.href=p.url,c.href=c.href,p.crossDomain=ze.protocol+"//"+ze.host!=c.protocol+"//"+c.host}catch(t){p.crossDomain=!0}}if(p.data&&p.processData&&"string"!=typeof p.data&&(p.data=S.param(p.data,p.traditional)),Ge(Ue,p,e,E),l)return E;for(u in(h=S.event&&p.global)&&0==S.active++&&S.event.trigger("ajaxStart"),p.type=p.type.toUpperCase(),p.hasContent=!Fe.test(p.type),r=p.url.replace(Ie,""),p.hasContent?p.data&&p.processData&&0===(p.contentType||"").indexOf("application/x-www-form-urlencoded")&&(p.data=p.data.replace(ke,"+")):(d=p.url.slice(r.length),p.data&&(p.processData||"string"==typeof p.data)&&(r+=(Te.test(r)?"&":"?")+p.data,delete p.data),!1===p.cache&&(r=r.replace(De,"$1"),d=(Te.test(r)?"&":"?")+"_="+Ae.guid+++d),p.url=r+d),p.ifModified&&(S.lastModified[r]&&E.setRequestHeader("If-Modified-Since",S.lastModified[r]),S.etag[r]&&E.setRequestHeader("If-None-Match",S.etag[r])),(p.data&&p.hasContent&&!1!==p.contentType||e.contentType)&&E.setRequestHeader("Content-Type",p.contentType),E.setRequestHeader("Accept",p.dataTypes[0]&&p.accepts[p.dataTypes[0]]?p.accepts[p.dataTypes[0]]+("*"!==p.dataTypes[0]?", "+Be+"; q=0.01":""):p.accepts["*"]),p.headers)E.setRequestHeader(u,p.headers[u]);if(p.beforeSend&&(!1===p.beforeSend.call(f,E,p)||l))return E.abort();if(_="abort",v.add(p.complete),E.done(p.success),E.fail(p.error),i=Ge(je,p,e,E)){if(E.readyState=1,h&&m.trigger("ajaxSend",[E,p]),l)return E;p.async&&p.timeout>0&&(s=n.setTimeout((function(){E.abort("timeout")}),p.timeout));try{l=!1,i.send(x,A)}catch(t){if(l)throw t;A(-1,t)}}else A(-1,"No Transport");function A(t,e,a,c){var u,d,b,x,w,_=e;l||(l=!0,s&&n.clearTimeout(s),i=void 0,o=c||"",E.readyState=t>0?4:0,u=t>=200&&t<300||304===t,a&&(x=function(t,e,n){for(var i,r,o,a,s=t.contents,c=t.dataTypes;"*"===c[0];)c.shift(),void 0===i&&(i=t.mimeType||e.getResponseHeader("Content-Type"));if(i)for(r in s)if(s[r]&&s[r].test(i)){c.unshift(r);break}if(c[0]in n)o=c[0];else{for(r in n){if(!c[0]||t.converters[r+" "+c[0]]){o=r;break}a||(a=r)}o=o||a}if(o)return o!==c[0]&&c.unshift(o),n[o]}(p,E,a)),!u&&S.inArray("script",p.dataTypes)>-1&&(p.converters["text script"]=function(){}),x=function(t,e,n,i){var r,o,a,s,c,l={},h=t.dataTypes.slice();if(h[1])for(a in t.converters)l[a.toLowerCase()]=t.converters[a];for(o=h.shift();o;)if(t.responseFields[o]&&(n[t.responseFields[o]]=e),!c&&i&&t.dataFilter&&(e=t.dataFilter(e,t.dataType)),c=o,o=h.shift())if("*"===o)o=c;else if("*"!==c&&c!==o){if(!(a=l[c+" "+o]||l["* "+o]))for(r in l)if((s=r.split(" "))[1]===o&&(a=l[c+" "+s[0]]||l["* "+s[0]])){!0===a?a=l[r]:!0!==l[r]&&(o=s[0],h.unshift(s[1]));break}if(!0!==a)if(a&&t.throws)e=a(e);else try{e=a(e)}catch(t){return{state:"parsererror",error:a?t:"No conversion from "+c+" to "+o}}}return{state:"success",data:e}}(p,x,E,u),u?(p.ifModified&&((w=E.getResponseHeader("Last-Modified"))&&(S.lastModified[r]=w),(w=E.getResponseHeader("etag"))&&(S.etag[r]=w)),204===t||"HEAD"===p.type?_="nocontent":304===t?_="notmodified":(_=x.state,d=x.data,u=!(b=x.error))):(b=_,!t&&_||(_="error",t<0&&(t=0))),E.status=t,E.statusText=(e||_)+"",u?g.resolveWith(f,[d,_,E]):g.rejectWith(f,[E,_,b]),E.statusCode(y),y=void 0,h&&m.trigger(u?"ajaxSuccess":"ajaxError",[E,p,u?d:b]),v.fireWith(f,[E,_]),h&&(m.trigger("ajaxComplete",[E,p]),--S.active||S.event.trigger("ajaxStop")))}return E},getJSON:function(t,e,n){return S.get(t,e,n,"json")},getScript:function(t,e){return S.get(t,void 0,e,"script")}}),S.each(["get","post"],(function(t,e){S[e]=function(t,n,i,r){return v(n)&&(r=r||i,i=n,n=void 0),S.ajax(S.extend({url:t,type:e,dataType:r,data:n,success:i},S.isPlainObject(t)&&t))}})),S.ajaxPrefilter((function(t){var e;for(e in t.headers)"content-type"===e.toLowerCase()&&(t.contentType=t.headers[e]||"")})),S._evalUrl=function(t,e,n){return S.ajax({url:t,type:"GET",dataType:"script",cache:!0,async:!1,global:!1,converters:{"text script":function(){}},dataFilter:function(t){S.globalEval(t,e,n)}})},S.fn.extend({wrapAll:function(t){var e;return this[0]&&(v(t)&&(t=t.call(this[0])),e=S(t,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&e.insertBefore(this[0]),e.map((function(){for(var t=this;t.firstElementChild;)t=t.firstElementChild;return t})).append(this)),this},wrapInner:function(t){return v(t)?this.each((function(e){S(this).wrapInner(t.call(this,e))})):this.each((function(){var e=S(this),n=e.contents();n.length?n.wrapAll(t):e.append(t)}))},wrap:function(t){var e=v(t);return this.each((function(n){S(this).wrapAll(e?t.call(this,n):t)}))},unwrap:function(t){return this.parent(t).not("body").each((function(){S(this).replaceWith(this.childNodes)})),this}}),S.expr.pseudos.hidden=function(t){return!S.expr.pseudos.visible(t)},S.expr.pseudos.visible=function(t){return!!(t.offsetWidth||t.offsetHeight||t.getClientRects().length)},S.ajaxSettings.xhr=function(){try{return new n.XMLHttpRequest}catch(t){}};var We={0:200,1223:204},Xe=S.ajaxSettings.xhr();g.cors=!!Xe&&"withCredentials"in Xe,g.ajax=Xe=!!Xe,S.ajaxTransport((function(t){var e,i;if(g.cors||Xe&&!t.crossDomain)return{send:function(r,o){var a,s=t.xhr();if(s.open(t.type,t.url,t.async,t.username,t.password),t.xhrFields)for(a in t.xhrFields)s[a]=t.xhrFields[a];for(a in t.mimeType&&s.overrideMimeType&&s.overrideMimeType(t.mimeType),t.crossDomain||r["X-Requested-With"]||(r["X-Requested-With"]="XMLHttpRequest"),r)s.setRequestHeader(a,r[a]);e=function(t){return function(){e&&(e=i=s.onload=s.onerror=s.onabort=s.ontimeout=s.onreadystatechange=null,"abort"===t?s.abort():"error"===t?"number"!=typeof s.status?o(0,"error"):o(s.status,s.statusText):o(We[s.status]||s.status,s.statusText,"text"!==(s.responseType||"text")||"string"!=typeof s.responseText?{binary:s.response}:{text:s.responseText},s.getAllResponseHeaders()))}},s.onload=e(),i=s.onerror=s.ontimeout=e("error"),void 0!==s.onabort?s.onabort=i:s.onreadystatechange=function(){4===s.readyState&&n.setTimeout((function(){e&&i()}))},e=e("abort");try{s.send(t.hasContent&&t.data||null)}catch(t){if(e)throw t}},abort:function(){e&&e()}}})),S.ajaxPrefilter((function(t){t.crossDomain&&(t.contents.script=!1)})),S.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/\b(?:java|ecma)script\b/},converters:{"text script":function(t){return S.globalEval(t),t}}}),S.ajaxPrefilter("script",(function(t){void 0===t.cache&&(t.cache=!1),t.crossDomain&&(t.type="GET")})),S.ajaxTransport("script",(function(t){var e,n;if(t.crossDomain||t.scriptAttrs)return{send:function(i,r){e=S("<script>").attr(t.scriptAttrs||{}).prop({charset:t.scriptCharset,src:t.url}).on("load error",n=function(t){e.remove(),n=null,t&&r("error"===t.type?404:200,t.type)}),b.head.appendChild(e[0])},abort:function(){n&&n()}}}));var qe,Ye=[],Ze=/(=)\?(?=&|$)|\?\?/;S.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var t=Ye.pop()||S.expando+"_"+Ae.guid++;return this[t]=!0,t}}),S.ajaxPrefilter("json jsonp",(function(t,e,i){var r,o,a,s=!1!==t.jsonp&&(Ze.test(t.url)?"url":"string"==typeof t.data&&0===(t.contentType||"").indexOf("application/x-www-form-urlencoded")&&Ze.test(t.data)&&"data");if(s||"jsonp"===t.dataTypes[0])return r=t.jsonpCallback=v(t.jsonpCallback)?t.jsonpCallback():t.jsonpCallback,s?t[s]=t[s].replace(Ze,"$1"+r):!1!==t.jsonp&&(t.url+=(Te.test(t.url)?"&":"?")+t.jsonp+"="+r),t.converters["script json"]=function(){return a||S.error(r+" was not called"),a[0]},t.dataTypes[0]="json",o=n[r],n[r]=function(){a=arguments},i.always((function(){void 0===o?S(n).removeProp(r):n[r]=o,t[r]&&(t.jsonpCallback=e.jsonpCallback,Ye.push(r)),a&&v(o)&&o(a[0]),a=o=void 0})),"script"})),g.createHTMLDocument=((qe=b.implementation.createHTMLDocument("").body).innerHTML="<form></form><form></form>",2===qe.childNodes.length),S.parseHTML=function(t,e,n){return"string"!=typeof t?[]:("boolean"==typeof e&&(n=e,e=!1),e||(g.createHTMLDocument?((i=(e=b.implementation.createHTMLDocument("")).createElement("base")).href=b.location.href,e.head.appendChild(i)):e=b),o=!n&&[],(r=R.exec(t))?[e.createElement(r[1])]:(r=_t([t],e,o),o&&o.length&&S(o).remove(),S.merge([],r.childNodes)));var i,r,o},S.fn.load=function(t,e,n){var i,r,o,a=this,s=t.indexOf(" ");return s>-1&&(i=ye(t.slice(s)),t=t.slice(0,s)),v(e)?(n=e,e=void 0):e&&"object"==typeof e&&(r="POST"),a.length>0&&S.ajax({url:t,type:r||"GET",dataType:"html",data:e}).done((function(t){o=arguments,a.html(i?S("<div>").append(S.parseHTML(t)).find(i):t)})).always(n&&function(t,e){a.each((function(){n.apply(this,o||[t.responseText,e,t])}))}),this},S.expr.pseudos.animated=function(t){return S.grep(S.timers,(function(e){return t===e.elem})).length},S.offset={setOffset:function(t,e,n){var i,r,o,a,s,c,l=S.css(t,"position"),h=S(t),u={};"static"===l&&(t.style.position="relative"),s=h.offset(),o=S.css(t,"top"),c=S.css(t,"left"),("absolute"===l||"fixed"===l)&&(o+c).indexOf("auto")>-1?(a=(i=h.position()).top,r=i.left):(a=parseFloat(o)||0,r=parseFloat(c)||0),v(e)&&(e=e.call(t,n,S.extend({},s))),null!=e.top&&(u.top=e.top-s.top+a),null!=e.left&&(u.left=e.left-s.left+r),"using"in e?e.using.call(t,u):("number"==typeof u.top&&(u.top+="px"),"number"==typeof u.left&&(u.left+="px"),h.css(u))}},S.fn.extend({offset:function(t){if(arguments.length)return void 0===t?this:this.each((function(e){S.offset.setOffset(this,t,e)}));var e,n,i=this[0];return i?i.getClientRects().length?(e=i.getBoundingClientRect(),n=i.ownerDocument.defaultView,{top:e.top+n.pageYOffset,left:e.left+n.pageXOffset}):{top:0,left:0}:void 0},position:function(){if(this[0]){var t,e,n,i=this[0],r={top:0,left:0};if("fixed"===S.css(i,"position"))e=i.getBoundingClientRect();else{for(e=this.offset(),n=i.ownerDocument,t=i.offsetParent||n.documentElement;t&&(t===n.body||t===n.documentElement)&&"static"===S.css(t,"position");)t=t.parentNode;t&&t!==i&&1===t.nodeType&&((r=S(t).offset()).top+=S.css(t,"borderTopWidth",!0),r.left+=S.css(t,"borderLeftWidth",!0))}return{top:e.top-r.top-S.css(i,"marginTop",!0),left:e.left-r.left-S.css(i,"marginLeft",!0)}}},offsetParent:function(){return this.map((function(){for(var t=this.offsetParent;t&&"static"===S.css(t,"position");)t=t.offsetParent;return t||ot}))}}),S.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},(function(t,e){var n="pageYOffset"===e;S.fn[t]=function(i){return V(this,(function(t,i,r){var o;if(y(t)?o=t:9===t.nodeType&&(o=t.defaultView),void 0===r)return o?o[e]:t[i];o?o.scrollTo(n?o.pageXOffset:r,n?r:o.pageYOffset):t[i]=r}),t,i,arguments.length)}})),S.each(["top","left"],(function(t,e){S.cssHooks[e]=Xt(g.pixelPosition,(function(t,n){if(n)return n=Wt(t,e),zt.test(n)?S(t).position()[e]+"px":n}))})),S.each({Height:"height",Width:"width"},(function(t,e){S.each({padding:"inner"+t,content:e,"":"outer"+t},(function(n,i){S.fn[i]=function(r,o){var a=arguments.length&&(n||"boolean"!=typeof r),s=n||(!0===r||!0===o?"margin":"border");return V(this,(function(e,n,r){var o;return y(e)?0===i.indexOf("outer")?e["inner"+t]:e.document.documentElement["client"+t]:9===e.nodeType?(o=e.documentElement,Math.max(e.body["scroll"+t],o["scroll"+t],e.body["offset"+t],o["offset"+t],o["client"+t])):void 0===r?S.css(e,n,s):S.style(e,n,r,s)}),e,a?r:void 0,a)}}))})),S.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],(function(t,e){S.fn[e]=function(t){return this.on(e,t)}})),S.fn.extend({bind:function(t,e,n){return this.on(t,null,e,n)},unbind:function(t,e){return this.off(t,null,e)},delegate:function(t,e,n,i){return this.on(e,t,n,i)},undelegate:function(t,e,n){return 1===arguments.length?this.off(t,"**"):this.off(e,t||"**",n)},hover:function(t,e){return this.mouseenter(t).mouseleave(e||t)}}),S.each("blur focus focusin focusout resize scroll click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup contextmenu".split(" "),(function(t,e){S.fn[e]=function(t,n){return arguments.length>0?this.on(e,null,t,n):this.trigger(e)}}));var $e=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g;S.proxy=function(t,e){var n,i,r;if("string"==typeof e&&(n=t[e],e=t,t=n),v(t))return i=s.call(arguments,2),(r=function(){return t.apply(e||this,i.concat(s.call(arguments)))}).guid=t.guid=t.guid||S.guid++,r},S.holdReady=function(t){t?S.readyWait++:S.ready(!0)},S.isArray=Array.isArray,S.parseJSON=JSON.parse,S.nodeName=P,S.isFunction=v,S.isWindow=y,S.camelCase=Y,S.type=_,S.now=Date.now,S.isNumeric=function(t){var e=S.type(t);return("number"===e||"string"===e)&&!isNaN(t-parseFloat(t))},S.trim=function(t){return null==t?"":(t+"").replace($e,"")},void 0===(i=function(){return S}.apply(e,[]))||(t.exports=i);var Qe=n.jQuery,Je=n.$;return S.noConflict=function(t){return n.$===S&&(n.$=Je),t&&n.jQuery===S&&(n.jQuery=Qe),S},void 0===r&&(n.jQuery=n.$=S),S}))},function(t,e,n){(function(e,n){t.exports=function t(e,n,i){function r(a,s){if(!n[a]){if(!e[a]){if(o)return o(a,!0);var c=new Error("Cannot find module '"+a+"'");throw c.code="MODULE_NOT_FOUND",c}var l=n[a]={exports:{}};e[a][0].call(l.exports,(function(t){var n=e[a][1][t];return r(n||t)}),l,l.exports,t,e,n,i)}return n[a].exports}for(var o=!1,a=0;a<i.length;a++)r(i[a]);return r}({1:[function(t,n,i){(function(t){!function(e){var r="object"==typeof i&&i&&!i.nodeType&&i,o="object"==typeof n&&n&&!n.nodeType&&n,a="object"==typeof t&&t;a.global!==a&&a.window!==a&&a.self!==a||(e=a);var s,c,l=2147483647,h=/^xn--/,u=/[^\x20-\x7E]/,d=/[\x2E\u3002\uFF0E\uFF61]/g,p={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},f=Math.floor,m=String.fromCharCode;function g(t){throw new RangeError(p[t])}function v(t,e){for(var n=t.length,i=[];n--;)i[n]=e(t[n]);return i}function y(t,e){var n=t.split("@"),i="";return n.length>1&&(i=n[0]+"@",t=n[1]),i+v((t=t.replace(d,".")).split("."),e).join(".")}function b(t){for(var e,n,i=[],r=0,o=t.length;r<o;)(e=t.charCodeAt(r++))>=55296&&e<=56319&&r<o?56320==(64512&(n=t.charCodeAt(r++)))?i.push(((1023&e)<<10)+(1023&n)+65536):(i.push(e),r--):i.push(e);return i}function x(t){return v(t,(function(t){var e="";return t>65535&&(e+=m((t-=65536)>>>10&1023|55296),t=56320|1023&t),e+=m(t)})).join("")}function w(t,e){return t+22+75*(t<26)-((0!=e)<<5)}function _(t,e,n){var i=0;for(t=n?f(t/700):t>>1,t+=f(t/e);t>455;i+=36)t=f(t/35);return f(i+36*t/(t+38))}function S(t){var e,n,i,r,o,a,s,c,h,u,d,p=[],m=t.length,v=0,y=128,b=72;for((n=t.lastIndexOf("-"))<0&&(n=0),i=0;i<n;++i)t.charCodeAt(i)>=128&&g("not-basic"),p.push(t.charCodeAt(i));for(r=n>0?n+1:0;r<m;){for(o=v,a=1,s=36;r>=m&&g("invalid-input"),((c=(d=t.charCodeAt(r++))-48<10?d-22:d-65<26?d-65:d-97<26?d-97:36)>=36||c>f((l-v)/a))&&g("overflow"),v+=c*a,!(c<(h=s<=b?1:s>=b+26?26:s-b));s+=36)a>f(l/(u=36-h))&&g("overflow"),a*=u;b=_(v-o,e=p.length+1,0==o),f(v/e)>l-y&&g("overflow"),y+=f(v/e),v%=e,p.splice(v++,0,y)}return x(p)}function E(t){var e,n,i,r,o,a,s,c,h,u,d,p,v,y,x,S=[];for(p=(t=b(t)).length,e=128,n=0,o=72,a=0;a<p;++a)(d=t[a])<128&&S.push(m(d));for(i=r=S.length,r&&S.push("-");i<p;){for(s=l,a=0;a<p;++a)(d=t[a])>=e&&d<s&&(s=d);for(s-e>f((l-n)/(v=i+1))&&g("overflow"),n+=(s-e)*v,e=s,a=0;a<p;++a)if((d=t[a])<e&&++n>l&&g("overflow"),d==e){for(c=n,h=36;!(c<(u=h<=o?1:h>=o+26?26:h-o));h+=36)x=c-u,y=36-u,S.push(m(w(u+x%y,0))),c=f(x/y);S.push(m(w(c,0))),o=_(n,v,i==r),n=0,++i}++n,++e}return S.join("")}if(s={version:"1.3.2",ucs2:{decode:b,encode:x},decode:S,encode:E,toASCII:function(t){return y(t,(function(t){return u.test(t)?"xn--"+E(t):t}))},toUnicode:function(t){return y(t,(function(t){return h.test(t)?S(t.slice(4).toLowerCase()):t}))}},r&&o)if(n.exports==r)o.exports=s;else for(c in s)s.hasOwnProperty(c)&&(r[c]=s[c]);else e.punycode=s}(this)}).call(this,void 0!==e?e:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],2:[function(t,e,n){var i=t("./log");function r(t,e){for(var n=3===t.nodeType?document.createTextNode(t.nodeValue):t.cloneNode(!1),o=t.firstChild;o;)!0!==e&&1===o.nodeType&&"SCRIPT"===o.nodeName||n.appendChild(r(o,e)),o=o.nextSibling;return 1===t.nodeType&&(n._scrollTop=t.scrollTop,n._scrollLeft=t.scrollLeft,"CANVAS"===t.nodeName?function(t,e){try{e&&(e.width=t.width,e.height=t.height,e.getContext("2d").putImageData(t.getContext("2d").getImageData(0,0,t.width,t.height),0,0))}catch(e){i("Unable to copy canvas content from",t,e)}}(t,n):"TEXTAREA"!==t.nodeName&&"SELECT"!==t.nodeName||(n.value=t.value)),n}e.exports=function(t,e,n,i,o,a,s){var c=r(t.documentElement,o.javascriptEnabled),l=e.createElement("iframe");return l.className="html2canvas-container",l.style.visibility="hidden",l.style.position="fixed",l.style.left="-10000px",l.style.top="0px",l.style.border="0",l.width=n,l.height=i,l.scrolling="no",e.body.appendChild(l),new Promise((function(e){var n=l.contentWindow.document;l.contentWindow.onload=l.onload=function(){var t=setInterval((function(){n.body.childNodes.length>0&&(function t(e){if(1===e.nodeType){e.scrollTop=e._scrollTop,e.scrollLeft=e._scrollLeft;for(var n=e.firstChild;n;)t(n),n=n.nextSibling}}(n.documentElement),clearInterval(t),"view"===o.type&&(l.contentWindow.scrollTo(a,s),!/(iPad|iPhone|iPod)/g.test(navigator.userAgent)||l.contentWindow.scrollY===s&&l.contentWindow.scrollX===a||(n.documentElement.style.top=-s+"px",n.documentElement.style.left=-a+"px",n.documentElement.style.position="absolute")),e(l))}),50)},n.open(),n.write("<!DOCTYPE html><html></html>"),function(t,e,n){!t.defaultView||e===t.defaultView.pageXOffset&&n===t.defaultView.pageYOffset||t.defaultView.scrollTo(e,n)}(t,a,s),n.replaceChild(n.adoptNode(c),n.documentElement),n.close()}))}},{"./log":13}],3:[function(t,e,n){function i(t){this.r=0,this.g=0,this.b=0,this.a=null,this.fromArray(t)||this.namedColor(t)||this.rgb(t)||this.rgba(t)||this.hex6(t)||this.hex3(t)}i.prototype.darken=function(t){var e=1-t;return new i([Math.round(this.r*e),Math.round(this.g*e),Math.round(this.b*e),this.a])},i.prototype.isTransparent=function(){return 0===this.a},i.prototype.isBlack=function(){return 0===this.r&&0===this.g&&0===this.b},i.prototype.fromArray=function(t){return Array.isArray(t)&&(this.r=Math.min(t[0],255),this.g=Math.min(t[1],255),this.b=Math.min(t[2],255),t.length>3&&(this.a=t[3])),Array.isArray(t)};var r=/^#([a-f0-9]{3})$/i;i.prototype.hex3=function(t){var e;return null!==(e=t.match(r))&&(this.r=parseInt(e[1][0]+e[1][0],16),this.g=parseInt(e[1][1]+e[1][1],16),this.b=parseInt(e[1][2]+e[1][2],16)),null!==e};var o=/^#([a-f0-9]{6})$/i;i.prototype.hex6=function(t){var e=null;return null!==(e=t.match(o))&&(this.r=parseInt(e[1].substring(0,2),16),this.g=parseInt(e[1].substring(2,4),16),this.b=parseInt(e[1].substring(4,6),16)),null!==e};var a=/^rgb\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*\)$/;i.prototype.rgb=function(t){var e;return null!==(e=t.match(a))&&(this.r=Number(e[1]),this.g=Number(e[2]),this.b=Number(e[3])),null!==e};var s=/^rgba\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d?\.?\d+)\s*\)$/;i.prototype.rgba=function(t){var e;return null!==(e=t.match(s))&&(this.r=Number(e[1]),this.g=Number(e[2]),this.b=Number(e[3]),this.a=Number(e[4])),null!==e},i.prototype.toString=function(){return null!==this.a&&1!==this.a?"rgba("+[this.r,this.g,this.b,this.a].join(",")+")":"rgb("+[this.r,this.g,this.b].join(",")+")"},i.prototype.namedColor=function(t){t=t.toLowerCase();var e=c[t];if(e)this.r=e[0],this.g=e[1],this.b=e[2];else if("transparent"===t)return this.r=this.g=this.b=this.a=0,!0;return!!e},i.prototype.isColor=!0;var c={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};e.exports=i},{}],4:[function(t,e,n){var i=t("./support"),r=t("./renderers/canvas"),o=t("./imageloader"),a=t("./nodeparser"),s=t("./nodecontainer"),c=t("./log"),l=t("./utils"),h=t("./clone"),u=t("./proxy").loadUrlDocument,d=l.getBounds,p=0;function f(t,e){var n,i,o=p++;if((e=e||{}).logging&&(c.options.logging=!0,c.options.start=Date.now()),e.async=void 0===e.async||e.async,e.allowTaint=void 0!==e.allowTaint&&e.allowTaint,e.removeContainer=void 0===e.removeContainer||e.removeContainer,e.javascriptEnabled=void 0!==e.javascriptEnabled&&e.javascriptEnabled,e.imageTimeout=void 0===e.imageTimeout?1e4:e.imageTimeout,e.renderer="function"==typeof e.renderer?e.renderer:r,e.strict=!!e.strict,"string"==typeof t){if("string"!=typeof e.proxy)return Promise.reject("Proxy must be used when rendering url");var a=null!=e.width?e.width:window.innerWidth,s=null!=e.height?e.height:window.innerHeight;return u((n=t,i=document.createElement("a"),i.href=n,i.href=i.href,i),e.proxy,document,a,s,e).then((function(t){return g(t.contentWindow.document.documentElement,t,e,a,s)}))}var l=(void 0===t?[document.documentElement]:t.length?t:[t])[0];return l.setAttribute("data-html2canvas-node"+o,o),function(t,e,n,i,r){return h(t,t,n,i,e,t.defaultView.pageXOffset,t.defaultView.pageYOffset).then((function(o){c("Document cloned");var a="data-html2canvas-node"+r,s="["+a+"='"+r+"']";t.querySelector(s).removeAttribute(a);var l=o.contentWindow,h=l.document.querySelector(s);return("function"==typeof e.onclone?Promise.resolve(e.onclone(l.document)):Promise.resolve(!0)).then((function(){return g(h,o,e,n,i)}))}))}(l.ownerDocument,e,l.ownerDocument.defaultView.innerWidth,l.ownerDocument.defaultView.innerHeight,o).then((function(t){return"function"==typeof e.onrendered&&(c("options.onrendered is deprecated, html2canvas returns a Promise containing the canvas"),e.onrendered(t)),t}))}f.CanvasRenderer=r,f.NodeContainer=s,f.log=c,f.utils=l;var m="undefined"==typeof document||"function"!=typeof Object.create||"function"!=typeof document.createElement("canvas").getContext?function(){return Promise.reject("No canvas support")}:f;function g(t,e,n,r,s){var l=e.contentWindow,h=new i(l.document),u=new o(n,h),p=d(t),f="view"===n.type?r:function(t){return Math.max(Math.max(t.body.scrollWidth,t.documentElement.scrollWidth),Math.max(t.body.offsetWidth,t.documentElement.offsetWidth),Math.max(t.body.clientWidth,t.documentElement.clientWidth))}(l.document),m="view"===n.type?s:function(t){return Math.max(Math.max(t.body.scrollHeight,t.documentElement.scrollHeight),Math.max(t.body.offsetHeight,t.documentElement.offsetHeight),Math.max(t.body.clientHeight,t.documentElement.clientHeight))}(l.document),g=new n.renderer(f,m,u,n,document);return new a(t,g,h,u,n).ready.then((function(){var i;return c("Finished rendering"),i="view"===n.type?v(g.canvas,{width:g.canvas.width,height:g.canvas.height,top:0,left:0,x:0,y:0}):t===l.document.body||t===l.document.documentElement||null!=n.canvas?g.canvas:v(g.canvas,{width:null!=n.width?n.width:p.width,height:null!=n.height?n.height:p.height,top:p.top,left:p.left,x:0,y:0}),function(t,e){e.removeContainer&&(t.parentNode.removeChild(t),c("Cleaned up container"))}(e,n),i}))}function v(t,e){var n=document.createElement("canvas"),i=Math.min(t.width-1,Math.max(0,e.left)),r=Math.min(t.width,Math.max(1,e.left+e.width)),o=Math.min(t.height-1,Math.max(0,e.top)),a=Math.min(t.height,Math.max(1,e.top+e.height));n.width=e.width,n.height=e.height;var s=r-i,l=a-o;return c("Cropping canvas at:","left:",e.left,"top:",e.top,"width:",s,"height:",l),c("Resulting crop with width",e.width,"and height",e.height,"with x",i,"and y",o),n.getContext("2d").drawImage(t,i,o,s,l,e.x,e.y,s,l),n}e.exports=m},{"./clone":2,"./imageloader":11,"./log":13,"./nodecontainer":14,"./nodeparser":15,"./proxy":16,"./renderers/canvas":20,"./support":22,"./utils":26}],5:[function(t,e,n){var i=t("./log"),r=t("./utils").smallImage;e.exports=function t(e){if(this.src=e,i("DummyImageContainer for",e),!this.promise||!this.image){i("Initiating DummyImageContainer"),t.prototype.image=new Image;var n=this.image;t.prototype.promise=new Promise((function(t,e){n.onload=t,n.onerror=e,n.src=r(),!0===n.complete&&t(n)}))}}},{"./log":13,"./utils":26}],6:[function(t,e,n){var i=t("./utils").smallImage;e.exports=function(t,e){var n,r,o=document.createElement("div"),a=document.createElement("img"),s=document.createElement("span");o.style.visibility="hidden",o.style.fontFamily=t,o.style.fontSize=e,o.style.margin=0,o.style.padding=0,document.body.appendChild(o),a.src=i(),a.width=1,a.height=1,a.style.margin=0,a.style.padding=0,a.style.verticalAlign="baseline",s.style.fontFamily=t,s.style.fontSize=e,s.style.margin=0,s.style.padding=0,s.appendChild(document.createTextNode("Hidden Text")),o.appendChild(s),o.appendChild(a),n=a.offsetTop-s.offsetTop+1,o.removeChild(s),o.appendChild(document.createTextNode("Hidden Text")),o.style.lineHeight="normal",a.style.verticalAlign="super",r=a.offsetTop-o.offsetTop+1,document.body.removeChild(o),this.baseline=n,this.lineWidth=1,this.middle=r}},{"./utils":26}],7:[function(t,e,n){var i=t("./font");function r(){this.data={}}r.prototype.getMetrics=function(t,e){return void 0===this.data[t+"-"+e]&&(this.data[t+"-"+e]=new i(t,e)),this.data[t+"-"+e]},e.exports=r},{"./font":6}],8:[function(t,e,n){var i=t("./utils").getBounds,r=t("./proxy").loadUrlDocument;function o(e,n,r){this.image=null,this.src=e;var o=this,a=i(e);this.promise=(n?new Promise((function(t){"about:blank"===e.contentWindow.document.URL||null==e.contentWindow.document.documentElement?e.contentWindow.onload=e.onload=function(){t(e)}:t(e)})):this.proxyLoad(r.proxy,a,r)).then((function(e){return t("./core")(e.contentWindow.document.documentElement,{type:"view",width:e.width,height:e.height,proxy:r.proxy,javascriptEnabled:r.javascriptEnabled,removeContainer:r.removeContainer,allowTaint:r.allowTaint,imageTimeout:r.imageTimeout/2})})).then((function(t){return o.image=t}))}o.prototype.proxyLoad=function(t,e,n){var i=this.src;return r(i.src,t,i.ownerDocument,e.width,e.height,n)},e.exports=o},{"./core":4,"./proxy":16,"./utils":26}],9:[function(t,e,n){function i(t){this.src=t.value,this.colorStops=[],this.type=null,this.x0=.5,this.y0=.5,this.x1=.5,this.y1=.5,this.promise=Promise.resolve(!0)}i.TYPES={LINEAR:1,RADIAL:2},i.REGEXP_COLORSTOP=/^\s*(rgba?\(\s*\d{1,3},\s*\d{1,3},\s*\d{1,3}(?:,\s*[0-9\.]+)?\s*\)|[a-z]{3,20}|#[a-f0-9]{3,6})(?:\s+(\d{1,3}(?:\.\d+)?)(%|px)?)?(?:\s|$)/i,e.exports=i},{}],10:[function(t,e,n){e.exports=function(t,e){this.src=t,this.image=new Image;var n=this;this.tainted=null,this.promise=new Promise((function(i,r){n.image.onload=i,n.image.onerror=r,e&&(n.image.crossOrigin="anonymous"),n.image.src=t,!0===n.image.complete&&i(n.image)}))}},{}],11:[function(t,e,n){var i=t("./log"),r=t("./imagecontainer"),o=t("./dummyimagecontainer"),a=t("./proxyimagecontainer"),s=t("./framecontainer"),c=t("./svgcontainer"),l=t("./svgnodecontainer"),h=t("./lineargradientcontainer"),u=t("./webkitgradientcontainer"),d=t("./utils").bind;function p(t,e){this.link=null,this.options=t,this.support=e,this.origin=this.getOrigin(window.location.href)}p.prototype.findImages=function(t){var e=[];return t.reduce((function(t,e){switch(e.node.nodeName){case"IMG":return t.concat([{args:[e.node.src],method:"url"}]);case"svg":case"IFRAME":return t.concat([{args:[e.node],method:e.node.nodeName}])}return t}),[]).forEach(this.addImage(e,this.loadImage),this),e},p.prototype.findBackgroundImage=function(t,e){return e.parseBackgroundImages().filter(this.hasImageBackground).forEach(this.addImage(t,this.loadImage),this),t},p.prototype.addImage=function(t,e){return function(n){n.args.forEach((function(r){this.imageExists(t,r)||(t.splice(0,0,e.call(this,n)),i("Added image #"+t.length,"string"==typeof r?r.substring(0,100):r))}),this)}},p.prototype.hasImageBackground=function(t){return"none"!==t.method},p.prototype.loadImage=function(t){if("url"===t.method){var e=t.args[0];return!this.isSVG(e)||this.support.svg||this.options.allowTaint?e.match(/data:image\/.*;base64,/i)?new r(e.replace(/url\(['"]{0,}|['"]{0,}\)$/gi,""),!1):this.isSameOrigin(e)||!0===this.options.allowTaint||this.isSVG(e)?new r(e,!1):this.support.cors&&!this.options.allowTaint&&this.options.useCORS?new r(e,!0):this.options.proxy?new a(e,this.options.proxy):new o(e):new c(e)}return"linear-gradient"===t.method?new h(t):"gradient"===t.method?new u(t):"svg"===t.method?new l(t.args[0],this.support.svg):"IFRAME"===t.method?new s(t.args[0],this.isSameOrigin(t.args[0].src),this.options):new o(t)},p.prototype.isSVG=function(t){return"svg"===t.substring(t.length-3).toLowerCase()||c.prototype.isInline(t)},p.prototype.imageExists=function(t,e){return t.some((function(t){return t.src===e}))},p.prototype.isSameOrigin=function(t){return this.getOrigin(t)===this.origin},p.prototype.getOrigin=function(t){var e=this.link||(this.link=document.createElement("a"));return e.href=t,e.href=e.href,e.protocol+e.hostname+e.port},p.prototype.getPromise=function(t){return this.timeout(t,this.options.imageTimeout).catch((function(){return new o(t.src).promise.then((function(e){t.image=e}))}))},p.prototype.get=function(t){var e=null;return this.images.some((function(n){return(e=n).src===t}))?e:null},p.prototype.fetch=function(t){return this.images=t.reduce(d(this.findBackgroundImage,this),this.findImages(t)),this.images.forEach((function(t,e){t.promise.then((function(){i("Succesfully loaded image #"+(e+1),t)}),(function(n){i("Failed loading image #"+(e+1),t,n)}))})),this.ready=Promise.all(this.images.map(this.getPromise,this)),i("Finished searching images"),this},p.prototype.timeout=function(t,e){var n,r=Promise.race([t.promise,new Promise((function(r,o){n=setTimeout((function(){i("Timed out loading image",t),o(t)}),e)}))]).then((function(t){return clearTimeout(n),t}));return r.catch((function(){clearTimeout(n)})),r},e.exports=p},{"./dummyimagecontainer":5,"./framecontainer":8,"./imagecontainer":10,"./lineargradientcontainer":12,"./log":13,"./proxyimagecontainer":17,"./svgcontainer":23,"./svgnodecontainer":24,"./utils":26,"./webkitgradientcontainer":27}],12:[function(t,e,n){var i=t("./gradientcontainer"),r=t("./color");function o(t){i.apply(this,arguments),this.type=i.TYPES.LINEAR;var e=o.REGEXP_DIRECTION.test(t.args[0])||!i.REGEXP_COLORSTOP.test(t.args[0]);e?t.args[0].split(/\s+/).reverse().forEach((function(t,e){switch(t){case"left":this.x0=0,this.x1=1;break;case"top":this.y0=0,this.y1=1;break;case"right":this.x0=1,this.x1=0;break;case"bottom":this.y0=1,this.y1=0;break;case"to":var n=this.y0,i=this.x0;this.y0=this.y1,this.x0=this.x1,this.x1=i,this.y1=n;break;case"center":break;default:var r=.01*parseFloat(t,10);if(isNaN(r))break;0===e?(this.y0=r,this.y1=1-this.y0):(this.x0=r,this.x1=1-this.x0)}}),this):(this.y0=0,this.y1=1),this.colorStops=t.args.slice(e?1:0).map((function(t){var e=t.match(i.REGEXP_COLORSTOP),n=+e[2],o=0===n?"%":e[3];return{color:new r(e[1]),stop:"%"===o?n/100:null}})),null===this.colorStops[0].stop&&(this.colorStops[0].stop=0),null===this.colorStops[this.colorStops.length-1].stop&&(this.colorStops[this.colorStops.length-1].stop=1),this.colorStops.forEach((function(t,e){null===t.stop&&this.colorStops.slice(e).some((function(n,i){return null!==n.stop&&(t.stop=(n.stop-this.colorStops[e-1].stop)/(i+1)+this.colorStops[e-1].stop,!0)}),this)}),this)}o.prototype=Object.create(i.prototype),o.REGEXP_DIRECTION=/^\s*(?:to|left|right|top|bottom|center|\d{1,3}(?:\.\d+)?%?)(?:\s|$)/i,e.exports=o},{"./color":3,"./gradientcontainer":9}],13:[function(t,e,n){var i=function(){i.options.logging&&window.console&&window.console.log&&Function.prototype.bind.call(window.console.log,window.console).apply(window.console,[Date.now()-i.options.start+"ms","html2canvas:"].concat([].slice.call(arguments,0)))};i.options={logging:!1},e.exports=i},{}],14:[function(t,e,n){var i=t("./color"),r=t("./utils"),o=r.getBounds,a=r.parseBackgrounds,s=r.offsetBounds;function c(t,e){this.node=t,this.parent=e,this.stack=null,this.bounds=null,this.borders=null,this.clip=[],this.backgroundClip=[],this.offsetBounds=null,this.visible=null,this.computedStyles=null,this.colors={},this.styles={},this.backgroundImages=null,this.transformData=null,this.transformMatrix=null,this.isPseudoElement=!1,this.opacity=null}function l(t){return-1!==t.toString().indexOf("%")}function h(t){return t.replace("px","")}function u(t){return parseFloat(t)}c.prototype.cloneTo=function(t){t.visible=this.visible,t.borders=this.borders,t.bounds=this.bounds,t.clip=this.clip,t.backgroundClip=this.backgroundClip,t.computedStyles=this.computedStyles,t.styles=this.styles,t.backgroundImages=this.backgroundImages,t.opacity=this.opacity},c.prototype.getOpacity=function(){return null===this.opacity?this.opacity=this.cssFloat("opacity"):this.opacity},c.prototype.assignStack=function(t){this.stack=t,t.children.push(this)},c.prototype.isElementVisible=function(){return this.node.nodeType===Node.TEXT_NODE?this.parent.visible:"none"!==this.css("display")&&"hidden"!==this.css("visibility")&&!this.node.hasAttribute("data-html2canvas-ignore")&&("INPUT"!==this.node.nodeName||"hidden"!==this.node.getAttribute("type"))},c.prototype.css=function(t){return this.computedStyles||(this.computedStyles=this.isPseudoElement?this.parent.computedStyle(this.before?":before":":after"):this.computedStyle(null)),this.styles[t]||(this.styles[t]=this.computedStyles[t])},c.prototype.prefixedCss=function(t){var e=this.css(t);return void 0===e&&["webkit","moz","ms","o"].some((function(n){return void 0!==(e=this.css(n+t.substr(0,1).toUpperCase()+t.substr(1)))}),this),void 0===e?null:e},c.prototype.computedStyle=function(t){return this.node.ownerDocument.defaultView.getComputedStyle(this.node,t)},c.prototype.cssInt=function(t){var e=parseInt(this.css(t),10);return isNaN(e)?0:e},c.prototype.color=function(t){return this.colors[t]||(this.colors[t]=new i(this.css(t)))},c.prototype.cssFloat=function(t){var e=parseFloat(this.css(t));return isNaN(e)?0:e},c.prototype.fontWeight=function(){var t=this.css("fontWeight");switch(parseInt(t,10)){case 401:t="bold";break;case 400:t="normal"}return t},c.prototype.parseClip=function(){var t=this.css("clip").match(this.CLIP);return t?{top:parseInt(t[1],10),right:parseInt(t[2],10),bottom:parseInt(t[3],10),left:parseInt(t[4],10)}:null},c.prototype.parseBackgroundImages=function(){return this.backgroundImages||(this.backgroundImages=a(this.css("backgroundImage")))},c.prototype.cssList=function(t,e){var n=(this.css(t)||"").split(",");return 1===(n=(n=n[e||0]||n[0]||"auto").trim().split(" ")).length&&(n=[n[0],l(n[0])?"auto":n[0]]),n},c.prototype.parseBackgroundSize=function(t,e,n){var i,r,o=this.cssList("backgroundSize",n);if(l(o[0]))i=t.width*parseFloat(o[0])/100;else{if(/contain|cover/.test(o[0])){var a=t.width/t.height,s=e.width/e.height;return a<s^"contain"===o[0]?{width:t.height*s,height:t.height}:{width:t.width,height:t.width/s}}i=parseInt(o[0],10)}return r="auto"===o[0]&&"auto"===o[1]?e.height:"auto"===o[1]?i/e.width*e.height:l(o[1])?t.height*parseFloat(o[1])/100:parseInt(o[1],10),"auto"===o[0]&&(i=r/e.height*e.width),{width:i,height:r}},c.prototype.parseBackgroundPosition=function(t,e,n,i){var r,o,a=this.cssList("backgroundPosition",n);return r=l(a[0])?(t.width-(i||e).width)*(parseFloat(a[0])/100):parseInt(a[0],10),o="auto"===a[1]?r/e.width*e.height:l(a[1])?(t.height-(i||e).height)*parseFloat(a[1])/100:parseInt(a[1],10),"auto"===a[0]&&(r=o/e.height*e.width),{left:r,top:o}},c.prototype.parseBackgroundRepeat=function(t){return this.cssList("backgroundRepeat",t)[0]},c.prototype.parseTextShadows=function(){var t=this.css("textShadow"),e=[];if(t&&"none"!==t)for(var n=t.match(this.TEXT_SHADOW_PROPERTY),r=0;n&&r<n.length;r++){var o=n[r].match(this.TEXT_SHADOW_VALUES);e.push({color:new i(o[0]),offsetX:o[1]?parseFloat(o[1].replace("px","")):0,offsetY:o[2]?parseFloat(o[2].replace("px","")):0,blur:o[3]?o[3].replace("px",""):0})}return e},c.prototype.parseTransform=function(){if(!this.transformData)if(this.hasTransform()){var t=this.parseBounds(),e=this.prefixedCss("transformOrigin").split(" ").map(h).map(u);e[0]+=t.left,e[1]+=t.top,this.transformData={origin:e,matrix:this.parseTransformMatrix()}}else this.transformData={origin:[0,0],matrix:[1,0,0,1,0,0]};return this.transformData},c.prototype.parseTransformMatrix=function(){if(!this.transformMatrix){var t=this.prefixedCss("transform"),e=t?function(t){if(t&&"matrix"===t[1])return t[2].split(",").map((function(t){return parseFloat(t.trim())}));if(t&&"matrix3d"===t[1]){var e=t[2].split(",").map((function(t){return parseFloat(t.trim())}));return[e[0],e[1],e[4],e[5],e[12],e[13]]}}(t.match(this.MATRIX_PROPERTY)):null;this.transformMatrix=e||[1,0,0,1,0,0]}return this.transformMatrix},c.prototype.parseBounds=function(){return this.bounds||(this.bounds=this.hasTransform()?s(this.node):o(this.node))},c.prototype.hasTransform=function(){return"1,0,0,1,0,0"!==this.parseTransformMatrix().join(",")||this.parent&&this.parent.hasTransform()},c.prototype.getValue=function(){var t,e,n=this.node.value||"";return"SELECT"===this.node.tagName?(t=this.node,n=(e=t.options[t.selectedIndex||0])&&e.text||""):"password"===this.node.type&&(n=Array(n.length+1).join("â¢")),0===n.length?this.node.placeholder||"":n},c.prototype.MATRIX_PROPERTY=/(matrix|matrix3d)\((.+)\)/,c.prototype.TEXT_SHADOW_PROPERTY=/((rgba|rgb)\([^\)]+\)(\s-?\d+px){0,})/g,c.prototype.TEXT_SHADOW_VALUES=/(-?\d+px)|(#.+)|(rgb\(.+\))|(rgba\(.+\))/g,c.prototype.CLIP=/^rect\((\d+)px,? (\d+)px,? (\d+)px,? (\d+)px\)$/,e.exports=c},{"./color":3,"./utils":26}],15:[function(t,e,n){var i=t("./log"),r=t("punycode"),o=t("./nodecontainer"),a=t("./textcontainer"),s=t("./pseudoelementcontainer"),c=t("./fontmetrics"),l=t("./color"),h=t("./stackingcontext"),u=t("./utils"),d=u.bind,p=u.getBounds,f=u.parseBackgrounds,m=u.offsetBounds;function g(t,e,n,r,a){i("Starting NodeParser"),this.renderer=e,this.options=a,this.range=null,this.support=n,this.renderQueue=[],this.stack=new h(!0,1,t.ownerDocument,null);var s=new o(t,null);if(a.background&&e.rectangle(0,0,e.width,e.height,new l(a.background)),t===t.ownerDocument.documentElement){var u=new o(s.color("backgroundColor").isTransparent()?t.ownerDocument.body:t.ownerDocument.documentElement,null);e.rectangle(0,0,e.width,e.height,u.color("backgroundColor"))}s.visibile=s.isElementVisible(),this.createPseudoHideStyles(t.ownerDocument),this.disableAnimations(t.ownerDocument),this.nodes=H([s].concat(this.getChildren(s)).filter((function(t){return t.visible=t.isElementVisible()})).map(this.getPseudoElements,this)),this.fontMetrics=new c,i("Fetched nodes, total:",this.nodes.length),i("Calculate overflow clips"),this.calculateOverflowClips(),i("Start fetching images"),this.images=r.fetch(this.nodes.filter(F)),this.ready=this.images.ready.then(d((function(){return i("Images loaded, starting parsing"),i("Creating stacking contexts"),this.createStackingContexts(),i("Sorting stacking contexts"),this.sortStackingContexts(this.stack),this.parse(this.stack),i("Render queue created with "+this.renderQueue.length+" items"),new Promise(d((function(t){a.async?"function"==typeof a.async?a.async.call(this,this.renderQueue,t):this.renderQueue.length>0?(this.renderIndex=0,this.asyncRenderer(this.renderQueue,t)):t():(this.renderQueue.forEach(this.paint,this),t())}),this))}),this))}function v(t){return t.parent&&t.parent.clip.length}function y(){}g.prototype.calculateOverflowClips=function(){this.nodes.forEach((function(t){if(F(t)){N(t)&&t.appendToDOM(),t.borders=this.parseBorders(t);var e="hidden"===t.css("overflow")?[t.borders.clip]:[],n=t.parseClip();n&&-1!==["absolute","fixed"].indexOf(t.css("position"))&&e.push([["rect",t.bounds.left+n.left,t.bounds.top+n.top,n.right-n.left,n.bottom-n.top]]),t.clip=v(t)?t.parent.clip.concat(e):e,t.backgroundClip="hidden"!==t.css("overflow")?t.clip.concat([t.borders.clip]):t.clip,N(t)&&t.cleanDOM()}else U(t)&&(t.clip=v(t)?t.parent.clip:[]);N(t)||(t.bounds=null)}),this)},g.prototype.asyncRenderer=function(t,e,n){n=n||Date.now(),this.paint(t[this.renderIndex++]),t.length===this.renderIndex?e():n+20>Date.now()?this.asyncRenderer(t,e,n):setTimeout(d((function(){this.asyncRenderer(t,e)}),this),0)},g.prototype.createPseudoHideStyles=function(t){this.createStyles(t,"."+s.prototype.PSEUDO_HIDE_ELEMENT_CLASS_BEFORE+':before { content: "" !important; display: none !important; }.'+s.prototype.PSEUDO_HIDE_ELEMENT_CLASS_AFTER+':after { content: "" !important; display: none !important; }')},g.prototype.disableAnimations=function(t){this.createStyles(t,"* { -webkit-animation: none !important; -moz-animation: none !important; -o-animation: none !important; animation: none !important; -webkit-transition: none !important; -moz-transition: none !important; -o-transition: none !important; transition: none !important;}")},g.prototype.createStyles=function(t,e){var n=t.createElement("style");n.innerHTML=e,t.body.appendChild(n)},g.prototype.getPseudoElements=function(t){var e=[[t]];if(t.node.nodeType===Node.ELEMENT_NODE){var n=this.getPseudoElement(t,":before"),i=this.getPseudoElement(t,":after");n&&e.push(n),i&&e.push(i)}return H(e)},g.prototype.getPseudoElement=function(t,e){var n=t.computedStyle(e);if(!n||!n.content||"none"===n.content||"-moz-alt-content"===n.content||"none"===n.display)return null;for(var i=function(t){var e=t.substr(0,1);return e===t.substr(t.length-1)&&e.match(/'|"/)?t.substr(1,t.length-2):t}(n.content),r="url"===i.substr(0,3),o=document.createElement(r?"img":"html2canvaspseudoelement"),c=new s(o,t,e),l=n.length-1;l>=0;l--){var h=n.item(l).replace(/(\-[a-z])/g,(function(t){return t.toUpperCase().replace("-","")}));o.style[h]=n[h]}if(o.className=s.prototype.PSEUDO_HIDE_ELEMENT_CLASS_BEFORE+" "+s.prototype.PSEUDO_HIDE_ELEMENT_CLASS_AFTER,r)return o.src=f(i)[0].args[0],[c];var u=document.createTextNode(i);return o.appendChild(u),[c,new a(u,c)]},g.prototype.getChildren=function(t){return H([].filter.call(t.node.childNodes,k).map((function(e){var n=[e.nodeType===Node.TEXT_NODE?new a(e,t):new o(e,t)].filter(z);return e.nodeType===Node.ELEMENT_NODE&&n.length&&"TEXTAREA"!==e.tagName?n[0].isElementVisible()?n.concat(this.getChildren(n[0])):[]:n}),this))},g.prototype.newStackingContext=function(t,e){var n=new h(e,t.getOpacity(),t.node,t.parent);t.cloneTo(n),(e?n.getParentStack(this):n.parent.stack).contexts.push(n),t.stack=n},g.prototype.createStackingContexts=function(){this.nodes.forEach((function(t){F(t)&&(this.isRootElement(t)||function(t){return t.getOpacity()<1}(t)||function(t){var e=t.css("position");return"auto"!==(-1!==["absolute","relative","fixed"].indexOf(e)?t.css("zIndex"):"auto")}(t)||this.isBodyWithTransparentRoot(t)||t.hasTransform())?this.newStackingContext(t,!0):F(t)&&(I(t)&&C(t)||function(t){return-1!==["inline-block","inline-table"].indexOf(t.css("display"))}(t)||D(t))?this.newStackingContext(t,!1):t.assignStack(t.parent.stack)}),this)},g.prototype.isBodyWithTransparentRoot=function(t){return"BODY"===t.node.nodeName&&t.parent.color("backgroundColor").isTransparent()},g.prototype.isRootElement=function(t){return null===t.parent},g.prototype.sortStackingContexts=function(t){var e;t.contexts.sort((e=t.contexts.slice(0),function(t,n){return t.cssInt("zIndex")+e.indexOf(t)/e.length-(n.cssInt("zIndex")+e.indexOf(n)/e.length)})),t.contexts.forEach(this.sortStackingContexts,this)},g.prototype.parseTextBounds=function(t){return function(e,n,i){if("none"!==t.parent.css("textDecoration").substr(0,4)||0!==e.trim().length){if(this.support.rangeBounds&&!t.parent.hasTransform()){var r=i.slice(0,n).join("").length;return this.getRangeBounds(t.node,r,e.length)}if(t.node&&"string"==typeof t.node.data){var o=t.node.splitText(e.length),a=this.getWrapperBounds(t.node,t.parent.hasTransform());return t.node=o,a}}else this.support.rangeBounds&&!t.parent.hasTransform()||(t.node=t.node.splitText(e.length));return{}}},g.prototype.getWrapperBounds=function(t,e){var n=t.ownerDocument.createElement("html2canvaswrapper"),i=t.parentNode,r=t.cloneNode(!0);n.appendChild(t.cloneNode(!0)),i.replaceChild(n,t);var o=e?m(n):p(n);return i.replaceChild(r,n),o},g.prototype.getRangeBounds=function(t,e,n){var i=this.range||(this.range=t.ownerDocument.createRange());return i.setStart(t,e),i.setEnd(t,e+n),i.getBoundingClientRect()},g.prototype.parse=function(t){var e=t.contexts.filter(T),n=t.children.filter(F),i=n.filter(O(D)),r=i.filter(O(I)).filter(O(P)),o=n.filter(O(I)).filter(D),a=i.filter(O(I)).filter(P),s=t.contexts.concat(i.filter(I)).filter(C),c=t.children.filter(U).filter(L),l=t.contexts.filter(M);e.concat(r).concat(o).concat(a).concat(s).concat(c).concat(l).forEach((function(t){this.renderQueue.push(t),R(t)&&(this.parse(t),this.renderQueue.push(new y))}),this)},g.prototype.paint=function(t){try{t instanceof y?this.renderer.ctx.restore():U(t)?(N(t.parent)&&t.parent.appendToDOM(),this.paintText(t),N(t.parent)&&t.parent.cleanDOM()):this.paintNode(t)}catch(t){if(i(t),this.options.strict)throw t}},g.prototype.paintNode=function(t){R(t)&&(this.renderer.setOpacity(t.opacity),this.renderer.ctx.save(),t.hasTransform()&&this.renderer.setTransform(t.parseTransform())),"INPUT"===t.node.nodeName&&"checkbox"===t.node.type?this.paintCheckbox(t):"INPUT"===t.node.nodeName&&"radio"===t.node.type?this.paintRadio(t):this.paintElement(t)},g.prototype.paintElement=function(t){var e=t.parseBounds();this.renderer.clip(t.backgroundClip,(function(){this.renderer.renderBackground(t,e,t.borders.borders.map(B))}),this),this.renderer.clip(t.clip,(function(){this.renderer.renderBorders(t.borders.borders)}),this),this.renderer.clip(t.backgroundClip,(function(){switch(t.node.nodeName){case"svg":case"IFRAME":var n=this.images.get(t.node);n?this.renderer.renderImage(t,e,t.borders,n):i("Error loading <"+t.node.nodeName+">",t.node);break;case"IMG":var r=this.images.get(t.node.src);r?this.renderer.renderImage(t,e,t.borders,r):i("Error loading <img>",t.node.src);break;case"CANVAS":this.renderer.renderImage(t,e,t.borders,{image:t.node});break;case"SELECT":case"INPUT":case"TEXTAREA":this.paintFormValue(t)}}),this)},g.prototype.paintCheckbox=function(t){var e=t.parseBounds(),n=Math.min(e.width,e.height),i={width:n-1,height:n-1,top:e.top,left:e.left},r=[3,3],o=[r,r,r,r],a=[1,1,1,1].map((function(t){return{color:new l("#A5A5A5"),width:t}})),s=_(i,o,a);this.renderer.clip(t.backgroundClip,(function(){this.renderer.rectangle(i.left+1,i.top+1,i.width-2,i.height-2,new l("#DEDEDE")),this.renderer.renderBorders(x(a,i,s,o)),t.node.checked&&(this.renderer.font(new l("#424242"),"normal","normal","bold",n-3+"px","arial"),this.renderer.text("â",i.left+n/6,i.top+n-1))}),this)},g.prototype.paintRadio=function(t){var e=t.parseBounds(),n=Math.min(e.width,e.height)-2;this.renderer.clip(t.backgroundClip,(function(){this.renderer.circleStroke(e.left+1,e.top+1,n,new l("#DEDEDE"),1,new l("#A5A5A5")),t.node.checked&&this.renderer.circle(Math.ceil(e.left+n/4)+1,Math.ceil(e.top+n/4)+1,Math.floor(n/2),new l("#424242"))}),this)},g.prototype.paintFormValue=function(t){var e=t.getValue();if(e.length>0){var n=t.node.ownerDocument,r=n.createElement("html2canvaswrapper");["lineHeight","textAlign","fontFamily","fontWeight","fontSize","color","paddingLeft","paddingTop","paddingRight","paddingBottom","width","height","borderLeftStyle","borderTopStyle","borderLeftWidth","borderTopWidth","boxSizing","whiteSpace","wordWrap"].forEach((function(e){try{r.style[e]=t.css(e)}catch(t){i("html2canvas: Parse: Exception caught in renderFormValue: "+t.message)}}));var o=t.parseBounds();r.style.position="fixed",r.style.left=o.left+"px",r.style.top=o.top+"px",r.textContent=e,n.body.appendChild(r),this.paintText(new a(r.firstChild,t)),n.body.removeChild(r)}},g.prototype.paintText=function(t){t.applyTextTransform();var e,n=r.ucs2.decode(t.node.data),i=this.options.letterRendering&&!function(t){return/^(normal|none|0px)$/.test(t.parent.css("letterSpacing"))}(t)||(e=t.node.data,/[^\u0000-\u00ff]/.test(e))?n.map((function(t){return r.ucs2.encode([t])})):function(t){for(var e,n,i=[],o=0,a=!1;t.length;)n=t[o],-1!==[32,13,10,9,45].indexOf(n)===a?((e=t.splice(0,o)).length&&i.push(r.ucs2.encode(e)),a=!a,o=0):o++,o>=t.length&&(e=t.splice(0,o)).length&&i.push(r.ucs2.encode(e));return i}(n),o=t.parent.fontWeight(),a=t.parent.css("fontSize"),s=t.parent.css("fontFamily"),c=t.parent.parseTextShadows();this.renderer.font(t.parent.color("color"),t.parent.css("fontStyle"),t.parent.css("fontVariant"),o,a,s),c.length?this.renderer.fontShadow(c[0].color,c[0].offsetX,c[0].offsetY,c[0].blur):this.renderer.clearShadow(),this.renderer.clip(t.parent.clip,(function(){i.map(this.parseTextBounds(t),this).forEach((function(e,n){e&&(this.renderer.text(i[n],e.left,e.bottom),this.renderTextDecoration(t.parent,e,this.fontMetrics.getMetrics(s,a)))}),this)}),this)},g.prototype.renderTextDecoration=function(t,e,n){switch(t.css("textDecoration").split(" ")[0]){case"underline":this.renderer.rectangle(e.left,Math.round(e.top+n.baseline+n.lineWidth),e.width,1,t.color("color"));break;case"overline":this.renderer.rectangle(e.left,Math.round(e.top),e.width,1,t.color("color"));break;case"line-through":this.renderer.rectangle(e.left,Math.ceil(e.top+n.middle+n.lineWidth),e.width,1,t.color("color"))}};var b={inset:[["darken",.6],["darken",.1],["darken",.1],["darken",.6]]};function x(t,e,n,i){return t.map((function(r,o){if(r.width>0){var a=e.left,s=e.top,c=e.width,l=e.height-t[2].width;switch(o){case 0:l=t[0].width,r.args=E({c1:[a,s],c2:[a+c,s],c3:[a+c-t[1].width,s+l],c4:[a+t[3].width,s+l]},i[0],i[1],n.topLeftOuter,n.topLeftInner,n.topRightOuter,n.topRightInner);break;case 1:a=e.left+e.width-t[1].width,c=t[1].width,r.args=E({c1:[a+c,s],c2:[a+c,s+l+t[2].width],c3:[a,s+l],c4:[a,s+t[0].width]},i[1],i[2],n.topRightOuter,n.topRightInner,n.bottomRightOuter,n.bottomRightInner);break;case 2:s=s+e.height-t[2].width,l=t[2].width,r.args=E({c1:[a+c,s+l],c2:[a,s+l],c3:[a+t[3].width,s],c4:[a+c-t[3].width,s]},i[2],i[3],n.bottomRightOuter,n.bottomRightInner,n.bottomLeftOuter,n.bottomLeftInner);break;case 3:c=t[3].width,r.args=E({c1:[a,s+l+t[2].width],c2:[a,s],c3:[a+c,s+t[0].width],c4:[a+c,s+l]},i[3],i[0],n.bottomLeftOuter,n.bottomLeftInner,n.topLeftOuter,n.topLeftInner)}}return r}))}function w(t,e,n,i){var r=(Math.sqrt(2)-1)/3*4,o=n*r,a=i*r,s=t+n,c=e+i;return{topLeft:S({x:t,y:c},{x:t,y:c-a},{x:s-o,y:e},{x:s,y:e}),topRight:S({x:t,y:e},{x:t+o,y:e},{x:s,y:c-a},{x:s,y:c}),bottomRight:S({x:s,y:e},{x:s,y:e+a},{x:t+o,y:c},{x:t,y:c}),bottomLeft:S({x:s,y:c},{x:s-o,y:c},{x:t,y:e+a},{x:t,y:e})}}function _(t,e,n){var i=t.left,r=t.top,o=t.width,a=t.height,s=e[0][0]<o/2?e[0][0]:o/2,c=e[0][1]<a/2?e[0][1]:a/2,l=e[1][0]<o/2?e[1][0]:o/2,h=e[1][1]<a/2?e[1][1]:a/2,u=e[2][0]<o/2?e[2][0]:o/2,d=e[2][1]<a/2?e[2][1]:a/2,p=e[3][0]<o/2?e[3][0]:o/2,f=e[3][1]<a/2?e[3][1]:a/2,m=o-l,g=a-d,v=o-u,y=a-f;return{topLeftOuter:w(i,r,s,c).topLeft.subdivide(.5),topLeftInner:w(i+n[3].width,r+n[0].width,Math.max(0,s-n[3].width),Math.max(0,c-n[0].width)).topLeft.subdivide(.5),topRightOuter:w(i+m,r,l,h).topRight.subdivide(.5),topRightInner:w(i+Math.min(m,o+n[3].width),r+n[0].width,m>o+n[3].width?0:l-n[3].width,h-n[0].width).topRight.subdivide(.5),bottomRightOuter:w(i+v,r+g,u,d).bottomRight.subdivide(.5),bottomRightInner:w(i+Math.min(v,o-n[3].width),r+Math.min(g,a+n[0].width),Math.max(0,u-n[1].width),d-n[2].width).bottomRight.subdivide(.5),bottomLeftOuter:w(i,r+y,p,f).bottomLeft.subdivide(.5),bottomLeftInner:w(i+n[3].width,r+y,Math.max(0,p-n[3].width),f-n[2].width).bottomLeft.subdivide(.5)}}function S(t,e,n,i){var r=function(t,e,n){return{x:t.x+(e.x-t.x)*n,y:t.y+(e.y-t.y)*n}};return{start:t,startControl:e,endControl:n,end:i,subdivide:function(o){var a=r(t,e,o),s=r(e,n,o),c=r(n,i,o),l=r(a,s,o),h=r(s,c,o),u=r(l,h,o);return[S(t,a,l,u),S(u,h,c,i)]},curveTo:function(t){t.push(["bezierCurve",e.x,e.y,n.x,n.y,i.x,i.y])},curveToReversed:function(i){i.push(["bezierCurve",n.x,n.y,e.x,e.y,t.x,t.y])}}}function E(t,e,n,i,r,o,a){var s=[];return e[0]>0||e[1]>0?(s.push(["line",i[1].start.x,i[1].start.y]),i[1].curveTo(s)):s.push(["line",t.c1[0],t.c1[1]]),n[0]>0||n[1]>0?(s.push(["line",o[0].start.x,o[0].start.y]),o[0].curveTo(s),s.push(["line",a[0].end.x,a[0].end.y]),a[0].curveToReversed(s)):(s.push(["line",t.c2[0],t.c2[1]]),s.push(["line",t.c3[0],t.c3[1]])),e[0]>0||e[1]>0?(s.push(["line",r[1].end.x,r[1].end.y]),r[1].curveToReversed(s)):s.push(["line",t.c4[0],t.c4[1]]),s}function A(t,e,n,i,r,o,a){e[0]>0||e[1]>0?(t.push(["line",i[0].start.x,i[0].start.y]),i[0].curveTo(t),i[1].curveTo(t)):t.push(["line",o,a]),(n[0]>0||n[1]>0)&&t.push(["line",r[0].start.x,r[0].start.y])}function T(t){return t.cssInt("zIndex")<0}function M(t){return t.cssInt("zIndex")>0}function C(t){return 0===t.cssInt("zIndex")}function P(t){return-1!==["inline","inline-block","inline-table"].indexOf(t.css("display"))}function R(t){return t instanceof h}function L(t){return t.node.data.trim().length>0}function k(t){return t.nodeType===Node.TEXT_NODE||t.nodeType===Node.ELEMENT_NODE}function I(t){return"static"!==t.css("position")}function D(t){return"none"!==t.css("float")}function O(t){var e=this;return function(){return!t.apply(e,arguments)}}function F(t){return t.node.nodeType===Node.ELEMENT_NODE}function N(t){return!0===t.isPseudoElement}function U(t){return t.node.nodeType===Node.TEXT_NODE}function j(t){return parseInt(t,10)}function B(t){return t.width}function z(t){return t.node.nodeType!==Node.ELEMENT_NODE||-1===["SCRIPT","HEAD","TITLE","OBJECT","BR","OPTION"].indexOf(t.node.nodeName)}function H(t){return[].concat.apply([],t)}g.prototype.parseBorders=function(t){var e=t.parseBounds(),n=function(t){return["TopLeft","TopRight","BottomRight","BottomLeft"].map((function(e){var n=t.css("border"+e+"Radius").split(" ");return n.length<=1&&(n[1]=n[0]),n.map(j)}))}(t),i=["Top","Right","Bottom","Left"].map((function(e,n){var i=t.css("border"+e+"Style"),r=t.color("border"+e+"Color");"inset"===i&&r.isBlack()&&(r=new l([255,255,255,r.a]));var o=b[i]?b[i][n]:null;return{width:t.cssInt("border"+e+"Width"),color:o?r[o[0]](o[1]):r,args:null}})),r=_(e,n,i);return{clip:this.parseBackgroundClip(t,r,i,n,e),borders:x(i,e,r,n)}},g.prototype.parseBackgroundClip=function(t,e,n,i,r){var o=[];switch(t.css("backgroundClip")){case"content-box":case"padding-box":A(o,i[0],i[1],e.topLeftInner,e.topRightInner,r.left+n[3].width,r.top+n[0].width),A(o,i[1],i[2],e.topRightInner,e.bottomRightInner,r.left+r.width-n[1].width,r.top+n[0].width),A(o,i[2],i[3],e.bottomRightInner,e.bottomLeftInner,r.left+r.width-n[1].width,r.top+r.height-n[2].width),A(o,i[3],i[0],e.bottomLeftInner,e.topLeftInner,r.left+n[3].width,r.top+r.height-n[2].width);break;default:A(o,i[0],i[1],e.topLeftOuter,e.topRightOuter,r.left,r.top),A(o,i[1],i[2],e.topRightOuter,e.bottomRightOuter,r.left+r.width,r.top),A(o,i[2],i[3],e.bottomRightOuter,e.bottomLeftOuter,r.left+r.width,r.top+r.height),A(o,i[3],i[0],e.bottomLeftOuter,e.topLeftOuter,r.left,r.top+r.height)}return o},e.exports=g},{"./color":3,"./fontmetrics":7,"./log":13,"./nodecontainer":14,"./pseudoelementcontainer":18,"./stackingcontext":21,"./textcontainer":25,"./utils":26,punycode:1}],16:[function(t,e,i){var r=t("./xhr"),o=t("./utils"),a=t("./log"),s=t("./clone"),c=o.decode64;function l(t,e,n){var i="withCredentials"in new XMLHttpRequest;if(!e)return Promise.reject("No proxy configured");var o=d(i),a=p(e,t,o);return i?r(a):u(n,a,o).then((function(t){return c(t.content)}))}var h=0;function u(t,e,i){return new Promise((function(r,o){var a=t.createElement("script"),s=function(){delete n.proxy[i],t.body.removeChild(a)};n.proxy[i]=function(t){s(),r(t)},a.src=e,a.onerror=function(t){s(),o(t)},t.body.appendChild(a)}))}function d(t){return t?"":"html2canvas_"+Date.now()+"_"+ ++h+"_"+Math.round(1e5*Math.random())}function p(t,e,n){return t+"?url="+encodeURIComponent(e)+(n.length?"&callback=html2canvas.proxy."+n:"")}function f(t){return function(e){var n,i=new DOMParser;try{n=i.parseFromString(e,"text/html")}catch(t){a("DOMParser not supported, falling back to createHTMLDocument"),n=document.implementation.createHTMLDocument("");try{n.open(),n.write(e),n.close()}catch(t){a("createHTMLDocument write not supported, falling back to document.body.innerHTML"),n.body.innerHTML=e}}var r=n.querySelector("base");if(!r||!r.href.host){var o=n.createElement("base");o.href=t,n.head.insertBefore(o,n.head.firstChild)}return n}}i.Proxy=l,i.ProxyURL=function(t,e,n){var i="crossOrigin"in new Image,r=d(i),o=p(e,t,r);return i?Promise.resolve(o):u(n,o,r).then((function(t){return"data:"+t.type+";base64,"+t.content}))},i.loadUrlDocument=function(t,e,n,i,r,o){return new l(t,e,window.document).then(f(t)).then((function(t){return s(t,n,i,r,o,0,0)}))}},{"./clone":2,"./log":13,"./utils":26,"./xhr":28}],17:[function(t,e,n){var i=t("./proxy").ProxyURL;e.exports=function(t,e){var n=document.createElement("a");n.href=t,t=n.href,this.src=t,this.image=new Image;var r=this;this.promise=new Promise((function(n,o){r.image.crossOrigin="Anonymous",r.image.onload=n,r.image.onerror=o,new i(t,e,document).then((function(t){r.image.src=t})).catch(o)}))}},{"./proxy":16}],18:[function(t,e,n){var i=t("./nodecontainer");function r(t,e,n){i.call(this,t,e),this.isPseudoElement=!0,this.before=":before"===n}r.prototype.cloneTo=function(t){r.prototype.cloneTo.call(this,t),t.isPseudoElement=!0,t.before=this.before},r.prototype=Object.create(i.prototype),r.prototype.appendToDOM=function(){this.before?this.parent.node.insertBefore(this.node,this.parent.node.firstChild):this.parent.node.appendChild(this.node),this.parent.node.className+=" "+this.getHideClass()},r.prototype.cleanDOM=function(){this.node.parentNode.removeChild(this.node),this.parent.node.className=this.parent.node.className.replace(this.getHideClass(),"")},r.prototype.getHideClass=function(){return this["PSEUDO_HIDE_ELEMENT_CLASS_"+(this.before?"BEFORE":"AFTER")]},r.prototype.PSEUDO_HIDE_ELEMENT_CLASS_BEFORE="___html2canvas___pseudoelement_before",r.prototype.PSEUDO_HIDE_ELEMENT_CLASS_AFTER="___html2canvas___pseudoelement_after",e.exports=r},{"./nodecontainer":14}],19:[function(t,e,n){var i=t("./log");function r(t,e,n,i,r){this.width=t,this.height=e,this.images=n,this.options=i,this.document=r}r.prototype.renderImage=function(t,e,n,i){var r=t.cssInt("paddingLeft"),o=t.cssInt("paddingTop"),a=t.cssInt("paddingRight"),s=t.cssInt("paddingBottom"),c=n.borders,l=e.width-(c[1].width+c[3].width+r+a),h=e.height-(c[0].width+c[2].width+o+s);this.drawImage(i,0,0,i.image.width||l,i.image.height||h,e.left+r+c[3].width,e.top+o+c[0].width,l,h)},r.prototype.renderBackground=function(t,e,n){e.height>0&&e.width>0&&(this.renderBackgroundColor(t,e),this.renderBackgroundImage(t,e,n))},r.prototype.renderBackgroundColor=function(t,e){var n=t.color("backgroundColor");n.isTransparent()||this.rectangle(e.left,e.top,e.width,e.height,n)},r.prototype.renderBorders=function(t){t.forEach(this.renderBorder,this)},r.prototype.renderBorder=function(t){t.color.isTransparent()||null===t.args||this.drawShape(t.args,t.color)},r.prototype.renderBackgroundImage=function(t,e,n){t.parseBackgroundImages().reverse().forEach((function(r,o,a){switch(r.method){case"url":var s=this.images.get(r.args[0]);s?this.renderBackgroundRepeating(t,e,s,a.length-(o+1),n):i("Error loading background-image",r.args[0]);break;case"linear-gradient":case"gradient":var c=this.images.get(r.value);c?this.renderBackgroundGradient(c,e,n):i("Error loading background-image",r.args[0]);break;case"none":break;default:i("Unknown background-image type",r.args[0])}}),this)},r.prototype.renderBackgroundRepeating=function(t,e,n,i,r){var o=t.parseBackgroundSize(e,n.image,i),a=t.parseBackgroundPosition(e,n.image,i,o);switch(t.parseBackgroundRepeat(i)){case"repeat-x":case"repeat no-repeat":this.backgroundRepeatShape(n,a,o,e,e.left+r[3],e.top+a.top+r[0],99999,o.height,r);break;case"repeat-y":case"no-repeat repeat":this.backgroundRepeatShape(n,a,o,e,e.left+a.left+r[3],e.top+r[0],o.width,99999,r);break;case"no-repeat":this.backgroundRepeatShape(n,a,o,e,e.left+a.left+r[3],e.top+a.top+r[0],o.width,o.height,r);break;default:this.renderBackgroundRepeat(n,a,o,{top:e.top,left:e.left},r[3],r[0])}},e.exports=r},{"./log":13}],20:[function(t,e,n){var i=t("../renderer"),r=t("../lineargradientcontainer"),o=t("../log");function a(t,e){i.apply(this,arguments),this.canvas=this.options.canvas||this.document.createElement("canvas"),this.options.canvas||(this.canvas.width=t,this.canvas.height=e),this.ctx=this.canvas.getContext("2d"),this.taintCtx=this.document.createElement("canvas").getContext("2d"),this.ctx.textBaseline="bottom",this.variables={},o("Initialized CanvasRenderer with size",t,"x",e)}function s(t){return t.length>0}a.prototype=Object.create(i.prototype),a.prototype.setFillStyle=function(t){return this.ctx.fillStyle="object"==typeof t&&t.isColor?t.toString():t,this.ctx},a.prototype.rectangle=function(t,e,n,i,r){this.setFillStyle(r).fillRect(t,e,n,i)},a.prototype.circle=function(t,e,n,i){this.setFillStyle(i),this.ctx.beginPath(),this.ctx.arc(t+n/2,e+n/2,n/2,0,2*Math.PI,!0),this.ctx.closePath(),this.ctx.fill()},a.prototype.circleStroke=function(t,e,n,i,r,o){this.circle(t,e,n,i),this.ctx.strokeStyle=o.toString(),this.ctx.stroke()},a.prototype.drawShape=function(t,e){this.shape(t),this.setFillStyle(e).fill()},a.prototype.taints=function(t){if(null===t.tainted){this.taintCtx.drawImage(t.image,0,0);try{this.taintCtx.getImageData(0,0,1,1),t.tainted=!1}catch(e){this.taintCtx=document.createElement("canvas").getContext("2d"),t.tainted=!0}}return t.tainted},a.prototype.drawImage=function(t,e,n,i,r,o,a,s,c){this.taints(t)&&!this.options.allowTaint||this.ctx.drawImage(t.image,e,n,i,r,o,a,s,c)},a.prototype.clip=function(t,e,n){this.ctx.save(),t.filter(s).forEach((function(t){this.shape(t).clip()}),this),e.call(n),this.ctx.restore()},a.prototype.shape=function(t){return this.ctx.beginPath(),t.forEach((function(t,e){"rect"===t[0]?this.ctx.rect.apply(this.ctx,t.slice(1)):this.ctx[0===e?"moveTo":t[0]+"To"].apply(this.ctx,t.slice(1))}),this),this.ctx.closePath(),this.ctx},a.prototype.font=function(t,e,n,i,r,o){this.setFillStyle(t).font=[e,n,i,r,o].join(" ").split(",")[0]},a.prototype.fontShadow=function(t,e,n,i){this.setVariable("shadowColor",t.toString()).setVariable("shadowOffsetY",e).setVariable("shadowOffsetX",n).setVariable("shadowBlur",i)},a.prototype.clearShadow=function(){this.setVariable("shadowColor","rgba(0,0,0,0)")},a.prototype.setOpacity=function(t){this.ctx.globalAlpha=t},a.prototype.setTransform=function(t){this.ctx.translate(t.origin[0],t.origin[1]),this.ctx.transform.apply(this.ctx,t.matrix),this.ctx.translate(-t.origin[0],-t.origin[1])},a.prototype.setVariable=function(t,e){return this.variables[t]!==e&&(this.variables[t]=this.ctx[t]=e),this},a.prototype.text=function(t,e,n){this.ctx.fillText(t,e,n)},a.prototype.backgroundRepeatShape=function(t,e,n,i,r,o,a,s,c){var l=[["line",Math.round(r),Math.round(o)],["line",Math.round(r+a),Math.round(o)],["line",Math.round(r+a),Math.round(s+o)],["line",Math.round(r),Math.round(s+o)]];this.clip([l],(function(){this.renderBackgroundRepeat(t,e,n,i,c[3],c[0])}),this)},a.prototype.renderBackgroundRepeat=function(t,e,n,i,r,o){var a=Math.round(i.left+e.left+r),s=Math.round(i.top+e.top+o);this.setFillStyle(this.ctx.createPattern(this.resizeImage(t,n),"repeat")),this.ctx.translate(a,s),this.ctx.fill(),this.ctx.translate(-a,-s)},a.prototype.renderBackgroundGradient=function(t,e){if(t instanceof r){var n=this.ctx.createLinearGradient(e.left+e.width*t.x0,e.top+e.height*t.y0,e.left+e.width*t.x1,e.top+e.height*t.y1);t.colorStops.forEach((function(t){n.addColorStop(t.stop,t.color.toString())})),this.rectangle(e.left,e.top,e.width,e.height,n)}},a.prototype.resizeImage=function(t,e){var n=t.image;if(n.width===e.width&&n.height===e.height)return n;var i=document.createElement("canvas");return i.width=e.width,i.height=e.height,i.getContext("2d").drawImage(n,0,0,n.width,n.height,0,0,e.width,e.height),i},e.exports=a},{"../lineargradientcontainer":12,"../log":13,"../renderer":19}],21:[function(t,e,n){var i=t("./nodecontainer");function r(t,e,n,r){i.call(this,n,r),this.ownStacking=t,this.contexts=[],this.children=[],this.opacity=(this.parent?this.parent.stack.opacity:1)*e}r.prototype=Object.create(i.prototype),r.prototype.getParentStack=function(t){var e=this.parent?this.parent.stack:null;return e?e.ownStacking?e:e.getParentStack(t):t.stack},e.exports=r},{"./nodecontainer":14}],22:[function(t,e,n){function i(t){this.rangeBounds=this.testRangeBounds(t),this.cors=this.testCORS(),this.svg=this.testSVG()}i.prototype.testRangeBounds=function(t){var e,n,i=!1;return t.createRange&&(e=t.createRange()).getBoundingClientRect&&((n=t.createElement("boundtest")).style.height="123px",n.style.display="block",t.body.appendChild(n),e.selectNode(n),123===e.getBoundingClientRect().height&&(i=!0),t.body.removeChild(n)),i},i.prototype.testCORS=function(){return void 0!==(new Image).crossOrigin},i.prototype.testSVG=function(){var t=new Image,e=document.createElement("canvas"),n=e.getContext("2d");t.src="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg'></svg>";try{n.drawImage(t,0,0),e.toDataURL()}catch(t){return!1}return!0},e.exports=i},{}],23:[function(t,e,i){var r=t("./xhr"),o=t("./utils").decode64;function a(t){this.src=t,this.image=null;var e=this;this.promise=this.hasFabric().then((function(){return e.isInline(t)?Promise.resolve(e.inlineFormatting(t)):r(t)})).then((function(t){return new Promise((function(i){n.svg.fabric.loadSVGFromString(t,e.createCanvas.call(e,i))}))}))}a.prototype.hasFabric=function(){return n.svg&&n.svg.fabric?Promise.resolve():Promise.reject(new Error("html2canvas.svg.js is not loaded, cannot render svg"))},a.prototype.inlineFormatting=function(t){return/^data:image\/svg\+xml;base64,/.test(t)?this.decode64(this.removeContentType(t)):this.removeContentType(t)},a.prototype.removeContentType=function(t){return t.replace(/^data:image\/svg\+xml(;base64)?,/,"")},a.prototype.isInline=function(t){return/^data:image\/svg\+xml/i.test(t)},a.prototype.createCanvas=function(t){var e=this;return function(i,r){var o=new n.svg.fabric.StaticCanvas("c");e.image=o.lowerCanvasEl,o.setWidth(r.width).setHeight(r.height).add(n.svg.fabric.util.groupSVGElements(i,r)).renderAll(),t(o.lowerCanvasEl)}},a.prototype.decode64=function(t){return"function"==typeof window.atob?window.atob(t):o(t)},e.exports=a},{"./utils":26,"./xhr":28}],24:[function(t,e,i){var r=t("./svgcontainer");function o(t,e){this.src=t,this.image=null;var i=this;this.promise=e?new Promise((function(e,n){i.image=new Image,i.image.onload=e,i.image.onerror=n,i.image.src="data:image/svg+xml,"+(new XMLSerializer).serializeToString(t),!0===i.image.complete&&e(i.image)})):this.hasFabric().then((function(){return new Promise((function(e){n.svg.fabric.parseSVGDocument(t,i.createCanvas.call(i,e))}))}))}o.prototype=Object.create(r.prototype),e.exports=o},{"./svgcontainer":23}],25:[function(t,e,n){var i=t("./nodecontainer");function r(t,e){i.call(this,t,e)}function o(t,e,n){if(t.length>0)return e+n.toUpperCase()}r.prototype=Object.create(i.prototype),r.prototype.applyTextTransform=function(){this.node.data=this.transform(this.parent.css("textTransform"))},r.prototype.transform=function(t){var e=this.node.data;switch(t){case"lowercase":return e.toLowerCase();case"capitalize":return e.replace(/(^|\s|:|-|\(|\))([a-z])/g,o);case"uppercase":return e.toUpperCase();default:return e}},e.exports=r},{"./nodecontainer":14}],26:[function(t,e,n){n.smallImage=function(){return"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"},n.bind=function(t,e){return function(){return t.apply(e,arguments)}},n.decode64=function(t){var e,n,i,r,o,a,s,c="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",l=t.length,h="";for(e=0;e<l;e+=4)o=c.indexOf(t[e])<<2|(n=c.indexOf(t[e+1]))>>4,a=(15&n)<<4|(i=c.indexOf(t[e+2]))>>2,s=(3&i)<<6|(r=c.indexOf(t[e+3])),h+=64===i?String.fromCharCode(o):64===r||-1===r?String.fromCharCode(o,a):String.fromCharCode(o,a,s);return h},n.getBounds=function(t){if(t.getBoundingClientRect){var e=t.getBoundingClientRect(),n=null==t.offsetWidth?e.width:t.offsetWidth;return{top:e.top,bottom:e.bottom||e.top+e.height,right:e.left+n,left:e.left,width:n,height:null==t.offsetHeight?e.height:t.offsetHeight}}return{}},n.offsetBounds=function(t){var e=t.offsetParent?n.offsetBounds(t.offsetParent):{top:0,left:0};return{top:t.offsetTop+e.top,bottom:t.offsetTop+t.offsetHeight+e.top,right:t.offsetLeft+e.left+t.offsetWidth,left:t.offsetLeft+e.left,width:t.offsetWidth,height:t.offsetHeight}},n.parseBackgrounds=function(t){var e,n,i,r,o,a,s,c=[],l=0,h=0,u=function(){e&&('"'===n.substr(0,1)&&(n=n.substr(1,n.length-2)),n&&s.push(n),"-"===e.substr(0,1)&&(r=e.indexOf("-",1)+1)>0&&(i=e.substr(0,r),e=e.substr(r)),c.push({prefix:i,method:e.toLowerCase(),value:o,args:s,image:null})),s=[],e=i=n=o=""};return s=[],e=i=n=o="",t.split("").forEach((function(t){if(!(0===l&&" \r\n\t".indexOf(t)>-1)){switch(t){case'"':a?a===t&&(a=null):a=t;break;case"(":if(a)break;if(0===l)return l=1,void(o+=t);h++;break;case")":if(a)break;if(1===l){if(0===h)return l=0,o+=t,void u();h--}break;case",":if(a)break;if(0===l)return void u();if(1===l&&0===h&&!e.match(/^url$/i))return s.push(n),n="",void(o+=t)}o+=t,0===l?e+=t:n+=t}})),u(),c}},{}],27:[function(t,e,n){var i=t("./gradientcontainer");function r(t){i.apply(this,arguments),this.type="linear"===t.args[0]?i.TYPES.LINEAR:i.TYPES.RADIAL}r.prototype=Object.create(i.prototype),e.exports=r},{"./gradientcontainer":9}],28:[function(t,e,n){e.exports=function(t){return new Promise((function(e,n){var i=new XMLHttpRequest;i.open("GET",t),i.onload=function(){200===i.status?e(i.responseText):n(new Error(i.statusText))},i.onerror=function(){n(new Error("Network Error"))},i.send()}))}},{}]},{},[4])(4)}).call(this,n(0),n(2))},function(t,e,n){!function(t){"use strict";function e(){}void 0===Number.EPSILON&&(Number.EPSILON=Math.pow(2,-52)),void 0===Math.sign&&(Math.sign=function(t){return t<0?-1:t>0?1:+t}),void 0===Function.prototype.name&&Object.defineProperty(Function.prototype,"name",{get:function(){return this.toString().match(/^\s*function\s*(\S*)\s*\(/)[1]}}),void 0===Object.assign&&(Object.assign=function(t){if(null==t)throw new TypeError("Cannot convert undefined or null to object");for(var e=Object(t),n=1;n<arguments.length;n++){var i=arguments[n];if(null!=i)for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(e[r]=i[r])}return e}),Object.assign(e.prototype,{addEventListener:function(t,e){void 0===this._listeners&&(this._listeners={});var n=this._listeners;void 0===n[t]&&(n[t]=[]),-1===n[t].indexOf(e)&&n[t].push(e)},hasEventListener:function(t,e){if(void 0===this._listeners)return!1;var n=this._listeners;return void 0!==n[t]&&-1!==n[t].indexOf(e)},removeEventListener:function(t,e){if(void 0!==this._listeners){var n=this._listeners[t];if(void 0!==n){var i=n.indexOf(e);-1!==i&&n.splice(i,1)}}},dispatchEvent:function(t){if(void 0!==this._listeners){var e=this._listeners[t.type];if(void 0!==e){t.target=this;var n=[],i=0,r=e.length;for(i=0;i<r;i++)n[i]=e[i];for(i=0;i<r;i++)n[i].call(this,t)}}}});var n,i,r,o,a,s,c={NoBlending:0,NormalBlending:1,AdditiveBlending:2,SubtractiveBlending:3,MultiplyBlending:4,CustomBlending:5},l={UVMapping:300,CubeReflectionMapping:301,CubeRefractionMapping:302,EquirectangularReflectionMapping:303,EquirectangularRefractionMapping:304,SphericalReflectionMapping:305,CubeUVReflectionMapping:306,CubeUVRefractionMapping:307},h={RepeatWrapping:1e3,ClampToEdgeWrapping:1001,MirroredRepeatWrapping:1002},u={NearestFilter:1003,NearestMipMapNearestFilter:1004,NearestMipMapLinearFilter:1005,LinearFilter:1006,LinearMipMapNearestFilter:1007,LinearMipMapLinearFilter:1008};function d(t,e){this.x=t||0,this.y=e||0}function p(e,n,i,r,o,a,s,c,l,h){Object.defineProperty(this,"id",{value:w()}),this.uuid=t.Math.generateUUID(),this.name="",this.sourceFile="",this.image=void 0!==e?e:p.DEFAULT_IMAGE,this.mipmaps=[],this.mapping=void 0!==n?n:p.DEFAULT_MAPPING,this.wrapS=void 0!==i?i:1001,this.wrapT=void 0!==r?r:1001,this.magFilter=void 0!==o?o:1006,this.minFilter=void 0!==a?a:1008,this.anisotropy=void 0!==l?l:1,this.format=void 0!==s?s:1023,this.type=void 0!==c?c:1009,this.offset=new d(0,0),this.repeat=new d(1,1),this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=void 0!==h?h:3e3,this.version=0,this.onUpdate=null}t.Math={DEG2RAD:Math.PI/180,RAD2DEG:180/Math.PI,generateUUID:(o="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split(""),a=new Array(36),s=0,function(){for(var t=0;t<36;t++)8===t||13===t||18===t||23===t?a[t]="-":14===t?a[t]="4":(s<=2&&(s=33554432+16777216*Math.random()|0),r=15&s,s>>=4,a[t]=o[19===t?3&r|8:r]);return a.join("")}),clamp:function(t,e,n){return Math.max(e,Math.min(n,t))},euclideanModulo:function(t,e){return(t%e+e)%e},mapLinear:function(t,e,n,i,r){return i+(t-e)*(r-i)/(n-e)},smoothstep:function(t,e,n){return t<=e?0:t>=n?1:(t=(t-e)/(n-e))*t*(3-2*t)},smootherstep:function(t,e,n){return t<=e?0:t>=n?1:(t=(t-e)/(n-e))*t*t*(t*(6*t-15)+10)},random16:function(){return console.warn("THREE.Math.random16() has been deprecated. Use Math.random() instead."),Math.random()},randInt:function(t,e){return t+Math.floor(Math.random()*(e-t+1))},randFloat:function(t,e){return t+Math.random()*(e-t)},randFloatSpread:function(t){return t*(.5-Math.random())},degToRad:function(e){return e*t.Math.DEG2RAD},radToDeg:function(e){return e*t.Math.RAD2DEG},isPowerOfTwo:function(t){return 0==(t&t-1)&&0!==t},nearestPowerOfTwo:function(t){return Math.pow(2,Math.round(Math.log(t)/Math.LN2))},nextPowerOfTwo:function(t){return t--,t|=t>>1,t|=t>>2,t|=t>>4,t|=t>>8,t|=t>>16,++t}},d.prototype={constructor:d,isVector2:!0,get width(){return this.x},set width(t){this.x=t},get height(){return this.y},set height(t){this.y=t},set:function(t,e){return this.x=t,this.y=e,this},setScalar:function(t){return this.x=t,this.y=t,this},setX:function(t){return this.x=t,this},setY:function(t){return this.y=t,this},setComponent:function(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;default:throw new Error("index is out of range: "+t)}},getComponent:function(t){switch(t){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+t)}},clone:function(){return new this.constructor(this.x,this.y)},copy:function(t){return this.x=t.x,this.y=t.y,this},add:function(t,e){return void 0!==e?(console.warn("THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,e)):(this.x+=t.x,this.y+=t.y,this)},addScalar:function(t){return this.x+=t,this.y+=t,this},addVectors:function(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this},addScaledVector:function(t,e){return this.x+=t.x*e,this.y+=t.y*e,this},sub:function(t,e){return void 0!==e?(console.warn("THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,e)):(this.x-=t.x,this.y-=t.y,this)},subScalar:function(t){return this.x-=t,this.y-=t,this},subVectors:function(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this},multiply:function(t){return this.x*=t.x,this.y*=t.y,this},multiplyScalar:function(t){return isFinite(t)?(this.x*=t,this.y*=t):(this.x=0,this.y=0),this},divide:function(t){return this.x/=t.x,this.y/=t.y,this},divideScalar:function(t){return this.multiplyScalar(1/t)},min:function(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this},max:function(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this},clamp:function(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this},clampScalar:function(t,e){return void 0===n&&(n=new d,i=new d),n.set(t,t),i.set(e,e),this.clamp(n,i)},clampLength:function(t,e){var n=this.length();return this.multiplyScalar(Math.max(t,Math.min(e,n))/n)},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this},negate:function(){return this.x=-this.x,this.y=-this.y,this},dot:function(t){return this.x*t.x+this.y*t.y},lengthSq:function(){return this.x*this.x+this.y*this.y},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},lengthManhattan:function(){return Math.abs(this.x)+Math.abs(this.y)},normalize:function(){return this.divideScalar(this.length())},angle:function(){var t=Math.atan2(this.y,this.x);return t<0&&(t+=2*Math.PI),t},distanceTo:function(t){return Math.sqrt(this.distanceToSquared(t))},distanceToSquared:function(t){var e=this.x-t.x,n=this.y-t.y;return e*e+n*n},distanceToManhattan:function(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)},setLength:function(t){return this.multiplyScalar(t/this.length())},lerp:function(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this},lerpVectors:function(t,e,n){return this.subVectors(e,t).multiplyScalar(n).add(t)},equals:function(t){return t.x===this.x&&t.y===this.y},fromArray:function(t,e){return void 0===e&&(e=0),this.x=t[e],this.y=t[e+1],this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this.x,t[e+1]=this.y,t},fromAttribute:function(t,e,n){return void 0===n&&(n=0),e=e*t.itemSize+n,this.x=t.array[e],this.y=t.array[e+1],this},rotateAround:function(t,e){var n=Math.cos(e),i=Math.sin(e),r=this.x-t.x,o=this.y-t.y;return this.x=r*n-o*i+t.x,this.y=r*i+o*n+t.y,this}},p.DEFAULT_IMAGE=void 0,p.DEFAULT_MAPPING=300,p.prototype={constructor:p,isTexture:!0,set needsUpdate(t){!0===t&&this.version++},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.image=t.image,this.mipmaps=t.mipmaps.slice(0),this.mapping=t.mapping,this.wrapS=t.wrapS,this.wrapT=t.wrapT,this.magFilter=t.magFilter,this.minFilter=t.minFilter,this.anisotropy=t.anisotropy,this.format=t.format,this.type=t.type,this.offset.copy(t.offset),this.repeat.copy(t.repeat),this.generateMipmaps=t.generateMipmaps,this.premultiplyAlpha=t.premultiplyAlpha,this.flipY=t.flipY,this.unpackAlignment=t.unpackAlignment,this.encoding=t.encoding,this},toJSON:function(e){if(void 0!==e.textures[this.uuid])return e.textures[this.uuid];var n={metadata:{version:4.4,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],wrap:[this.wrapS,this.wrapT],minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY};if(void 0!==this.image){var i=this.image;void 0===i.uuid&&(i.uuid=t.Math.generateUUID()),void 0===e.images[i.uuid]&&(e.images[i.uuid]={uuid:i.uuid,url:function(t){var e;return void 0!==t.toDataURL?e=t:((e=document.createElementNS("http://www.w3.org/1999/xhtml","canvas")).width=t.width,e.height=t.height,e.getContext("2d").drawImage(t,0,0,t.width,t.height)),e.width>2048||e.height>2048?e.toDataURL("image/jpeg",.6):e.toDataURL("image/png")}(i)}),n.image=i.uuid}return e.textures[this.uuid]=n,n},dispose:function(){this.dispatchEvent({type:"dispose"})},transformUv:function(t){if(300===this.mapping){if(t.multiply(this.repeat),t.add(this.offset),t.x<0||t.x>1)switch(this.wrapS){case 1e3:t.x=t.x-Math.floor(t.x);break;case 1001:t.x=t.x<0?0:1;break;case 1002:1===Math.abs(Math.floor(t.x)%2)?t.x=Math.ceil(t.x)-t.x:t.x=t.x-Math.floor(t.x)}if(t.y<0||t.y>1)switch(this.wrapT){case 1e3:t.y=t.y-Math.floor(t.y);break;case 1001:t.y=t.y<0?0:1;break;case 1002:1===Math.abs(Math.floor(t.y)%2)?t.y=Math.ceil(t.y)-t.y:t.y=t.y-Math.floor(t.y)}this.flipY&&(t.y=1-t.y)}}},Object.assign(p.prototype,e.prototype);var f,m,g,v,y,b,x=0;function w(){return x++}function _(t,e,n,i){this.x=t||0,this.y=e||0,this.z=n||0,this.w=void 0!==i?i:1}function S(e,n,i){this.uuid=t.Math.generateUUID(),this.width=e,this.height=n,this.scissor=new _(0,0,e,n),this.scissorTest=!1,this.viewport=new _(0,0,e,n),void 0===(i=i||{}).minFilter&&(i.minFilter=1006),this.texture=new p(void 0,void 0,i.wrapS,i.wrapT,i.magFilter,i.minFilter,i.format,i.type,i.anisotropy,i.encoding),this.depthBuffer=void 0===i.depthBuffer||i.depthBuffer,this.stencilBuffer=void 0===i.stencilBuffer||i.stencilBuffer,this.depthTexture=void 0!==i.depthTexture?i.depthTexture:null}function E(t,e,n){S.call(this,t,e,n),this.activeCubeFace=0,this.activeMipMapLevel=0}function A(t,e,n,i){this._x=t||0,this._y=e||0,this._z=n||0,this._w=void 0!==i?i:1}function T(t,e,n){this.x=t||0,this.y=e||0,this.z=n||0}function M(){this.elements=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),arguments.length>0&&console.error("THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.")}function C(t,e,n,i,r,o,a,s,c,l){t=void 0!==t?t:[],e=void 0!==e?e:301,p.call(this,t,e,n,i,r,o,a,s,c,l),this.flipY=!1}_.prototype={constructor:_,isVector4:!0,set:function(t,e,n,i){return this.x=t,this.y=e,this.z=n,this.w=i,this},setScalar:function(t){return this.x=t,this.y=t,this.z=t,this.w=t,this},setX:function(t){return this.x=t,this},setY:function(t){return this.y=t,this},setZ:function(t){return this.z=t,this},setW:function(t){return this.w=t,this},setComponent:function(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;case 2:this.z=e;break;case 3:this.w=e;break;default:throw new Error("index is out of range: "+t)}},getComponent:function(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+t)}},clone:function(){return new this.constructor(this.x,this.y,this.z,this.w)},copy:function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this.w=void 0!==t.w?t.w:1,this},add:function(t,e){return void 0!==e?(console.warn("THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,e)):(this.x+=t.x,this.y+=t.y,this.z+=t.z,this.w+=t.w,this)},addScalar:function(t){return this.x+=t,this.y+=t,this.z+=t,this.w+=t,this},addVectors:function(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this.z=t.z+e.z,this.w=t.w+e.w,this},addScaledVector:function(t,e){return this.x+=t.x*e,this.y+=t.y*e,this.z+=t.z*e,this.w+=t.w*e,this},sub:function(t,e){return void 0!==e?(console.warn("THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,e)):(this.x-=t.x,this.y-=t.y,this.z-=t.z,this.w-=t.w,this)},subScalar:function(t){return this.x-=t,this.y-=t,this.z-=t,this.w-=t,this},subVectors:function(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this.z=t.z-e.z,this.w=t.w-e.w,this},multiplyScalar:function(t){return isFinite(t)?(this.x*=t,this.y*=t,this.z*=t,this.w*=t):(this.x=0,this.y=0,this.z=0,this.w=0),this},applyMatrix4:function(t){var e=this.x,n=this.y,i=this.z,r=this.w,o=t.elements;return this.x=o[0]*e+o[4]*n+o[8]*i+o[12]*r,this.y=o[1]*e+o[5]*n+o[9]*i+o[13]*r,this.z=o[2]*e+o[6]*n+o[10]*i+o[14]*r,this.w=o[3]*e+o[7]*n+o[11]*i+o[15]*r,this},divideScalar:function(t){return this.multiplyScalar(1/t)},setAxisAngleFromQuaternion:function(t){this.w=2*Math.acos(t.w);var e=Math.sqrt(1-t.w*t.w);return e<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=t.x/e,this.y=t.y/e,this.z=t.z/e),this},setAxisAngleFromRotationMatrix:function(t){var e,n,i,r,o=t.elements,a=o[0],s=o[4],c=o[8],l=o[1],h=o[5],u=o[9],d=o[2],p=o[6],f=o[10];if(Math.abs(s-l)<.01&&Math.abs(c-d)<.01&&Math.abs(u-p)<.01){if(Math.abs(s+l)<.1&&Math.abs(c+d)<.1&&Math.abs(u+p)<.1&&Math.abs(a+h+f-3)<.1)return this.set(1,0,0,0),this;e=Math.PI;var m=(a+1)/2,g=(h+1)/2,v=(f+1)/2,y=(s+l)/4,b=(c+d)/4,x=(u+p)/4;return m>g&&m>v?m<.01?(n=0,i=.707106781,r=.707106781):(i=y/(n=Math.sqrt(m)),r=b/n):g>v?g<.01?(n=.707106781,i=0,r=.707106781):(n=y/(i=Math.sqrt(g)),r=x/i):v<.01?(n=.707106781,i=.707106781,r=0):(n=b/(r=Math.sqrt(v)),i=x/r),this.set(n,i,r,e),this}var w=Math.sqrt((p-u)*(p-u)+(c-d)*(c-d)+(l-s)*(l-s));return Math.abs(w)<.001&&(w=1),this.x=(p-u)/w,this.y=(c-d)/w,this.z=(l-s)/w,this.w=Math.acos((a+h+f-1)/2),this},min:function(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this.w=Math.min(this.w,t.w),this},max:function(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this.w=Math.max(this.w,t.w),this},clamp:function(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this.z=Math.max(t.z,Math.min(e.z,this.z)),this.w=Math.max(t.w,Math.min(e.w,this.w)),this},clampScalar:function(){var t,e;return function(n,i){return void 0===t&&(t=new _,e=new _),t.set(n,n,n,n),e.set(i,i,i,i),this.clamp(t,e)}}(),floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this},dot:function(t){return this.x*t.x+this.y*t.y+this.z*t.z+this.w*t.w},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},lengthManhattan:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)},normalize:function(){return this.divideScalar(this.length())},setLength:function(t){return this.multiplyScalar(t/this.length())},lerp:function(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this.z+=(t.z-this.z)*e,this.w+=(t.w-this.w)*e,this},lerpVectors:function(t,e,n){return this.subVectors(e,t).multiplyScalar(n).add(t)},equals:function(t){return t.x===this.x&&t.y===this.y&&t.z===this.z&&t.w===this.w},fromArray:function(t,e){return void 0===e&&(e=0),this.x=t[e],this.y=t[e+1],this.z=t[e+2],this.w=t[e+3],this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this.x,t[e+1]=this.y,t[e+2]=this.z,t[e+3]=this.w,t},fromAttribute:function(t,e,n){return void 0===n&&(n=0),e=e*t.itemSize+n,this.x=t.array[e],this.y=t.array[e+1],this.z=t.array[e+2],this.w=t.array[e+3],this}},Object.assign(S.prototype,e.prototype,{isWebGLRenderTarget:!0,setSize:function(t,e){this.width===t&&this.height===e||(this.width=t,this.height=e,this.dispose()),this.viewport.set(0,0,t,e),this.scissor.set(0,0,t,e)},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.width=t.width,this.height=t.height,this.viewport.copy(t.viewport),this.texture=t.texture.clone(),this.depthBuffer=t.depthBuffer,this.stencilBuffer=t.stencilBuffer,this.depthTexture=t.depthTexture,this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),E.prototype=Object.create(S.prototype),E.prototype.constructor=E,E.prototype.isWebGLRenderTargetCube=!0,A.prototype={constructor:A,get x(){return this._x},set x(t){this._x=t,this.onChangeCallback()},get y(){return this._y},set y(t){this._y=t,this.onChangeCallback()},get z(){return this._z},set z(t){this._z=t,this.onChangeCallback()},get w(){return this._w},set w(t){this._w=t,this.onChangeCallback()},set:function(t,e,n,i){return this._x=t,this._y=e,this._z=n,this._w=i,this.onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._w)},copy:function(t){return this._x=t.x,this._y=t.y,this._z=t.z,this._w=t.w,this.onChangeCallback(),this},setFromEuler:function(t,e){if(!1===(t&&t.isEuler))throw new Error("THREE.Quaternion: .setFromEuler() now expects a Euler rotation rather than a Vector3 and order.");var n=Math.cos(t._x/2),i=Math.cos(t._y/2),r=Math.cos(t._z/2),o=Math.sin(t._x/2),a=Math.sin(t._y/2),s=Math.sin(t._z/2),c=t.order;return"XYZ"===c?(this._x=o*i*r+n*a*s,this._y=n*a*r-o*i*s,this._z=n*i*s+o*a*r,this._w=n*i*r-o*a*s):"YXZ"===c?(this._x=o*i*r+n*a*s,this._y=n*a*r-o*i*s,this._z=n*i*s-o*a*r,this._w=n*i*r+o*a*s):"ZXY"===c?(this._x=o*i*r-n*a*s,this._y=n*a*r+o*i*s,this._z=n*i*s+o*a*r,this._w=n*i*r-o*a*s):"ZYX"===c?(this._x=o*i*r-n*a*s,this._y=n*a*r+o*i*s,this._z=n*i*s-o*a*r,this._w=n*i*r+o*a*s):"YZX"===c?(this._x=o*i*r+n*a*s,this._y=n*a*r+o*i*s,this._z=n*i*s-o*a*r,this._w=n*i*r-o*a*s):"XZY"===c&&(this._x=o*i*r-n*a*s,this._y=n*a*r-o*i*s,this._z=n*i*s+o*a*r,this._w=n*i*r+o*a*s),!1!==e&&this.onChangeCallback(),this},setFromAxisAngle:function(t,e){var n=e/2,i=Math.sin(n);return this._x=t.x*i,this._y=t.y*i,this._z=t.z*i,this._w=Math.cos(n),this.onChangeCallback(),this},setFromRotationMatrix:function(t){var e,n=t.elements,i=n[0],r=n[4],o=n[8],a=n[1],s=n[5],c=n[9],l=n[2],h=n[6],u=n[10],d=i+s+u;return d>0?(e=.5/Math.sqrt(d+1),this._w=.25/e,this._x=(h-c)*e,this._y=(o-l)*e,this._z=(a-r)*e):i>s&&i>u?(e=2*Math.sqrt(1+i-s-u),this._w=(h-c)/e,this._x=.25*e,this._y=(r+a)/e,this._z=(o+l)/e):s>u?(e=2*Math.sqrt(1+s-i-u),this._w=(o-l)/e,this._x=(r+a)/e,this._y=.25*e,this._z=(c+h)/e):(e=2*Math.sqrt(1+u-i-s),this._w=(a-r)/e,this._x=(o+l)/e,this._y=(c+h)/e,this._z=.25*e),this.onChangeCallback(),this},setFromUnitVectors:function(){var t,e;return function(n,i){return void 0===t&&(t=new T),(e=n.dot(i)+1)<1e-6?(e=0,Math.abs(n.x)>Math.abs(n.z)?t.set(-n.y,n.x,0):t.set(0,-n.z,n.y)):t.crossVectors(n,i),this._x=t.x,this._y=t.y,this._z=t.z,this._w=e,this.normalize()}}(),inverse:function(){return this.conjugate().normalize()},conjugate:function(){return this._x*=-1,this._y*=-1,this._z*=-1,this.onChangeCallback(),this},dot:function(t){return this._x*t._x+this._y*t._y+this._z*t._z+this._w*t._w},lengthSq:function(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w},length:function(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)},normalize:function(){var t=this.length();return 0===t?(this._x=0,this._y=0,this._z=0,this._w=1):(t=1/t,this._x=this._x*t,this._y=this._y*t,this._z=this._z*t,this._w=this._w*t),this.onChangeCallback(),this},multiply:function(t,e){return void 0!==e?(console.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(t,e)):this.multiplyQuaternions(this,t)},premultiply:function(t){return this.multiplyQuaternions(t,this)},multiplyQuaternions:function(t,e){var n=t._x,i=t._y,r=t._z,o=t._w,a=e._x,s=e._y,c=e._z,l=e._w;return this._x=n*l+o*a+i*c-r*s,this._y=i*l+o*s+r*a-n*c,this._z=r*l+o*c+n*s-i*a,this._w=o*l-n*a-i*s-r*c,this.onChangeCallback(),this},slerp:function(t,e){if(0===e)return this;if(1===e)return this.copy(t);var n=this._x,i=this._y,r=this._z,o=this._w,a=o*t._w+n*t._x+i*t._y+r*t._z;if(a<0?(this._w=-t._w,this._x=-t._x,this._y=-t._y,this._z=-t._z,a=-a):this.copy(t),a>=1)return this._w=o,this._x=n,this._y=i,this._z=r,this;var s=Math.sqrt(1-a*a);if(Math.abs(s)<.001)return this._w=.5*(o+this._w),this._x=.5*(n+this._x),this._y=.5*(i+this._y),this._z=.5*(r+this._z),this;var c=Math.atan2(s,a),l=Math.sin((1-e)*c)/s,h=Math.sin(e*c)/s;return this._w=o*l+this._w*h,this._x=n*l+this._x*h,this._y=i*l+this._y*h,this._z=r*l+this._z*h,this.onChangeCallback(),this},equals:function(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._w===this._w},fromArray:function(t,e){return void 0===e&&(e=0),this._x=t[e],this._y=t[e+1],this._z=t[e+2],this._w=t[e+3],this.onChangeCallback(),this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this._x,t[e+1]=this._y,t[e+2]=this._z,t[e+3]=this._w,t},onChange:function(t){return this.onChangeCallback=t,this},onChangeCallback:function(){}},Object.assign(A,{slerp:function(t,e,n,i){return n.copy(t).slerp(e,i)},slerpFlat:function(t,e,n,i,r,o,a){var s=n[i+0],c=n[i+1],l=n[i+2],h=n[i+3],u=r[o+0],d=r[o+1],p=r[o+2],f=r[o+3];if(h!==f||s!==u||c!==d||l!==p){var m=1-a,g=s*u+c*d+l*p+h*f,v=g>=0?1:-1,y=1-g*g;if(y>Number.EPSILON){var b=Math.sqrt(y),x=Math.atan2(b,g*v);m=Math.sin(m*x)/b,a=Math.sin(a*x)/b}var w=a*v;if(s=s*m+u*w,c=c*m+d*w,l=l*m+p*w,h=h*m+f*w,m===1-a){var _=1/Math.sqrt(s*s+c*c+l*l+h*h);s*=_,c*=_,l*=_,h*=_}}t[e]=s,t[e+1]=c,t[e+2]=l,t[e+3]=h}}),T.prototype={constructor:T,isVector3:!0,set:function(t,e,n){return this.x=t,this.y=e,this.z=n,this},setScalar:function(t){return this.x=t,this.y=t,this.z=t,this},setX:function(t){return this.x=t,this},setY:function(t){return this.y=t,this},setZ:function(t){return this.z=t,this},setComponent:function(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;case 2:this.z=e;break;default:throw new Error("index is out of range: "+t)}},getComponent:function(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+t)}},clone:function(){return new this.constructor(this.x,this.y,this.z)},copy:function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this},add:function(t,e){return void 0!==e?(console.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,e)):(this.x+=t.x,this.y+=t.y,this.z+=t.z,this)},addScalar:function(t){return this.x+=t,this.y+=t,this.z+=t,this},addVectors:function(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this.z=t.z+e.z,this},addScaledVector:function(t,e){return this.x+=t.x*e,this.y+=t.y*e,this.z+=t.z*e,this},sub:function(t,e){return void 0!==e?(console.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,e)):(this.x-=t.x,this.y-=t.y,this.z-=t.z,this)},subScalar:function(t){return this.x-=t,this.y-=t,this.z-=t,this},subVectors:function(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this.z=t.z-e.z,this},multiply:function(t,e){return void 0!==e?(console.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(t,e)):(this.x*=t.x,this.y*=t.y,this.z*=t.z,this)},multiplyScalar:function(t){return isFinite(t)?(this.x*=t,this.y*=t,this.z*=t):(this.x=0,this.y=0,this.z=0),this},multiplyVectors:function(t,e){return this.x=t.x*e.x,this.y=t.y*e.y,this.z=t.z*e.z,this},applyEuler:function(t){return!1===(t&&t.isEuler)&&console.error("THREE.Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order."),void 0===b&&(b=new A),this.applyQuaternion(b.setFromEuler(t))},applyAxisAngle:function(){var t;return function(e,n){return void 0===t&&(t=new A),this.applyQuaternion(t.setFromAxisAngle(e,n))}}(),applyMatrix3:function(t){var e=this.x,n=this.y,i=this.z,r=t.elements;return this.x=r[0]*e+r[3]*n+r[6]*i,this.y=r[1]*e+r[4]*n+r[7]*i,this.z=r[2]*e+r[5]*n+r[8]*i,this},applyMatrix4:function(t){var e=this.x,n=this.y,i=this.z,r=t.elements;return this.x=r[0]*e+r[4]*n+r[8]*i+r[12],this.y=r[1]*e+r[5]*n+r[9]*i+r[13],this.z=r[2]*e+r[6]*n+r[10]*i+r[14],this},applyProjection:function(t){var e=this.x,n=this.y,i=this.z,r=t.elements,o=1/(r[3]*e+r[7]*n+r[11]*i+r[15]);return this.x=(r[0]*e+r[4]*n+r[8]*i+r[12])*o,this.y=(r[1]*e+r[5]*n+r[9]*i+r[13])*o,this.z=(r[2]*e+r[6]*n+r[10]*i+r[14])*o,this},applyQuaternion:function(t){var e=this.x,n=this.y,i=this.z,r=t.x,o=t.y,a=t.z,s=t.w,c=s*e+o*i-a*n,l=s*n+a*e-r*i,h=s*i+r*n-o*e,u=-r*e-o*n-a*i;return this.x=c*s+u*-r+l*-a-h*-o,this.y=l*s+u*-o+h*-r-c*-a,this.z=h*s+u*-a+c*-o-l*-r,this},project:function(t){return void 0===y&&(y=new M),y.multiplyMatrices(t.projectionMatrix,y.getInverse(t.matrixWorld)),this.applyProjection(y)},unproject:function(){var t;return function(e){return void 0===t&&(t=new M),t.multiplyMatrices(e.matrixWorld,t.getInverse(e.projectionMatrix)),this.applyProjection(t)}}(),transformDirection:function(t){var e=this.x,n=this.y,i=this.z,r=t.elements;return this.x=r[0]*e+r[4]*n+r[8]*i,this.y=r[1]*e+r[5]*n+r[9]*i,this.z=r[2]*e+r[6]*n+r[10]*i,this.normalize()},divide:function(t){return this.x/=t.x,this.y/=t.y,this.z/=t.z,this},divideScalar:function(t){return this.multiplyScalar(1/t)},min:function(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this},max:function(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this},clamp:function(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this.z=Math.max(t.z,Math.min(e.z,this.z)),this},clampScalar:function(){var t,e;return function(n,i){return void 0===t&&(t=new T,e=new T),t.set(n,n,n),e.set(i,i,i),this.clamp(t,e)}}(),clampLength:function(t,e){var n=this.length();return this.multiplyScalar(Math.max(t,Math.min(e,n))/n)},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},dot:function(t){return this.x*t.x+this.y*t.y+this.z*t.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},lengthManhattan:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},normalize:function(){return this.divideScalar(this.length())},setLength:function(t){return this.multiplyScalar(t/this.length())},lerp:function(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this.z+=(t.z-this.z)*e,this},lerpVectors:function(t,e,n){return this.subVectors(e,t).multiplyScalar(n).add(t)},cross:function(t,e){if(void 0!==e)return console.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(t,e);var n=this.x,i=this.y,r=this.z;return this.x=i*t.z-r*t.y,this.y=r*t.x-n*t.z,this.z=n*t.y-i*t.x,this},crossVectors:function(t,e){var n=t.x,i=t.y,r=t.z,o=e.x,a=e.y,s=e.z;return this.x=i*s-r*a,this.y=r*o-n*s,this.z=n*a-i*o,this},projectOnVector:function(t){var e=t.dot(this)/t.lengthSq();return this.copy(t).multiplyScalar(e)},projectOnPlane:function(t){return void 0===v&&(v=new T),v.copy(this).projectOnVector(t),this.sub(v)},reflect:function(){var t;return function(e){return void 0===t&&(t=new T),this.sub(t.copy(e).multiplyScalar(2*this.dot(e)))}}(),angleTo:function(e){var n=this.dot(e)/Math.sqrt(this.lengthSq()*e.lengthSq());return Math.acos(t.Math.clamp(n,-1,1))},distanceTo:function(t){return Math.sqrt(this.distanceToSquared(t))},distanceToSquared:function(t){var e=this.x-t.x,n=this.y-t.y,i=this.z-t.z;return e*e+n*n+i*i},distanceToManhattan:function(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)+Math.abs(this.z-t.z)},setFromSpherical:function(t){var e=Math.sin(t.phi)*t.radius;return this.x=e*Math.sin(t.theta),this.y=Math.cos(t.phi)*t.radius,this.z=e*Math.cos(t.theta),this},setFromMatrixPosition:function(t){return this.setFromMatrixColumn(t,3)},setFromMatrixScale:function(t){var e=this.setFromMatrixColumn(t,0).length(),n=this.setFromMatrixColumn(t,1).length(),i=this.setFromMatrixColumn(t,2).length();return this.x=e,this.y=n,this.z=i,this},setFromMatrixColumn:function(t,e){if("number"==typeof t){console.warn("THREE.Vector3: setFromMatrixColumn now expects ( matrix, index ).");var n=t;t=e,e=n}return this.fromArray(t.elements,4*e)},equals:function(t){return t.x===this.x&&t.y===this.y&&t.z===this.z},fromArray:function(t,e){return void 0===e&&(e=0),this.x=t[e],this.y=t[e+1],this.z=t[e+2],this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this.x,t[e+1]=this.y,t[e+2]=this.z,t},fromAttribute:function(t,e,n){return void 0===n&&(n=0),e=e*t.itemSize+n,this.x=t.array[e],this.y=t.array[e+1],this.z=t.array[e+2],this}},M.prototype={constructor:M,isMatrix4:!0,set:function(t,e,n,i,r,o,a,s,c,l,h,u,d,p,f,m){var g=this.elements;return g[0]=t,g[4]=e,g[8]=n,g[12]=i,g[1]=r,g[5]=o,g[9]=a,g[13]=s,g[2]=c,g[6]=l,g[10]=h,g[14]=u,g[3]=d,g[7]=p,g[11]=f,g[15]=m,this},identity:function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this},clone:function(){return(new M).fromArray(this.elements)},copy:function(t){return this.elements.set(t.elements),this},copyPosition:function(t){var e=this.elements,n=t.elements;return e[12]=n[12],e[13]=n[13],e[14]=n[14],this},extractBasis:function(t,e,n){return t.setFromMatrixColumn(this,0),e.setFromMatrixColumn(this,1),n.setFromMatrixColumn(this,2),this},makeBasis:function(t,e,n){return this.set(t.x,e.x,n.x,0,t.y,e.y,n.y,0,t.z,e.z,n.z,0,0,0,0,1),this},extractRotation:function(){var t;return function(e){void 0===t&&(t=new T);var n=this.elements,i=e.elements,r=1/t.setFromMatrixColumn(e,0).length(),o=1/t.setFromMatrixColumn(e,1).length(),a=1/t.setFromMatrixColumn(e,2).length();return n[0]=i[0]*r,n[1]=i[1]*r,n[2]=i[2]*r,n[4]=i[4]*o,n[5]=i[5]*o,n[6]=i[6]*o,n[8]=i[8]*a,n[9]=i[9]*a,n[10]=i[10]*a,this}}(),makeRotationFromEuler:function(t){!1===(t&&t.isEuler)&&console.error("THREE.Matrix: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.");var e=this.elements,n=t.x,i=t.y,r=t.z,o=Math.cos(n),a=Math.sin(n),s=Math.cos(i),c=Math.sin(i),l=Math.cos(r),h=Math.sin(r);if("XYZ"===t.order){var u=o*l,d=o*h,p=a*l,f=a*h;e[0]=s*l,e[4]=-s*h,e[8]=c,e[1]=d+p*c,e[5]=u-f*c,e[9]=-a*s,e[2]=f-u*c,e[6]=p+d*c,e[10]=o*s}else if("YXZ"===t.order){var m=s*l,g=s*h,v=c*l,y=c*h;e[0]=m+y*a,e[4]=v*a-g,e[8]=o*c,e[1]=o*h,e[5]=o*l,e[9]=-a,e[2]=g*a-v,e[6]=y+m*a,e[10]=o*s}else if("ZXY"===t.order)m=s*l,g=s*h,v=c*l,y=c*h,e[0]=m-y*a,e[4]=-o*h,e[8]=v+g*a,e[1]=g+v*a,e[5]=o*l,e[9]=y-m*a,e[2]=-o*c,e[6]=a,e[10]=o*s;else if("ZYX"===t.order)u=o*l,d=o*h,p=a*l,f=a*h,e[0]=s*l,e[4]=p*c-d,e[8]=u*c+f,e[1]=s*h,e[5]=f*c+u,e[9]=d*c-p,e[2]=-c,e[6]=a*s,e[10]=o*s;else if("YZX"===t.order){var b=o*s,x=o*c,w=a*s,_=a*c;e[0]=s*l,e[4]=_-b*h,e[8]=w*h+x,e[1]=h,e[5]=o*l,e[9]=-a*l,e[2]=-c*l,e[6]=x*h+w,e[10]=b-_*h}else"XZY"===t.order&&(b=o*s,x=o*c,w=a*s,_=a*c,e[0]=s*l,e[4]=-h,e[8]=c*l,e[1]=b*h+_,e[5]=o*l,e[9]=x*h-w,e[2]=w*h-x,e[6]=a*l,e[10]=_*h+b);return e[3]=0,e[7]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,this},makeRotationFromQuaternion:function(t){var e=this.elements,n=t.x,i=t.y,r=t.z,o=t.w,a=n+n,s=i+i,c=r+r,l=n*a,h=n*s,u=n*c,d=i*s,p=i*c,f=r*c,m=o*a,g=o*s,v=o*c;return e[0]=1-(d+f),e[4]=h-v,e[8]=u+g,e[1]=h+v,e[5]=1-(l+f),e[9]=p-m,e[2]=u-g,e[6]=p+m,e[10]=1-(l+d),e[3]=0,e[7]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,this},lookAt:function(t,e,n){void 0===f&&(f=new T,m=new T,g=new T);var i=this.elements;return g.subVectors(t,e).normalize(),0===g.lengthSq()&&(g.z=1),f.crossVectors(n,g).normalize(),0===f.lengthSq()&&(g.z+=1e-4,f.crossVectors(n,g).normalize()),m.crossVectors(g,f),i[0]=f.x,i[4]=m.x,i[8]=g.x,i[1]=f.y,i[5]=m.y,i[9]=g.y,i[2]=f.z,i[6]=m.z,i[10]=g.z,this},multiply:function(t,e){return void 0!==e?(console.warn("THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(t,e)):this.multiplyMatrices(this,t)},premultiply:function(t){return this.multiplyMatrices(t,this)},multiplyMatrices:function(t,e){var n=t.elements,i=e.elements,r=this.elements,o=n[0],a=n[4],s=n[8],c=n[12],l=n[1],h=n[5],u=n[9],d=n[13],p=n[2],f=n[6],m=n[10],g=n[14],v=n[3],y=n[7],b=n[11],x=n[15],w=i[0],_=i[4],S=i[8],E=i[12],A=i[1],T=i[5],M=i[9],C=i[13],P=i[2],R=i[6],L=i[10],k=i[14],I=i[3],D=i[7],O=i[11],F=i[15];return r[0]=o*w+a*A+s*P+c*I,r[4]=o*_+a*T+s*R+c*D,r[8]=o*S+a*M+s*L+c*O,r[12]=o*E+a*C+s*k+c*F,r[1]=l*w+h*A+u*P+d*I,r[5]=l*_+h*T+u*R+d*D,r[9]=l*S+h*M+u*L+d*O,r[13]=l*E+h*C+u*k+d*F,r[2]=p*w+f*A+m*P+g*I,r[6]=p*_+f*T+m*R+g*D,r[10]=p*S+f*M+m*L+g*O,r[14]=p*E+f*C+m*k+g*F,r[3]=v*w+y*A+b*P+x*I,r[7]=v*_+y*T+b*R+x*D,r[11]=v*S+y*M+b*L+x*O,r[15]=v*E+y*C+b*k+x*F,this},multiplyToArray:function(t,e,n){var i=this.elements;return this.multiplyMatrices(t,e),n[0]=i[0],n[1]=i[1],n[2]=i[2],n[3]=i[3],n[4]=i[4],n[5]=i[5],n[6]=i[6],n[7]=i[7],n[8]=i[8],n[9]=i[9],n[10]=i[10],n[11]=i[11],n[12]=i[12],n[13]=i[13],n[14]=i[14],n[15]=i[15],this},multiplyScalar:function(t){var e=this.elements;return e[0]*=t,e[4]*=t,e[8]*=t,e[12]*=t,e[1]*=t,e[5]*=t,e[9]*=t,e[13]*=t,e[2]*=t,e[6]*=t,e[10]*=t,e[14]*=t,e[3]*=t,e[7]*=t,e[11]*=t,e[15]*=t,this},applyToVector3Array:function(){var t;return function(e,n,i){void 0===t&&(t=new T),void 0===n&&(n=0),void 0===i&&(i=e.length);for(var r=0,o=n;r<i;r+=3,o+=3)t.fromArray(e,o),t.applyMatrix4(this),t.toArray(e,o);return e}}(),applyToBuffer:function(){var t;return function(e,n,i){void 0===t&&(t=new T),void 0===n&&(n=0),void 0===i&&(i=e.length/e.itemSize);for(var r=0,o=n;r<i;r++,o++)t.x=e.getX(o),t.y=e.getY(o),t.z=e.getZ(o),t.applyMatrix4(this),e.setXYZ(t.x,t.y,t.z);return e}}(),determinant:function(){var t=this.elements,e=t[0],n=t[4],i=t[8],r=t[12],o=t[1],a=t[5],s=t[9],c=t[13],l=t[2],h=t[6],u=t[10],d=t[14];return t[3]*(+r*s*h-i*c*h-r*a*u+n*c*u+i*a*d-n*s*d)+t[7]*(+e*s*d-e*c*u+r*o*u-i*o*d+i*c*l-r*s*l)+t[11]*(+e*c*h-e*a*d-r*o*h+n*o*d+r*a*l-n*c*l)+t[15]*(-i*a*l-e*s*h+e*a*u+i*o*h-n*o*u+n*s*l)},transpose:function(){var t,e=this.elements;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this},flattenToArrayOffset:function(t,e){return console.warn("THREE.Matrix3: .flattenToArrayOffset is deprecated - just use .toArray instead."),this.toArray(t,e)},getPosition:function(){var t;return function(){return void 0===t&&(t=new T),console.warn("THREE.Matrix4: .getPosition() has been removed. Use Vector3.setFromMatrixPosition( matrix ) instead."),t.setFromMatrixColumn(this,3)}}(),setPosition:function(t){var e=this.elements;return e[12]=t.x,e[13]=t.y,e[14]=t.z,this},getInverse:function(t,e){var n=this.elements,i=t.elements,r=i[0],o=i[1],a=i[2],s=i[3],c=i[4],l=i[5],h=i[6],u=i[7],d=i[8],p=i[9],f=i[10],m=i[11],g=i[12],v=i[13],y=i[14],b=i[15],x=p*y*u-v*f*u+v*h*m-l*y*m-p*h*b+l*f*b,w=g*f*u-d*y*u-g*h*m+c*y*m+d*h*b-c*f*b,_=d*v*u-g*p*u+g*l*m-c*v*m-d*l*b+c*p*b,S=g*p*h-d*v*h-g*l*f+c*v*f+d*l*y-c*p*y,E=r*x+o*w+a*_+s*S;if(0===E){var A="THREE.Matrix4.getInverse(): can't invert matrix, determinant is 0";if(!0===e)throw new Error(A);return console.warn(A),this.identity()}var T=1/E;return n[0]=x*T,n[1]=(v*f*s-p*y*s-v*a*m+o*y*m+p*a*b-o*f*b)*T,n[2]=(l*y*s-v*h*s+v*a*u-o*y*u-l*a*b+o*h*b)*T,n[3]=(p*h*s-l*f*s-p*a*u+o*f*u+l*a*m-o*h*m)*T,n[4]=w*T,n[5]=(d*y*s-g*f*s+g*a*m-r*y*m-d*a*b+r*f*b)*T,n[6]=(g*h*s-c*y*s-g*a*u+r*y*u+c*a*b-r*h*b)*T,n[7]=(c*f*s-d*h*s+d*a*u-r*f*u-c*a*m+r*h*m)*T,n[8]=_*T,n[9]=(g*p*s-d*v*s-g*o*m+r*v*m+d*o*b-r*p*b)*T,n[10]=(c*v*s-g*l*s+g*o*u-r*v*u-c*o*b+r*l*b)*T,n[11]=(d*l*s-c*p*s-d*o*u+r*p*u+c*o*m-r*l*m)*T,n[12]=S*T,n[13]=(d*v*a-g*p*a+g*o*f-r*v*f-d*o*y+r*p*y)*T,n[14]=(g*l*a-c*v*a-g*o*h+r*v*h+c*o*y-r*l*y)*T,n[15]=(c*p*a-d*l*a+d*o*h-r*p*h-c*o*f+r*l*f)*T,this},scale:function(t){var e=this.elements,n=t.x,i=t.y,r=t.z;return e[0]*=n,e[4]*=i,e[8]*=r,e[1]*=n,e[5]*=i,e[9]*=r,e[2]*=n,e[6]*=i,e[10]*=r,e[3]*=n,e[7]*=i,e[11]*=r,this},getMaxScaleOnAxis:function(){var t=this.elements,e=t[0]*t[0]+t[1]*t[1]+t[2]*t[2],n=t[4]*t[4]+t[5]*t[5]+t[6]*t[6],i=t[8]*t[8]+t[9]*t[9]+t[10]*t[10];return Math.sqrt(Math.max(e,n,i))},makeTranslation:function(t,e,n){return this.set(1,0,0,t,0,1,0,e,0,0,1,n,0,0,0,1),this},makeRotationX:function(t){var e=Math.cos(t),n=Math.sin(t);return this.set(1,0,0,0,0,e,-n,0,0,n,e,0,0,0,0,1),this},makeRotationY:function(t){var e=Math.cos(t),n=Math.sin(t);return this.set(e,0,n,0,0,1,0,0,-n,0,e,0,0,0,0,1),this},makeRotationZ:function(t){var e=Math.cos(t),n=Math.sin(t);return this.set(e,-n,0,0,n,e,0,0,0,0,1,0,0,0,0,1),this},makeRotationAxis:function(t,e){var n=Math.cos(e),i=Math.sin(e),r=1-n,o=t.x,a=t.y,s=t.z,c=r*o,l=r*a;return this.set(c*o+n,c*a-i*s,c*s+i*a,0,c*a+i*s,l*a+n,l*s-i*o,0,c*s-i*a,l*s+i*o,r*s*s+n,0,0,0,0,1),this},makeScale:function(t,e,n){return this.set(t,0,0,0,0,e,0,0,0,0,n,0,0,0,0,1),this},compose:function(t,e,n){return this.makeRotationFromQuaternion(e),this.scale(n),this.setPosition(t),this},decompose:function(){var t,e;return function(n,i,r){void 0===t&&(t=new T,e=new M);var o=this.elements,a=t.set(o[0],o[1],o[2]).length(),s=t.set(o[4],o[5],o[6]).length(),c=t.set(o[8],o[9],o[10]).length();this.determinant()<0&&(a=-a),n.x=o[12],n.y=o[13],n.z=o[14],e.elements.set(this.elements);var l=1/a,h=1/s,u=1/c;return e.elements[0]*=l,e.elements[1]*=l,e.elements[2]*=l,e.elements[4]*=h,e.elements[5]*=h,e.elements[6]*=h,e.elements[8]*=u,e.elements[9]*=u,e.elements[10]*=u,i.setFromRotationMatrix(e),r.x=a,r.y=s,r.z=c,this}}(),makeFrustum:function(t,e,n,i,r,o){var a=this.elements,s=2*r/(e-t),c=2*r/(i-n),l=(e+t)/(e-t),h=(i+n)/(i-n),u=-(o+r)/(o-r),d=-2*o*r/(o-r);return a[0]=s,a[4]=0,a[8]=l,a[12]=0,a[1]=0,a[5]=c,a[9]=h,a[13]=0,a[2]=0,a[6]=0,a[10]=u,a[14]=d,a[3]=0,a[7]=0,a[11]=-1,a[15]=0,this},makePerspective:function(e,n,i,r){var o=i*Math.tan(t.Math.DEG2RAD*e*.5),a=-o,s=a*n,c=o*n;return this.makeFrustum(s,c,a,o,i,r)},makeOrthographic:function(t,e,n,i,r,o){var a=this.elements,s=1/(e-t),c=1/(n-i),l=1/(o-r),h=(e+t)*s,u=(n+i)*c,d=(o+r)*l;return a[0]=2*s,a[4]=0,a[8]=0,a[12]=-h,a[1]=0,a[5]=2*c,a[9]=0,a[13]=-u,a[2]=0,a[6]=0,a[10]=-2*l,a[14]=-d,a[3]=0,a[7]=0,a[11]=0,a[15]=1,this},equals:function(t){for(var e=this.elements,n=t.elements,i=0;i<16;i++)if(e[i]!==n[i])return!1;return!0},fromArray:function(t,e){void 0===e&&(e=0);for(var n=0;n<16;n++)this.elements[n]=t[n+e];return this},toArray:function(t,e){void 0===t&&(t=[]),void 0===e&&(e=0);var n=this.elements;return t[e]=n[0],t[e+1]=n[1],t[e+2]=n[2],t[e+3]=n[3],t[e+4]=n[4],t[e+5]=n[5],t[e+6]=n[6],t[e+7]=n[7],t[e+8]=n[8],t[e+9]=n[9],t[e+10]=n[10],t[e+11]=n[11],t[e+12]=n[12],t[e+13]=n[13],t[e+14]=n[14],t[e+15]=n[15],t}},C.prototype=Object.create(p.prototype),C.prototype.constructor=C,C.prototype.isCubeTexture=!0,Object.defineProperty(C.prototype,"images",{get:function(){return this.image},set:function(t){this.image=t}});var P=new p,R=new C;function L(){this.seq=[],this.map={}}var k=[],I=[];function D(t,e,n){var i=t[0];if(i<=0||i>0)return t;var r=e*n,o=k[r];if(void 0===o&&(o=new Float32Array(r),k[r]=o),0!==e){i.toArray(o,0);for(var a=1,s=0;a!==e;++a)s+=n,t[a].toArray(o,s)}return o}function O(t,e){var n=I[e];void 0===n&&(n=new Int32Array(e),I[e]=n);for(var i=0;i!==e;++i)n[i]=t.allocTextureUnit();return n}function F(t,e){t.uniform1f(this.addr,e)}function N(t,e){t.uniform1i(this.addr,e)}function U(t,e){void 0===e.x?t.uniform2fv(this.addr,e):t.uniform2f(this.addr,e.x,e.y)}function j(t,e){void 0!==e.x?t.uniform3f(this.addr,e.x,e.y,e.z):void 0!==e.r?t.uniform3f(this.addr,e.r,e.g,e.b):t.uniform3fv(this.addr,e)}function B(t,e){void 0===e.x?t.uniform4fv(this.addr,e):t.uniform4f(this.addr,e.x,e.y,e.z,e.w)}function z(t,e){t.uniformMatrix2fv(this.addr,!1,e.elements||e)}function H(t,e){t.uniformMatrix3fv(this.addr,!1,e.elements||e)}function G(t,e){t.uniformMatrix4fv(this.addr,!1,e.elements||e)}function V(t,e,n){var i=n.allocTextureUnit();t.uniform1i(this.addr,i),n.setTexture2D(e||P,i)}function W(t,e,n){var i=n.allocTextureUnit();t.uniform1i(this.addr,i),n.setTextureCube(e||R,i)}function X(t,e){t.uniform2iv(this.addr,e)}function q(t,e){t.uniform3iv(this.addr,e)}function Y(t,e){t.uniform4iv(this.addr,e)}function Z(t,e){t.uniform1fv(this.addr,e)}function $(t,e){t.uniform1iv(this.addr,e)}function Q(t,e){t.uniform2fv(this.addr,D(e,this.size,2))}function J(t,e){t.uniform3fv(this.addr,D(e,this.size,3))}function K(t,e){t.uniform4fv(this.addr,D(e,this.size,4))}function tt(t,e){t.uniformMatrix2fv(this.addr,!1,D(e,this.size,4))}function et(t,e){t.uniformMatrix3fv(this.addr,!1,D(e,this.size,9))}function nt(t,e){t.uniformMatrix4fv(this.addr,!1,D(e,this.size,16))}function it(t,e,n){var i=e.length,r=O(n,i);t.uniform1iv(this.addr,r);for(var o=0;o!==i;++o)n.setTexture2D(e[o]||P,r[o])}function rt(t,e,n){var i=e.length,r=O(n,i);t.uniform1iv(this.addr,r);for(var o=0;o!==i;++o)n.setTextureCube(e[o]||R,r[o])}function ot(t,e,n){this.id=t,this.addr=n,this.setValue=function(t){switch(t){case 5126:return F;case 35664:return U;case 35665:return j;case 35666:return B;case 35674:return z;case 35675:return H;case 35676:return G;case 35678:return V;case 35680:return W;case 5124:case 35670:return N;case 35667:case 35671:return X;case 35668:case 35672:return q;case 35669:case 35673:return Y}}(e.type)}function at(t,e,n){this.id=t,this.addr=n,this.size=e.size,this.setValue=function(t){switch(t){case 5126:return Z;case 35664:return Q;case 35665:return J;case 35666:return K;case 35674:return tt;case 35675:return et;case 35676:return nt;case 35678:return it;case 35680:return rt;case 5124:case 35670:return $;case 35667:case 35671:return X;case 35668:case 35672:return q;case 35669:case 35673:return Y}}(e.type)}function st(t){this.id=t,L.call(this)}st.prototype.setValue=function(t,e){for(var n=this.seq,i=0,r=n.length;i!==r;++i){var o=n[i];o.setValue(t,e[o.id])}};var ct=/([\w\d_]+)(\])?(\[|\.)?/g;function lt(t,e){t.seq.push(e),t.map[e.id]=e}function ht(t,e,n){var i=t.name,r=i.length;for(ct.lastIndex=0;;){var o=ct.exec(i),a=ct.lastIndex,s=o[1],c="]"===o[2],l=o[3];if(c&&(s|=0),void 0===l||"["===l&&a+2===r){lt(n,void 0===l?new ot(s,t,e):new at(s,t,e));break}var h=n.map[s];void 0===h&&lt(n,h=new st(s)),n=h}}function ut(t,e,n){L.call(this),this.renderer=n;for(var i=t.getProgramParameter(e,t.ACTIVE_UNIFORMS),r=0;r!==i;++r){var o=t.getActiveUniform(e,r),a=o.name;ht(o,t.getUniformLocation(e,a),this)}}ut.prototype.setValue=function(t,e,n){var i=this.map[e];void 0!==i&&i.setValue(t,n,this.renderer)},ut.prototype.set=function(t,e,n){var i=this.map[n];void 0!==i&&i.setValue(t,e[n],this.renderer)},ut.prototype.setOptional=function(t,e,n){var i=e[n];void 0!==i&&this.setValue(t,n,i)},ut.upload=function(t,e,n,i){for(var r=0,o=e.length;r!==o;++r){var a=e[r],s=n[a.id];!1!==s.needsUpdate&&a.setValue(t,s.value,i)}},ut.seqWithValue=function(t,e){for(var n=[],i=0,r=t.length;i!==r;++i){var o=t[i];o.id in e&&n.push(o)}return n},ut.splitDynamic=function(t,e){for(var n=null,i=t.length,r=0,o=0;o!==i;++o){var a=t[o],s=e[a.id];s&&!0===s.dynamic?(null===n&&(n=[]),n.push(a)):(r<o&&(t[r]=a),++r)}return r<i&&(t.length=r),n},ut.evalDynamic=function(t,e,n,i,r){for(var o=0,a=t.length;o!==a;++o){var s=e[t[o].id],c=s.onUpdateCallback;void 0!==c&&c.call(s,n,i,r)}},t.UniformsUtils={merge:function(t){for(var e={},n=0;n<t.length;n++){var i=this.clone(t[n]);for(var r in i)e[r]=i[r]}return e},clone:function(t){var e={};for(var n in t)for(var i in e[n]={},t[n]){var r=t[n][i];r&&r.isColor||r&&r.isVector2||r&&r.isVector3||r&&r.isVector4||r&&r.isMatrix3||r&&r.isMatrix4||r&&r.isTexture?e[n][i]=r.clone():Array.isArray(r)?e[n][i]=r.slice():e[n][i]=r}return e}};var dt={alphamap_fragment:"#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, vUv ).g;\n#endif\n",alphamap_pars_fragment:"#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif\n",alphatest_fragment:"#ifdef ALPHATEST\n\tif ( diffuseColor.a < ALPHATEST ) discard;\n#endif\n",aomap_fragment:"#ifdef USE_AOMAP\n\tfloat ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;\n\treflectedLight.indirectDiffuse *= ambientOcclusion;\n\t#if defined( USE_ENVMAP ) && defined( PHYSICAL )\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\t\treflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.specularRoughness );\n\t#endif\n#endif\n",aomap_pars_fragment:"#ifdef USE_AOMAP\n\tuniform sampler2D aoMap;\n\tuniform float aoMapIntensity;\n#endif",begin_vertex:"\nvec3 transformed = vec3( position );\n",beginnormal_vertex:"\nvec3 objectNormal = vec3( normal );\n",bsdfs:"bool testLightInRange( const in float lightDistance, const in float cutoffDistance ) {\n\treturn any( bvec2( cutoffDistance == 0.0, lightDistance < cutoffDistance ) );\n}\nfloat punctualLightIntensityToIrradianceFactor( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n\t\tif( decayExponent > 0.0 ) {\n#if defined ( PHYSICALLY_CORRECT_LIGHTS )\n\t\t\tfloat distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n\t\t\tfloat maxDistanceCutoffFactor = pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n\t\t\treturn distanceFalloff * maxDistanceCutoffFactor;\n#else\n\t\t\treturn pow( saturate( -lightDistance / cutoffDistance + 1.0 ), decayExponent );\n#endif\n\t\t}\n\t\treturn 1.0;\n}\nvec3 BRDF_Diffuse_Lambert( const in vec3 diffuseColor ) {\n\treturn RECIPROCAL_PI * diffuseColor;\n}\nvec3 F_Schlick( const in vec3 specularColor, const in float dotLH ) {\n\tfloat fresnel = exp2( ( -5.55473 * dotLH - 6.98316 ) * dotLH );\n\treturn ( 1.0 - specularColor ) * fresnel + specularColor;\n}\nfloat G_GGX_Smith( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gl = dotNL + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\tfloat gv = dotNV + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\treturn 1.0 / ( gl * gv );\n}\nfloat G_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\tfloat gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\treturn 0.5 / max( gv + gl, EPSILON );\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n\tfloat a2 = pow2( alpha );\n\tfloat denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\n\treturn RECIPROCAL_PI * a2 / pow2( denom );\n}\nvec3 BRDF_Specular_GGX( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float roughness ) {\n\tfloat alpha = pow2( roughness );\n\tvec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );\n\tfloat dotNL = saturate( dot( geometry.normal, incidentLight.direction ) );\n\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\tfloat dotNH = saturate( dot( geometry.normal, halfDir ) );\n\tfloat dotLH = saturate( dot( incidentLight.direction, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, dotLH );\n\tfloat G = G_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\tfloat D = D_GGX( alpha, dotNH );\n\treturn F * ( G * D );\n}\nvec3 BRDF_Specular_GGX_Environment( const in GeometricContext geometry, const in vec3 specularColor, const in float roughness ) {\n\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\tconst vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n\tvec4 r = roughness * c0 + c1;\n\tfloat a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n\tvec2 AB = vec2( -1.04, 1.04 ) * a004 + r.zw;\n\treturn specularColor * AB.x + AB.y;\n}\nfloat G_BlinnPhong_Implicit( ) {\n\treturn 0.25;\n}\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n}\nvec3 BRDF_Specular_BlinnPhong( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float shininess ) {\n\tvec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );\n\tfloat dotNH = saturate( dot( geometry.normal, halfDir ) );\n\tfloat dotLH = saturate( dot( incidentLight.direction, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, dotLH );\n\tfloat G = G_BlinnPhong_Implicit( );\n\tfloat D = D_BlinnPhong( shininess, dotNH );\n\treturn F * ( G * D );\n}\nfloat GGXRoughnessToBlinnExponent( const in float ggxRoughness ) {\n\treturn ( 2.0 / pow2( ggxRoughness + 0.0001 ) - 2.0 );\n}\nfloat BlinnExponentToGGXRoughness( const in float blinnExponent ) {\n\treturn sqrt( 2.0 / ( blinnExponent + 2.0 ) );\n}\n",bumpmap_pars_fragment:"#ifdef USE_BUMPMAP\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\tvec2 dHdxy_fwd() {\n\t\tvec2 dSTdx = dFdx( vUv );\n\t\tvec2 dSTdy = dFdy( vUv );\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vUv ).x;\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;\n\t\treturn vec2( dBx, dBy );\n\t}\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy ) {\n\t\tvec3 vSigmaX = dFdx( surf_pos );\n\t\tvec3 vSigmaY = dFdy( surf_pos );\n\t\tvec3 vN = surf_norm;\n\t\tvec3 R1 = cross( vSigmaY, vN );\n\t\tvec3 R2 = cross( vN, vSigmaX );\n\t\tfloat fDet = dot( vSigmaX, R1 );\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\t}\n#endif\n",clipping_planes_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tfor ( int i = 0; i < NUM_CLIPPING_PLANES; ++ i ) {\n\t\tvec4 plane = clippingPlanes[ i ];\n\t\tif ( dot( vViewPosition, plane.xyz ) > plane.w ) discard;\n\t}\n#endif\n",clipping_planes_pars_fragment:"#if NUM_CLIPPING_PLANES > 0\n\t#if ! defined( PHYSICAL ) && ! defined( PHONG )\n\t\tvarying vec3 vViewPosition;\n\t#endif\n\tuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n#endif\n",clipping_planes_pars_vertex:"#if NUM_CLIPPING_PLANES > 0 && ! defined( PHYSICAL ) && ! defined( PHONG )\n\tvarying vec3 vViewPosition;\n#endif\n",clipping_planes_vertex:"#if NUM_CLIPPING_PLANES > 0 && ! defined( PHYSICAL ) && ! defined( PHONG )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n",color_fragment:"#ifdef USE_COLOR\n\tdiffuseColor.rgb *= vColor;\n#endif",color_pars_fragment:"#ifdef USE_COLOR\n\tvarying vec3 vColor;\n#endif\n",color_pars_vertex:"#ifdef USE_COLOR\n\tvarying vec3 vColor;\n#endif",color_vertex:"#ifdef USE_COLOR\n\tvColor.xyz = color.xyz;\n#endif",common:"#define PI 3.14159265359\n#define PI2 6.28318530718\n#define RECIPROCAL_PI 0.31830988618\n#define RECIPROCAL_PI2 0.15915494\n#define LOG2 1.442695\n#define EPSILON 1e-6\n#define saturate(a) clamp( a, 0.0, 1.0 )\n#define whiteCompliment(a) ( 1.0 - saturate( a ) )\nfloat pow2( const in float x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat average( const in vec3 color ) { return dot( color, vec3( 0.3333 ) ); }\nhighp float rand( const in vec2 uv ) {\n\tconst highp float a = 12.9898, b = 78.233, c = 43758.5453;\n\thighp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n\treturn fract(sin(sn) * c);\n}\nstruct IncidentLight {\n\tvec3 color;\n\tvec3 direction;\n\tbool visible;\n};\nstruct ReflectedLight {\n\tvec3 directDiffuse;\n\tvec3 directSpecular;\n\tvec3 indirectDiffuse;\n\tvec3 indirectSpecular;\n};\nstruct GeometricContext {\n\tvec3 position;\n\tvec3 normal;\n\tvec3 viewDir;\n};\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n}\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\nvec3 projectOnPlane(in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\tfloat distance = dot( planeNormal, point - pointOnPlane );\n\treturn - distance * planeNormal + point;\n}\nfloat sideOfPlane( in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\treturn sign( dot( point - pointOnPlane, planeNormal ) );\n}\nvec3 linePlaneIntersect( in vec3 pointOnLine, in vec3 lineDirection, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\treturn lineDirection * ( dot( planeNormal, pointOnPlane - pointOnLine ) / dot( planeNormal, lineDirection ) ) + pointOnLine;\n}\n",cube_uv_reflection_fragment:"#ifdef ENVMAP_TYPE_CUBE_UV\n#define cubeUV_textureSize (1024.0)\nint getFaceFromDirection(vec3 direction) {\n\tvec3 absDirection = abs(direction);\n\tint face = -1;\n\tif( absDirection.x > absDirection.z ) {\n\t\tif(absDirection.x > absDirection.y )\n\t\t\tface = direction.x > 0.0 ? 0 : 3;\n\t\telse\n\t\t\tface = direction.y > 0.0 ? 1 : 4;\n\t}\n\telse {\n\t\tif(absDirection.z > absDirection.y )\n\t\t\tface = direction.z > 0.0 ? 2 : 5;\n\t\telse\n\t\t\tface = direction.y > 0.0 ? 1 : 4;\n\t}\n\treturn face;\n}\n#define cubeUV_maxLods1  (log2(cubeUV_textureSize*0.25) - 1.0)\n#define cubeUV_rangeClamp (exp2((6.0 - 1.0) * 2.0))\nvec2 MipLevelInfo( vec3 vec, float roughnessLevel, float roughness ) {\n\tfloat scale = exp2(cubeUV_maxLods1 - roughnessLevel);\n\tfloat dxRoughness = dFdx(roughness);\n\tfloat dyRoughness = dFdy(roughness);\n\tvec3 dx = dFdx( vec * scale * dxRoughness );\n\tvec3 dy = dFdy( vec * scale * dyRoughness );\n\tfloat d = max( dot( dx, dx ), dot( dy, dy ) );\n\td = clamp(d, 1.0, cubeUV_rangeClamp);\n\tfloat mipLevel = 0.5 * log2(d);\n\treturn vec2(floor(mipLevel), fract(mipLevel));\n}\n#define cubeUV_maxLods2 (log2(cubeUV_textureSize*0.25) - 2.0)\n#define cubeUV_rcpTextureSize (1.0 / cubeUV_textureSize)\nvec2 getCubeUV(vec3 direction, float roughnessLevel, float mipLevel) {\n\tmipLevel = roughnessLevel > cubeUV_maxLods2 - 3.0 ? 0.0 : mipLevel;\n\tfloat a = 16.0 * cubeUV_rcpTextureSize;\n\tvec2 exp2_packed = exp2( vec2( roughnessLevel, mipLevel ) );\n\tvec2 rcp_exp2_packed = vec2( 1.0 ) / exp2_packed;\n\tfloat powScale = exp2_packed.x * exp2_packed.y;\n\tfloat scale = rcp_exp2_packed.x * rcp_exp2_packed.y * 0.25;\n\tfloat mipOffset = 0.75*(1.0 - rcp_exp2_packed.y) * rcp_exp2_packed.x;\n\tbool bRes = mipLevel == 0.0;\n\tscale =  bRes && (scale < a) ? a : scale;\n\tvec3 r;\n\tvec2 offset;\n\tint face = getFaceFromDirection(direction);\n\tfloat rcpPowScale = 1.0 / powScale;\n\tif( face == 0) {\n\t\tr = vec3(direction.x, -direction.z, direction.y);\n\t\toffset = vec2(0.0+mipOffset,0.75 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ?  a : offset.y;\n\t}\n\telse if( face == 1) {\n\t\tr = vec3(direction.y, direction.x, direction.z);\n\t\toffset = vec2(scale+mipOffset, 0.75 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ?  a : offset.y;\n\t}\n\telse if( face == 2) {\n\t\tr = vec3(direction.z, direction.x, direction.y);\n\t\toffset = vec2(2.0*scale+mipOffset, 0.75 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ?  a : offset.y;\n\t}\n\telse if( face == 3) {\n\t\tr = vec3(direction.x, direction.z, direction.y);\n\t\toffset = vec2(0.0+mipOffset,0.5 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ?  0.0 : offset.y;\n\t}\n\telse if( face == 4) {\n\t\tr = vec3(direction.y, direction.x, -direction.z);\n\t\toffset = vec2(scale+mipOffset, 0.5 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ?  0.0 : offset.y;\n\t}\n\telse {\n\t\tr = vec3(direction.z, -direction.x, direction.y);\n\t\toffset = vec2(2.0*scale+mipOffset, 0.5 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ?  0.0 : offset.y;\n\t}\n\tr = normalize(r);\n\tfloat texelOffset = 0.5 * cubeUV_rcpTextureSize;\n\tvec2 s = ( r.yz / abs( r.x ) + vec2( 1.0 ) ) * 0.5;\n\tvec2 base = offset + vec2( texelOffset );\n\treturn base + s * ( scale - 2.0 * texelOffset );\n}\n#define cubeUV_maxLods3 (log2(cubeUV_textureSize*0.25) - 3.0)\nvec4 textureCubeUV(vec3 reflectedDirection, float roughness ) {\n\tfloat roughnessVal = roughness* cubeUV_maxLods3;\n\tfloat r1 = floor(roughnessVal);\n\tfloat r2 = r1 + 1.0;\n\tfloat t = fract(roughnessVal);\n\tvec2 mipInfo = MipLevelInfo(reflectedDirection, r1, roughness);\n\tfloat s = mipInfo.y;\n\tfloat level0 = mipInfo.x;\n\tfloat level1 = level0 + 1.0;\n\tlevel1 = level1 > 5.0 ? 5.0 : level1;\n\tlevel0 += min( floor( s + 0.5 ), 5.0 );\n\tvec2 uv_10 = getCubeUV(reflectedDirection, r1, level0);\n\tvec4 color10 = envMapTexelToLinear(texture2D(envMap, uv_10));\n\tvec2 uv_20 = getCubeUV(reflectedDirection, r2, level0);\n\tvec4 color20 = envMapTexelToLinear(texture2D(envMap, uv_20));\n\tvec4 result = mix(color10, color20, t);\n\treturn vec4(result.rgb, 1.0);\n}\n#endif\n",defaultnormal_vertex:"#ifdef FLIP_SIDED\n\tobjectNormal = -objectNormal;\n#endif\nvec3 transformedNormal = normalMatrix * objectNormal;\n",displacementmap_pars_vertex:"#ifdef USE_DISPLACEMENTMAP\n\tuniform sampler2D displacementMap;\n\tuniform float displacementScale;\n\tuniform float displacementBias;\n#endif\n",displacementmap_vertex:"#ifdef USE_DISPLACEMENTMAP\n\ttransformed += normal * ( texture2D( displacementMap, uv ).x * displacementScale + displacementBias );\n#endif\n",emissivemap_fragment:"#ifdef USE_EMISSIVEMAP\n\tvec4 emissiveColor = texture2D( emissiveMap, vUv );\n\temissiveColor.rgb = emissiveMapTexelToLinear( emissiveColor ).rgb;\n\ttotalEmissiveRadiance *= emissiveColor.rgb;\n#endif\n",emissivemap_pars_fragment:"#ifdef USE_EMISSIVEMAP\n\tuniform sampler2D emissiveMap;\n#endif\n",encodings_fragment:"  gl_FragColor = linearToOutputTexel( gl_FragColor );\n",encodings_pars_fragment:"\nvec4 LinearToLinear( in vec4 value ) {\n  return value;\n}\nvec4 GammaToLinear( in vec4 value, in float gammaFactor ) {\n  return vec4( pow( value.xyz, vec3( gammaFactor ) ), value.w );\n}\nvec4 LinearToGamma( in vec4 value, in float gammaFactor ) {\n  return vec4( pow( value.xyz, vec3( 1.0 / gammaFactor ) ), value.w );\n}\nvec4 sRGBToLinear( in vec4 value ) {\n  return vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.w );\n}\nvec4 LinearTosRGB( in vec4 value ) {\n  return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.w );\n}\nvec4 RGBEToLinear( in vec4 value ) {\n  return vec4( value.rgb * exp2( value.a * 255.0 - 128.0 ), 1.0 );\n}\nvec4 LinearToRGBE( in vec4 value ) {\n  float maxComponent = max( max( value.r, value.g ), value.b );\n  float fExp = clamp( ceil( log2( maxComponent ) ), -128.0, 127.0 );\n  return vec4( value.rgb / exp2( fExp ), ( fExp + 128.0 ) / 255.0 );\n}\nvec4 RGBMToLinear( in vec4 value, in float maxRange ) {\n  return vec4( value.xyz * value.w * maxRange, 1.0 );\n}\nvec4 LinearToRGBM( in vec4 value, in float maxRange ) {\n  float maxRGB = max( value.x, max( value.g, value.b ) );\n  float M      = clamp( maxRGB / maxRange, 0.0, 1.0 );\n  M            = ceil( M * 255.0 ) / 255.0;\n  return vec4( value.rgb / ( M * maxRange ), M );\n}\nvec4 RGBDToLinear( in vec4 value, in float maxRange ) {\n    return vec4( value.rgb * ( ( maxRange / 255.0 ) / value.a ), 1.0 );\n}\nvec4 LinearToRGBD( in vec4 value, in float maxRange ) {\n    float maxRGB = max( value.x, max( value.g, value.b ) );\n    float D      = max( maxRange / maxRGB, 1.0 );\n    D            = min( floor( D ) / 255.0, 1.0 );\n    return vec4( value.rgb * ( D * ( 255.0 / maxRange ) ), D );\n}\nconst mat3 cLogLuvM = mat3( 0.2209, 0.3390, 0.4184, 0.1138, 0.6780, 0.7319, 0.0102, 0.1130, 0.2969 );\nvec4 LinearToLogLuv( in vec4 value )  {\n  vec3 Xp_Y_XYZp = value.rgb * cLogLuvM;\n  Xp_Y_XYZp = max(Xp_Y_XYZp, vec3(1e-6, 1e-6, 1e-6));\n  vec4 vResult;\n  vResult.xy = Xp_Y_XYZp.xy / Xp_Y_XYZp.z;\n  float Le = 2.0 * log2(Xp_Y_XYZp.y) + 127.0;\n  vResult.w = fract(Le);\n  vResult.z = (Le - (floor(vResult.w*255.0))/255.0)/255.0;\n  return vResult;\n}\nconst mat3 cLogLuvInverseM = mat3( 6.0014, -2.7008, -1.7996, -1.3320, 3.1029, -5.7721, 0.3008, -1.0882, 5.6268 );\nvec4 LogLuvToLinear( in vec4 value ) {\n  float Le = value.z * 255.0 + value.w;\n  vec3 Xp_Y_XYZp;\n  Xp_Y_XYZp.y = exp2((Le - 127.0) / 2.0);\n  Xp_Y_XYZp.z = Xp_Y_XYZp.y / value.y;\n  Xp_Y_XYZp.x = value.x * Xp_Y_XYZp.z;\n  vec3 vRGB = Xp_Y_XYZp.rgb * cLogLuvInverseM;\n  return vec4( max(vRGB, 0.0), 1.0 );\n}\n",envmap_fragment:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\tvec3 cameraToVertex = normalize( vWorldPosition - cameraPosition );\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#else\n\t\tvec3 reflectVec = vReflect;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 envColor = textureCube( envMap, flipNormal * vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\t#elif defined( ENVMAP_TYPE_EQUIREC )\n\t\tvec2 sampleUV;\n\t\tsampleUV.y = saturate( flipNormal * reflectVec.y * 0.5 + 0.5 );\n\t\tsampleUV.x = atan( flipNormal * reflectVec.z, flipNormal * reflectVec.x ) * RECIPROCAL_PI2 + 0.5;\n\t\tvec4 envColor = texture2D( envMap, sampleUV );\n\t#elif defined( ENVMAP_TYPE_SPHERE )\n\t\tvec3 reflectView = flipNormal * normalize( ( viewMatrix * vec4( reflectVec, 0.0 ) ).xyz + vec3( 0.0, 0.0, 1.0 ) );\n\t\tvec4 envColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5 );\n\t#else\n\t\tvec4 envColor = vec4( 0.0 );\n\t#endif\n\tenvColor = envMapTexelToLinear( envColor );\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\n\t#endif\n#endif\n",envmap_pars_fragment:"#if defined( USE_ENVMAP ) || defined( PHYSICAL )\n\tuniform float reflectivity;\n\tuniform float envMapIntenstiy;\n#endif\n#ifdef USE_ENVMAP\n\t#if ! defined( PHYSICAL ) && ( defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) )\n\t\tvarying vec3 vWorldPosition;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n\tuniform float flipEnvMap;\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( PHYSICAL )\n\t\tuniform float refractionRatio;\n\t#else\n\t\tvarying vec3 vReflect;\n\t#endif\n#endif\n",envmap_pars_vertex:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\tvarying vec3 vWorldPosition;\n\t#else\n\t\tvarying vec3 vReflect;\n\t\tuniform float refractionRatio;\n\t#endif\n#endif\n",envmap_vertex:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\tvWorldPosition = worldPosition.xyz;\n\t#else\n\t\tvec3 cameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\t\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvReflect = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#endif\n#endif\n",fog_fragment:"#ifdef USE_FOG\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tfloat depth = gl_FragDepthEXT / gl_FragCoord.w;\n\t#else\n\t\tfloat depth = gl_FragCoord.z / gl_FragCoord.w;\n\t#endif\n\t#ifdef FOG_EXP2\n\t\tfloat fogFactor = whiteCompliment( exp2( - fogDensity * fogDensity * depth * depth * LOG2 ) );\n\t#else\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, depth );\n\t#endif\n\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n#endif\n",fog_pars_fragment:"#ifdef USE_FOG\n\tuniform vec3 fogColor;\n\t#ifdef FOG_EXP2\n\t\tuniform float fogDensity;\n\t#else\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\t#endif\n#endif",lightmap_fragment:"#ifdef USE_LIGHTMAP\n\treflectedLight.indirectDiffuse += PI * texture2D( lightMap, vUv2 ).xyz * lightMapIntensity;\n#endif\n",lightmap_pars_fragment:"#ifdef USE_LIGHTMAP\n\tuniform sampler2D lightMap;\n\tuniform float lightMapIntensity;\n#endif",lights_lambert_vertex:"vec3 diffuse = vec3( 1.0 );\nGeometricContext geometry;\ngeometry.position = mvPosition.xyz;\ngeometry.normal = normalize( transformedNormal );\ngeometry.viewDir = normalize( -mvPosition.xyz );\nGeometricContext backGeometry;\nbackGeometry.position = geometry.position;\nbackGeometry.normal = -geometry.normal;\nbackGeometry.viewDir = geometry.viewDir;\nvLightFront = vec3( 0.0 );\n#ifdef DOUBLE_SIDED\n\tvLightBack = vec3( 0.0 );\n#endif\nIncidentLight directLight;\nfloat dotNL;\nvec3 directLightColor_Diffuse;\n#if NUM_POINT_LIGHTS > 0\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tgetPointDirectLightIrradiance( pointLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tgetSpotDirectLightIrradiance( spotLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n#endif\n#if NUM_DIR_LIGHTS > 0\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tgetDirectionalDirectLightIrradiance( directionalLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\tvLightFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry );\n\t\t#endif\n\t}\n#endif\n",lights_pars:"uniform vec3 ambientLightColor;\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n\tvec3 irradiance = ambientLightColor;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treturn irradiance;\n}\n#if NUM_DIR_LIGHTS > 0\n\tstruct DirectionalLight {\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tint shadow;\n\t\tfloat shadowBias;\n\t\tfloat shadowRadius;\n\t\tvec2 shadowMapSize;\n\t};\n\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n\tvoid getDirectionalDirectLightIrradiance( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n\t\tdirectLight.color = directionalLight.color;\n\t\tdirectLight.direction = directionalLight.direction;\n\t\tdirectLight.visible = true;\n\t}\n#endif\n#if NUM_POINT_LIGHTS > 0\n\tstruct PointLight {\n\t\tvec3 position;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tint shadow;\n\t\tfloat shadowBias;\n\t\tfloat shadowRadius;\n\t\tvec2 shadowMapSize;\n\t};\n\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n\tvoid getPointDirectLightIrradiance( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n\t\tvec3 lVector = pointLight.position - geometry.position;\n\t\tdirectLight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tif ( testLightInRange( lightDistance, pointLight.distance ) ) {\n\t\t\tdirectLight.color = pointLight.color;\n\t\t\tdirectLight.color *= punctualLightIntensityToIrradianceFactor( lightDistance, pointLight.distance, pointLight.decay );\n\t\t\tdirectLight.visible = true;\n\t\t} else {\n\t\t\tdirectLight.color = vec3( 0.0 );\n\t\t\tdirectLight.visible = false;\n\t\t}\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tstruct SpotLight {\n\t\tvec3 position;\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tfloat coneCos;\n\t\tfloat penumbraCos;\n\t\tint shadow;\n\t\tfloat shadowBias;\n\t\tfloat shadowRadius;\n\t\tvec2 shadowMapSize;\n\t};\n\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n\tvoid getSpotDirectLightIrradiance( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight directLight  ) {\n\t\tvec3 lVector = spotLight.position - geometry.position;\n\t\tdirectLight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tfloat angleCos = dot( directLight.direction, spotLight.direction );\n\t\tif ( all( bvec2( angleCos > spotLight.coneCos, testLightInRange( lightDistance, spotLight.distance ) ) ) ) {\n\t\t\tfloat spotEffect = smoothstep( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n\t\t\tdirectLight.color = spotLight.color;\n\t\t\tdirectLight.color *= spotEffect * punctualLightIntensityToIrradianceFactor( lightDistance, spotLight.distance, spotLight.decay );\n\t\t\tdirectLight.visible = true;\n\t\t} else {\n\t\t\tdirectLight.color = vec3( 0.0 );\n\t\t\tdirectLight.visible = false;\n\t\t}\n\t}\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tstruct HemisphereLight {\n\t\tvec3 direction;\n\t\tvec3 skyColor;\n\t\tvec3 groundColor;\n\t};\n\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in GeometricContext geometry ) {\n\t\tfloat dotNL = dot( geometry.normal, hemiLight.direction );\n\t\tfloat hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n\t\tvec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tirradiance *= PI;\n\t\t#endif\n\t\treturn irradiance;\n\t}\n#endif\n#if defined( USE_ENVMAP ) && defined( PHYSICAL )\n\tvec3 getLightProbeIndirectIrradiance( const in GeometricContext geometry, const in int maxMIPLevel ) {\n\t\t#include <normal_flip>\n\t\tvec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );\n\t\t#ifdef ENVMAP_TYPE_CUBE\n\t\t\tvec3 queryVec = flipNormal * vec3( flipEnvMap * worldNormal.x, worldNormal.yz );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = textureCubeLodEXT( envMap, queryVec, float( maxMIPLevel ) );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = textureCube( envMap, queryVec, float( maxMIPLevel ) );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 queryVec = flipNormal * vec3( flipEnvMap * worldNormal.x, worldNormal.yz );\n\t\t\tvec4 envMapColor = textureCubeUV( queryVec, 1.0 );\n\t\t#else\n\t\t\tvec4 envMapColor = vec4( 0.0 );\n\t\t#endif\n\t\treturn PI * envMapColor.rgb * envMapIntensity;\n\t}\n\tfloat getSpecularMIPLevel( const in float blinnShininessExponent, const in int maxMIPLevel ) {\n\t\tfloat maxMIPLevelScalar = float( maxMIPLevel );\n\t\tfloat desiredMIPLevel = maxMIPLevelScalar - 0.79248 - 0.5 * log2( pow2( blinnShininessExponent ) + 1.0 );\n\t\treturn clamp( desiredMIPLevel, 0.0, maxMIPLevelScalar );\n\t}\n\tvec3 getLightProbeIndirectRadiance( const in GeometricContext geometry, const in float blinnShininessExponent, const in int maxMIPLevel ) {\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( -geometry.viewDir, geometry.normal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( -geometry.viewDir, geometry.normal, refractionRatio );\n\t\t#endif\n\t\t#include <normal_flip>\n\t\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n\t\tfloat specularMIPLevel = getSpecularMIPLevel( blinnShininessExponent, maxMIPLevel );\n\t\t#ifdef ENVMAP_TYPE_CUBE\n\t\t\tvec3 queryReflectVec = flipNormal * vec3( flipEnvMap * reflectVec.x, reflectVec.yz );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = textureCubeLodEXT( envMap, queryReflectVec, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = textureCube( envMap, queryReflectVec, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 queryReflectVec = flipNormal * vec3( flipEnvMap * reflectVec.x, reflectVec.yz );\n\t\t\tvec4 envMapColor = textureCubeUV(queryReflectVec, BlinnExponentToGGXRoughness(blinnShininessExponent));\n\t\t#elif defined( ENVMAP_TYPE_EQUIREC )\n\t\t\tvec2 sampleUV;\n\t\t\tsampleUV.y = saturate( flipNormal * reflectVec.y * 0.5 + 0.5 );\n\t\t\tsampleUV.x = atan( flipNormal * reflectVec.z, flipNormal * reflectVec.x ) * RECIPROCAL_PI2 + 0.5;\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = texture2DLodEXT( envMap, sampleUV, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = texture2D( envMap, sampleUV, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_SPHERE )\n\t\t\tvec3 reflectView = flipNormal * normalize( ( viewMatrix * vec4( reflectVec, 0.0 ) ).xyz + vec3( 0.0,0.0,1.0 ) );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = texture2DLodEXT( envMap, reflectView.xy * 0.5 + 0.5, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#endif\n\t\treturn envMapColor.rgb * envMapIntensity;\n\t}\n#endif\n",lights_phong_fragment:"BlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;\n",lights_phong_pars_fragment:"varying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\nstruct BlinnPhongMaterial {\n\tvec3\tdiffuseColor;\n\tvec3\tspecularColor;\n\tfloat\tspecularShininess;\n\tfloat\tspecularStrength;\n};\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_Specular_BlinnPhong( directLight, geometry, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_BlinnPhong\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_BlinnPhong\n#define Material_LightProbeLOD( material )\t(0)\n",lights_physical_fragment:"PhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\nmaterial.specularRoughness = clamp( roughnessFactor, 0.04, 1.0 );\n#ifdef STANDARD\n\tmaterial.specularColor = mix( vec3( DEFAULT_SPECULAR_COEFFICIENT ), diffuseColor.rgb, metalnessFactor );\n#else\n\tmaterial.specularColor = mix( vec3( MAXIMUM_SPECULAR_COEFFICIENT * pow2( reflectivity ) ), diffuseColor.rgb, metalnessFactor );\n\tmaterial.clearCoat = saturate( clearCoat );\tmaterial.clearCoatRoughness = clamp( clearCoatRoughness, 0.04, 1.0 );\n#endif\n",lights_physical_pars_fragment:"struct PhysicalMaterial {\n\tvec3\tdiffuseColor;\n\tfloat\tspecularRoughness;\n\tvec3\tspecularColor;\n\t#ifndef STANDARD\n\t\tfloat clearCoat;\n\t\tfloat clearCoatRoughness;\n\t#endif\n};\n#define MAXIMUM_SPECULAR_COEFFICIENT 0.16\n#define DEFAULT_SPECULAR_COEFFICIENT 0.04\nfloat clearCoatDHRApprox( const in float roughness, const in float dotNL ) {\n\treturn DEFAULT_SPECULAR_COEFFICIENT + ( 1.0 - DEFAULT_SPECULAR_COEFFICIENT ) * ( pow( 1.0 - dotNL, 5.0 ) * pow( 1.0 - roughness, 2.0 ) );\n}\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\t#ifndef STANDARD\n\t\tfloat clearCoatDHR = material.clearCoat * clearCoatDHRApprox( material.clearCoatRoughness, dotNL );\n\t#else\n\t\tfloat clearCoatDHR = 0.0;\n\t#endif\n\treflectedLight.directSpecular += ( 1.0 - clearCoatDHR ) * irradiance * BRDF_Specular_GGX( directLight, geometry, material.specularColor, material.specularRoughness );\n\treflectedLight.directDiffuse += ( 1.0 - clearCoatDHR ) * irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n\t#ifndef STANDARD\n\t\treflectedLight.directSpecular += irradiance * material.clearCoat * BRDF_Specular_GGX( directLight, geometry, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearCoatRoughness );\n\t#endif\n}\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 clearCoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t#ifndef STANDARD\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\t\tfloat dotNL = dotNV;\n\t\tfloat clearCoatDHR = material.clearCoat * clearCoatDHRApprox( material.clearCoatRoughness, dotNL );\n\t#else\n\t\tfloat clearCoatDHR = 0.0;\n\t#endif\n\treflectedLight.indirectSpecular += ( 1.0 - clearCoatDHR ) * radiance * BRDF_Specular_GGX_Environment( geometry, material.specularColor, material.specularRoughness );\n\t#ifndef STANDARD\n\t\treflectedLight.indirectSpecular += clearCoatRadiance * material.clearCoat * BRDF_Specular_GGX_Environment( geometry, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearCoatRoughness );\n\t#endif\n}\n#define RE_Direct\t\t\t\tRE_Direct_Physical\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular\t\tRE_IndirectSpecular_Physical\n#define Material_BlinnShininessExponent( material )   GGXRoughnessToBlinnExponent( material.specularRoughness )\n#define Material_ClearCoat_BlinnShininessExponent( material )   GGXRoughnessToBlinnExponent( material.clearCoatRoughness )\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n}\n",lights_template:"\nGeometricContext geometry;\ngeometry.position = - vViewPosition;\ngeometry.normal = normal;\ngeometry.viewDir = normalize( vViewPosition );\nIncidentLight directLight;\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n\tPointLight pointLight;\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tgetPointDirectLightIrradiance( pointLight, geometry, directLight );\n\t\t#ifdef USE_SHADOWMAP\n\t\tdirectLight.color *= all( bvec2( pointLight.shadow, directLight.visible ) ) ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n\tSpotLight spotLight;\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tgetSpotDirectLightIrradiance( spotLight, geometry, directLight );\n\t\t#ifdef USE_SHADOWMAP\n\t\tdirectLight.color *= all( bvec2( spotLight.shadow, directLight.visible ) ) ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n\tDirectionalLight directionalLight;\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tgetDirectionalDirectLightIrradiance( directionalLight, geometry, directLight );\n\t\t#ifdef USE_SHADOWMAP\n\t\tdirectLight.color *= all( bvec2( directionalLight.shadow, directLight.visible ) ) ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if defined( RE_IndirectDiffuse )\n\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n\t#ifdef USE_LIGHTMAP\n\t\tvec3 lightMapIrradiance = texture2D( lightMap, vUv2 ).xyz * lightMapIntensity;\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tlightMapIrradiance *= PI;\n\t\t#endif\n\t\tirradiance += lightMapIrradiance;\n\t#endif\n\t#if ( NUM_HEMI_LIGHTS > 0 )\n\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n\t\t}\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( PHYSICAL ) && defined( ENVMAP_TYPE_CUBE_UV )\n\t \tirradiance += getLightProbeIndirectIrradiance( geometry, 8 );\n\t#endif\n\tRE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );\n#endif\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n\tvec3 radiance = getLightProbeIndirectRadiance( geometry, Material_BlinnShininessExponent( material ), 8 );\n\t#ifndef STANDARD\n\t\tvec3 clearCoatRadiance = getLightProbeIndirectRadiance( geometry, Material_ClearCoat_BlinnShininessExponent( material ), 8 );\n\t#else\n\t\tvec3 clearCoatRadiance = vec3( 0.0 );\n\t#endif\n\t\t\n\tRE_IndirectSpecular( radiance, clearCoatRadiance, geometry, material, reflectedLight );\n#endif\n",logdepthbuf_fragment:"#if defined(USE_LOGDEPTHBUF) && defined(USE_LOGDEPTHBUF_EXT)\n\tgl_FragDepthEXT = log2(vFragDepth) * logDepthBufFC * 0.5;\n#endif",logdepthbuf_pars_fragment:"#ifdef USE_LOGDEPTHBUF\n\tuniform float logDepthBufFC;\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t#endif\n#endif\n",logdepthbuf_pars_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t#endif\n\tuniform float logDepthBufFC;\n#endif",logdepthbuf_vertex:"#ifdef USE_LOGDEPTHBUF\n\tgl_Position.z = log2(max( EPSILON, gl_Position.w + 1.0 )) * logDepthBufFC;\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvFragDepth = 1.0 + gl_Position.w;\n\t#else\n\t\tgl_Position.z = (gl_Position.z - 1.0) * gl_Position.w;\n\t#endif\n#endif\n",map_fragment:"#ifdef USE_MAP\n\tvec4 texelColor = texture2D( map, vUv );\n\ttexelColor = mapTexelToLinear( texelColor );\n\tdiffuseColor *= texelColor;\n#endif\n",map_pars_fragment:"#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif\n",map_particle_fragment:"#ifdef USE_MAP\n\tvec4 mapTexel = texture2D( map, vec2( gl_PointCoord.x, 1.0 - gl_PointCoord.y ) * offsetRepeat.zw + offsetRepeat.xy );\n\tdiffuseColor *= mapTexelToLinear( mapTexel );\n#endif\n",map_particle_pars_fragment:"#ifdef USE_MAP\n\tuniform vec4 offsetRepeat;\n\tuniform sampler2D map;\n#endif\n",metalnessmap_fragment:"float metalnessFactor = metalness;\n#ifdef USE_METALNESSMAP\n\tvec4 texelMetalness = texture2D( metalnessMap, vUv );\n\tmetalnessFactor *= texelMetalness.r;\n#endif\n",metalnessmap_pars_fragment:"#ifdef USE_METALNESSMAP\n\tuniform sampler2D metalnessMap;\n#endif",morphnormal_vertex:"#ifdef USE_MORPHNORMALS\n\tobjectNormal += ( morphNormal0 - normal ) * morphTargetInfluences[ 0 ];\n\tobjectNormal += ( morphNormal1 - normal ) * morphTargetInfluences[ 1 ];\n\tobjectNormal += ( morphNormal2 - normal ) * morphTargetInfluences[ 2 ];\n\tobjectNormal += ( morphNormal3 - normal ) * morphTargetInfluences[ 3 ];\n#endif\n",morphtarget_pars_vertex:"#ifdef USE_MORPHTARGETS\n\t#ifndef USE_MORPHNORMALS\n\tuniform float morphTargetInfluences[ 8 ];\n\t#else\n\tuniform float morphTargetInfluences[ 4 ];\n\t#endif\n#endif",morphtarget_vertex:"#ifdef USE_MORPHTARGETS\n\ttransformed += ( morphTarget0 - position ) * morphTargetInfluences[ 0 ];\n\ttransformed += ( morphTarget1 - position ) * morphTargetInfluences[ 1 ];\n\ttransformed += ( morphTarget2 - position ) * morphTargetInfluences[ 2 ];\n\ttransformed += ( morphTarget3 - position ) * morphTargetInfluences[ 3 ];\n\t#ifndef USE_MORPHNORMALS\n\ttransformed += ( morphTarget4 - position ) * morphTargetInfluences[ 4 ];\n\ttransformed += ( morphTarget5 - position ) * morphTargetInfluences[ 5 ];\n\ttransformed += ( morphTarget6 - position ) * morphTargetInfluences[ 6 ];\n\ttransformed += ( morphTarget7 - position ) * morphTargetInfluences[ 7 ];\n\t#endif\n#endif\n",normal_flip:"#ifdef DOUBLE_SIDED\n\tfloat flipNormal = ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n#else\n\tfloat flipNormal = 1.0;\n#endif\n",normal_fragment:"#ifdef FLAT_SHADED\n\tvec3 fdx = vec3( dFdx( vViewPosition.x ), dFdx( vViewPosition.y ), dFdx( vViewPosition.z ) );\n\tvec3 fdy = vec3( dFdy( vViewPosition.x ), dFdy( vViewPosition.y ), dFdy( vViewPosition.z ) );\n\tvec3 normal = normalize( cross( fdx, fdy ) );\n#else\n\tvec3 normal = normalize( vNormal ) * flipNormal;\n#endif\n#ifdef USE_NORMALMAP\n\tnormal = perturbNormal2Arb( -vViewPosition, normal );\n#elif defined( USE_BUMPMAP )\n\tnormal = perturbNormalArb( -vViewPosition, normal, dHdxy_fwd() );\n#endif\n",normalmap_pars_fragment:"#ifdef USE_NORMALMAP\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n\tvec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm ) {\n\t\tvec3 q0 = dFdx( eye_pos.xyz );\n\t\tvec3 q1 = dFdy( eye_pos.xyz );\n\t\tvec2 st0 = dFdx( vUv.st );\n\t\tvec2 st1 = dFdy( vUv.st );\n\t\tvec3 S = normalize( q0 * st1.t - q1 * st0.t );\n\t\tvec3 T = normalize( -q0 * st1.s + q1 * st0.s );\n\t\tvec3 N = normalize( surf_norm );\n\t\tvec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\t\tmapN.xy = normalScale * mapN.xy;\n\t\tmat3 tsn = mat3( S, T, N );\n\t\treturn normalize( tsn * mapN );\n\t}\n#endif\n",packing:"vec3 packNormalToRGB( const in vec3 normal ) {\n  return normalize( normal ) * 0.5 + 0.5;\n}\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n  return 1.0 - 2.0 * rgb.xyz;\n}\nconst float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;\nconst vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256.,  256. );\nconst vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );\nconst float ShiftRight8 = 1. / 256.;\nvec4 packDepthToRGBA( const in float v ) {\n\tvec4 r = vec4( fract( v * PackFactors ), v );\n\tr.yzw -= r.xyz * ShiftRight8;\treturn r * PackUpscale;\n}\nfloat unpackRGBAToDepth( const in vec4 v ) {\n\treturn dot( v, UnpackFactors );\n}\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\n  return ( viewZ + near ) / ( near - far );\n}\nfloat orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {\n  return linearClipZ * ( near - far ) - near;\n}\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n  return (( near + viewZ ) * far ) / (( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {\n  return ( near * far ) / ( ( far - near ) * invClipZ - far );\n}\n",premultiplied_alpha_fragment:"#ifdef PREMULTIPLIED_ALPHA\n\tgl_FragColor.rgb *= gl_FragColor.a;\n#endif\n",project_vertex:"#ifdef USE_SKINNING\n\tvec4 mvPosition = modelViewMatrix * skinned;\n#else\n\tvec4 mvPosition = modelViewMatrix * vec4( transformed, 1.0 );\n#endif\ngl_Position = projectionMatrix * mvPosition;\n",roughnessmap_fragment:"float roughnessFactor = roughness;\n#ifdef USE_ROUGHNESSMAP\n\tvec4 texelRoughness = texture2D( roughnessMap, vUv );\n\troughnessFactor *= texelRoughness.r;\n#endif\n",roughnessmap_pars_fragment:"#ifdef USE_ROUGHNESSMAP\n\tuniform sampler2D roughnessMap;\n#endif",shadowmap_pars_fragment:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\t\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHTS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHTS ];\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\t\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHTS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHTS ];\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\t\tuniform sampler2D pointShadowMap[ NUM_POINT_LIGHTS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHTS ];\n\t#endif\n\tfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n\t\treturn step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\n\t}\n\tfloat texture2DShadowLerp( sampler2D depths, vec2 size, vec2 uv, float compare ) {\n\t\tconst vec2 offset = vec2( 0.0, 1.0 );\n\t\tvec2 texelSize = vec2( 1.0 ) / size;\n\t\tvec2 centroidUV = floor( uv * size + 0.5 ) / size;\n\t\tfloat lb = texture2DCompare( depths, centroidUV + texelSize * offset.xx, compare );\n\t\tfloat lt = texture2DCompare( depths, centroidUV + texelSize * offset.xy, compare );\n\t\tfloat rb = texture2DCompare( depths, centroidUV + texelSize * offset.yx, compare );\n\t\tfloat rt = texture2DCompare( depths, centroidUV + texelSize * offset.yy, compare );\n\t\tvec2 f = fract( uv * size + 0.5 );\n\t\tfloat a = mix( lb, lt, f.y );\n\t\tfloat b = mix( rb, rt, f.y );\n\t\tfloat c = mix( a, b, f.x );\n\t\treturn c;\n\t}\n\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\tshadowCoord.z += shadowBias;\n\t\tbvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );\n\t\tbool inFrustum = all( inFrustumVec );\n\t\tbvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );\n\t\tbool frustumTest = all( frustumTestVec );\n\t\tif ( frustumTest ) {\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\treturn (\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\treturn (\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\treturn texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#endif\n\t\t}\n\t\treturn 1.0;\n\t}\n\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\n\t\tvec3 absV = abs( v );\n\t\tfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n\t\tabsV *= scaleToCube;\n\t\tv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n\t\tvec2 planar = v.xy;\n\t\tfloat almostATexel = 1.5 * texelSizeY;\n\t\tfloat almostOne = 1.0 - almostATexel;\n\t\tif ( absV.z >= almostOne ) {\n\t\t\tif ( v.z > 0.0 )\n\t\t\t\tplanar.x = 4.0 - v.x;\n\t\t} else if ( absV.x >= almostOne ) {\n\t\t\tfloat signX = sign( v.x );\n\t\t\tplanar.x = v.z * signX + 2.0 * signX;\n\t\t} else if ( absV.y >= almostOne ) {\n\t\t\tfloat signY = sign( v.y );\n\t\t\tplanar.x = v.x + 2.0 * signY + 2.0;\n\t\t\tplanar.y = v.z * signY - 2.0;\n\t\t}\n\t\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n\t}\n\tfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tvec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n\t\tvec3 lightToPosition = shadowCoord.xyz;\n\t\tvec3 bd3D = normalize( lightToPosition );\n\t\tfloat dp = ( length( lightToPosition ) - shadowBias ) / 1000.0;\n\t\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n\t\t\treturn (\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\treturn texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n\t\t#endif\n\t}\n#endif\n",shadowmap_pars_vertex:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHTS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHTS ];\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\t\tuniform mat4 spotShadowMatrix[ NUM_SPOT_LIGHTS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHTS ];\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\t\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHTS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHTS ];\n\t#endif\n#endif\n",shadowmap_vertex:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * worldPosition;\n\t}\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tvSpotShadowCoord[ i ] = spotShadowMatrix[ i ] * worldPosition;\n\t}\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * worldPosition;\n\t}\n\t#endif\n#endif\n",shadowmask_pars_fragment:"float getShadowMask() {\n\tfloat shadow = 1.0;\n\t#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\tDirectionalLight directionalLight;\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tshadow *= bool( directionalLight.shadow ) ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t}\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\tSpotLight spotLight;\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tshadow *= bool( spotLight.shadow ) ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t}\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\tPointLight pointLight;\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tshadow *= bool( pointLight.shadow ) ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ] ) : 1.0;\n\t}\n\t#endif\n\t#endif\n\treturn shadow;\n}\n",skinbase_vertex:"#ifdef USE_SKINNING\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n#endif",skinning_pars_vertex:"#ifdef USE_SKINNING\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\t#ifdef BONE_TEXTURE\n\t\tuniform sampler2D boneTexture;\n\t\tuniform int boneTextureWidth;\n\t\tuniform int boneTextureHeight;\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tfloat j = i * 4.0;\n\t\t\tfloat x = mod( j, float( boneTextureWidth ) );\n\t\t\tfloat y = floor( j / float( boneTextureWidth ) );\n\t\t\tfloat dx = 1.0 / float( boneTextureWidth );\n\t\t\tfloat dy = 1.0 / float( boneTextureHeight );\n\t\t\ty = dy * ( y + 0.5 );\n\t\t\tvec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\n\t\t\tvec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\n\t\t\tvec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\n\t\t\tvec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\n\t\t\tmat4 bone = mat4( v1, v2, v3, v4 );\n\t\t\treturn bone;\n\t\t}\n\t#else\n\t\tuniform mat4 boneMatrices[ MAX_BONES ];\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tmat4 bone = boneMatrices[ int(i) ];\n\t\t\treturn bone;\n\t\t}\n\t#endif\n#endif\n",skinning_vertex:"#ifdef USE_SKINNING\n\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n\tvec4 skinned = vec4( 0.0 );\n\tskinned += boneMatX * skinVertex * skinWeight.x;\n\tskinned += boneMatY * skinVertex * skinWeight.y;\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\tskinned += boneMatW * skinVertex * skinWeight.w;\n\tskinned  = bindMatrixInverse * skinned;\n#endif\n",skinnormal_vertex:"#ifdef USE_SKINNING\n\tmat4 skinMatrix = mat4( 0.0 );\n\tskinMatrix += skinWeight.x * boneMatX;\n\tskinMatrix += skinWeight.y * boneMatY;\n\tskinMatrix += skinWeight.z * boneMatZ;\n\tskinMatrix += skinWeight.w * boneMatW;\n\tskinMatrix  = bindMatrixInverse * skinMatrix * bindMatrix;\n\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n#endif\n",specularmap_fragment:"float specularStrength;\n#ifdef USE_SPECULARMAP\n\tvec4 texelSpecular = texture2D( specularMap, vUv );\n\tspecularStrength = texelSpecular.r;\n#else\n\tspecularStrength = 1.0;\n#endif",specularmap_pars_fragment:"#ifdef USE_SPECULARMAP\n\tuniform sampler2D specularMap;\n#endif",tonemapping_fragment:"#if defined( TONE_MAPPING )\n  gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n#endif\n",tonemapping_pars_fragment:"#define saturate(a) clamp( a, 0.0, 1.0 )\nuniform float toneMappingExposure;\nuniform float toneMappingWhitePoint;\nvec3 LinearToneMapping( vec3 color ) {\n  return toneMappingExposure * color;\n}\nvec3 ReinhardToneMapping( vec3 color ) {\n  color *= toneMappingExposure;\n  return saturate( color / ( vec3( 1.0 ) + color ) );\n}\n#define Uncharted2Helper( x ) max( ( ( x * ( 0.15 * x + 0.10 * 0.50 ) + 0.20 * 0.02 ) / ( x * ( 0.15 * x + 0.50 ) + 0.20 * 0.30 ) ) - 0.02 / 0.30, vec3( 0.0 ) )\nvec3 Uncharted2ToneMapping( vec3 color ) {\n  color *= toneMappingExposure;\n  return saturate( Uncharted2Helper( color ) / Uncharted2Helper( vec3( toneMappingWhitePoint ) ) );\n}\nvec3 OptimizedCineonToneMapping( vec3 color ) {\n  color *= toneMappingExposure;\n  color = max( vec3( 0.0 ), color - 0.004 );\n  return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n}\n",uv_pars_fragment:"#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP ) || defined( USE_ROUGHNESSMAP ) || defined( USE_METALNESSMAP )\n\tvarying vec2 vUv;\n#endif",uv_pars_vertex:"#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP ) || defined( USE_ROUGHNESSMAP ) || defined( USE_METALNESSMAP )\n\tvarying vec2 vUv;\n\tuniform vec4 offsetRepeat;\n#endif\n",uv_vertex:"#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP ) || defined( USE_ROUGHNESSMAP ) || defined( USE_METALNESSMAP )\n\tvUv = uv * offsetRepeat.zw + offsetRepeat.xy;\n#endif",uv2_pars_fragment:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvarying vec2 vUv2;\n#endif",uv2_pars_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tattribute vec2 uv2;\n\tvarying vec2 vUv2;\n#endif",uv2_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvUv2 = uv2;\n#endif",worldpos_vertex:"#if defined( USE_ENVMAP ) || defined( PHONG ) || defined( PHYSICAL ) || defined( LAMBERT ) || defined ( USE_SHADOWMAP )\n\t#ifdef USE_SKINNING\n\t\tvec4 worldPosition = modelMatrix * skinned;\n\t#else\n\t\tvec4 worldPosition = modelMatrix * vec4( transformed, 1.0 );\n\t#endif\n#endif\n",cube_frag:"uniform samplerCube tCube;\nuniform float tFlip;\nuniform float opacity;\nvarying vec3 vWorldPosition;\n#include <common>\nvoid main() {\n\tgl_FragColor = textureCube( tCube, vec3( tFlip * vWorldPosition.x, vWorldPosition.yz ) );\n\tgl_FragColor.a *= opacity;\n}\n",cube_vert:"varying vec3 vWorldPosition;\n#include <common>\nvoid main() {\n\tvWorldPosition = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n}\n",depth_frag:"#if DEPTH_PACKING == 3200\n\tuniform float opacity;\n#endif\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#if DEPTH_PACKING == 3200\n\t\tdiffuseColor.a = opacity;\n\t#endif\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <logdepthbuf_fragment>\n\t#if DEPTH_PACKING == 3200\n\t\tgl_FragColor = vec4( vec3( gl_FragCoord.z ), opacity );\n\t#elif DEPTH_PACKING == 3201\n\t\tgl_FragColor = packDepthToRGBA( gl_FragCoord.z );\n\t#endif\n}\n",depth_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#include <begin_vertex>\n\t#include <displacementmap_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n}\n",distanceRGBA_frag:"uniform vec3 lightPos;\nvarying vec4 vWorldPosition;\n#include <common>\n#include <packing>\n#include <clipping_planes_pars_fragment>\nvoid main () {\n\t#include <clipping_planes_fragment>\n\tgl_FragColor = packDepthToRGBA( length( vWorldPosition.xyz - lightPos.xyz ) / 1000.0 );\n}\n",distanceRGBA_vert:"varying vec4 vWorldPosition;\n#include <common>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <skinbase_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\tvWorldPosition = worldPosition;\n}\n",equirect_frag:"uniform sampler2D tEquirect;\nuniform float tFlip;\nvarying vec3 vWorldPosition;\n#include <common>\nvoid main() {\n\tvec3 direction = normalize( vWorldPosition );\n\tvec2 sampleUV;\n\tsampleUV.y = saturate( tFlip * direction.y * -0.5 + 0.5 );\n\tsampleUV.x = atan( direction.z, direction.x ) * RECIPROCAL_PI2 + 0.5;\n\tgl_FragColor = texture2D( tEquirect, sampleUV );\n}\n",equirect_vert:"varying vec3 vWorldPosition;\n#include <common>\nvoid main() {\n\tvWorldPosition = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n}\n",linedashed_frag:"uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\n\t\tdiscard;\n\t}\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <color_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}\n",linedashed_vert:"uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <color_vertex>\n\tvLineDistance = scale * lineDistance;\n\tvec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n}\n",meshbasic_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\tReflectedLight reflectedLight;\n\treflectedLight.directDiffuse = vec3( 0.0 );\n\treflectedLight.directSpecular = vec3( 0.0 );\n\treflectedLight.indirectDiffuse = diffuseColor.rgb;\n\treflectedLight.indirectSpecular = vec3( 0.0 );\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\n\t#include <normal_flip>\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}\n",meshbasic_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_ENVMAP\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <envmap_vertex>\n}\n",meshlambert_frag:"uniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\nvarying vec3 vLightFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n#endif\n#include <common>\n#include <packing>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <bsdfs>\n#include <lights_pars>\n#include <fog_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <emissivemap_fragment>\n\treflectedLight.indirectDiffuse = getAmbientLightIrradiance( ambientLightColor );\n\t#include <lightmap_fragment>\n\treflectedLight.indirectDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb );\n\t#ifdef DOUBLE_SIDED\n\t\treflectedLight.directDiffuse = ( gl_FrontFacing ) ? vLightFront : vLightBack;\n\t#else\n\t\treflectedLight.directDiffuse = vLightFront;\n\t#endif\n\treflectedLight.directDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb ) * getShadowMask();\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <normal_flip>\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}\n",meshlambert_vert:"#define LAMBERT\nvarying vec3 vLightFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <bsdfs>\n#include <lights_pars>\n#include <color_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <lights_lambert_vertex>\n\t#include <shadowmap_vertex>\n}\n",meshphong_frag:"#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_flip>\n\t#include <normal_fragment>\n\t#include <emissivemap_fragment>\n\t#include <lights_phong_fragment>\n\t#include <lights_template>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}\n",meshphong_vert:"#define PHONG\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif\n\t#include <begin_vertex>\n\t#include <displacementmap_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n}\n",meshphysical_frag:"#define PHYSICAL\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifndef STANDARD\n\tuniform float clearCoat;\n\tuniform float clearCoatRoughness;\n#endif\nuniform float envMapIntensity;\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <packing>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <cube_uv_reflection_fragment>\n#include <lights_pars>\n#include <lights_physical_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_flip>\n\t#include <normal_fragment>\n\t#include <emissivemap_fragment>\n\t#include <lights_physical_fragment>\n\t#include <lights_template>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}\n",meshphysical_vert:"#define PHYSICAL\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif\n\t#include <begin_vertex>\n\t#include <displacementmap_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n}\n",normal_frag:"uniform float opacity;\nvarying vec3 vNormal;\n#include <common>\n#include <packing>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tgl_FragColor = vec4( packNormalToRGB( vNormal ), opacity );\n\t#include <logdepthbuf_fragment>\n}\n",normal_vert:"varying vec3 vNormal;\n#include <common>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\tvNormal = normalize( normalMatrix * normal );\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n}\n",points_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <fog_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_particle_fragment>\n\t#include <color_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}\n",points_vert:"uniform float size;\nuniform float scale;\n#include <common>\n#include <color_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <color_vertex>\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\t#ifdef USE_SIZEATTENUATION\n\t\tgl_PointSize = size * ( scale / - mvPosition.z );\n\t#else\n\t\tgl_PointSize = size;\n\t#endif\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n}\n",shadow_frag:"uniform float opacity;\n#include <common>\n#include <packing>\n#include <bsdfs>\n#include <lights_pars>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\nvoid main() {\n\tgl_FragColor = vec4( 0.0, 0.0, 0.0, opacity * ( 1.0  - getShadowMask() ) );\n}\n",shadow_vert:"#include <shadowmap_pars_vertex>\nvoid main() {\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n}\n"};function pt(t,e,n){return void 0===e&&void 0===n?this.set(t):this.setRGB(t,e,n)}pt.prototype={constructor:pt,isColor:!0,r:1,g:1,b:1,set:function(t){return t&&t.isColor?this.copy(t):"number"==typeof t?this.setHex(t):"string"==typeof t&&this.setStyle(t),this},setScalar:function(t){this.r=t,this.g=t,this.b=t},setHex:function(t){return t=Math.floor(t),this.r=(t>>16&255)/255,this.g=(t>>8&255)/255,this.b=(255&t)/255,this},setRGB:function(t,e,n){return this.r=t,this.g=e,this.b=n,this},setHSL:function(){function e(t,e,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?t+6*(e-t)*n:n<.5?e:n<2/3?t+6*(e-t)*(2/3-n):t}return function(n,i,r){if(n=t.Math.euclideanModulo(n,1),i=t.Math.clamp(i,0,1),r=t.Math.clamp(r,0,1),0===i)this.r=this.g=this.b=r;else{var o=r<=.5?r*(1+i):r+i-r*i,a=2*r-o;this.r=e(a,o,n+1/3),this.g=e(a,o,n),this.b=e(a,o,n-1/3)}return this}}(),setStyle:function(e){function n(t){void 0!==t&&parseFloat(t)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}var i;if(i=/^((?:rgb|hsl)a?)\(\s*([^\)]*)\)/.exec(e)){var r,o=i[1],a=i[2];switch(o){case"rgb":case"rgba":if(r=/^(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(a))return this.r=Math.min(255,parseInt(r[1],10))/255,this.g=Math.min(255,parseInt(r[2],10))/255,this.b=Math.min(255,parseInt(r[3],10))/255,n(r[5]),this;if(r=/^(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(a))return this.r=Math.min(100,parseInt(r[1],10))/100,this.g=Math.min(100,parseInt(r[2],10))/100,this.b=Math.min(100,parseInt(r[3],10))/100,n(r[5]),this;break;case"hsl":case"hsla":if(r=/^([0-9]*\.?[0-9]+)\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(a)){var s=parseFloat(r[1])/360,c=parseInt(r[2],10)/100,l=parseInt(r[3],10)/100;return n(r[5]),this.setHSL(s,c,l)}}}else if(i=/^\#([A-Fa-f0-9]+)$/.exec(e)){var h,u=(h=i[1]).length;if(3===u)return this.r=parseInt(h.charAt(0)+h.charAt(0),16)/255,this.g=parseInt(h.charAt(1)+h.charAt(1),16)/255,this.b=parseInt(h.charAt(2)+h.charAt(2),16)/255,this;if(6===u)return this.r=parseInt(h.charAt(0)+h.charAt(1),16)/255,this.g=parseInt(h.charAt(2)+h.charAt(3),16)/255,this.b=parseInt(h.charAt(4)+h.charAt(5),16)/255,this}return e&&e.length>0&&(void 0!==(h=t.ColorKeywords[e])?this.setHex(h):console.warn("THREE.Color: Unknown color "+e)),this},clone:function(){return new this.constructor(this.r,this.g,this.b)},copy:function(t){return this.r=t.r,this.g=t.g,this.b=t.b,this},copyGammaToLinear:function(t,e){return void 0===e&&(e=2),this.r=Math.pow(t.r,e),this.g=Math.pow(t.g,e),this.b=Math.pow(t.b,e),this},copyLinearToGamma:function(t,e){void 0===e&&(e=2);var n=e>0?1/e:1;return this.r=Math.pow(t.r,n),this.g=Math.pow(t.g,n),this.b=Math.pow(t.b,n),this},convertGammaToLinear:function(){var t=this.r,e=this.g,n=this.b;return this.r=t*t,this.g=e*e,this.b=n*n,this},convertLinearToGamma:function(){return this.r=Math.sqrt(this.r),this.g=Math.sqrt(this.g),this.b=Math.sqrt(this.b),this},getHex:function(){return 255*this.r<<16^255*this.g<<8^255*this.b<<0},getHexString:function(){return("000000"+this.getHex().toString(16)).slice(-6)},getHSL:function(t){var e,n,i=t||{h:0,s:0,l:0},r=this.r,o=this.g,a=this.b,s=Math.max(r,o,a),c=Math.min(r,o,a),l=(c+s)/2;if(c===s)e=0,n=0;else{var h=s-c;switch(n=l<=.5?h/(s+c):h/(2-s-c),s){case r:e=(o-a)/h+(o<a?6:0);break;case o:e=(a-r)/h+2;break;case a:e=(r-o)/h+4}e/=6}return i.h=e,i.s=n,i.l=l,i},getStyle:function(){return"rgb("+(255*this.r|0)+","+(255*this.g|0)+","+(255*this.b|0)+")"},offsetHSL:function(t,e,n){var i=this.getHSL();return i.h+=t,i.s+=e,i.l+=n,this.setHSL(i.h,i.s,i.l),this},add:function(t){return this.r+=t.r,this.g+=t.g,this.b+=t.b,this},addColors:function(t,e){return this.r=t.r+e.r,this.g=t.g+e.g,this.b=t.b+e.b,this},addScalar:function(t){return this.r+=t,this.g+=t,this.b+=t,this},sub:function(t){return this.r=Math.max(0,this.r-t.r),this.g=Math.max(0,this.g-t.g),this.b=Math.max(0,this.b-t.b),this},multiply:function(t){return this.r*=t.r,this.g*=t.g,this.b*=t.b,this},multiplyScalar:function(t){return this.r*=t,this.g*=t,this.b*=t,this},lerp:function(t,e){return this.r+=(t.r-this.r)*e,this.g+=(t.g-this.g)*e,this.b+=(t.b-this.b)*e,this},equals:function(t){return t.r===this.r&&t.g===this.g&&t.b===this.b},fromArray:function(t,e){return void 0===e&&(e=0),this.r=t[e],this.g=t[e+1],this.b=t[e+2],this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this.r,t[e+1]=this.g,t[e+2]=this.b,t},toJSON:function(){return this.getHex()}},t.ColorKeywords={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};var ft={common:{diffuse:{value:new pt(15658734)},opacity:{value:1},map:{value:null},offsetRepeat:{value:new _(0,0,1,1)},specularMap:{value:null},alphaMap:{value:null},envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new d(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new pt(16777215)}},lights:{ambientLightColor:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{},shadow:{},shadowBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{},shadow:{},shadowBias:{},shadowRadius:{},shadowMapSize:{}}},spotShadowMap:{value:[]},spotShadowMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{},shadow:{},shadowBias:{},shadowRadius:{},shadowMapSize:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}}},points:{diffuse:{value:new pt(15658734)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},offsetRepeat:{value:new _(0,0,1,1)}}},mt={basic:{uniforms:t.UniformsUtils.merge([ft.common,ft.aomap,ft.fog]),vertexShader:dt.meshbasic_vert,fragmentShader:dt.meshbasic_frag},lambert:{uniforms:t.UniformsUtils.merge([ft.common,ft.aomap,ft.lightmap,ft.emissivemap,ft.fog,ft.lights,{emissive:{value:new pt(0)}}]),vertexShader:dt.meshlambert_vert,fragmentShader:dt.meshlambert_frag},phong:{uniforms:t.UniformsUtils.merge([ft.common,ft.aomap,ft.lightmap,ft.emissivemap,ft.bumpmap,ft.normalmap,ft.displacementmap,ft.fog,ft.lights,{emissive:{value:new pt(0)},specular:{value:new pt(1118481)},shininess:{value:30}}]),vertexShader:dt.meshphong_vert,fragmentShader:dt.meshphong_frag},standard:{uniforms:t.UniformsUtils.merge([ft.common,ft.aomap,ft.lightmap,ft.emissivemap,ft.bumpmap,ft.normalmap,ft.displacementmap,ft.roughnessmap,ft.metalnessmap,ft.fog,ft.lights,{emissive:{value:new pt(0)},roughness:{value:.5},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:dt.meshphysical_vert,fragmentShader:dt.meshphysical_frag},points:{uniforms:t.UniformsUtils.merge([ft.points,ft.fog]),vertexShader:dt.points_vert,fragmentShader:dt.points_frag},dashed:{uniforms:t.UniformsUtils.merge([ft.common,ft.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:dt.linedashed_vert,fragmentShader:dt.linedashed_frag},depth:{uniforms:t.UniformsUtils.merge([ft.common,ft.displacementmap]),vertexShader:dt.depth_vert,fragmentShader:dt.depth_frag},normal:{uniforms:{opacity:{value:1}},vertexShader:dt.normal_vert,fragmentShader:dt.normal_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:dt.cube_vert,fragmentShader:dt.cube_frag},equirect:{uniforms:{tEquirect:{value:null},tFlip:{value:-1}},vertexShader:dt.equirect_vert,fragmentShader:dt.equirect_frag},distanceRGBA:{uniforms:{lightPos:{value:new T}},vertexShader:dt.distanceRGBA_vert,fragmentShader:dt.distanceRGBA_frag}};function gt(t,e){this.min=void 0!==t?t:new d(1/0,1/0),this.max=void 0!==e?e:new d(-1/0,-1/0)}function vt(t,e){var n,i,r,o,a,s,c,l,h=t.context,u=t.state;function p(){var e=new Float32Array([-1,-1,0,0,1,-1,1,0,1,1,1,1,-1,1,0,1]),d=new Uint16Array([0,1,2,0,2,3]);n=h.createBuffer(),i=h.createBuffer(),h.bindBuffer(h.ARRAY_BUFFER,n),h.bufferData(h.ARRAY_BUFFER,e,h.STATIC_DRAW),h.bindBuffer(h.ELEMENT_ARRAY_BUFFER,i),h.bufferData(h.ELEMENT_ARRAY_BUFFER,d,h.STATIC_DRAW),c=h.createTexture(),l=h.createTexture(),u.bindTexture(h.TEXTURE_2D,c),h.texImage2D(h.TEXTURE_2D,0,h.RGB,16,16,0,h.RGB,h.UNSIGNED_BYTE,null),h.texParameteri(h.TEXTURE_2D,h.TEXTURE_WRAP_S,h.CLAMP_TO_EDGE),h.texParameteri(h.TEXTURE_2D,h.TEXTURE_WRAP_T,h.CLAMP_TO_EDGE),h.texParameteri(h.TEXTURE_2D,h.TEXTURE_MAG_FILTER,h.NEAREST),h.texParameteri(h.TEXTURE_2D,h.TEXTURE_MIN_FILTER,h.NEAREST),u.bindTexture(h.TEXTURE_2D,l),h.texImage2D(h.TEXTURE_2D,0,h.RGBA,16,16,0,h.RGBA,h.UNSIGNED_BYTE,null),h.texParameteri(h.TEXTURE_2D,h.TEXTURE_WRAP_S,h.CLAMP_TO_EDGE),h.texParameteri(h.TEXTURE_2D,h.TEXTURE_WRAP_T,h.CLAMP_TO_EDGE),h.texParameteri(h.TEXTURE_2D,h.TEXTURE_MAG_FILTER,h.NEAREST),h.texParameteri(h.TEXTURE_2D,h.TEXTURE_MIN_FILTER,h.NEAREST),r={vertexShader:["uniform lowp int renderType;","uniform vec3 screenPosition;","uniform vec2 scale;","uniform float rotation;","uniform sampler2D occlusionMap;","attribute vec2 position;","attribute vec2 uv;","varying vec2 vUV;","varying float vVisibility;","void main() {","vUV = uv;","vec2 pos = position;","if ( renderType == 2 ) {","vec4 visibility = texture2D( occlusionMap, vec2( 0.1, 0.1 ) );","visibility += texture2D( occlusionMap, vec2( 0.5, 0.1 ) );","visibility += texture2D( occlusionMap, vec2( 0.9, 0.1 ) );","visibility += texture2D( occlusionMap, vec2( 0.9, 0.5 ) );","visibility += texture2D( occlusionMap, vec2( 0.9, 0.9 ) );","visibility += texture2D( occlusionMap, vec2( 0.5, 0.9 ) );","visibility += texture2D( occlusionMap, vec2( 0.1, 0.9 ) );","visibility += texture2D( occlusionMap, vec2( 0.1, 0.5 ) );","visibility += texture2D( occlusionMap, vec2( 0.5, 0.5 ) );","vVisibility =        visibility.r / 9.0;","vVisibility *= 1.0 - visibility.g / 9.0;","vVisibility *=       visibility.b / 9.0;","vVisibility *= 1.0 - visibility.a / 9.0;","pos.x = cos( rotation ) * position.x - sin( rotation ) * position.y;","pos.y = sin( rotation ) * position.x + cos( rotation ) * position.y;","}","gl_Position = vec4( ( pos * scale + screenPosition.xy ).xy, screenPosition.z, 1.0 );","}"].join("\n"),fragmentShader:["uniform lowp int renderType;","uniform sampler2D map;","uniform float opacity;","uniform vec3 color;","varying vec2 vUV;","varying float vVisibility;","void main() {","if ( renderType == 0 ) {","gl_FragColor = vec4( 1.0, 0.0, 1.0, 0.0 );","} else if ( renderType == 1 ) {","gl_FragColor = texture2D( map, vUV );","} else {","vec4 texture = texture2D( map, vUV );","texture.a *= opacity * vVisibility;","gl_FragColor = texture;","gl_FragColor.rgb *= color;","}","}"].join("\n")},o=function(e){var n=h.createProgram(),i=h.createShader(h.FRAGMENT_SHADER),r=h.createShader(h.VERTEX_SHADER),o="precision "+t.getPrecision()+" float;\n";return h.shaderSource(i,o+e.fragmentShader),h.shaderSource(r,o+e.vertexShader),h.compileShader(i),h.compileShader(r),h.attachShader(n,i),h.attachShader(n,r),h.linkProgram(n),n}(r),a={vertex:h.getAttribLocation(o,"position"),uv:h.getAttribLocation(o,"uv")},s={renderType:h.getUniformLocation(o,"renderType"),map:h.getUniformLocation(o,"map"),occlusionMap:h.getUniformLocation(o,"occlusionMap"),opacity:h.getUniformLocation(o,"opacity"),color:h.getUniformLocation(o,"color"),scale:h.getUniformLocation(o,"scale"),rotation:h.getUniformLocation(o,"rotation"),screenPosition:h.getUniformLocation(o,"screenPosition")}}this.render=function(r,f,m){if(0!==e.length){var g=new T,v=m.w/m.z,y=.5*m.z,b=.5*m.w,x=16/m.w,w=new d(x*v,x),_=new T(1,1,0),S=new d(1,1),E=new gt;E.min.set(0,0),E.max.set(m.z-16,m.w-16),void 0===o&&p(),h.useProgram(o),u.initAttributes(),u.enableAttribute(a.vertex),u.enableAttribute(a.uv),u.disableUnusedAttributes(),h.uniform1i(s.occlusionMap,0),h.uniform1i(s.map,1),h.bindBuffer(h.ARRAY_BUFFER,n),h.vertexAttribPointer(a.vertex,2,h.FLOAT,!1,16,0),h.vertexAttribPointer(a.uv,2,h.FLOAT,!1,16,8),h.bindBuffer(h.ELEMENT_ARRAY_BUFFER,i),u.disable(h.CULL_FACE),u.setDepthWrite(!1);for(var A=0,M=e.length;A<M;A++){x=16/m.w,w.set(x*v,x);var C=e[A];if(g.set(C.matrixWorld.elements[12],C.matrixWorld.elements[13],C.matrixWorld.elements[14]),g.applyMatrix4(f.matrixWorldInverse),g.applyProjection(f.projectionMatrix),_.copy(g),S.x=m.x+_.x*y+y-8,S.y=m.y+_.y*b+b-8,!0===E.containsPoint(S)){u.activeTexture(h.TEXTURE0),u.bindTexture(h.TEXTURE_2D,null),u.activeTexture(h.TEXTURE1),u.bindTexture(h.TEXTURE_2D,c),h.copyTexImage2D(h.TEXTURE_2D,0,h.RGB,S.x,S.y,16,16,0),h.uniform1i(s.renderType,0),h.uniform2f(s.scale,w.x,w.y),h.uniform3f(s.screenPosition,_.x,_.y,_.z),u.disable(h.BLEND),u.enable(h.DEPTH_TEST),h.drawElements(h.TRIANGLES,6,h.UNSIGNED_SHORT,0),u.activeTexture(h.TEXTURE0),u.bindTexture(h.TEXTURE_2D,l),h.copyTexImage2D(h.TEXTURE_2D,0,h.RGBA,S.x,S.y,16,16,0),h.uniform1i(s.renderType,1),u.disable(h.DEPTH_TEST),u.activeTexture(h.TEXTURE1),u.bindTexture(h.TEXTURE_2D,c),h.drawElements(h.TRIANGLES,6,h.UNSIGNED_SHORT,0),C.positionScreen.copy(_),C.customUpdateCallback?C.customUpdateCallback(C):C.updateLensFlares(),h.uniform1i(s.renderType,2),u.enable(h.BLEND);for(var P=0,R=C.lensFlares.length;P<R;P++){var L=C.lensFlares[P];L.opacity>.001&&L.scale>.001&&(_.x=L.x,_.y=L.y,_.z=L.z,x=L.size*L.scale/m.w,w.x=x*v,w.y=x,h.uniform3f(s.screenPosition,_.x,_.y,_.z),h.uniform2f(s.scale,w.x,w.y),h.uniform1f(s.rotation,L.rotation),h.uniform1f(s.opacity,L.opacity),h.uniform3f(s.color,L.color.r,L.color.g,L.color.b),u.setBlending(L.blending,L.blendEquation,L.blendSrc,L.blendDst),t.setTexture2D(L.texture,1),h.drawElements(h.TRIANGLES,6,h.UNSIGNED_SHORT,0))}}}u.enable(h.CULL_FACE),u.enable(h.DEPTH_TEST),u.setDepthWrite(!0),t.resetGLState()}}}function yt(t,e){var n,i,r,o,a,s,c=t.context,l=t.state,h=new T,u=new A,d=new T;function f(){var e=new Float32Array([-.5,-.5,0,0,.5,-.5,1,0,.5,.5,1,1,-.5,.5,0,1]),l=new Uint16Array([0,1,2,0,2,3]);n=c.createBuffer(),i=c.createBuffer(),c.bindBuffer(c.ARRAY_BUFFER,n),c.bufferData(c.ARRAY_BUFFER,e,c.STATIC_DRAW),c.bindBuffer(c.ELEMENT_ARRAY_BUFFER,i),c.bufferData(c.ELEMENT_ARRAY_BUFFER,l,c.STATIC_DRAW),r=function(){var e=c.createProgram(),n=c.createShader(c.VERTEX_SHADER),i=c.createShader(c.FRAGMENT_SHADER);return c.shaderSource(n,["precision "+t.getPrecision()+" float;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform float rotation;","uniform vec2 scale;","uniform vec2 uvOffset;","uniform vec2 uvScale;","attribute vec2 position;","attribute vec2 uv;","varying vec2 vUV;","void main() {","vUV = uvOffset + uv * uvScale;","vec2 alignedPosition = position * scale;","vec2 rotatedPosition;","rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;","rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;","vec4 finalPosition;","finalPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );","finalPosition.xy += rotatedPosition;","finalPosition = projectionMatrix * finalPosition;","gl_Position = finalPosition;","}"].join("\n")),c.shaderSource(i,["precision "+t.getPrecision()+" float;","uniform vec3 color;","uniform sampler2D map;","uniform float opacity;","uniform int fogType;","uniform vec3 fogColor;","uniform float fogDensity;","uniform float fogNear;","uniform float fogFar;","uniform float alphaTest;","varying vec2 vUV;","void main() {","vec4 texture = texture2D( map, vUV );","if ( texture.a < alphaTest ) discard;","gl_FragColor = vec4( color * texture.xyz, texture.a * opacity );","if ( fogType > 0 ) {","float depth = gl_FragCoord.z / gl_FragCoord.w;","float fogFactor = 0.0;","if ( fogType == 1 ) {","fogFactor = smoothstep( fogNear, fogFar, depth );","} else {","const float LOG2 = 1.442695;","fogFactor = exp2( - fogDensity * fogDensity * depth * depth * LOG2 );","fogFactor = 1.0 - clamp( fogFactor, 0.0, 1.0 );","}","gl_FragColor = mix( gl_FragColor, vec4( fogColor, gl_FragColor.w ), fogFactor );","}","}"].join("\n")),c.compileShader(n),c.compileShader(i),c.attachShader(e,n),c.attachShader(e,i),c.linkProgram(e),e}(),o={position:c.getAttribLocation(r,"position"),uv:c.getAttribLocation(r,"uv")},a={uvOffset:c.getUniformLocation(r,"uvOffset"),uvScale:c.getUniformLocation(r,"uvScale"),rotation:c.getUniformLocation(r,"rotation"),scale:c.getUniformLocation(r,"scale"),color:c.getUniformLocation(r,"color"),map:c.getUniformLocation(r,"map"),opacity:c.getUniformLocation(r,"opacity"),modelViewMatrix:c.getUniformLocation(r,"modelViewMatrix"),projectionMatrix:c.getUniformLocation(r,"projectionMatrix"),fogType:c.getUniformLocation(r,"fogType"),fogDensity:c.getUniformLocation(r,"fogDensity"),fogNear:c.getUniformLocation(r,"fogNear"),fogFar:c.getUniformLocation(r,"fogFar"),fogColor:c.getUniformLocation(r,"fogColor"),alphaTest:c.getUniformLocation(r,"alphaTest")};var h=document.createElementNS("http://www.w3.org/1999/xhtml","canvas");h.width=8,h.height=8;var u=h.getContext("2d");u.fillStyle="white",u.fillRect(0,0,8,8),(s=new p(h)).needsUpdate=!0}function m(t,e){return t.renderOrder!==e.renderOrder?t.renderOrder-e.renderOrder:t.z!==e.z?e.z-t.z:e.id-t.id}this.render=function(p,g){if(0!==e.length){void 0===r&&f(),c.useProgram(r),l.initAttributes(),l.enableAttribute(o.position),l.enableAttribute(o.uv),l.disableUnusedAttributes(),l.disable(c.CULL_FACE),l.enable(c.BLEND),c.bindBuffer(c.ARRAY_BUFFER,n),c.vertexAttribPointer(o.position,2,c.FLOAT,!1,16,0),c.vertexAttribPointer(o.uv,2,c.FLOAT,!1,16,8),c.bindBuffer(c.ELEMENT_ARRAY_BUFFER,i),c.uniformMatrix4fv(a.projectionMatrix,!1,g.projectionMatrix.elements),l.activeTexture(c.TEXTURE0),c.uniform1i(a.map,0);var v=0,y=0,b=p.fog;b?(c.uniform3f(a.fogColor,b.color.r,b.color.g,b.color.b),b&&b.isFog?(c.uniform1f(a.fogNear,b.near),c.uniform1f(a.fogFar,b.far),c.uniform1i(a.fogType,1),v=1,y=1):b&&b.isFogExp2&&(c.uniform1f(a.fogDensity,b.density),c.uniform1i(a.fogType,2),v=2,y=2)):(c.uniform1i(a.fogType,0),v=0,y=0);for(var x=0,w=e.length;x<w;x++)(S=e[x]).modelViewMatrix.multiplyMatrices(g.matrixWorldInverse,S.matrixWorld),S.z=-S.modelViewMatrix.elements[14];e.sort(m);var _=[];for(x=0,w=e.length;x<w;x++){var S,E=(S=e[x]).material;if(!1!==E.visible){c.uniform1f(a.alphaTest,E.alphaTest),c.uniformMatrix4fv(a.modelViewMatrix,!1,S.modelViewMatrix.elements),S.matrixWorld.decompose(h,u,d),_[0]=d.x,_[1]=d.y;var A=0;p.fog&&E.fog&&(A=y),v!==A&&(c.uniform1i(a.fogType,A),v=A),null!==E.map?(c.uniform2f(a.uvOffset,E.map.offset.x,E.map.offset.y),c.uniform2f(a.uvScale,E.map.repeat.x,E.map.repeat.y)):(c.uniform2f(a.uvOffset,0,0),c.uniform2f(a.uvScale,1,1)),c.uniform1f(a.opacity,E.opacity),c.uniform3f(a.color,E.color.r,E.color.g,E.color.b),c.uniform1f(a.rotation,E.rotation),c.uniform2fv(a.scale,_),l.setBlending(E.blending,E.blendEquation,E.blendSrc,E.blendDst),l.setDepthTest(E.depthTest),l.setDepthWrite(E.depthWrite),E.map?t.setTexture2D(E.map,0):t.setTexture2D(s,0),c.drawElements(c.TRIANGLES,6,c.UNSIGNED_SHORT,0)}}l.enable(c.CULL_FACE),t.resetGLState()}}}function bt(){Object.defineProperty(this,"id",{value:Ft()}),this.uuid=t.Math.generateUUID(),this.name="",this.type="Material",this.fog=!0,this.lights=!0,this.blending=1,this.side=0,this.shading=2,this.vertexColors=0,this.opacity=1,this.transparent=!1,this.blendSrc=204,this.blendDst=205,this.blendEquation=100,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=3,this.depthTest=!0,this.depthWrite=!0,this.clippingPlanes=null,this.clipShadows=!1,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.alphaTest=0,this.premultipliedAlpha=!1,this.overdraw=0,this.visible=!0,this._needsUpdate=!0}mt.physical={uniforms:t.UniformsUtils.merge([mt.standard.uniforms,{clearCoat:{value:0},clearCoatRoughness:{value:0}}]),vertexShader:dt.meshphysical_vert,fragmentShader:dt.meshphysical_frag},gt.prototype={constructor:gt,set:function(t,e){return this.min.copy(t),this.max.copy(e),this},setFromPoints:function(t){this.makeEmpty();for(var e=0,n=t.length;e<n;e++)this.expandByPoint(t[e]);return this},setFromCenterAndSize:function(){var t=new d;return function(e,n){var i=t.copy(n).multiplyScalar(.5);return this.min.copy(e).sub(i),this.max.copy(e).add(i),this}}(),clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.min.copy(t.min),this.max.copy(t.max),this},makeEmpty:function(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y},getCenter:function(t){var e=t||new d;return this.isEmpty()?e.set(0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)},getSize:function(t){var e=t||new d;return this.isEmpty()?e.set(0,0):e.subVectors(this.max,this.min)},expandByPoint:function(t){return this.min.min(t),this.max.max(t),this},expandByVector:function(t){return this.min.sub(t),this.max.add(t),this},expandByScalar:function(t){return this.min.addScalar(-t),this.max.addScalar(t),this},containsPoint:function(t){return!(t.x<this.min.x||t.x>this.max.x||t.y<this.min.y||t.y>this.max.y)},containsBox:function(t){return this.min.x<=t.min.x&&t.max.x<=this.max.x&&this.min.y<=t.min.y&&t.max.y<=this.max.y},getParameter:function(t,e){return(e||new d).set((t.x-this.min.x)/(this.max.x-this.min.x),(t.y-this.min.y)/(this.max.y-this.min.y))},intersectsBox:function(t){return!(t.max.x<this.min.x||t.min.x>this.max.x||t.max.y<this.min.y||t.min.y>this.max.y)},clampPoint:function(t,e){return(e||new d).copy(t).clamp(this.min,this.max)},distanceToPoint:function(){var t=new d;return function(e){return t.copy(e).clamp(this.min,this.max).sub(e).length()}}(),intersect:function(t){return this.min.max(t.min),this.max.min(t.max),this},union:function(t){return this.min.min(t.min),this.max.max(t.max),this},translate:function(t){return this.min.add(t),this.max.add(t),this},equals:function(t){return t.min.equals(this.min)&&t.max.equals(this.max)}},bt.prototype={constructor:bt,isMaterial:!0,get needsUpdate(){return this._needsUpdate},set needsUpdate(t){!0===t&&this.update(),this._needsUpdate=t},setValues:function(t){if(void 0!==t)for(var e in t){var n=t[e];if(void 0!==n){var i=this[e];void 0!==i?i&&i.isColor?i.set(n):i&&i.isVector3&&n&&n.isVector3?i.copy(n):this[e]="overdraw"===e?Number(n):n:console.warn("THREE."+this.type+": '"+e+"' is not a property of this material.")}else console.warn("THREE.Material: '"+e+"' parameter is undefined.")}},toJSON:function(t){var e=void 0===t;e&&(t={textures:{},images:{}});var n={metadata:{version:4.4,type:"Material",generator:"Material.toJSON"}};function i(t){var e=[];for(var n in t){var i=t[n];delete i.metadata,e.push(i)}return e}if(n.uuid=this.uuid,n.type=this.type,""!==this.name&&(n.name=this.name),this.color&&this.color.isColor&&(n.color=this.color.getHex()),void 0!==this.roughness&&(n.roughness=this.roughness),void 0!==this.metalness&&(n.metalness=this.metalness),this.emissive&&this.emissive.isColor&&(n.emissive=this.emissive.getHex()),this.specular&&this.specular.isColor&&(n.specular=this.specular.getHex()),void 0!==this.shininess&&(n.shininess=this.shininess),this.map&&this.map.isTexture&&(n.map=this.map.toJSON(t).uuid),this.alphaMap&&this.alphaMap.isTexture&&(n.alphaMap=this.alphaMap.toJSON(t).uuid),this.lightMap&&this.lightMap.isTexture&&(n.lightMap=this.lightMap.toJSON(t).uuid),this.bumpMap&&this.bumpMap.isTexture&&(n.bumpMap=this.bumpMap.toJSON(t).uuid,n.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(n.normalMap=this.normalMap.toJSON(t).uuid,n.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(n.displacementMap=this.displacementMap.toJSON(t).uuid,n.displacementScale=this.displacementScale,n.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(n.roughnessMap=this.roughnessMap.toJSON(t).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(n.metalnessMap=this.metalnessMap.toJSON(t).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(n.emissiveMap=this.emissiveMap.toJSON(t).uuid),this.specularMap&&this.specularMap.isTexture&&(n.specularMap=this.specularMap.toJSON(t).uuid),this.envMap&&this.envMap.isTexture&&(n.envMap=this.envMap.toJSON(t).uuid,n.reflectivity=this.reflectivity),void 0!==this.size&&(n.size=this.size),void 0!==this.sizeAttenuation&&(n.sizeAttenuation=this.sizeAttenuation),1!==this.blending&&(n.blending=this.blending),2!==this.shading&&(n.shading=this.shading),0!==this.side&&(n.side=this.side),0!==this.vertexColors&&(n.vertexColors=this.vertexColors),this.opacity<1&&(n.opacity=this.opacity),!0===this.transparent&&(n.transparent=this.transparent),n.depthFunc=this.depthFunc,n.depthTest=this.depthTest,n.depthWrite=this.depthWrite,this.alphaTest>0&&(n.alphaTest=this.alphaTest),!0===this.premultipliedAlpha&&(n.premultipliedAlpha=this.premultipliedAlpha),!0===this.wireframe&&(n.wireframe=this.wireframe),this.wireframeLinewidth>1&&(n.wireframeLinewidth=this.wireframeLinewidth),"round"!==this.wireframeLinecap&&(n.wireframeLinecap=this.wireframeLinecap),"round"!==this.wireframeLinejoin&&(n.wireframeLinejoin=this.wireframeLinejoin),n.skinning=this.skinning,n.morphTargets=this.morphTargets,e){var r=i(t.textures),o=i(t.images);r.length>0&&(n.textures=r),o.length>0&&(n.images=o)}return n},clone:function(){return(new this.constructor).copy(this)},copy:function(t){this.name=t.name,this.fog=t.fog,this.lights=t.lights,this.blending=t.blending,this.side=t.side,this.shading=t.shading,this.vertexColors=t.vertexColors,this.opacity=t.opacity,this.transparent=t.transparent,this.blendSrc=t.blendSrc,this.blendDst=t.blendDst,this.blendEquation=t.blendEquation,this.blendSrcAlpha=t.blendSrcAlpha,this.blendDstAlpha=t.blendDstAlpha,this.blendEquationAlpha=t.blendEquationAlpha,this.depthFunc=t.depthFunc,this.depthTest=t.depthTest,this.depthWrite=t.depthWrite,this.colorWrite=t.colorWrite,this.precision=t.precision,this.polygonOffset=t.polygonOffset,this.polygonOffsetFactor=t.polygonOffsetFactor,this.polygonOffsetUnits=t.polygonOffsetUnits,this.alphaTest=t.alphaTest,this.premultipliedAlpha=t.premultipliedAlpha,this.overdraw=t.overdraw,this.visible=t.visible,this.clipShadows=t.clipShadows;var e=t.clippingPlanes,n=null;if(null!==e){var i=e.length;n=new Array(i);for(var r=0;r!==i;++r)n[r]=e[r].clone()}return this.clippingPlanes=n,this},update:function(){this.dispatchEvent({type:"update"})},dispose:function(){this.dispatchEvent({type:"dispose"})}},Object.assign(bt.prototype,e.prototype);var xt,wt,_t,St,Et,At,Tt,Mt,Ct,Pt,Rt,Lt,kt,It,Dt,Ot=0;function Ft(){return Ot++}function Nt(t){bt.call(this),this.type="ShaderMaterial",this.defines={},this.uniforms={},this.vertexShader="void main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",this.fragmentShader="void main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}",this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,void 0!==t&&(void 0!==t.attributes&&console.error("THREE.ShaderMaterial: attributes should now be defined in THREE.BufferGeometry instead."),this.setValues(t))}function Ut(t){bt.call(this),this.type="MeshDepthMaterial",this.depthPacking=3200,this.skinning=!1,this.morphTargets=!1,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.setValues(t)}function jt(t,e){this.min=void 0!==t?t:new T(1/0,1/0,1/0),this.max=void 0!==e?e:new T(-1/0,-1/0,-1/0)}function Bt(t,e){this.center=void 0!==t?t:new T,this.radius=void 0!==e?e:0}function zt(){this.elements=new Float32Array([1,0,0,0,1,0,0,0,1]),arguments.length>0&&console.error("THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.")}function Ht(t,e){this.normal=void 0!==t?t:new T(1,0,0),this.constant=void 0!==e?e:0}function Gt(t,e,n,i,r,o){this.planes=[void 0!==t?t:new Ht,void 0!==e?e:new Ht,void 0!==n?n:new Ht,void 0!==i?i:new Ht,void 0!==r?r:new Ht,void 0!==o?o:new Ht]}function Vt(e,n,i,r){var o=e.context,a=e.state,s=new Gt,c=new M,l=n.shadows,h=new d,u=new d(r.maxTextureSize,r.maxTextureSize),p=new T,f=new T,m=[],g=new Array(4),v=new Array(4),y={},b=[new T(1,0,0),new T(-1,0,0),new T(0,0,1),new T(0,0,-1),new T(0,1,0),new T(0,-1,0)],x=[new T(0,1,0),new T(0,1,0),new T(0,1,0),new T(0,1,0),new T(0,0,1),new T(0,0,-1)],w=[new _,new _,new _,new _,new _,new _],E=new Ut;E.depthPacking=3201,E.clipping=!0;for(var A=mt.distanceRGBA,C=t.UniformsUtils.clone(A.uniforms),P=0;4!==P;++P){var R=0!=(1&P),L=0!=(2&P),k=E.clone();k.morphTargets=R,k.skinning=L,g[P]=k;var I=new Nt({defines:{USE_SHADOWMAP:""},uniforms:C,vertexShader:A.vertexShader,fragmentShader:A.fragmentShader,morphTargets:R,skinning:L,clipping:!0});v[P]=I}var D=this;function O(t,n,i,r){var o=t.geometry,a=null,s=g,c=t.customDepthMaterial;if(i&&(s=v,c=t.customDistanceMaterial),c)a=c;else{var l=!1;n.morphTargets&&(o&&o.isBufferGeometry?l=o.morphAttributes&&o.morphAttributes.position&&o.morphAttributes.position.length>0:o&&o.isGeometry&&(l=o.morphTargets&&o.morphTargets.length>0));var h=0;l&&(h|=1),t.isSkinnedMesh&&n.skinning&&(h|=2),a=s[h]}if(e.localClippingEnabled&&!0===n.clipShadows&&0!==n.clippingPlanes.length){var u=a.uuid,d=n.uuid,p=y[u];void 0===p&&(p={},y[u]=p);var f=p[d];void 0===f&&(f=a.clone(),p[d]=f),a=f}a.visible=n.visible,a.wireframe=n.wireframe;var m=n.side;return D.renderSingleSided&&2==m&&(m=0),D.renderReverseSided&&(0===m?m=1:1===m&&(m=0)),a.side=m,a.clipShadows=n.clipShadows,a.clippingPlanes=n.clippingPlanes,a.wireframeLinewidth=n.wireframeLinewidth,a.linewidth=n.linewidth,i&&void 0!==a.uniforms.lightPos&&a.uniforms.lightPos.value.copy(r),a}function F(t,e,n){if(!1!==t.visible){0!=(t.layers.mask&e.layers.mask)&&(t.isMesh||t.isLine||t.isPoints)&&(!t.castShadow||!1!==t.frustumCulled&&!0!==s.intersectsObject(t)||!0===t.material.visible&&(t.modelViewMatrix.multiplyMatrices(n.matrixWorldInverse,t.matrixWorld),m.push(t)));for(var i=t.children,r=0,o=i.length;r<o;r++)F(i[r],e,n)}}this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=1,this.renderReverseSided=!0,this.renderSingleSided=!0,this.render=function(t,n){if(!1!==D.enabled&&(!1!==D.autoUpdate||!1!==D.needsUpdate)&&0!==l.length){var r,d;a.clearColor(1,1,1,1),a.disable(o.BLEND),a.setDepthTest(!0),a.setScissorTest(!1);for(var g=0,v=l.length;g<v;g++){var y=l[g],_=y.shadow;if(void 0!==_){var E=_.camera;if(h.copy(_.mapSize),h.min(u),y&&y.isPointLight){r=6,d=!0;var A=h.x,T=h.y;w[0].set(2*A,T,A,T),w[1].set(0,T,A,T),w[2].set(3*A,T,A,T),w[3].set(A,T,A,T),w[4].set(3*A,0,A,T),w[5].set(A,0,A,T),h.x*=4,h.y*=2}else r=1,d=!1;if(null===_.map){var M={minFilter:1003,magFilter:1003,format:1023};_.map=new S(h.x,h.y,M),E.updateProjectionMatrix()}_&&_.isSpotLightShadow&&_.update(y);var C=_.map,P=_.matrix;f.setFromMatrixPosition(y.matrixWorld),E.position.copy(f),e.setRenderTarget(C),e.clear();for(var R=0;R<r;R++){if(d){p.copy(E.position),p.add(b[R]),E.up.copy(x[R]),E.lookAt(p);var L=w[R];a.viewport(L)}else p.setFromMatrixPosition(y.target.matrixWorld),E.lookAt(p);E.updateMatrixWorld(),E.matrixWorldInverse.getInverse(E.matrixWorld),P.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),P.multiply(E.projectionMatrix),P.multiply(E.matrixWorldInverse),c.multiplyMatrices(E.projectionMatrix,E.matrixWorldInverse),s.setFromMatrix(c),m.length=0,F(t,n,E);for(var k=0,I=m.length;k<I;k++){var N=m[k],U=i.update(N),j=N.material;if(j&&j.isMultiMaterial)for(var B=U.groups,z=j.materials,H=0,G=B.length;H<G;H++){var V=B[H],W=z[V.materialIndex];if(!0===W.visible){var X=O(N,W,d,f);e.renderBufferDirect(E,null,U,X,N,V)}}else X=O(N,j,d,f),e.renderBufferDirect(E,null,U,X,N,null)}}}else console.warn("THREE.WebGLShadowMap:",y,"has no shadow.")}var q=e.getClearColor(),Y=e.getClearAlpha();e.setClearColor(q,Y),D.needsUpdate=!1}}}function Wt(t,e){this.origin=void 0!==t?t:new T,this.direction=void 0!==e?e:new T}function Xt(t,e,n,i){this._x=t||0,this._y=e||0,this._z=n||0,this._order=i||Xt.DefaultOrder}function qt(){this.mask=1}function Yt(){Object.defineProperty(this,"id",{value:te()}),this.uuid=t.Math.generateUUID(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=Yt.DefaultUp.clone();var e=new T,n=new Xt,i=new A,r=new T(1,1,1);n.onChange((function(){i.setFromEuler(n,!1)})),i.onChange((function(){n.setFromQuaternion(i,void 0,!1)})),Object.defineProperties(this,{position:{enumerable:!0,value:e},rotation:{enumerable:!0,value:n},quaternion:{enumerable:!0,value:i},scale:{enumerable:!0,value:r},modelViewMatrix:{value:new M},normalMatrix:{value:new zt}}),this.matrix=new M,this.matrixWorld=new M,this.matrixAutoUpdate=Yt.DefaultMatrixAutoUpdate,this.matrixWorldNeedsUpdate=!1,this.layers=new qt,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.userData={},this.onBeforeRender=null}Nt.prototype=Object.create(bt.prototype),Nt.prototype.constructor=Nt,Nt.prototype.isShaderMaterial=!0,Nt.prototype.copy=function(e){return bt.prototype.copy.call(this,e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=t.UniformsUtils.clone(e.uniforms),this.defines=e.defines,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.lights=e.lights,this.clipping=e.clipping,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this.extensions=e.extensions,this},Nt.prototype.toJSON=function(t){var e=bt.prototype.toJSON.call(this,t);return e.uniforms=this.uniforms,e.vertexShader=this.vertexShader,e.fragmentShader=this.fragmentShader,e},Ut.prototype=Object.create(bt.prototype),Ut.prototype.constructor=Ut,Ut.prototype.isMeshDepthMaterial=!0,Ut.prototype.copy=function(t){return bt.prototype.copy.call(this,t),this.depthPacking=t.depthPacking,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.map=t.map,this.alphaMap=t.alphaMap,this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this},jt.prototype={constructor:jt,isBox3:!0,set:function(t,e){return this.min.copy(t),this.max.copy(e),this},setFromArray:function(t){for(var e=1/0,n=1/0,i=1/0,r=-1/0,o=-1/0,a=-1/0,s=0,c=t.length;s<c;s+=3){var l=t[s],h=t[s+1],u=t[s+2];l<e&&(e=l),h<n&&(n=h),u<i&&(i=u),l>r&&(r=l),h>o&&(o=h),u>a&&(a=u)}this.min.set(e,n,i),this.max.set(r,o,a)},setFromPoints:function(t){this.makeEmpty();for(var e=0,n=t.length;e<n;e++)this.expandByPoint(t[e]);return this},setFromCenterAndSize:function(){var t=new T;return function(e,n){var i=t.copy(n).multiplyScalar(.5);return this.min.copy(e).sub(i),this.max.copy(e).add(i),this}}(),setFromObject:function(){var t=new T;return function(e){var n=this;return e.updateMatrixWorld(!0),this.makeEmpty(),e.traverse((function(e){var i=e.geometry;if(void 0!==i)if(i&&i.isGeometry)for(var r=i.vertices,o=0,a=r.length;o<a;o++)t.copy(r[o]),t.applyMatrix4(e.matrixWorld),n.expandByPoint(t);else if(i&&i.isBufferGeometry){var s,c,l,h=i.attributes.position;if(void 0!==h)for(h&&h.isInterleavedBufferAttribute?(s=h.data.array,c=h.offset,l=h.data.stride):(s=h.array,c=0,l=3),o=c,a=s.length;o<a;o+=l)t.fromArray(s,o),t.applyMatrix4(e.matrixWorld),n.expandByPoint(t)}})),this}}(),clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.min.copy(t.min),this.max.copy(t.max),this},makeEmpty:function(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z},getCenter:function(t){var e=t||new T;return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)},getSize:function(t){var e=t||new T;return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)},expandByPoint:function(t){return this.min.min(t),this.max.max(t),this},expandByVector:function(t){return this.min.sub(t),this.max.add(t),this},expandByScalar:function(t){return this.min.addScalar(-t),this.max.addScalar(t),this},containsPoint:function(t){return!(t.x<this.min.x||t.x>this.max.x||t.y<this.min.y||t.y>this.max.y||t.z<this.min.z||t.z>this.max.z)},containsBox:function(t){return this.min.x<=t.min.x&&t.max.x<=this.max.x&&this.min.y<=t.min.y&&t.max.y<=this.max.y&&this.min.z<=t.min.z&&t.max.z<=this.max.z},getParameter:function(t,e){return(e||new T).set((t.x-this.min.x)/(this.max.x-this.min.x),(t.y-this.min.y)/(this.max.y-this.min.y),(t.z-this.min.z)/(this.max.z-this.min.z))},intersectsBox:function(t){return!(t.max.x<this.min.x||t.min.x>this.max.x||t.max.y<this.min.y||t.min.y>this.max.y||t.max.z<this.min.z||t.min.z>this.max.z)},intersectsSphere:function(t){return void 0===Dt&&(Dt=new T),this.clampPoint(t.center,Dt),Dt.distanceToSquared(t.center)<=t.radius*t.radius},intersectsPlane:function(t){var e,n;return t.normal.x>0?(e=t.normal.x*this.min.x,n=t.normal.x*this.max.x):(e=t.normal.x*this.max.x,n=t.normal.x*this.min.x),t.normal.y>0?(e+=t.normal.y*this.min.y,n+=t.normal.y*this.max.y):(e+=t.normal.y*this.max.y,n+=t.normal.y*this.min.y),t.normal.z>0?(e+=t.normal.z*this.min.z,n+=t.normal.z*this.max.z):(e+=t.normal.z*this.max.z,n+=t.normal.z*this.min.z),e<=t.constant&&n>=t.constant},clampPoint:function(t,e){return(e||new T).copy(t).clamp(this.min,this.max)},distanceToPoint:function(){var t=new T;return function(e){return t.copy(e).clamp(this.min,this.max).sub(e).length()}}(),getBoundingSphere:function(){var t=new T;return function(e){var n=e||new Bt;return this.getCenter(n.center),n.radius=.5*this.size(t).length(),n}}(),intersect:function(t){return this.min.max(t.min),this.max.min(t.max),this.isEmpty()&&this.makeEmpty(),this},union:function(t){return this.min.min(t.min),this.max.max(t.max),this},applyMatrix4:(It=[new T,new T,new T,new T,new T,new T,new T,new T],function(t){return this.isEmpty()||(It[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(t),It[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(t),It[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(t),It[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(t),It[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(t),It[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(t),It[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(t),It[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(t),this.setFromPoints(It)),this}),translate:function(t){return this.min.add(t),this.max.add(t),this},equals:function(t){return t.min.equals(this.min)&&t.max.equals(this.max)}},Bt.prototype={constructor:Bt,set:function(t,e){return this.center.copy(t),this.radius=e,this},setFromPoints:(kt=new jt,function(t,e){var n=this.center;void 0!==e?n.copy(e):kt.setFromPoints(t).getCenter(n);for(var i=0,r=0,o=t.length;r<o;r++)i=Math.max(i,n.distanceToSquared(t[r]));return this.radius=Math.sqrt(i),this}),clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.center.copy(t.center),this.radius=t.radius,this},empty:function(){return this.radius<=0},containsPoint:function(t){return t.distanceToSquared(this.center)<=this.radius*this.radius},distanceToPoint:function(t){return t.distanceTo(this.center)-this.radius},intersectsSphere:function(t){var e=this.radius+t.radius;return t.center.distanceToSquared(this.center)<=e*e},intersectsBox:function(t){return t.intersectsSphere(this)},intersectsPlane:function(t){return Math.abs(this.center.dot(t.normal)-t.constant)<=this.radius},clampPoint:function(t,e){var n=this.center.distanceToSquared(t),i=e||new T;return i.copy(t),n>this.radius*this.radius&&(i.sub(this.center).normalize(),i.multiplyScalar(this.radius).add(this.center)),i},getBoundingBox:function(t){var e=t||new jt;return e.set(this.center,this.center),e.expandByScalar(this.radius),e},applyMatrix4:function(t){return this.center.applyMatrix4(t),this.radius=this.radius*t.getMaxScaleOnAxis(),this},translate:function(t){return this.center.add(t),this},equals:function(t){return t.center.equals(this.center)&&t.radius===this.radius}},zt.prototype={constructor:zt,isMatrix3:!0,set:function(t,e,n,i,r,o,a,s,c){var l=this.elements;return l[0]=t,l[1]=i,l[2]=a,l[3]=e,l[4]=r,l[5]=s,l[6]=n,l[7]=o,l[8]=c,this},identity:function(){return this.set(1,0,0,0,1,0,0,0,1),this},clone:function(){return(new this.constructor).fromArray(this.elements)},copy:function(t){var e=t.elements;return this.set(e[0],e[3],e[6],e[1],e[4],e[7],e[2],e[5],e[8]),this},setFromMatrix4:function(t){var e=t.elements;return this.set(e[0],e[4],e[8],e[1],e[5],e[9],e[2],e[6],e[10]),this},applyToVector3Array:function(){var t;return function(e,n,i){void 0===t&&(t=new T),void 0===n&&(n=0),void 0===i&&(i=e.length);for(var r=0,o=n;r<i;r+=3,o+=3)t.fromArray(e,o),t.applyMatrix3(this),t.toArray(e,o);return e}}(),applyToBuffer:function(){var t;return function(e,n,i){void 0===t&&(t=new T),void 0===n&&(n=0),void 0===i&&(i=e.length/e.itemSize);for(var r=0,o=n;r<i;r++,o++)t.x=e.getX(o),t.y=e.getY(o),t.z=e.getZ(o),t.applyMatrix3(this),e.setXYZ(t.x,t.y,t.z);return e}}(),multiplyScalar:function(t){var e=this.elements;return e[0]*=t,e[3]*=t,e[6]*=t,e[1]*=t,e[4]*=t,e[7]*=t,e[2]*=t,e[5]*=t,e[8]*=t,this},determinant:function(){var t=this.elements,e=t[0],n=t[1],i=t[2],r=t[3],o=t[4],a=t[5],s=t[6],c=t[7],l=t[8];return e*o*l-e*a*c-n*r*l+n*a*s+i*r*c-i*o*s},getInverse:function(t,e){t&&t.isMatrix4&&console.error("THREE.Matrix3.getInverse no longer takes a Matrix4 argument.");var n=t.elements,i=this.elements,r=n[0],o=n[1],a=n[2],s=n[3],c=n[4],l=n[5],h=n[6],u=n[7],d=n[8],p=d*c-l*u,f=l*h-d*s,m=u*s-c*h,g=r*p+o*f+a*m;if(0===g){var v="THREE.Matrix3.getInverse(): can't invert matrix, determinant is 0";if(!0===e)throw new Error(v);return console.warn(v),this.identity()}var y=1/g;return i[0]=p*y,i[1]=(a*u-d*o)*y,i[2]=(l*o-a*c)*y,i[3]=f*y,i[4]=(d*r-a*h)*y,i[5]=(a*s-l*r)*y,i[6]=m*y,i[7]=(o*h-u*r)*y,i[8]=(c*r-o*s)*y,this},transpose:function(){var t,e=this.elements;return t=e[1],e[1]=e[3],e[3]=t,t=e[2],e[2]=e[6],e[6]=t,t=e[5],e[5]=e[7],e[7]=t,this},flattenToArrayOffset:function(t,e){return console.warn("THREE.Matrix3: .flattenToArrayOffset is deprecated - just use .toArray instead."),this.toArray(t,e)},getNormalMatrix:function(t){return this.setFromMatrix4(t).getInverse(this).transpose()},transposeIntoArray:function(t){var e=this.elements;return t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8],this},fromArray:function(t,e){void 0===e&&(e=0);for(var n=0;n<9;n++)this.elements[n]=t[n+e];return this},toArray:function(t,e){void 0===t&&(t=[]),void 0===e&&(e=0);var n=this.elements;return t[e]=n[0],t[e+1]=n[1],t[e+2]=n[2],t[e+3]=n[3],t[e+4]=n[4],t[e+5]=n[5],t[e+6]=n[6],t[e+7]=n[7],t[e+8]=n[8],t}},Ht.prototype={constructor:Ht,set:function(t,e){return this.normal.copy(t),this.constant=e,this},setComponents:function(t,e,n,i){return this.normal.set(t,e,n),this.constant=i,this},setFromNormalAndCoplanarPoint:function(t,e){return this.normal.copy(t),this.constant=-e.dot(this.normal),this},setFromCoplanarPoints:function(){var t=new T,e=new T;return function(n,i,r){var o=t.subVectors(r,i).cross(e.subVectors(n,i)).normalize();return this.setFromNormalAndCoplanarPoint(o,n),this}}(),clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.normal.copy(t.normal),this.constant=t.constant,this},normalize:function(){var t=1/this.normal.length();return this.normal.multiplyScalar(t),this.constant*=t,this},negate:function(){return this.constant*=-1,this.normal.negate(),this},distanceToPoint:function(t){return this.normal.dot(t)+this.constant},distanceToSphere:function(t){return this.distanceToPoint(t.center)-t.radius},projectPoint:function(t,e){return this.orthoPoint(t,e).sub(t).negate()},orthoPoint:function(t,e){var n=this.distanceToPoint(t);return(e||new T).copy(this.normal).multiplyScalar(n)},intersectLine:function(){var t=new T;return function(e,n){var i=n||new T,r=e.delta(t),o=this.normal.dot(r);if(0===o)return 0===this.distanceToPoint(e.start)?i.copy(e.start):void 0;var a=-(e.start.dot(this.normal)+this.constant)/o;return a<0||a>1?void 0:i.copy(r).multiplyScalar(a).add(e.start)}}(),intersectsLine:function(t){var e=this.distanceToPoint(t.start),n=this.distanceToPoint(t.end);return e<0&&n>0||n<0&&e>0},intersectsBox:function(t){return t.intersectsPlane(this)},intersectsSphere:function(t){return t.intersectsPlane(this)},coplanarPoint:function(t){return(t||new T).copy(this.normal).multiplyScalar(-this.constant)},applyMatrix4:function(){var t=new T,e=new zt;return function(n,i){var r=this.coplanarPoint(t).applyMatrix4(n),o=i||e.getNormalMatrix(n),a=this.normal.applyMatrix3(o).normalize();return this.constant=-r.dot(a),this}}(),translate:function(t){return this.constant=this.constant-t.dot(this.normal),this},equals:function(t){return t.normal.equals(this.normal)&&t.constant===this.constant}},Gt.prototype={constructor:Gt,set:function(t,e,n,i,r,o){var a=this.planes;return a[0].copy(t),a[1].copy(e),a[2].copy(n),a[3].copy(i),a[4].copy(r),a[5].copy(o),this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){for(var e=this.planes,n=0;n<6;n++)e[n].copy(t.planes[n]);return this},setFromMatrix:function(t){var e=this.planes,n=t.elements,i=n[0],r=n[1],o=n[2],a=n[3],s=n[4],c=n[5],l=n[6],h=n[7],u=n[8],d=n[9],p=n[10],f=n[11],m=n[12],g=n[13],v=n[14],y=n[15];return e[0].setComponents(a-i,h-s,f-u,y-m).normalize(),e[1].setComponents(a+i,h+s,f+u,y+m).normalize(),e[2].setComponents(a+r,h+c,f+d,y+g).normalize(),e[3].setComponents(a-r,h-c,f-d,y-g).normalize(),e[4].setComponents(a-o,h-l,f-p,y-v).normalize(),e[5].setComponents(a+o,h+l,f+p,y+v).normalize(),this},intersectsObject:(Lt=new Bt,function(t){var e=t.geometry;return null===e.boundingSphere&&e.computeBoundingSphere(),Lt.copy(e.boundingSphere).applyMatrix4(t.matrixWorld),this.intersectsSphere(Lt)}),intersectsSprite:function(){var t=new Bt;return function(e){return t.center.set(0,0,0),t.radius=.7071067811865476,t.applyMatrix4(e.matrixWorld),this.intersectsSphere(t)}}(),intersectsSphere:function(t){for(var e=this.planes,n=t.center,i=-t.radius,r=0;r<6;r++)if(e[r].distanceToPoint(n)<i)return!1;return!0},intersectsBox:(Pt=new T,Rt=new T,function(t){for(var e=this.planes,n=0;n<6;n++){var i=e[n];Pt.x=i.normal.x>0?t.min.x:t.max.x,Rt.x=i.normal.x>0?t.max.x:t.min.x,Pt.y=i.normal.y>0?t.min.y:t.max.y,Rt.y=i.normal.y>0?t.max.y:t.min.y,Pt.z=i.normal.z>0?t.min.z:t.max.z,Rt.z=i.normal.z>0?t.max.z:t.min.z;var r=i.distanceToPoint(Pt),o=i.distanceToPoint(Rt);if(r<0&&o<0)return!1}return!0}),containsPoint:function(t){for(var e=this.planes,n=0;n<6;n++)if(e[n].distanceToPoint(t)<0)return!1;return!0}},Wt.prototype={constructor:Wt,set:function(t,e){return this.origin.copy(t),this.direction.copy(e),this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.origin.copy(t.origin),this.direction.copy(t.direction),this},at:function(t,e){return(e||new T).copy(this.direction).multiplyScalar(t).add(this.origin)},lookAt:function(t){return this.direction.copy(t).sub(this.origin).normalize(),this},recast:function(){var t=new T;return function(e){return this.origin.copy(this.at(e,t)),this}}(),closestPointToPoint:function(t,e){var n=e||new T;n.subVectors(t,this.origin);var i=n.dot(this.direction);return i<0?n.copy(this.origin):n.copy(this.direction).multiplyScalar(i).add(this.origin)},distanceToPoint:function(t){return Math.sqrt(this.distanceSqToPoint(t))},distanceSqToPoint:function(){var t=new T;return function(e){var n=t.subVectors(e,this.origin).dot(this.direction);return n<0?this.origin.distanceToSquared(e):(t.copy(this.direction).multiplyScalar(n).add(this.origin),t.distanceToSquared(e))}}(),distanceSqToSegment:(Tt=new T,Mt=new T,Ct=new T,function(t,e,n,i){Tt.copy(t).add(e).multiplyScalar(.5),Mt.copy(e).sub(t).normalize(),Ct.copy(this.origin).sub(Tt);var r,o,a,s,c=.5*t.distanceTo(e),l=-this.direction.dot(Mt),h=Ct.dot(this.direction),u=-Ct.dot(Mt),d=Ct.lengthSq(),p=Math.abs(1-l*l);if(p>0)if(o=l*h-u,s=c*p,(r=l*u-h)>=0)if(o>=-s)if(o<=s){var f=1/p;a=(r*=f)*(r+l*(o*=f)+2*h)+o*(l*r+o+2*u)+d}else o=c,a=-(r=Math.max(0,-(l*o+h)))*r+o*(o+2*u)+d;else o=-c,a=-(r=Math.max(0,-(l*o+h)))*r+o*(o+2*u)+d;else o<=-s?a=-(r=Math.max(0,-(-l*c+h)))*r+(o=r>0?-c:Math.min(Math.max(-c,-u),c))*(o+2*u)+d:o<=s?(r=0,a=(o=Math.min(Math.max(-c,-u),c))*(o+2*u)+d):a=-(r=Math.max(0,-(l*c+h)))*r+(o=r>0?c:Math.min(Math.max(-c,-u),c))*(o+2*u)+d;else o=l>0?-c:c,a=-(r=Math.max(0,-(l*o+h)))*r+o*(o+2*u)+d;return n&&n.copy(this.direction).multiplyScalar(r).add(this.origin),i&&i.copy(Mt).multiplyScalar(o).add(Tt),a}),intersectSphere:function(){var t=new T;return function(e,n){t.subVectors(e.center,this.origin);var i=t.dot(this.direction),r=t.dot(t)-i*i,o=e.radius*e.radius;if(r>o)return null;var a=Math.sqrt(o-r),s=i-a,c=i+a;return s<0&&c<0?null:s<0?this.at(c,n):this.at(s,n)}}(),intersectsSphere:function(t){return this.distanceToPoint(t.center)<=t.radius},distanceToPlane:function(t){var e=t.normal.dot(this.direction);if(0===e)return 0===t.distanceToPoint(this.origin)?0:null;var n=-(this.origin.dot(t.normal)+t.constant)/e;return n>=0?n:null},intersectPlane:function(t,e){var n=this.distanceToPlane(t);return null===n?null:this.at(n,e)},intersectsPlane:function(t){var e=t.distanceToPoint(this.origin);return 0===e||t.normal.dot(this.direction)*e<0},intersectBox:function(t,e){var n,i,r,o,a,s,c=1/this.direction.x,l=1/this.direction.y,h=1/this.direction.z,u=this.origin;return c>=0?(n=(t.min.x-u.x)*c,i=(t.max.x-u.x)*c):(n=(t.max.x-u.x)*c,i=(t.min.x-u.x)*c),l>=0?(r=(t.min.y-u.y)*l,o=(t.max.y-u.y)*l):(r=(t.max.y-u.y)*l,o=(t.min.y-u.y)*l),n>o||r>i?null:((r>n||n!=n)&&(n=r),(o<i||i!=i)&&(i=o),h>=0?(a=(t.min.z-u.z)*h,s=(t.max.z-u.z)*h):(a=(t.max.z-u.z)*h,s=(t.min.z-u.z)*h),n>s||a>i?null:((a>n||n!=n)&&(n=a),(s<i||i!=i)&&(i=s),i<0?null:this.at(n>=0?n:i,e)))},intersectsBox:(At=new T,function(t){return null!==this.intersectBox(t,At)}),intersectTriangle:function(){var t=new T,e=new T,n=new T,i=new T;return function(r,o,a,s,c){e.subVectors(o,r),n.subVectors(a,r),i.crossVectors(e,n);var l,h=this.direction.dot(i);if(h>0){if(s)return null;l=1}else{if(!(h<0))return null;l=-1,h=-h}t.subVectors(this.origin,r);var u=l*this.direction.dot(n.crossVectors(t,n));if(u<0)return null;var d=l*this.direction.dot(e.cross(t));if(d<0)return null;if(u+d>h)return null;var p=-l*t.dot(i);return p<0?null:this.at(p/h,c)}}(),applyMatrix4:function(t){return this.direction.add(this.origin).applyMatrix4(t),this.origin.applyMatrix4(t),this.direction.sub(this.origin),this.direction.normalize(),this},equals:function(t){return t.origin.equals(this.origin)&&t.direction.equals(this.direction)}},Xt.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"],Xt.DefaultOrder="XYZ",Xt.prototype={constructor:Xt,isEuler:!0,get x(){return this._x},set x(t){this._x=t,this.onChangeCallback()},get y(){return this._y},set y(t){this._y=t,this.onChangeCallback()},get z(){return this._z},set z(t){this._z=t,this.onChangeCallback()},get order(){return this._order},set order(t){this._order=t,this.onChangeCallback()},set:function(t,e,n,i){return this._x=t,this._y=e,this._z=n,this._order=i||this._order,this.onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._order)},copy:function(t){return this._x=t._x,this._y=t._y,this._z=t._z,this._order=t._order,this.onChangeCallback(),this},setFromRotationMatrix:function(e,n,i){var r=t.Math.clamp,o=e.elements,a=o[0],s=o[4],c=o[8],l=o[1],h=o[5],u=o[9],d=o[2],p=o[6],f=o[10];return"XYZ"===(n=n||this._order)?(this._y=Math.asin(r(c,-1,1)),Math.abs(c)<.99999?(this._x=Math.atan2(-u,f),this._z=Math.atan2(-s,a)):(this._x=Math.atan2(p,h),this._z=0)):"YXZ"===n?(this._x=Math.asin(-r(u,-1,1)),Math.abs(u)<.99999?(this._y=Math.atan2(c,f),this._z=Math.atan2(l,h)):(this._y=Math.atan2(-d,a),this._z=0)):"ZXY"===n?(this._x=Math.asin(r(p,-1,1)),Math.abs(p)<.99999?(this._y=Math.atan2(-d,f),this._z=Math.atan2(-s,h)):(this._y=0,this._z=Math.atan2(l,a))):"ZYX"===n?(this._y=Math.asin(-r(d,-1,1)),Math.abs(d)<.99999?(this._x=Math.atan2(p,f),this._z=Math.atan2(l,a)):(this._x=0,this._z=Math.atan2(-s,h))):"YZX"===n?(this._z=Math.asin(r(l,-1,1)),Math.abs(l)<.99999?(this._x=Math.atan2(-u,h),this._y=Math.atan2(-d,a)):(this._x=0,this._y=Math.atan2(c,f))):"XZY"===n?(this._z=Math.asin(-r(s,-1,1)),Math.abs(s)<.99999?(this._x=Math.atan2(p,h),this._y=Math.atan2(c,a)):(this._x=Math.atan2(-u,f),this._y=0)):console.warn("THREE.Euler: .setFromRotationMatrix() given unsupported order: "+n),this._order=n,!1!==i&&this.onChangeCallback(),this},setFromQuaternion:function(){var t;return function(e,n,i){return void 0===t&&(t=new M),t.makeRotationFromQuaternion(e),this.setFromRotationMatrix(t,n,i)}}(),setFromVector3:function(t,e){return this.set(t.x,t.y,t.z,e||this._order)},reorder:(Et=new A,function(t){return Et.setFromEuler(this),this.setFromQuaternion(Et,t)}),equals:function(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._order===this._order},fromArray:function(t){return this._x=t[0],this._y=t[1],this._z=t[2],void 0!==t[3]&&(this._order=t[3]),this.onChangeCallback(),this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this._x,t[e+1]=this._y,t[e+2]=this._z,t[e+3]=this._order,t},toVector3:function(t){return t?t.set(this._x,this._y,this._z):new T(this._x,this._y,this._z)},onChange:function(t){return this.onChangeCallback=t,this},onChangeCallback:function(){}},qt.prototype={constructor:qt,set:function(t){this.mask=1<<t},enable:function(t){this.mask|=1<<t},toggle:function(t){this.mask^=1<<t},disable:function(t){this.mask&=~(1<<t)},test:function(t){return 0!=(this.mask&t.mask)}},Yt.DefaultUp=new T(0,1,0),Yt.DefaultMatrixAutoUpdate=!0,Object.assign(Yt.prototype,e.prototype,{isObject3D:!0,applyMatrix:function(t){this.matrix.multiplyMatrices(t,this.matrix),this.matrix.decompose(this.position,this.quaternion,this.scale)},setRotationFromAxisAngle:function(t,e){this.quaternion.setFromAxisAngle(t,e)},setRotationFromEuler:function(t){this.quaternion.setFromEuler(t,!0)},setRotationFromMatrix:function(t){this.quaternion.setFromRotationMatrix(t)},setRotationFromQuaternion:function(t){this.quaternion.copy(t)},rotateOnAxis:(St=new A,function(t,e){return St.setFromAxisAngle(t,e),this.quaternion.multiply(St),this}),rotateX:function(){var t=new T(1,0,0);return function(e){return this.rotateOnAxis(t,e)}}(),rotateY:function(){var t=new T(0,1,0);return function(e){return this.rotateOnAxis(t,e)}}(),rotateZ:function(){var t=new T(0,0,1);return function(e){return this.rotateOnAxis(t,e)}}(),translateOnAxis:function(){var t=new T;return function(e,n){return t.copy(e).applyQuaternion(this.quaternion),this.position.add(t.multiplyScalar(n)),this}}(),translateX:function(){var t=new T(1,0,0);return function(e){return this.translateOnAxis(t,e)}}(),translateY:function(){var t=new T(0,1,0);return function(e){return this.translateOnAxis(t,e)}}(),translateZ:function(){var t=new T(0,0,1);return function(e){return this.translateOnAxis(t,e)}}(),localToWorld:function(t){return t.applyMatrix4(this.matrixWorld)},worldToLocal:(_t=new M,function(t){return t.applyMatrix4(_t.getInverse(this.matrixWorld))}),lookAt:function(){var t=new M;return function(e){t.lookAt(e,this.position,this.up),this.quaternion.setFromRotationMatrix(t)}}(),add:function(t){if(arguments.length>1){for(var e=0;e<arguments.length;e++)this.add(arguments[e]);return this}return t===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",t),this):(t&&t.isObject3D?(null!==t.parent&&t.parent.remove(t),t.parent=this,t.dispatchEvent({type:"added"}),this.children.push(t)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",t),this)},remove:function(t){if(arguments.length>1)for(var e=0;e<arguments.length;e++)this.remove(arguments[e]);var n=this.children.indexOf(t);-1!==n&&(t.parent=null,t.dispatchEvent({type:"removed"}),this.children.splice(n,1))},getObjectById:function(t){return this.getObjectByProperty("id",t)},getObjectByName:function(t){return this.getObjectByProperty("name",t)},getObjectByProperty:function(t,e){if(this[t]===e)return this;for(var n=0,i=this.children.length;n<i;n++){var r=this.children[n].getObjectByProperty(t,e);if(void 0!==r)return r}},getWorldPosition:function(t){var e=t||new T;return this.updateMatrixWorld(!0),e.setFromMatrixPosition(this.matrixWorld)},getWorldQuaternion:(xt=new T,wt=new T,function(t){var e=t||new A;return this.updateMatrixWorld(!0),this.matrixWorld.decompose(xt,e,wt),e}),getWorldRotation:function(){var t=new A;return function(e){var n=e||new Xt;return this.getWorldQuaternion(t),n.setFromQuaternion(t,this.rotation.order,!1)}}(),getWorldScale:function(){var t=new T,e=new A;return function(n){var i=n||new T;return this.updateMatrixWorld(!0),this.matrixWorld.decompose(t,e,i),i}}(),getWorldDirection:function(){var t=new A;return function(e){var n=e||new T;return this.getWorldQuaternion(t),n.set(0,0,1).applyQuaternion(t)}}(),raycast:function(){},traverse:function(t){t(this);for(var e=this.children,n=0,i=e.length;n<i;n++)e[n].traverse(t)},traverseVisible:function(t){if(!1!==this.visible){t(this);for(var e=this.children,n=0,i=e.length;n<i;n++)e[n].traverseVisible(t)}},traverseAncestors:function(t){var e=this.parent;null!==e&&(t(e),e.traverseAncestors(t))},updateMatrix:function(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0},updateMatrixWorld:function(t){!0===this.matrixAutoUpdate&&this.updateMatrix(),!0!==this.matrixWorldNeedsUpdate&&!0!==t||(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,t=!0);for(var e=this.children,n=0,i=e.length;n<i;n++)e[n].updateMatrixWorld(t)},toJSON:function(t){var e=void 0===t||""===t,n={};e&&(t={geometries:{},materials:{},textures:{},images:{}},n.metadata={version:4.4,type:"Object",generator:"Object3D.toJSON"});var i={};if(i.uuid=this.uuid,i.type=this.type,""!==this.name&&(i.name=this.name),"{}"!==JSON.stringify(this.userData)&&(i.userData=this.userData),!0===this.castShadow&&(i.castShadow=!0),!0===this.receiveShadow&&(i.receiveShadow=!0),!1===this.visible&&(i.visible=!1),i.matrix=this.matrix.toArray(),void 0!==this.geometry&&(void 0===t.geometries[this.geometry.uuid]&&(t.geometries[this.geometry.uuid]=this.geometry.toJSON(t)),i.geometry=this.geometry.uuid),void 0!==this.material&&(void 0===t.materials[this.material.uuid]&&(t.materials[this.material.uuid]=this.material.toJSON(t)),i.material=this.material.uuid),this.children.length>0){i.children=[];for(var r=0;r<this.children.length;r++)i.children.push(this.children[r].toJSON(t).object)}if(e){var o=l(t.geometries),a=l(t.materials),s=l(t.textures),c=l(t.images);o.length>0&&(n.geometries=o),a.length>0&&(n.materials=a),s.length>0&&(n.textures=s),c.length>0&&(n.images=c)}return n.object=i,n;function l(t){var e=[];for(var n in t){var i=t[n];delete i.metadata,e.push(i)}return e}},clone:function(t){return(new this.constructor).copy(this,t)},copy:function(t,e){if(void 0===e&&(e=!0),this.name=t.name,this.up.copy(t.up),this.position.copy(t.position),this.quaternion.copy(t.quaternion),this.scale.copy(t.scale),this.matrix.copy(t.matrix),this.matrixWorld.copy(t.matrixWorld),this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrixWorldNeedsUpdate=t.matrixWorldNeedsUpdate,this.visible=t.visible,this.castShadow=t.castShadow,this.receiveShadow=t.receiveShadow,this.frustumCulled=t.frustumCulled,this.renderOrder=t.renderOrder,this.userData=JSON.parse(JSON.stringify(t.userData)),!0===e)for(var n=0;n<t.children.length;n++){var i=t.children[n];this.add(i.clone())}return this}});var Zt,$t,Qt,Jt,Kt=0;function te(){return Kt++}function ee(t,e){this.start=void 0!==t?t:new T,this.end=void 0!==e?e:new T}function ne(t,e,n){this.a=void 0!==t?t:new T,this.b=void 0!==e?e:new T,this.c=void 0!==n?n:new T}function ie(t,e,n,i,r,o){this.a=t,this.b=e,this.c=n,this.normal=i&&i.isVector3?i:new T,this.vertexNormals=Array.isArray(i)?i:[],this.color=r&&r.isColor?r:new pt,this.vertexColors=Array.isArray(r)?r:[],this.materialIndex=void 0!==o?o:0}function re(t){bt.call(this),this.type="MeshBasicMaterial",this.color=new pt(16777215),this.map=null,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.lights=!1,this.setValues(t)}function oe(e,n,i){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.uuid=t.Math.generateUUID(),this.array=e,this.itemSize=n,this.count=void 0!==e?e.length/n:0,this.normalized=!0===i,this.dynamic=!1,this.updateRange={offset:0,count:-1},this.version=0}function ae(t,e){return new oe(new Uint16Array(t),e)}function se(t,e){return new oe(new Uint32Array(t),e)}function ce(t,e){return new oe(new Float32Array(t),e)}function le(){Object.defineProperty(this,"id",{value:ue()}),this.uuid=t.Math.generateUUID(),this.name="",this.type="Geometry",this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingBox=null,this.boundingSphere=null,this.elementsNeedUpdate=!1,this.verticesNeedUpdate=!1,this.uvsNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.lineDistancesNeedUpdate=!1,this.groupsNeedUpdate=!1}ee.prototype={constructor:ee,set:function(t,e){return this.start.copy(t),this.end.copy(e),this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.start.copy(t.start),this.end.copy(t.end),this},getCenter:function(t){return(t||new T).addVectors(this.start,this.end).multiplyScalar(.5)},delta:function(t){return(t||new T).subVectors(this.end,this.start)},distanceSq:function(){return this.start.distanceToSquared(this.end)},distance:function(){return this.start.distanceTo(this.end)},at:function(t,e){var n=e||new T;return this.delta(n).multiplyScalar(t).add(this.start)},closestPointToPointParameter:(Qt=new T,Jt=new T,function(e,n){Qt.subVectors(e,this.start),Jt.subVectors(this.end,this.start);var i=Jt.dot(Jt),r=Jt.dot(Qt)/i;return n&&(r=t.Math.clamp(r,0,1)),r}),closestPointToPoint:function(t,e,n){var i=this.closestPointToPointParameter(t,e),r=n||new T;return this.delta(r).multiplyScalar(i).add(this.start)},applyMatrix4:function(t){return this.start.applyMatrix4(t),this.end.applyMatrix4(t),this},equals:function(t){return t.start.equals(this.start)&&t.end.equals(this.end)}},ne.normal=($t=new T,function(t,e,n,i){var r=i||new T;r.subVectors(n,e),$t.subVectors(t,e),r.cross($t);var o=r.lengthSq();return o>0?r.multiplyScalar(1/Math.sqrt(o)):r.set(0,0,0)}),ne.barycoordFromPoint=function(){var t=new T,e=new T,n=new T;return function(i,r,o,a,s){t.subVectors(a,r),e.subVectors(o,r),n.subVectors(i,r);var c=t.dot(t),l=t.dot(e),h=t.dot(n),u=e.dot(e),d=e.dot(n),p=c*u-l*l,f=s||new T;if(0===p)return f.set(-2,-1,-1);var m=1/p,g=(u*h-l*d)*m,v=(c*d-l*h)*m;return f.set(1-g-v,v,g)}}(),ne.containsPoint=function(){var t=new T;return function(e,n,i,r){var o=ne.barycoordFromPoint(e,n,i,r,t);return o.x>=0&&o.y>=0&&o.x+o.y<=1}}(),ne.prototype={constructor:ne,set:function(t,e,n){return this.a.copy(t),this.b.copy(e),this.c.copy(n),this},setFromPointsAndIndices:function(t,e,n,i){return this.a.copy(t[e]),this.b.copy(t[n]),this.c.copy(t[i]),this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.a.copy(t.a),this.b.copy(t.b),this.c.copy(t.c),this},area:function(){var t=new T,e=new T;return function(){return t.subVectors(this.c,this.b),e.subVectors(this.a,this.b),.5*t.cross(e).length()}}(),midpoint:function(t){return(t||new T).addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)},normal:function(t){return ne.normal(this.a,this.b,this.c,t)},plane:function(t){return(t||new Ht).setFromCoplanarPoints(this.a,this.b,this.c)},barycoordFromPoint:function(t,e){return ne.barycoordFromPoint(t,this.a,this.b,this.c,e)},containsPoint:function(t){return ne.containsPoint(t,this.a,this.b,this.c)},closestPointToPoint:function(){var t,e,n,i;return function(r,o){void 0===t&&(t=new Ht,e=[new ee,new ee,new ee],n=new T,i=new T);var a=o||new T,s=1/0;if(t.setFromCoplanarPoints(this.a,this.b,this.c),t.projectPoint(r,n),!0===this.containsPoint(n))a.copy(n);else{e[0].set(this.a,this.b),e[1].set(this.b,this.c),e[2].set(this.c,this.a);for(var c=0;c<e.length;c++){e[c].closestPointToPoint(n,!0,i);var l=n.distanceToSquared(i);l<s&&(s=l,a.copy(i))}}return a}}(),equals:function(t){return t.a.equals(this.a)&&t.b.equals(this.b)&&t.c.equals(this.c)}},ie.prototype={constructor:ie,clone:function(){return(new this.constructor).copy(this)},copy:function(t){this.a=t.a,this.b=t.b,this.c=t.c,this.normal.copy(t.normal),this.color.copy(t.color),this.materialIndex=t.materialIndex;for(var e=0,n=t.vertexNormals.length;e<n;e++)this.vertexNormals[e]=t.vertexNormals[e].clone();for(e=0,n=t.vertexColors.length;e<n;e++)this.vertexColors[e]=t.vertexColors[e].clone();return this}},re.prototype=Object.create(bt.prototype),re.prototype.constructor=re,re.prototype.isMeshBasicMaterial=!0,re.prototype.copy=function(t){return bt.prototype.copy.call(this,t),this.color.copy(t.color),this.map=t.map,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this},oe.prototype={constructor:oe,isBufferAttribute:!0,set needsUpdate(t){!0===t&&this.version++},setDynamic:function(t){return this.dynamic=t,this},copy:function(t){return this.array=new t.array.constructor(t.array),this.itemSize=t.itemSize,this.count=t.count,this.normalized=t.normalized,this.dynamic=t.dynamic,this},copyAt:function(t,e,n){t*=this.itemSize,n*=e.itemSize;for(var i=0,r=this.itemSize;i<r;i++)this.array[t+i]=e.array[n+i];return this},copyArray:function(t){return this.array.set(t),this},copyColorsArray:function(t){for(var e=this.array,n=0,i=0,r=t.length;i<r;i++){var o=t[i];void 0===o&&(console.warn("THREE.BufferAttribute.copyColorsArray(): color is undefined",i),o=new pt),e[n++]=o.r,e[n++]=o.g,e[n++]=o.b}return this},copyIndicesArray:function(t){for(var e=this.array,n=0,i=0,r=t.length;i<r;i++){var o=t[i];e[n++]=o.a,e[n++]=o.b,e[n++]=o.c}return this},copyVector2sArray:function(t){for(var e=this.array,n=0,i=0,r=t.length;i<r;i++){var o=t[i];void 0===o&&(console.warn("THREE.BufferAttribute.copyVector2sArray(): vector is undefined",i),o=new d),e[n++]=o.x,e[n++]=o.y}return this},copyVector3sArray:function(t){for(var e=this.array,n=0,i=0,r=t.length;i<r;i++){var o=t[i];void 0===o&&(console.warn("THREE.BufferAttribute.copyVector3sArray(): vector is undefined",i),o=new T),e[n++]=o.x,e[n++]=o.y,e[n++]=o.z}return this},copyVector4sArray:function(t){for(var e=this.array,n=0,i=0,r=t.length;i<r;i++){var o=t[i];void 0===o&&(console.warn("THREE.BufferAttribute.copyVector4sArray(): vector is undefined",i),o=new _),e[n++]=o.x,e[n++]=o.y,e[n++]=o.z,e[n++]=o.w}return this},set:function(t,e){return void 0===e&&(e=0),this.array.set(t,e),this},getX:function(t){return this.array[t*this.itemSize]},setX:function(t,e){return this.array[t*this.itemSize]=e,this},getY:function(t){return this.array[t*this.itemSize+1]},setY:function(t,e){return this.array[t*this.itemSize+1]=e,this},getZ:function(t){return this.array[t*this.itemSize+2]},setZ:function(t,e){return this.array[t*this.itemSize+2]=e,this},getW:function(t){return this.array[t*this.itemSize+3]},setW:function(t,e){return this.array[t*this.itemSize+3]=e,this},setXY:function(t,e,n){return t*=this.itemSize,this.array[t+0]=e,this.array[t+1]=n,this},setXYZ:function(t,e,n,i){return t*=this.itemSize,this.array[t+0]=e,this.array[t+1]=n,this.array[t+2]=i,this},setXYZW:function(t,e,n,i,r){return t*=this.itemSize,this.array[t+0]=e,this.array[t+1]=n,this.array[t+2]=i,this.array[t+3]=r,this},clone:function(){return(new this.constructor).copy(this)}},Object.assign(le.prototype,e.prototype,{isGeometry:!0,applyMatrix:function(t){for(var e=(new zt).getNormalMatrix(t),n=0,i=this.vertices.length;n<i;n++)this.vertices[n].applyMatrix4(t);for(n=0,i=this.faces.length;n<i;n++){var r=this.faces[n];r.normal.applyMatrix3(e).normalize();for(var o=0,a=r.vertexNormals.length;o<a;o++)r.vertexNormals[o].applyMatrix3(e).normalize()}return null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this.verticesNeedUpdate=!0,this.normalsNeedUpdate=!0,this},rotateX:function(){var t;return function(e){return void 0===t&&(t=new M),t.makeRotationX(e),this.applyMatrix(t),this}}(),rotateY:function(){var t;return function(e){return void 0===t&&(t=new M),t.makeRotationY(e),this.applyMatrix(t),this}}(),rotateZ:function(){var t;return function(e){return void 0===t&&(t=new M),t.makeRotationZ(e),this.applyMatrix(t),this}}(),translate:function(){var t;return function(e,n,i){return void 0===t&&(t=new M),t.makeTranslation(e,n,i),this.applyMatrix(t),this}}(),scale:function(){var t;return function(e,n,i){return void 0===t&&(t=new M),t.makeScale(e,n,i),this.applyMatrix(t),this}}(),lookAt:function(t){void 0===Zt&&(Zt=new Yt),Zt.lookAt(t),Zt.updateMatrix(),this.applyMatrix(Zt.matrix)},fromBufferGeometry:function(t){var e=this,n=null!==t.index?t.index.array:void 0,i=t.attributes,r=i.position.array,o=void 0!==i.normal?i.normal.array:void 0,a=void 0!==i.color?i.color.array:void 0,s=void 0!==i.uv?i.uv.array:void 0,c=void 0!==i.uv2?i.uv2.array:void 0;void 0!==c&&(this.faceVertexUvs[1]=[]);for(var l=[],h=[],u=[],p=0,f=0;p<r.length;p+=3,f+=2)e.vertices.push(new T(r[p],r[p+1],r[p+2])),void 0!==o&&l.push(new T(o[p],o[p+1],o[p+2])),void 0!==a&&e.colors.push(new pt(a[p],a[p+1],a[p+2])),void 0!==s&&h.push(new d(s[f],s[f+1])),void 0!==c&&u.push(new d(c[f],c[f+1]));function m(t,n,i,r){var d=new ie(t,n,i,void 0!==o?[l[t].clone(),l[n].clone(),l[i].clone()]:[],void 0!==a?[e.colors[t].clone(),e.colors[n].clone(),e.colors[i].clone()]:[],r);e.faces.push(d),void 0!==s&&e.faceVertexUvs[0].push([h[t].clone(),h[n].clone(),h[i].clone()]),void 0!==c&&e.faceVertexUvs[1].push([u[t].clone(),u[n].clone(),u[i].clone()])}if(void 0!==n){var g=t.groups;if(g.length>0)for(p=0;p<g.length;p++)for(var v=g[p],y=v.start,b=(f=y,y+v.count);f<b;f+=3)m(n[f],n[f+1],n[f+2],v.materialIndex);else for(p=0;p<n.length;p+=3)m(n[p],n[p+1],n[p+2])}else for(p=0;p<r.length/3;p+=3)m(p,p+1,p+2);return this.computeFaceNormals(),null!==t.boundingBox&&(this.boundingBox=t.boundingBox.clone()),null!==t.boundingSphere&&(this.boundingSphere=t.boundingSphere.clone()),this},center:function(){this.computeBoundingBox();var t=this.boundingBox.getCenter().negate();return this.translate(t.x,t.y,t.z),t},normalize:function(){this.computeBoundingSphere();var t=this.boundingSphere.center,e=this.boundingSphere.radius,n=0===e?1:1/e,i=new M;return i.set(n,0,0,-n*t.x,0,n,0,-n*t.y,0,0,n,-n*t.z,0,0,0,1),this.applyMatrix(i),this},computeFaceNormals:function(){for(var t=new T,e=new T,n=0,i=this.faces.length;n<i;n++){var r=this.faces[n],o=this.vertices[r.a],a=this.vertices[r.b],s=this.vertices[r.c];t.subVectors(s,a),e.subVectors(o,a),t.cross(e),t.normalize(),r.normal.copy(t)}},computeVertexNormals:function(t){var e,n,i,r,o,a;for(void 0===t&&(t=!0),a=new Array(this.vertices.length),e=0,n=this.vertices.length;e<n;e++)a[e]=new T;if(t){var s,c,l,h=new T,u=new T;for(i=0,r=this.faces.length;i<r;i++)o=this.faces[i],s=this.vertices[o.a],c=this.vertices[o.b],l=this.vertices[o.c],h.subVectors(l,c),u.subVectors(s,c),h.cross(u),a[o.a].add(h),a[o.b].add(h),a[o.c].add(h)}else for(i=0,r=this.faces.length;i<r;i++)a[(o=this.faces[i]).a].add(o.normal),a[o.b].add(o.normal),a[o.c].add(o.normal);for(e=0,n=this.vertices.length;e<n;e++)a[e].normalize();for(i=0,r=this.faces.length;i<r;i++){var d=(o=this.faces[i]).vertexNormals;3===d.length?(d[0].copy(a[o.a]),d[1].copy(a[o.b]),d[2].copy(a[o.c])):(d[0]=a[o.a].clone(),d[1]=a[o.b].clone(),d[2]=a[o.c].clone())}this.faces.length>0&&(this.normalsNeedUpdate=!0)},computeMorphNormals:function(){var t,e,n,i,r;for(n=0,i=this.faces.length;n<i;n++)for((r=this.faces[n]).__originalFaceNormal?r.__originalFaceNormal.copy(r.normal):r.__originalFaceNormal=r.normal.clone(),r.__originalVertexNormals||(r.__originalVertexNormals=[]),t=0,e=r.vertexNormals.length;t<e;t++)r.__originalVertexNormals[t]?r.__originalVertexNormals[t].copy(r.vertexNormals[t]):r.__originalVertexNormals[t]=r.vertexNormals[t].clone();var o=new le;for(o.faces=this.faces,t=0,e=this.morphTargets.length;t<e;t++){if(!this.morphNormals[t]){this.morphNormals[t]={},this.morphNormals[t].faceNormals=[],this.morphNormals[t].vertexNormals=[];var a=this.morphNormals[t].faceNormals,s=this.morphNormals[t].vertexNormals;for(n=0,i=this.faces.length;n<i;n++)c=new T,l={a:new T,b:new T,c:new T},a.push(c),s.push(l)}var c,l,h=this.morphNormals[t];for(o.vertices=this.morphTargets[t].vertices,o.computeFaceNormals(),o.computeVertexNormals(),n=0,i=this.faces.length;n<i;n++)r=this.faces[n],c=h.faceNormals[n],l=h.vertexNormals[n],c.copy(r.normal),l.a.copy(r.vertexNormals[0]),l.b.copy(r.vertexNormals[1]),l.c.copy(r.vertexNormals[2])}for(n=0,i=this.faces.length;n<i;n++)(r=this.faces[n]).normal=r.__originalFaceNormal,r.vertexNormals=r.__originalVertexNormals},computeTangents:function(){console.warn("THREE.Geometry: .computeTangents() has been removed.")},computeLineDistances:function(){for(var t=0,e=this.vertices,n=0,i=e.length;n<i;n++)n>0&&(t+=e[n].distanceTo(e[n-1])),this.lineDistances[n]=t},computeBoundingBox:function(){null===this.boundingBox&&(this.boundingBox=new jt),this.boundingBox.setFromPoints(this.vertices)},computeBoundingSphere:function(){null===this.boundingSphere&&(this.boundingSphere=new Bt),this.boundingSphere.setFromPoints(this.vertices)},merge:function(t,e,n){if(!1!==(t&&t.isGeometry)){var i,r=this.vertices.length,o=this.vertices,a=t.vertices,s=this.faces,c=t.faces,l=this.faceVertexUvs[0],h=t.faceVertexUvs[0],u=this.colors,d=t.colors;void 0===n&&(n=0),void 0!==e&&(i=(new zt).getNormalMatrix(e));for(var p=0,f=a.length;p<f;p++){var m=a[p].clone();void 0!==e&&m.applyMatrix4(e),o.push(m)}for(p=0,f=d.length;p<f;p++)u.push(d[p].clone());for(p=0,f=c.length;p<f;p++){var g,v,y,b=c[p],x=b.vertexNormals,w=b.vertexColors;(g=new ie(b.a+r,b.b+r,b.c+r)).normal.copy(b.normal),void 0!==i&&g.normal.applyMatrix3(i).normalize();for(var _=0,S=x.length;_<S;_++)v=x[_].clone(),void 0!==i&&v.applyMatrix3(i).normalize(),g.vertexNormals.push(v);for(g.color.copy(b.color),_=0,S=w.length;_<S;_++)y=w[_],g.vertexColors.push(y.clone());g.materialIndex=b.materialIndex+n,s.push(g)}for(p=0,f=h.length;p<f;p++){var E=h[p],A=[];if(void 0!==E){for(_=0,S=E.length;_<S;_++)A.push(E[_].clone());l.push(A)}}}else console.error("THREE.Geometry.merge(): geometry not an instance of THREE.Geometry.",t)},mergeMesh:function(t){!1!==(t&&t.isMesh)?(t.matrixAutoUpdate&&t.updateMatrix(),this.merge(t.geometry,t.matrix)):console.error("THREE.Geometry.mergeMesh(): mesh not an instance of THREE.Mesh.",t)},mergeVertices:function(){var t,e,n,i,r,o,a,s,c={},l=[],h=[],u=Math.pow(10,4);for(n=0,i=this.vertices.length;n<i;n++)t=this.vertices[n],void 0===c[e=Math.round(t.x*u)+"_"+Math.round(t.y*u)+"_"+Math.round(t.z*u)]?(c[e]=n,l.push(this.vertices[n]),h[n]=l.length-1):h[n]=h[c[e]];var d=[];for(n=0,i=this.faces.length;n<i;n++){(r=this.faces[n]).a=h[r.a],r.b=h[r.b],r.c=h[r.c],o=[r.a,r.b,r.c];for(var p=0;p<3;p++)if(o[p]===o[(p+1)%3]){d.push(n);break}}for(n=d.length-1;n>=0;n--){var f=d[n];for(this.faces.splice(f,1),a=0,s=this.faceVertexUvs.length;a<s;a++)this.faceVertexUvs[a].splice(f,1)}var m=this.vertices.length-l.length;return this.vertices=l,m},sortFacesByMaterialIndex:function(){for(var t=this.faces,e=t.length,n=0;n<e;n++)t[n]._id=n;t.sort((function(t,e){return t.materialIndex-e.materialIndex}));var i,r,o=this.faceVertexUvs[0],a=this.faceVertexUvs[1];for(o&&o.length===e&&(i=[]),a&&a.length===e&&(r=[]),n=0;n<e;n++){var s=t[n]._id;i&&i.push(o[s]),r&&r.push(a[s])}i&&(this.faceVertexUvs[0]=i),r&&(this.faceVertexUvs[1]=r)},toJSON:function(){var t={metadata:{version:4.4,type:"Geometry",generator:"Geometry.toJSON"}};if(t.uuid=this.uuid,t.type=this.type,""!==this.name&&(t.name=this.name),void 0!==this.parameters){var e=this.parameters;for(var n in e)void 0!==e[n]&&(t[n]=e[n]);return t}for(var i=[],r=0;r<this.vertices.length;r++){var o=this.vertices[r];i.push(o.x,o.y,o.z)}var a=[],s=[],c={},l=[],h={},u=[],d={};for(r=0;r<this.faces.length;r++){var p=this.faces[r],f=void 0!==this.faceVertexUvs[0][r],m=p.normal.length()>0,g=p.vertexNormals.length>0,v=1!==p.color.r||1!==p.color.g||1!==p.color.b,y=p.vertexColors.length>0,b=0;if(b=S(b,0,0),b=S(b,1,!0),b=S(b,2,!1),b=S(b,3,f),b=S(b,4,m),b=S(b,5,g),b=S(b,6,v),b=S(b,7,y),a.push(b),a.push(p.a,p.b,p.c),a.push(p.materialIndex),f){var x=this.faceVertexUvs[0][r];a.push(T(x[0]),T(x[1]),T(x[2]))}if(m&&a.push(E(p.normal)),g){var w=p.vertexNormals;a.push(E(w[0]),E(w[1]),E(w[2]))}if(v&&a.push(A(p.color)),y){var _=p.vertexColors;a.push(A(_[0]),A(_[1]),A(_[2]))}}function S(t,e,n){return n?t|1<<e:t&~(1<<e)}function E(t){var e=t.x.toString()+t.y.toString()+t.z.toString();return void 0!==c[e]||(c[e]=s.length/3,s.push(t.x,t.y,t.z)),c[e]}function A(t){var e=t.r.toString()+t.g.toString()+t.b.toString();return void 0!==h[e]||(h[e]=l.length,l.push(t.getHex())),h[e]}function T(t){var e=t.x.toString()+t.y.toString();return void 0!==d[e]||(d[e]=u.length/2,u.push(t.x,t.y)),d[e]}return t.data={},t.data.vertices=i,t.data.normals=s,l.length>0&&(t.data.colors=l),u.length>0&&(t.data.uvs=[u]),t.data.faces=a,t},clone:function(){return(new le).copy(this)},copy:function(t){this.vertices=[],this.faces=[],this.faceVertexUvs=[[]],this.colors=[];for(var e=t.vertices,n=0,i=e.length;n<i;n++)this.vertices.push(e[n].clone());var r=t.colors;for(n=0,i=r.length;n<i;n++)this.colors.push(r[n].clone());var o=t.faces;for(n=0,i=o.length;n<i;n++)this.faces.push(o[n].clone());for(n=0,i=t.faceVertexUvs.length;n<i;n++){var a=t.faceVertexUvs[n];void 0===this.faceVertexUvs[n]&&(this.faceVertexUvs[n]=[]);for(var s=0,c=a.length;s<c;s++){for(var l=a[s],h=[],u=0,d=l.length;u<d;u++){var p=l[u];h.push(p.clone())}this.faceVertexUvs[n].push(h)}}return this},dispose:function(){this.dispatchEvent({type:"dispose"})}});var he=0;function ue(){return he++}function de(){Object.defineProperty(this,"id",{value:ue()}),this.uuid=t.Math.generateUUID(),this.name="",this.type="DirectGeometry",this.indices=[],this.vertices=[],this.normals=[],this.colors=[],this.uvs=[],this.uvs2=[],this.groups=[],this.morphTargets={},this.skinWeights=[],this.skinIndices=[],this.boundingBox=null,this.boundingSphere=null,this.verticesNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.uvsNeedUpdate=!1,this.groupsNeedUpdate=!1}function pe(){Object.defineProperty(this,"id",{value:ue()}),this.uuid=t.Math.generateUUID(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0}}function fe(t,e){Yt.call(this),this.type="Mesh",this.geometry=void 0!==t?t:new pe,this.material=void 0!==e?e:new re({color:16777215*Math.random()}),this.drawMode=0,this.updateMorphTargets()}function me(t,e,n,i,r,o){pe.call(this),this.type="BoxBufferGeometry",this.parameters={width:t,height:e,depth:n,widthSegments:i,heightSegments:r,depthSegments:o};var a,s,c,l,h=this,u=function(t,e,n){var i=0;return i+=(t+1)*(e+1)*2,i+=(t+1)*(n+1)*2,i+=(n+1)*(e+1)*2}(i=Math.floor(i)||1,r=Math.floor(r)||1,o=Math.floor(o)||1),d=(l=0,l+=(a=i)*(s=r)*2,l+=a*(c=o)*2,6*(l+=c*s*2)),p=new(d>65535?Uint32Array:Uint16Array)(d),f=new Float32Array(3*u),m=new Float32Array(3*u),g=new Float32Array(2*u),v=0,y=0,b=0,x=0,w=0;function _(t,e,n,i,r,o,a,s,c,l,u){for(var d=o/c,_=a/l,S=o/2,E=a/2,A=s/2,M=c+1,C=l+1,P=0,R=0,L=new T,k=0;k<C;k++)for(var I=k*_-E,D=0;D<M;D++){var O=D*d-S;L[t]=O*i,L[e]=I*r,L[n]=A,f[v]=L.x,f[v+1]=L.y,f[v+2]=L.z,L[t]=0,L[e]=0,L[n]=s>0?1:-1,m[v]=L.x,m[v+1]=L.y,m[v+2]=L.z,g[y]=D/c,g[y+1]=1-k/l,v+=3,y+=2,P+=1}for(k=0;k<l;k++)for(D=0;D<c;D++){var F=x+D+M*k,N=x+D+M*(k+1),U=x+(D+1)+M*(k+1),j=x+(D+1)+M*k;p[b]=F,p[b+1]=N,p[b+2]=j,p[b+3]=N,p[b+4]=U,p[b+5]=j,b+=6,R+=6}h.addGroup(w,R,u),w+=R,x+=P}_("z","y","x",-1,-1,n,e,t,o,r,0),_("z","y","x",1,-1,n,e,-t,o,r,1),_("x","z","y",1,1,t,n,e,i,o,2),_("x","z","y",1,-1,t,n,-e,i,o,3),_("x","y","z",1,-1,t,e,n,i,r,4),_("x","y","z",-1,-1,t,e,-n,i,r,5),this.setIndex(new oe(p,1)),this.addAttribute("position",new oe(f,3)),this.addAttribute("normal",new oe(m,3)),this.addAttribute("uv",new oe(g,2))}function ge(t,e,n,i){pe.call(this),this.type="PlaneBufferGeometry",this.parameters={width:t,height:e,widthSegments:n,heightSegments:i};for(var r=t/2,o=e/2,a=Math.floor(n)||1,s=Math.floor(i)||1,c=a+1,l=s+1,h=t/a,u=e/s,d=new Float32Array(c*l*3),p=new Float32Array(c*l*3),f=new Float32Array(c*l*2),m=0,g=0,v=0;v<l;v++)for(var y=v*u-o,b=0;b<c;b++){var x=b*h-r;d[m]=x,d[m+1]=-y,p[m+2]=1,f[g]=b/a,f[g+1]=1-v/s,m+=3,g+=2}m=0;var w=new(d.length/3>65535?Uint32Array:Uint16Array)(a*s*6);for(v=0;v<s;v++)for(b=0;b<a;b++){var _=b+c*v,S=b+c*(v+1),E=b+1+c*(v+1),A=b+1+c*v;w[m]=_,w[m+1]=S,w[m+2]=A,w[m+3]=S,w[m+4]=E,w[m+5]=A,m+=6}this.setIndex(new oe(w,1)),this.addAttribute("position",new oe(d,3)),this.addAttribute("normal",new oe(p,3)),this.addAttribute("uv",new oe(f,2))}function ve(){Yt.call(this),this.type="Camera",this.matrixWorldInverse=new M,this.projectionMatrix=new M}function ye(t,e,n,i){ve.call(this),this.type="PerspectiveCamera",this.fov=void 0!==t?t:50,this.zoom=1,this.near=void 0!==n?n:.1,this.far=void 0!==i?i:2e3,this.focus=10,this.aspect=void 0!==e?e:1,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}function be(t,e,n,i,r,o){ve.call(this),this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=t,this.right=e,this.top=n,this.bottom=i,this.near=void 0!==r?r:.1,this.far=void 0!==o?o:2e3,this.updateProjectionMatrix()}function xe(t,e,n){var i,r,o;return{setMode:function(t){i=t},setIndex:function(n){n.array instanceof Uint32Array&&e.get("OES_element_index_uint")?(r=t.UNSIGNED_INT,o=4):(r=t.UNSIGNED_SHORT,o=2)},render:function(e,a){t.drawElements(i,a,r,e*o),n.calls++,n.vertices+=a,i===t.TRIANGLES&&(n.faces+=a/3)},renderInstances:function(a,s,c){var l=e.get("ANGLE_instanced_arrays");null!==l?(l.drawElementsInstancedANGLE(i,c,r,s*o,a.maxInstancedCount),n.calls++,n.vertices+=c*a.maxInstancedCount,i===t.TRIANGLES&&(n.faces+=a.maxInstancedCount*c/3)):console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.")}}}function we(t,e,n){var i;return{setMode:function(t){i=t},render:function(e,r){t.drawArrays(i,e,r),n.calls++,n.vertices+=r,i===t.TRIANGLES&&(n.faces+=r/3)},renderInstances:function(r){var o=e.get("ANGLE_instanced_arrays");if(null!==o){var a=r.attributes.position,s=0;a&&a.isInterleavedBufferAttribute?(s=a.data.count,o.drawArraysInstancedANGLE(i,0,s,r.maxInstancedCount)):(s=a.count,o.drawArraysInstancedANGLE(i,0,s,r.maxInstancedCount)),n.calls++,n.vertices+=s*r.maxInstancedCount,i===t.TRIANGLES&&(n.faces+=r.maxInstancedCount*s/3)}else console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.")}}}function _e(){var t={};return{get:function(e){if(void 0!==t[e.id])return t[e.id];var n;switch(e.type){case"DirectionalLight":n={direction:new T,color:new pt,shadow:!1,shadowBias:0,shadowRadius:1,shadowMapSize:new d};break;case"SpotLight":n={position:new T,direction:new T,color:new pt,distance:0,coneCos:0,penumbraCos:0,decay:0,shadow:!1,shadowBias:0,shadowRadius:1,shadowMapSize:new d};break;case"PointLight":n={position:new T,color:new pt,distance:0,decay:0,shadow:!1,shadowBias:0,shadowRadius:1,shadowMapSize:new d};break;case"HemisphereLight":n={direction:new T,skyColor:new pt,groundColor:new pt}}return t[e.id]=n,n}}}function Se(t,e,n){var i=t.createShader(e);return t.shaderSource(i,n),t.compileShader(i),!1===t.getShaderParameter(i,t.COMPILE_STATUS)&&console.error("THREE.WebGLShader: Shader couldn't compile."),""!==t.getShaderInfoLog(i)&&console.warn("THREE.WebGLShader: gl.getShaderInfoLog()",e===t.VERTEX_SHADER?"vertex":"fragment",t.getShaderInfoLog(i),function(t){for(var e=t.split("\n"),n=0;n<e.length;n++)e[n]=n+1+": "+e[n];return e.join("\n")}(n)),i}Object.assign(de.prototype,e.prototype,{computeBoundingBox:le.prototype.computeBoundingBox,computeBoundingSphere:le.prototype.computeBoundingSphere,computeFaceNormals:function(){console.warn("THREE.DirectGeometry: computeFaceNormals() is not a method of this type of geometry.")},computeVertexNormals:function(){console.warn("THREE.DirectGeometry: computeVertexNormals() is not a method of this type of geometry.")},computeGroups:function(t){for(var e,n,i=[],r=t.faces,o=0;o<r.length;o++){var a=r[o];a.materialIndex!==n&&(n=a.materialIndex,void 0!==e&&(e.count=3*o-e.start,i.push(e)),e={start:3*o,materialIndex:n})}void 0!==e&&(e.count=3*o-e.start,i.push(e)),this.groups=i},fromGeometry:function(t){var e,n=t.faces,i=t.vertices,r=t.faceVertexUvs,o=r[0]&&r[0].length>0,a=r[1]&&r[1].length>0,s=t.morphTargets,c=s.length;if(c>0){e=[];for(var l=0;l<c;l++)e[l]=[];this.morphTargets.position=e}var h,u=t.morphNormals,p=u.length;if(p>0){for(h=[],l=0;l<p;l++)h[l]=[];this.morphTargets.normal=h}var f=t.skinIndices,m=t.skinWeights,g=f.length===i.length,v=m.length===i.length;for(l=0;l<n.length;l++){var y=n[l];this.vertices.push(i[y.a],i[y.b],i[y.c]);var b=y.vertexNormals;if(3===b.length)this.normals.push(b[0],b[1],b[2]);else{var x=y.normal;this.normals.push(x,x,x)}var w,_=y.vertexColors;if(3===_.length)this.colors.push(_[0],_[1],_[2]);else{var S=y.color;this.colors.push(S,S,S)}!0===o&&(void 0!==(w=r[0][l])?this.uvs.push(w[0],w[1],w[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv ",l),this.uvs.push(new d,new d,new d))),!0===a&&(void 0!==(w=r[1][l])?this.uvs2.push(w[0],w[1],w[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv2 ",l),this.uvs2.push(new d,new d,new d)));for(var E=0;E<c;E++){var A=s[E].vertices;e[E].push(A[y.a],A[y.b],A[y.c])}for(E=0;E<p;E++){var T=u[E].vertexNormals[l];h[E].push(T.a,T.b,T.c)}g&&this.skinIndices.push(f[y.a],f[y.b],f[y.c]),v&&this.skinWeights.push(m[y.a],m[y.b],m[y.c])}return this.computeGroups(t),this.verticesNeedUpdate=t.verticesNeedUpdate,this.normalsNeedUpdate=t.normalsNeedUpdate,this.colorsNeedUpdate=t.colorsNeedUpdate,this.uvsNeedUpdate=t.uvsNeedUpdate,this.groupsNeedUpdate=t.groupsNeedUpdate,this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),Object.assign(pe.prototype,e.prototype,{isBufferGeometry:!0,getIndex:function(){return this.index},setIndex:function(t){this.index=t},addAttribute:function(t,e){return!1===(e&&e.isBufferAttribute)&&!1===(e&&e.isInterleavedBufferAttribute)?(console.warn("THREE.BufferGeometry: .addAttribute() now expects ( name, attribute )."),void this.addAttribute(t,new oe(arguments[1],arguments[2]))):"index"===t?(console.warn("THREE.BufferGeometry.addAttribute: Use .setIndex() for index attribute."),void this.setIndex(e)):(this.attributes[t]=e,this)},getAttribute:function(t){return this.attributes[t]},removeAttribute:function(t){return delete this.attributes[t],this},addGroup:function(t,e,n){this.groups.push({start:t,count:e,materialIndex:void 0!==n?n:0})},clearGroups:function(){this.groups=[]},setDrawRange:function(t,e){this.drawRange.start=t,this.drawRange.count=e},applyMatrix:function(t){var e=this.attributes.position;void 0!==e&&(t.applyToVector3Array(e.array),e.needsUpdate=!0);var n=this.attributes.normal;return void 0!==n&&((new zt).getNormalMatrix(t).applyToVector3Array(n.array),n.needsUpdate=!0),null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this},rotateX:function(){var t;return function(e){return void 0===t&&(t=new M),t.makeRotationX(e),this.applyMatrix(t),this}}(),rotateY:function(){var t;return function(e){return void 0===t&&(t=new M),t.makeRotationY(e),this.applyMatrix(t),this}}(),rotateZ:function(){var t;return function(e){return void 0===t&&(t=new M),t.makeRotationZ(e),this.applyMatrix(t),this}}(),translate:function(){var t;return function(e,n,i){return void 0===t&&(t=new M),t.makeTranslation(e,n,i),this.applyMatrix(t),this}}(),scale:function(){var t;return function(e,n,i){return void 0===t&&(t=new M),t.makeScale(e,n,i),this.applyMatrix(t),this}}(),lookAt:function(){var t;return function(e){void 0===t&&(t=new Yt),t.lookAt(e),t.updateMatrix(),this.applyMatrix(t.matrix)}}(),center:function(){this.computeBoundingBox();var t=this.boundingBox.getCenter().negate();return this.translate(t.x,t.y,t.z),t},setFromObject:function(t){var e=t.geometry;if(t&&t.isPoints||t&&t.isLine){var n=new ce(3*e.vertices.length,3),i=new ce(3*e.colors.length,3);if(this.addAttribute("position",n.copyVector3sArray(e.vertices)),this.addAttribute("color",i.copyColorsArray(e.colors)),e.lineDistances&&e.lineDistances.length===e.vertices.length){var r=new ce(e.lineDistances.length,1);this.addAttribute("lineDistance",r.copyArray(e.lineDistances))}null!==e.boundingSphere&&(this.boundingSphere=e.boundingSphere.clone()),null!==e.boundingBox&&(this.boundingBox=e.boundingBox.clone())}else t&&t.isMesh&&e&&e.isGeometry&&this.fromGeometry(e);return this},updateFromObject:function(t){var e,n=t.geometry;if(t&&t.isMesh){var i=n.__directGeometry;if(!0===n.elementsNeedUpdate&&(i=void 0,n.elementsNeedUpdate=!1),void 0===i)return this.fromGeometry(n);i.verticesNeedUpdate=n.verticesNeedUpdate,i.normalsNeedUpdate=n.normalsNeedUpdate,i.colorsNeedUpdate=n.colorsNeedUpdate,i.uvsNeedUpdate=n.uvsNeedUpdate,i.groupsNeedUpdate=n.groupsNeedUpdate,n.verticesNeedUpdate=!1,n.normalsNeedUpdate=!1,n.colorsNeedUpdate=!1,n.uvsNeedUpdate=!1,n.groupsNeedUpdate=!1,n=i}return!0===n.verticesNeedUpdate&&(void 0!==(e=this.attributes.position)&&(e.copyVector3sArray(n.vertices),e.needsUpdate=!0),n.verticesNeedUpdate=!1),!0===n.normalsNeedUpdate&&(void 0!==(e=this.attributes.normal)&&(e.copyVector3sArray(n.normals),e.needsUpdate=!0),n.normalsNeedUpdate=!1),!0===n.colorsNeedUpdate&&(void 0!==(e=this.attributes.color)&&(e.copyColorsArray(n.colors),e.needsUpdate=!0),n.colorsNeedUpdate=!1),n.uvsNeedUpdate&&(void 0!==(e=this.attributes.uv)&&(e.copyVector2sArray(n.uvs),e.needsUpdate=!0),n.uvsNeedUpdate=!1),n.lineDistancesNeedUpdate&&(void 0!==(e=this.attributes.lineDistance)&&(e.copyArray(n.lineDistances),e.needsUpdate=!0),n.lineDistancesNeedUpdate=!1),n.groupsNeedUpdate&&(n.computeGroups(t.geometry),this.groups=n.groups,n.groupsNeedUpdate=!1),this},fromGeometry:function(t){return t.__directGeometry=(new de).fromGeometry(t),this.fromDirectGeometry(t.__directGeometry)},fromDirectGeometry:function(t){var e=new Float32Array(3*t.vertices.length);if(this.addAttribute("position",new oe(e,3).copyVector3sArray(t.vertices)),t.normals.length>0){var n=new Float32Array(3*t.normals.length);this.addAttribute("normal",new oe(n,3).copyVector3sArray(t.normals))}if(t.colors.length>0){var i=new Float32Array(3*t.colors.length);this.addAttribute("color",new oe(i,3).copyColorsArray(t.colors))}if(t.uvs.length>0){var r=new Float32Array(2*t.uvs.length);this.addAttribute("uv",new oe(r,2).copyVector2sArray(t.uvs))}if(t.uvs2.length>0){var o=new Float32Array(2*t.uvs2.length);this.addAttribute("uv2",new oe(o,2).copyVector2sArray(t.uvs2))}if(t.indices.length>0){var a=new(t.vertices.length>65535?Uint32Array:Uint16Array)(3*t.indices.length);this.setIndex(new oe(a,1).copyIndicesArray(t.indices))}for(var s in this.groups=t.groups,t.morphTargets){for(var c=[],l=t.morphTargets[s],h=0,u=l.length;h<u;h++){var d=l[h],p=new ce(3*d.length,3);c.push(p.copyVector3sArray(d))}this.morphAttributes[s]=c}if(t.skinIndices.length>0){var f=new ce(4*t.skinIndices.length,4);this.addAttribute("skinIndex",f.copyVector4sArray(t.skinIndices))}if(t.skinWeights.length>0){var m=new ce(4*t.skinWeights.length,4);this.addAttribute("skinWeight",m.copyVector4sArray(t.skinWeights))}return null!==t.boundingSphere&&(this.boundingSphere=t.boundingSphere.clone()),null!==t.boundingBox&&(this.boundingBox=t.boundingBox.clone()),this},computeBoundingBox:function(){null===this.boundingBox&&(this.boundingBox=new jt);var t=this.attributes.position.array;void 0!==t?this.boundingBox.setFromArray(t):this.boundingBox.makeEmpty(),(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox: Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)},computeBoundingSphere:function(){var t=new jt,e=new T;return function(){null===this.boundingSphere&&(this.boundingSphere=new Bt);var n=this.attributes.position;if(n){var i=n.array,r=this.boundingSphere.center;t.setFromArray(i),t.getCenter(r);for(var o=0,a=0,s=i.length;a<s;a+=3)e.fromArray(i,a),o=Math.max(o,r.distanceToSquared(e));this.boundingSphere.radius=Math.sqrt(o),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}}(),computeFaceNormals:function(){},computeVertexNormals:function(){var t=this.index,e=this.attributes,n=this.groups;if(e.position){var i=e.position.array;if(void 0===e.normal)this.addAttribute("normal",new oe(new Float32Array(i.length),3));else for(var r=e.normal.array,o=0,a=r.length;o<a;o++)r[o]=0;var s,c,l,h=e.normal.array,u=new T,d=new T,p=new T,f=new T,m=new T;if(t){var g=t.array;0===n.length&&this.addGroup(0,g.length);for(var v=0,y=n.length;v<y;++v){var b=n[v],x=b.start;for(o=x,a=x+b.count;o<a;o+=3)s=3*g[o+0],c=3*g[o+1],l=3*g[o+2],u.fromArray(i,s),d.fromArray(i,c),p.fromArray(i,l),f.subVectors(p,d),m.subVectors(u,d),f.cross(m),h[s]+=f.x,h[s+1]+=f.y,h[s+2]+=f.z,h[c]+=f.x,h[c+1]+=f.y,h[c+2]+=f.z,h[l]+=f.x,h[l+1]+=f.y,h[l+2]+=f.z}}else for(o=0,a=i.length;o<a;o+=9)u.fromArray(i,o),d.fromArray(i,o+3),p.fromArray(i,o+6),f.subVectors(p,d),m.subVectors(u,d),f.cross(m),h[o]=f.x,h[o+1]=f.y,h[o+2]=f.z,h[o+3]=f.x,h[o+4]=f.y,h[o+5]=f.z,h[o+6]=f.x,h[o+7]=f.y,h[o+8]=f.z;this.normalizeNormals(),e.normal.needsUpdate=!0}},merge:function(t,e){if(!1!==(t&&t.isBufferGeometry)){void 0===e&&(e=0);var n=this.attributes;for(var i in n)if(void 0!==t.attributes[i])for(var r=n[i].array,o=t.attributes[i],a=o.array,s=0,c=o.itemSize*e;s<a.length;s++,c++)r[c]=a[s];return this}console.error("THREE.BufferGeometry.merge(): geometry not an instance of THREE.BufferGeometry.",t)},normalizeNormals:function(){for(var t,e,n,i,r=this.attributes.normal.array,o=0,a=r.length;o<a;o+=3)t=r[o],e=r[o+1],n=r[o+2],i=1/Math.sqrt(t*t+e*e+n*n),r[o]*=i,r[o+1]*=i,r[o+2]*=i},toNonIndexed:function(){if(null===this.index)return console.warn("THREE.BufferGeometry.toNonIndexed(): Geometry is already non-indexed."),this;var t=new pe,e=this.index.array,n=this.attributes;for(var i in n){for(var r=n[i],o=r.array,a=r.itemSize,s=new o.constructor(e.length*a),c=0,l=0,h=0,u=e.length;h<u;h++){c=e[h]*a;for(var d=0;d<a;d++)s[l++]=o[c++]}t.addAttribute(i,new oe(s,a))}return t},toJSON:function(){var t={metadata:{version:4.4,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(t.uuid=this.uuid,t.type=this.type,""!==this.name&&(t.name=this.name),void 0!==this.parameters){var e=this.parameters;for(var n in e)void 0!==e[n]&&(t[n]=e[n]);return t}t.data={attributes:{}};var i=this.index;if(null!==i){var r=Array.prototype.slice.call(i.array);t.data.index={type:i.array.constructor.name,array:r}}var o=this.attributes;for(var n in o){var a=o[n];r=Array.prototype.slice.call(a.array),t.data.attributes[n]={itemSize:a.itemSize,type:a.array.constructor.name,array:r,normalized:a.normalized}}var s=this.groups;s.length>0&&(t.data.groups=JSON.parse(JSON.stringify(s)));var c=this.boundingSphere;return null!==c&&(t.data.boundingSphere={center:c.center.toArray(),radius:c.radius}),t},clone:function(){return(new pe).copy(this)},copy:function(t){var e=t.index;null!==e&&this.setIndex(e.clone());var n=t.attributes;for(var i in n){var r=n[i];this.addAttribute(i,r.clone())}for(var o=t.groups,a=0,s=o.length;a<s;a++){var c=o[a];this.addGroup(c.start,c.count,c.materialIndex)}return this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),pe.MaxIndex=65535,fe.prototype=Object.assign(Object.create(Yt.prototype),{constructor:fe,isMesh:!0,setDrawMode:function(t){this.drawMode=t},copy:function(t){return Yt.prototype.copy.call(this,t),this.drawMode=t.drawMode,this},updateMorphTargets:function(){var t=this.geometry.morphTargets;if(void 0!==t&&t.length>0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(var e=0,n=t.length;e<n;e++)this.morphTargetInfluences.push(0),this.morphTargetDictionary[t[e].name]=e}},raycast:function(){var t=new M,e=new Wt,n=new Bt,i=new T,r=new T,o=new T,a=new T,s=new T,c=new T,l=new d,h=new d,u=new d,p=new T,f=new T,m=new T;function g(t,e,n,i,r,o,a){return ne.barycoordFromPoint(t,e,n,i,p),r.multiplyScalar(p.x),o.multiplyScalar(p.y),a.multiplyScalar(p.z),r.add(o).add(a),r.clone()}function v(t,e,n,i,r,o,a){var s=t.material;if(null===(1===s.side?n.intersectTriangle(o,r,i,!0,a):n.intersectTriangle(i,r,o,2!==s.side,a)))return null;m.copy(a),m.applyMatrix4(t.matrixWorld);var c=e.ray.origin.distanceTo(m);return c<e.near||c>e.far?null:{distance:c,point:m.clone(),object:t}}function y(t,e,n,a,s,c,d,p){i.fromArray(a,3*c),r.fromArray(a,3*d),o.fromArray(a,3*p);var m=v(t,e,n,i,r,o,f);return m&&(s&&(l.fromArray(s,2*c),h.fromArray(s,2*d),u.fromArray(s,2*p),m.uv=g(f,i,r,o,l,h,u)),m.face=new ie(c,d,p,ne.normal(i,r,o)),m.faceIndex=c),m}return function(d,p){var m,b,x=this.geometry,w=this.material,_=this.matrixWorld;if(void 0!==w&&(null===x.boundingSphere&&x.computeBoundingSphere(),n.copy(x.boundingSphere),n.applyMatrix4(_),!1!==d.ray.intersectsSphere(n)&&(t.getInverse(_),e.copy(d.ray).applyMatrix4(t),null===x.boundingBox||!1!==e.intersectsBox(x.boundingBox))))if(x&&x.isBufferGeometry){var S,E,A,T=x.index,M=x.attributes,C=M.position.array;if(void 0!==M.uv&&(m=M.uv.array),null!==T)for(var P=T.array,R=0,L=P.length;R<L;R+=3)S=P[R],E=P[R+1],A=P[R+2],(b=y(this,d,e,C,m,S,E,A))&&(b.faceIndex=Math.floor(R/3),p.push(b));else for(R=0,L=C.length;R<L;R+=9)(b=y(this,d,e,C,m,S=R/3,E=S+1,A=S+2))&&(b.index=S,p.push(b))}else if(x&&x.isGeometry){var k,I,D,O=w&&w.isMultiMaterial,F=!0===O?w.materials:null,N=x.vertices,U=x.faces,j=x.faceVertexUvs[0];j.length>0&&(m=j);for(var B=0,z=U.length;B<z;B++){var H=U[B],G=!0===O?F[H.materialIndex]:w;if(void 0!==G){if(k=N[H.a],I=N[H.b],D=N[H.c],!0===G.morphTargets){var V=x.morphTargets,W=this.morphTargetInfluences;i.set(0,0,0),r.set(0,0,0),o.set(0,0,0);for(var X=0,q=V.length;X<q;X++){var Y=W[X];if(0!==Y){var Z=V[X].vertices;i.addScaledVector(a.subVectors(Z[H.a],k),Y),r.addScaledVector(s.subVectors(Z[H.b],I),Y),o.addScaledVector(c.subVectors(Z[H.c],D),Y)}}i.add(k),r.add(I),o.add(D),k=i,I=r,D=o}if(b=v(this,d,e,k,I,D,f)){if(m){var $=m[B];l.copy($[0]),h.copy($[1]),u.copy($[2]),b.uv=g(f,k,I,D,l,h,u)}b.face=H,b.faceIndex=B,p.push(b)}}}}}}(),clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}}),me.prototype=Object.create(pe.prototype),me.prototype.constructor=me,ge.prototype=Object.create(pe.prototype),ge.prototype.constructor=ge,ve.prototype=Object.create(Yt.prototype),ve.prototype.constructor=ve,ve.prototype.isCamera=!0,ve.prototype.getWorldDirection=function(){var t=new A;return function(e){var n=e||new T;return this.getWorldQuaternion(t),n.set(0,0,-1).applyQuaternion(t)}}(),ve.prototype.lookAt=function(){var t=new M;return function(e){t.lookAt(this.position,e,this.up),this.quaternion.setFromRotationMatrix(t)}}(),ve.prototype.clone=function(){return(new this.constructor).copy(this)},ve.prototype.copy=function(t){return Yt.prototype.copy.call(this,t),this.matrixWorldInverse.copy(t.matrixWorldInverse),this.projectionMatrix.copy(t.projectionMatrix),this},ye.prototype=Object.assign(Object.create(ve.prototype),{constructor:ye,isPerspectiveCamera:!0,copy:function(t){return ve.prototype.copy.call(this,t),this.fov=t.fov,this.zoom=t.zoom,this.near=t.near,this.far=t.far,this.focus=t.focus,this.aspect=t.aspect,this.view=null===t.view?null:Object.assign({},t.view),this.filmGauge=t.filmGauge,this.filmOffset=t.filmOffset,this},setFocalLength:function(e){var n=.5*this.getFilmHeight()/e;this.fov=2*t.Math.RAD2DEG*Math.atan(n),this.updateProjectionMatrix()},getFocalLength:function(){var e=Math.tan(.5*t.Math.DEG2RAD*this.fov);return.5*this.getFilmHeight()/e},getEffectiveFOV:function(){return 2*t.Math.RAD2DEG*Math.atan(Math.tan(.5*t.Math.DEG2RAD*this.fov)/this.zoom)},getFilmWidth:function(){return this.filmGauge*Math.min(this.aspect,1)},getFilmHeight:function(){return this.filmGauge/Math.max(this.aspect,1)},setViewOffset:function(t,e,n,i,r,o){this.aspect=t/e,this.view={fullWidth:t,fullHeight:e,offsetX:n,offsetY:i,width:r,height:o},this.updateProjectionMatrix()},clearViewOffset:function(){this.view=null,this.updateProjectionMatrix()},updateProjectionMatrix:function(){var e=this.near,n=e*Math.tan(.5*t.Math.DEG2RAD*this.fov)/this.zoom,i=2*n,r=this.aspect*i,o=-.5*r,a=this.view;if(null!==a){var s=a.fullWidth,c=a.fullHeight;o+=a.offsetX*r/s,n-=a.offsetY*i/c,r*=a.width/s,i*=a.height/c}var l=this.filmOffset;0!==l&&(o+=e*l/this.getFilmWidth()),this.projectionMatrix.makeFrustum(o,o+r,n-i,n,e,this.far)},toJSON:function(t){var e=Yt.prototype.toJSON.call(this,t);return e.object.fov=this.fov,e.object.zoom=this.zoom,e.object.near=this.near,e.object.far=this.far,e.object.focus=this.focus,e.object.aspect=this.aspect,null!==this.view&&(e.object.view=Object.assign({},this.view)),e.object.filmGauge=this.filmGauge,e.object.filmOffset=this.filmOffset,e}}),be.prototype=Object.assign(Object.create(ve.prototype),{constructor:be,isOrthographicCamera:!0,copy:function(t){return ve.prototype.copy.call(this,t),this.left=t.left,this.right=t.right,this.top=t.top,this.bottom=t.bottom,this.near=t.near,this.far=t.far,this.zoom=t.zoom,this.view=null===t.view?null:Object.assign({},t.view),this},setViewOffset:function(t,e,n,i,r,o){this.view={fullWidth:t,fullHeight:e,offsetX:n,offsetY:i,width:r,height:o},this.updateProjectionMatrix()},clearViewOffset:function(){this.view=null,this.updateProjectionMatrix()},updateProjectionMatrix:function(){var t=(this.right-this.left)/(2*this.zoom),e=(this.top-this.bottom)/(2*this.zoom),n=(this.right+this.left)/2,i=(this.top+this.bottom)/2,r=n-t,o=n+t,a=i+e,s=i-e;if(null!==this.view){var c=this.zoom/(this.view.width/this.view.fullWidth),l=this.zoom/(this.view.height/this.view.fullHeight),h=(this.right-this.left)/this.view.width,u=(this.top-this.bottom)/this.view.height;o=(r+=h*(this.view.offsetX/c))+h*(this.view.width/c),s=(a-=u*(this.view.offsetY/l))-u*(this.view.height/l)}this.projectionMatrix.makeOrthographic(r,o,a,s,this.near,this.far)},toJSON:function(t){var e=Yt.prototype.toJSON.call(this,t);return e.object.zoom=this.zoom,e.object.left=this.left,e.object.right=this.right,e.object.top=this.top,e.object.bottom=this.bottom,e.object.near=this.near,e.object.far=this.far,null!==this.view&&(e.object.view=Object.assign({},this.view)),e}});var Ee,Ae,Te=0;function Me(t){switch(t){case 3e3:return["Linear","( value )"];case 3001:return["sRGB","( value )"];case 3002:return["RGBE","( value )"];case 3004:return["RGBM","( value, 7.0 )"];case 3005:return["RGBM","( value, 16.0 )"];case 3006:return["RGBD","( value, 256.0 )"];case 3007:return["Gamma","( value, float( GAMMA_FACTOR ) )"];default:throw new Error("unsupported encoding: "+t)}}function Ce(t,e){var n=Me(e);return"vec4 "+t+"( vec4 value ) { return "+n[0]+"ToLinear"+n[1]+"; }"}function Pe(t,e){var n;switch(e){case 1:n="Linear";break;case 2:n="Reinhard";break;case 3:n="Uncharted2";break;case 4:n="OptimizedCineon";break;default:throw new Error("unsupported toneMapping: "+e)}return"vec3 "+t+"( vec3 color ) { return "+n+"ToneMapping( color ); }"}function Re(t){return""!==t}function Le(t,e){return t.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights)}function ke(t){return t.replace(/#include +<([\w\d.]+)>/g,(function(t,e){var n=dt[e];if(void 0===n)throw new Error("Can not resolve #include <"+e+">");return ke(n)}))}function Ie(t){return t.replace(/for \( int i \= (\d+)\; i < (\d+)\; i \+\+ \) \{([\s\S]+?)(?=\})\}/g,(function(t,e,n,i){for(var r="",o=parseInt(e);o<parseInt(n);o++)r+=i.replace(/\[ i \]/g,"[ "+o+" ]");return r}))}function De(t,e,n,i){var r=t.context,o=n.extensions,a=n.defines,s=n.__webglShader.vertexShader,c=n.__webglShader.fragmentShader,l="SHADOWMAP_TYPE_BASIC";1===i.shadowMapType?l="SHADOWMAP_TYPE_PCF":2===i.shadowMapType&&(l="SHADOWMAP_TYPE_PCF_SOFT");var h="ENVMAP_TYPE_CUBE",u="ENVMAP_MODE_REFLECTION",d="ENVMAP_BLENDING_MULTIPLY";if(i.envMap){switch(n.envMap.mapping){case 301:case 302:h="ENVMAP_TYPE_CUBE";break;case 306:case 307:h="ENVMAP_TYPE_CUBE_UV";break;case 303:case 304:h="ENVMAP_TYPE_EQUIREC";break;case 305:h="ENVMAP_TYPE_SPHERE"}switch(n.envMap.mapping){case 302:case 304:u="ENVMAP_MODE_REFRACTION"}switch(n.combine){case 0:d="ENVMAP_BLENDING_MULTIPLY";break;case 1:d="ENVMAP_BLENDING_MIX";break;case 2:d="ENVMAP_BLENDING_ADD"}}var p,f,m,g,v,y=t.gammaFactor>0?t.gammaFactor:1,b=function(t,e,n){return[(t=t||{}).derivatives||e.envMapCubeUV||e.bumpMap||e.normalMap||e.flatShading?"#extension GL_OES_standard_derivatives : enable":"",(t.fragDepth||e.logarithmicDepthBuffer)&&n.get("EXT_frag_depth")?"#extension GL_EXT_frag_depth : enable":"",t.drawBuffers&&n.get("WEBGL_draw_buffers")?"#extension GL_EXT_draw_buffers : require":"",(t.shaderTextureLOD||e.envMap)&&n.get("EXT_shader_texture_lod")?"#extension GL_EXT_shader_texture_lod : enable":""].filter(Re).join("\n")}(o,i,t.extensions),x=function(t){var e=[];for(var n in t){var i=t[n];!1!==i&&e.push("#define "+n+" "+i)}return e.join("\n")}(a),w=r.createProgram();n.isRawShaderMaterial?(p=[x,"\n"].filter(Re).join("\n"),f=[b,x,"\n"].filter(Re).join("\n")):(p=["precision "+i.precision+" float;","precision "+i.precision+" int;","#define SHADER_NAME "+n.__webglShader.name,x,i.supportsVertexTextures?"#define VERTEX_TEXTURES":"","#define GAMMA_FACTOR "+y,"#define MAX_BONES "+i.maxBones,i.map?"#define USE_MAP":"",i.envMap?"#define USE_ENVMAP":"",i.envMap?"#define "+u:"",i.lightMap?"#define USE_LIGHTMAP":"",i.aoMap?"#define USE_AOMAP":"",i.emissiveMap?"#define USE_EMISSIVEMAP":"",i.bumpMap?"#define USE_BUMPMAP":"",i.normalMap?"#define USE_NORMALMAP":"",i.displacementMap&&i.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",i.specularMap?"#define USE_SPECULARMAP":"",i.roughnessMap?"#define USE_ROUGHNESSMAP":"",i.metalnessMap?"#define USE_METALNESSMAP":"",i.alphaMap?"#define USE_ALPHAMAP":"",i.vertexColors?"#define USE_COLOR":"",i.flatShading?"#define FLAT_SHADED":"",i.skinning?"#define USE_SKINNING":"",i.useVertexTexture?"#define BONE_TEXTURE":"",i.morphTargets?"#define USE_MORPHTARGETS":"",i.morphNormals&&!1===i.flatShading?"#define USE_MORPHNORMALS":"",i.doubleSided?"#define DOUBLE_SIDED":"",i.flipSided?"#define FLIP_SIDED":"","#define NUM_CLIPPING_PLANES "+i.numClippingPlanes,i.shadowMapEnabled?"#define USE_SHADOWMAP":"",i.shadowMapEnabled?"#define "+l:"",i.sizeAttenuation?"#define USE_SIZEATTENUATION":"",i.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",i.logarithmicDepthBuffer&&t.extensions.get("EXT_frag_depth")?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_COLOR","\tattribute vec3 color;","#endif","#ifdef USE_MORPHTARGETS","\tattribute vec3 morphTarget0;","\tattribute vec3 morphTarget1;","\tattribute vec3 morphTarget2;","\tattribute vec3 morphTarget3;","\t#ifdef USE_MORPHNORMALS","\t\tattribute vec3 morphNormal0;","\t\tattribute vec3 morphNormal1;","\t\tattribute vec3 morphNormal2;","\t\tattribute vec3 morphNormal3;","\t#else","\t\tattribute vec3 morphTarget4;","\t\tattribute vec3 morphTarget5;","\t\tattribute vec3 morphTarget6;","\t\tattribute vec3 morphTarget7;","\t#endif","#endif","#ifdef USE_SKINNING","\tattribute vec4 skinIndex;","\tattribute vec4 skinWeight;","#endif","\n"].filter(Re).join("\n"),f=[b,"precision "+i.precision+" float;","precision "+i.precision+" int;","#define SHADER_NAME "+n.__webglShader.name,x,i.alphaTest?"#define ALPHATEST "+i.alphaTest:"","#define GAMMA_FACTOR "+y,i.useFog&&i.fog?"#define USE_FOG":"",i.useFog&&i.fogExp?"#define FOG_EXP2":"",i.map?"#define USE_MAP":"",i.envMap?"#define USE_ENVMAP":"",i.envMap?"#define "+h:"",i.envMap?"#define "+u:"",i.envMap?"#define "+d:"",i.lightMap?"#define USE_LIGHTMAP":"",i.aoMap?"#define USE_AOMAP":"",i.emissiveMap?"#define USE_EMISSIVEMAP":"",i.bumpMap?"#define USE_BUMPMAP":"",i.normalMap?"#define USE_NORMALMAP":"",i.specularMap?"#define USE_SPECULARMAP":"",i.roughnessMap?"#define USE_ROUGHNESSMAP":"",i.metalnessMap?"#define USE_METALNESSMAP":"",i.alphaMap?"#define USE_ALPHAMAP":"",i.vertexColors?"#define USE_COLOR":"",i.flatShading?"#define FLAT_SHADED":"",i.doubleSided?"#define DOUBLE_SIDED":"",i.flipSided?"#define FLIP_SIDED":"","#define NUM_CLIPPING_PLANES "+i.numClippingPlanes,i.shadowMapEnabled?"#define USE_SHADOWMAP":"",i.shadowMapEnabled?"#define "+l:"",i.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",i.physicallyCorrectLights?"#define PHYSICALLY_CORRECT_LIGHTS":"",i.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",i.logarithmicDepthBuffer&&t.extensions.get("EXT_frag_depth")?"#define USE_LOGDEPTHBUF_EXT":"",i.envMap&&t.extensions.get("EXT_shader_texture_lod")?"#define TEXTURE_LOD_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;",0!==i.toneMapping?"#define TONE_MAPPING":"",0!==i.toneMapping?dt.tonemapping_pars_fragment:"",0!==i.toneMapping?Pe("toneMapping",i.toneMapping):"",i.outputEncoding||i.mapEncoding||i.envMapEncoding||i.emissiveMapEncoding?dt.encodings_pars_fragment:"",i.mapEncoding?Ce("mapTexelToLinear",i.mapEncoding):"",i.envMapEncoding?Ce("envMapTexelToLinear",i.envMapEncoding):"",i.emissiveMapEncoding?Ce("emissiveMapTexelToLinear",i.emissiveMapEncoding):"",i.outputEncoding?(m="linearToOutputTexel",g=i.outputEncoding,v=Me(g),"vec4 "+m+"( vec4 value ) { return LinearTo"+v[0]+v[1]+"; }"):"",i.depthPacking?"#define DEPTH_PACKING "+n.depthPacking:"","\n"].filter(Re).join("\n")),s=Le(s=ke(s),i),c=Le(c=ke(c),i),n.isShaderMaterial||(s=Ie(s),c=Ie(c));var _=p+s,S=f+c,E=Se(r,r.VERTEX_SHADER,_),A=Se(r,r.FRAGMENT_SHADER,S);r.attachShader(w,E),r.attachShader(w,A),void 0!==n.index0AttributeName?r.bindAttribLocation(w,0,n.index0AttributeName):!0===i.morphTargets&&r.bindAttribLocation(w,0,"position"),r.linkProgram(w);var T,M,C=r.getProgramInfoLog(w),P=r.getShaderInfoLog(E),R=r.getShaderInfoLog(A),L=!0,k=!0;return!1===r.getProgramParameter(w,r.LINK_STATUS)?(L=!1,console.error("THREE.WebGLProgram: shader error: ",r.getError(),"gl.VALIDATE_STATUS",r.getProgramParameter(w,r.VALIDATE_STATUS),"gl.getProgramInfoLog",C,P,R)):""!==C?console.warn("THREE.WebGLProgram: gl.getProgramInfoLog()",C):""!==P&&""!==R||(k=!1),k&&(this.diagnostics={runnable:L,material:n,programLog:C,vertexShader:{log:P,prefix:p},fragmentShader:{log:R,prefix:f}}),r.deleteShader(E),r.deleteShader(A),this.getUniforms=function(){return void 0===T&&(T=new ut(r,w,t)),T},this.getAttributes=function(){return void 0===M&&(M=function(t,e,n){for(var i={},r=t.getProgramParameter(e,t.ACTIVE_ATTRIBUTES),o=0;o<r;o++){var a=t.getActiveAttrib(e,o).name;i[a]=t.getAttribLocation(e,a)}return i}(r,w)),M},this.destroy=function(){r.deleteProgram(w),this.program=void 0},Object.defineProperties(this,{uniforms:{get:function(){return console.warn("THREE.WebGLProgram: .uniforms is now .getUniforms()."),this.getUniforms()}},attributes:{get:function(){return console.warn("THREE.WebGLProgram: .attributes is now .getAttributes()."),this.getAttributes()}}}),this.id=Te++,this.code=e,this.usedTimes=1,this.program=w,this.vertexShader=E,this.fragmentShader=A,this}function Oe(t,e){var n=[],i={MeshDepthMaterial:"depth",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points"},r=["precision","supportsVertexTextures","map","mapEncoding","envMap","envMapMode","envMapEncoding","lightMap","aoMap","emissiveMap","emissiveMapEncoding","bumpMap","normalMap","displacementMap","specularMap","roughnessMap","metalnessMap","alphaMap","combine","vertexColors","fog","useFog","fogExp","flatShading","sizeAttenuation","logarithmicDepthBuffer","skinning","maxBones","useVertexTexture","morphTargets","morphNormals","maxMorphTargets","maxMorphNormals","premultipliedAlpha","numDirLights","numPointLights","numSpotLights","numHemiLights","shadowMapEnabled","shadowMapType","toneMapping","physicallyCorrectLights","alphaTest","doubleSided","flipSided","numClippingPlanes","depthPacking"];function o(t,e){var n;return t?t&&t.isTexture?n=t.encoding:t&&t.isWebGLRenderTarget&&(console.warn("THREE.WebGLPrograms.getTextureEncodingFromMap: don't use render targets as textures. Use their .texture property instead."),n=t.texture.encoding):n=3e3,3e3===n&&e&&(n=3007),n}this.getParameters=function(n,r,a,s,c){var l=i[n.type],h=function(t){if(e.floatVertexTextures&&t&&t.skeleton&&t.skeleton.useVertexTexture)return 1024;var n=e.maxVertexUniforms,i=Math.floor((n-20)/4);return void 0!==t&&t&&t.isSkinnedMesh&&(i=Math.min(t.skeleton.bones.length,i))<t.skeleton.bones.length&&console.warn("WebGLRenderer: too many bones - "+t.skeleton.bones.length+", this GPU supports just "+i+" (try OpenGL instead of ANGLE)"),i}(c),u=t.getPrecision();null!==n.precision&&(u=e.getMaxPrecision(n.precision))!==n.precision&&console.warn("THREE.WebGLProgram.getParameters:",n.precision,"not supported, using",u,"instead.");var d=t.getCurrentRenderTarget();return{shaderID:l,precision:u,supportsVertexTextures:e.vertexTextures,outputEncoding:o(d?d.texture:null,t.gammaOutput),map:!!n.map,mapEncoding:o(n.map,t.gammaInput),envMap:!!n.envMap,envMapMode:n.envMap&&n.envMap.mapping,envMapEncoding:o(n.envMap,t.gammaInput),envMapCubeUV:!!n.envMap&&(306===n.envMap.mapping||307===n.envMap.mapping),lightMap:!!n.lightMap,aoMap:!!n.aoMap,emissiveMap:!!n.emissiveMap,emissiveMapEncoding:o(n.emissiveMap,t.gammaInput),bumpMap:!!n.bumpMap,normalMap:!!n.normalMap,displacementMap:!!n.displacementMap,roughnessMap:!!n.roughnessMap,metalnessMap:!!n.metalnessMap,specularMap:!!n.specularMap,alphaMap:!!n.alphaMap,combine:n.combine,vertexColors:n.vertexColors,fog:!!a,useFog:n.fog,fogExp:a&&a.isFogExp2,flatShading:1===n.shading,sizeAttenuation:n.sizeAttenuation,logarithmicDepthBuffer:e.logarithmicDepthBuffer,skinning:n.skinning,maxBones:h,useVertexTexture:e.floatVertexTextures&&c&&c.skeleton&&c.skeleton.useVertexTexture,morphTargets:n.morphTargets,morphNormals:n.morphNormals,maxMorphTargets:t.maxMorphTargets,maxMorphNormals:t.maxMorphNormals,numDirLights:r.directional.length,numPointLights:r.point.length,numSpotLights:r.spot.length,numHemiLights:r.hemi.length,numClippingPlanes:s,shadowMapEnabled:t.shadowMap.enabled&&c.receiveShadow&&r.shadows.length>0,shadowMapType:t.shadowMap.type,toneMapping:t.toneMapping,physicallyCorrectLights:t.physicallyCorrectLights,premultipliedAlpha:n.premultipliedAlpha,alphaTest:n.alphaTest,doubleSided:2===n.side,flipSided:1===n.side,depthPacking:void 0!==n.depthPacking&&n.depthPacking}},this.getProgramCode=function(t,e){var n=[];if(e.shaderID?n.push(e.shaderID):(n.push(t.fragmentShader),n.push(t.vertexShader)),void 0!==t.defines)for(var i in t.defines)n.push(i),n.push(t.defines[i]);for(var o=0;o<r.length;o++)n.push(e[r[o]]);return n.join()},this.acquireProgram=function(e,i,r){for(var o,a=0,s=n.length;a<s;a++){var c=n[a];if(c.code===r){++(o=c).usedTimes;break}}return void 0===o&&(o=new De(t,r,e,i),n.push(o)),o},this.releaseProgram=function(t){if(0==--t.usedTimes){var e=n.indexOf(t);n[e]=n[n.length-1],n.pop(),t.destroy()}},this.programs=n}function Fe(t,e,n){var i={};function r(t){var a=t.target,s=i[a.id];null!==s.index&&o(s.index),function(t){for(var e in t)o(t[e])}(s.attributes),a.removeEventListener("dispose",r),delete i[a.id];var c=e.get(a);c.wireframe&&o(c.wireframe),e.delete(a);var l=e.get(s);l.wireframe&&o(l.wireframe),e.delete(s),n.memory.geometries--}function o(n){var i=function(t){return t.isInterleavedBufferAttribute?e.get(t.data).__webglBuffer:e.get(t).__webglBuffer}(n);void 0!==i&&(t.deleteBuffer(i),function(t){t.isInterleavedBufferAttribute?e.delete(t.data):e.delete(t)}(n))}return{get:function(t){var e,o=t.geometry;return void 0!==i[o.id]?i[o.id]:(o.addEventListener("dispose",r),o.isBufferGeometry?e=o:o.isGeometry&&(void 0===o._bufferGeometry&&(o._bufferGeometry=(new pe).setFromObject(t)),e=o._bufferGeometry),i[o.id]=e,n.memory.geometries++,e)}}}function Ne(t,e,n){var i=new Fe(t,e,n);function r(n,i){var r=n.isInterleavedBufferAttribute?n.data:n,o=e.get(r);void 0===o.__webglBuffer?function(e,n,i){e.__webglBuffer=t.createBuffer(),t.bindBuffer(i,e.__webglBuffer);var r=n.dynamic?t.DYNAMIC_DRAW:t.STATIC_DRAW;t.bufferData(i,n.array,r),e.version=n.version}(o,r,i):o.version!==r.version&&function(e,n,i){t.bindBuffer(i,e.__webglBuffer),!1===n.dynamic||-1===n.updateRange.count?t.bufferSubData(i,0,n.array):0===n.updateRange.count?console.error("THREE.WebGLObjects.updateBuffer: dynamic THREE.BufferAttribute marked as needsUpdate but updateRange.count is 0, ensure you are using set methods or updating manually."):(t.bufferSubData(i,n.updateRange.offset*n.array.BYTES_PER_ELEMENT,n.array.subarray(n.updateRange.offset,n.updateRange.offset+n.updateRange.count)),n.updateRange.count=0),e.version=n.version}(o,r,i)}return{getAttributeBuffer:function(t){return t.isInterleavedBufferAttribute?e.get(t.data).__webglBuffer:e.get(t).__webglBuffer},getWireframeAttribute:function(n){var i=e.get(n);if(void 0!==i.wireframe)return i.wireframe;var o,a=[],s=n.index,c=n.attributes,l=c.position;if(null!==s)for(var h=0,u=(o=s.array).length;h<u;h+=3){var d=o[h+0],p=o[h+1],f=o[h+2];a.push(d,p,p,f,f,d)}else for(h=0,u=(o=c.position.array).length/3-1;h<u;h+=3)d=h+0,p=h+1,f=h+2,a.push(d,p,p,f,f,d);var m=new oe(new(l.count>65535?Uint32Array:Uint16Array)(a),1);return r(m,t.ELEMENT_ARRAY_BUFFER),i.wireframe=m,m},update:function(e){var n=i.get(e);e.geometry.isGeometry&&n.updateFromObject(e);var o=n.index,a=n.attributes;for(var s in null!==o&&r(o,t.ELEMENT_ARRAY_BUFFER),a)r(a[s],t.ARRAY_BUFFER);var c=n.morphAttributes;for(var s in c)for(var l=c[s],h=0,u=l.length;h<u;h++)r(l[h],t.ARRAY_BUFFER);return n}}}function Ue(e,n,i,r,o,a,s){var c=s.memory,l="undefined"!=typeof WebGL2RenderingContext&&e instanceof WebGL2RenderingContext;function h(t,e){if(t.width>e||t.height>e){var n=e/Math.max(t.width,t.height),i=document.createElementNS("http://www.w3.org/1999/xhtml","canvas");return i.width=Math.floor(t.width*n),i.height=Math.floor(t.height*n),i.getContext("2d").drawImage(t,0,0,t.width,t.height,0,0,i.width,i.height),console.warn("THREE.WebGLRenderer: image is too big ("+t.width+"x"+t.height+"). Resized to "+i.width+"x"+i.height,t),i}return t}function u(e){return t.Math.isPowerOfTwo(e.width)&&t.Math.isPowerOfTwo(e.height)}function d(t){return 1003===t||1004===t||1005===t?e.NEAREST:e.LINEAR}function p(t){var n=t.target;n.removeEventListener("dispose",p),function(t){var n=r.get(t);if(t.image&&n.__image__webglTextureCube)e.deleteTexture(n.__image__webglTextureCube);else{if(void 0===n.__webglInit)return;e.deleteTexture(n.__webglTexture)}r.delete(t)}(n),c.textures--}function f(t){var n=t.target;n.removeEventListener("dispose",f),function(t){var n=r.get(t),i=r.get(t.texture);if(t){if(void 0!==i.__webglTexture&&e.deleteTexture(i.__webglTexture),t.depthTexture&&t.depthTexture.dispose(),t&&t.isWebGLRenderTargetCube)for(var o=0;o<6;o++)e.deleteFramebuffer(n.__webglFramebuffer[o]),n.__webglDepthbuffer&&e.deleteRenderbuffer(n.__webglDepthbuffer[o]);else e.deleteFramebuffer(n.__webglFramebuffer),n.__webglDepthbuffer&&e.deleteRenderbuffer(n.__webglDepthbuffer);r.delete(t.texture),r.delete(t)}}(n),c.textures--}function m(n,s){var d=r.get(n);if(n.version>0&&d.__version!==n.version){var f=n.image;if(void 0===f)console.warn("THREE.WebGLRenderer: Texture marked for update but image is undefined",n);else{if(!1!==f.complete)return void function(n,r,s){void 0===n.__webglInit&&(n.__webglInit=!0,r.addEventListener("dispose",p),n.__webglTexture=e.createTexture(),c.textures++),i.activeTexture(e.TEXTURE0+s),i.bindTexture(e.TEXTURE_2D,n.__webglTexture),e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,r.flipY),e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,r.premultiplyAlpha),e.pixelStorei(e.UNPACK_ALIGNMENT,r.unpackAlignment);var d=h(r.image,o.maxTextureSize);(function(t){return 1001!==t.wrapS||1001!==t.wrapT||1003!==t.minFilter&&1006!==t.minFilter})(r)&&!1===u(d)&&(d=function(e){if(e instanceof HTMLImageElement||e instanceof HTMLCanvasElement){var n=document.createElementNS("http://www.w3.org/1999/xhtml","canvas");return n.width=t.Math.nearestPowerOfTwo(e.width),n.height=t.Math.nearestPowerOfTwo(e.height),n.getContext("2d").drawImage(e,0,0,n.width,n.height),console.warn("THREE.WebGLRenderer: image is not power of two ("+e.width+"x"+e.height+"). Resized to "+n.width+"x"+n.height,e),n}return e}(d));var f=u(d),m=a(r.format),v=a(r.type);g(e.TEXTURE_2D,r,f);var y,b=r.mipmaps;if(r&&r.isDepthTexture){var x=e.DEPTH_COMPONENT;if(1015===r.type){if(!l)throw new Error("Float Depth Texture only supported in WebGL2.0");x=e.DEPTH_COMPONENT32F}else l&&(x=e.DEPTH_COMPONENT16);1027===r.format&&(x=e.DEPTH_STENCIL),i.texImage2D(e.TEXTURE_2D,0,x,d.width,d.height,0,m,v,null)}else if(r&&r.isDataTexture)if(b.length>0&&f){for(var w=0,_=b.length;w<_;w++)y=b[w],i.texImage2D(e.TEXTURE_2D,w,m,y.width,y.height,0,m,v,y.data);r.generateMipmaps=!1}else i.texImage2D(e.TEXTURE_2D,0,m,d.width,d.height,0,m,v,d.data);else if(r&&r.isCompressedTexture)for(w=0,_=b.length;w<_;w++)y=b[w],1023!==r.format&&1022!==r.format?i.getCompressedTextureFormats().indexOf(m)>-1?i.compressedTexImage2D(e.TEXTURE_2D,w,m,y.width,y.height,0,y.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):i.texImage2D(e.TEXTURE_2D,w,m,y.width,y.height,0,m,v,y.data);else if(b.length>0&&f){for(w=0,_=b.length;w<_;w++)y=b[w],i.texImage2D(e.TEXTURE_2D,w,m,m,v,y);r.generateMipmaps=!1}else i.texImage2D(e.TEXTURE_2D,0,m,m,v,d);r.generateMipmaps&&f&&e.generateMipmap(e.TEXTURE_2D),n.__version=r.version,r.onUpdate&&r.onUpdate(r)}(d,n,s);console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete",n)}}i.activeTexture(e.TEXTURE0+s),i.bindTexture(e.TEXTURE_2D,d.__webglTexture)}function g(t,i,s){var c;if(s?(e.texParameteri(t,e.TEXTURE_WRAP_S,a(i.wrapS)),e.texParameteri(t,e.TEXTURE_WRAP_T,a(i.wrapT)),e.texParameteri(t,e.TEXTURE_MAG_FILTER,a(i.magFilter)),e.texParameteri(t,e.TEXTURE_MIN_FILTER,a(i.minFilter))):(e.texParameteri(t,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(t,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),1001===i.wrapS&&1001===i.wrapT||console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping.",i),e.texParameteri(t,e.TEXTURE_MAG_FILTER,d(i.magFilter)),e.texParameteri(t,e.TEXTURE_MIN_FILTER,d(i.minFilter)),1003!==i.minFilter&&1006!==i.minFilter&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.",i)),c=n.get("EXT_texture_filter_anisotropic")){if(1015===i.type&&null===n.get("OES_texture_float_linear"))return;if(1016===i.type&&null===n.get("OES_texture_half_float_linear"))return;(i.anisotropy>1||r.get(i).__currentAnisotropy)&&(e.texParameterf(t,c.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(i.anisotropy,o.getMaxAnisotropy())),r.get(i).__currentAnisotropy=i.anisotropy)}}function v(t,n,o,s){var c=a(n.texture.format),l=a(n.texture.type);i.texImage2D(s,0,c,n.width,n.height,0,c,l,null),e.bindFramebuffer(e.FRAMEBUFFER,t),e.framebufferTexture2D(e.FRAMEBUFFER,o,s,r.get(n.texture).__webglTexture,0),e.bindFramebuffer(e.FRAMEBUFFER,null)}function y(t,n){e.bindRenderbuffer(e.RENDERBUFFER,t),n.depthBuffer&&!n.stencilBuffer?(e.renderbufferStorage(e.RENDERBUFFER,e.DEPTH_COMPONENT16,n.width,n.height),e.framebufferRenderbuffer(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.RENDERBUFFER,t)):n.depthBuffer&&n.stencilBuffer?(e.renderbufferStorage(e.RENDERBUFFER,e.DEPTH_STENCIL,n.width,n.height),e.framebufferRenderbuffer(e.FRAMEBUFFER,e.DEPTH_STENCIL_ATTACHMENT,e.RENDERBUFFER,t)):e.renderbufferStorage(e.RENDERBUFFER,e.RGBA4,n.width,n.height),e.bindRenderbuffer(e.RENDERBUFFER,null)}function b(t){var n=r.get(t),i=t&&t.isWebGLRenderTargetCube;if(t.depthTexture){if(i)throw new Error("target.depthTexture not supported in Cube render targets");!function(t,n){if(n&&n.isWebGLRenderTargetCube)throw new Error("Depth Texture with cube render targets is not supported!");if(e.bindFramebuffer(e.FRAMEBUFFER,t),!n.depthTexture||!n.depthTexture.isDepthTexture)throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");r.get(n.depthTexture).__webglTexture&&n.depthTexture.image.width===n.width&&n.depthTexture.image.height===n.height||(n.depthTexture.image.width=n.width,n.depthTexture.image.height=n.height,n.depthTexture.needsUpdate=!0),m(n.depthTexture,0);var i=r.get(n.depthTexture).__webglTexture;if(1026===n.depthTexture.format)e.framebufferTexture2D(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.TEXTURE_2D,i,0);else{if(1027!==n.depthTexture.format)throw new Error("Unknown depthTexture format");e.framebufferTexture2D(e.FRAMEBUFFER,e.DEPTH_STENCIL_ATTACHMENT,e.TEXTURE_2D,i,0)}}(n.__webglFramebuffer,t)}else if(i){n.__webglDepthbuffer=[];for(var o=0;o<6;o++)e.bindFramebuffer(e.FRAMEBUFFER,n.__webglFramebuffer[o]),n.__webglDepthbuffer[o]=e.createRenderbuffer(),y(n.__webglDepthbuffer[o],t)}else e.bindFramebuffer(e.FRAMEBUFFER,n.__webglFramebuffer),n.__webglDepthbuffer=e.createRenderbuffer(),y(n.__webglDepthbuffer,t);e.bindFramebuffer(e.FRAMEBUFFER,null)}this.setTexture2D=m,this.setTextureCube=function(t,n){var s=r.get(t);if(6===t.image.length)if(t.version>0&&s.__version!==t.version){s.__image__webglTextureCube||(t.addEventListener("dispose",p),s.__image__webglTextureCube=e.createTexture(),c.textures++),i.activeTexture(e.TEXTURE0+n),i.bindTexture(e.TEXTURE_CUBE_MAP,s.__image__webglTextureCube),e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,t.flipY);for(var l=t&&t.isCompressedTexture,d=t.image[0]&&t.image[0].isDataTexture,f=[],m=0;m<6;m++)f[m]=l||d?d?t.image[m].image:t.image[m]:h(t.image[m],o.maxCubemapSize);var v=u(f[0]),y=a(t.format),b=a(t.type);for(g(e.TEXTURE_CUBE_MAP,t,v),m=0;m<6;m++)if(l)for(var x,w=f[m].mipmaps,_=0,S=w.length;_<S;_++)x=w[_],1023!==t.format&&1022!==t.format?i.getCompressedTextureFormats().indexOf(y)>-1?i.compressedTexImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+m,_,y,x.width,x.height,0,x.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):i.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+m,_,y,x.width,x.height,0,y,b,x.data);else d?i.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+m,0,y,f[m].width,f[m].height,0,y,b,f[m].data):i.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+m,0,y,y,b,f[m]);t.generateMipmaps&&v&&e.generateMipmap(e.TEXTURE_CUBE_MAP),s.__version=t.version,t.onUpdate&&t.onUpdate(t)}else i.activeTexture(e.TEXTURE0+n),i.bindTexture(e.TEXTURE_CUBE_MAP,s.__image__webglTextureCube)},this.setTextureCubeDynamic=function(t,n){i.activeTexture(e.TEXTURE0+n),i.bindTexture(e.TEXTURE_CUBE_MAP,r.get(t).__webglTexture)},this.setupRenderTarget=function(t){var n=r.get(t),o=r.get(t.texture);t.addEventListener("dispose",f),o.__webglTexture=e.createTexture(),c.textures++;var a=t&&t.isWebGLRenderTargetCube,s=u(t);if(a){n.__webglFramebuffer=[];for(var l=0;l<6;l++)n.__webglFramebuffer[l]=e.createFramebuffer()}else n.__webglFramebuffer=e.createFramebuffer();if(a){for(i.bindTexture(e.TEXTURE_CUBE_MAP,o.__webglTexture),g(e.TEXTURE_CUBE_MAP,t.texture,s),l=0;l<6;l++)v(n.__webglFramebuffer[l],t,e.COLOR_ATTACHMENT0,e.TEXTURE_CUBE_MAP_POSITIVE_X+l);t.texture.generateMipmaps&&s&&e.generateMipmap(e.TEXTURE_CUBE_MAP),i.bindTexture(e.TEXTURE_CUBE_MAP,null)}else i.bindTexture(e.TEXTURE_2D,o.__webglTexture),g(e.TEXTURE_2D,t.texture,s),v(n.__webglFramebuffer,t,e.COLOR_ATTACHMENT0,e.TEXTURE_2D),t.texture.generateMipmaps&&s&&e.generateMipmap(e.TEXTURE_2D),i.bindTexture(e.TEXTURE_2D,null);t.depthBuffer&&b(t)},this.updateRenderTargetMipmap=function(t){var n=t.texture;if(n.generateMipmaps&&u(t)&&1003!==n.minFilter&&1006!==n.minFilter){var o=t&&t.isWebGLRenderTargetCube?e.TEXTURE_CUBE_MAP:e.TEXTURE_2D,a=r.get(n).__webglTexture;i.bindTexture(o,a),e.generateMipmap(o),i.bindTexture(o,null)}}}function je(){var t={};return{get:function(e){var n=e.uuid,i=t[n];return void 0===i&&(i={},t[n]=i),i},delete:function(e){delete t[e.uuid]},clear:function(){t={}}}}function Be(t,e,n){var i=new function(){var e=!1,n=new _,i=null,r=new _;return{setMask:function(n){i===n||e||(t.colorMask(n,n,n,n),i=n)},setLocked:function(t){e=t},setClear:function(e,i,o,a){n.set(e,i,o,a),!1===r.equals(n)&&(t.clearColor(e,i,o,a),r.copy(n))},reset:function(){e=!1,i=null,r.set(0,0,0,1)}}},r=new function(){var e=!1,n=null,i=null,r=null;return{setTest:function(e){e?D(t.DEPTH_TEST):O(t.DEPTH_TEST)},setMask:function(i){n===i||e||(t.depthMask(i),n=i)},setFunc:function(e){if(i!==e){if(e)switch(e){case 0:t.depthFunc(t.NEVER);break;case 1:t.depthFunc(t.ALWAYS);break;case 2:t.depthFunc(t.LESS);break;case 3:t.depthFunc(t.LEQUAL);break;case 4:t.depthFunc(t.EQUAL);break;case 5:t.depthFunc(t.GEQUAL);break;case 6:t.depthFunc(t.GREATER);break;case 7:t.depthFunc(t.NOTEQUAL);break;default:t.depthFunc(t.LEQUAL)}else t.depthFunc(t.LEQUAL);i=e}},setLocked:function(t){e=t},setClear:function(e){r!==e&&(t.clearDepth(e),r=e)},reset:function(){e=!1,n=null,i=null,r=null}}},o=new function(){var e=!1,n=null,i=null,r=null,o=null,a=null,s=null,c=null,l=null;return{setTest:function(e){e?D(t.STENCIL_TEST):O(t.STENCIL_TEST)},setMask:function(i){n===i||e||(t.stencilMask(i),n=i)},setFunc:function(e,n,a){i===e&&r===n&&o===a||(t.stencilFunc(e,n,a),i=e,r=n,o=a)},setOp:function(e,n,i){a===e&&s===n&&c===i||(t.stencilOp(e,n,i),a=e,s=n,c=i)},setLocked:function(t){e=t},setClear:function(e){l!==e&&(t.clearStencil(e),l=e)},reset:function(){e=!1,n=null,i=null,r=null,o=null,a=null,s=null,c=null,l=null}}},a=t.getParameter(t.MAX_VERTEX_ATTRIBS),s=new Uint8Array(a),c=new Uint8Array(a),l=new Uint8Array(a),h={},u=null,d=null,p=null,f=null,m=null,g=null,v=null,y=null,b=!1,x=null,w=null,S=null,E=null,A=null,T=null,M=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS),C=null,P={},R=new _,L=new _;function k(e,n,i){var r=new Uint8Array(4),o=t.createTexture();t.bindTexture(e,o),t.texParameteri(e,t.TEXTURE_MIN_FILTER,t.NEAREST),t.texParameteri(e,t.TEXTURE_MAG_FILTER,t.NEAREST);for(var a=0;a<i;a++)t.texImage2D(n+a,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,r);return o}var I={};function D(e){!0!==h[e]&&(t.enable(e),h[e]=!0)}function O(e){!1!==h[e]&&(t.disable(e),h[e]=!1)}function F(e,i,r,o,a,s,c,l){if(0===e)return O(t.BLEND),void(d=e);D(t.BLEND),e===d&&l===b||(2===e?l?(t.blendEquationSeparate(t.FUNC_ADD,t.FUNC_ADD),t.blendFuncSeparate(t.ONE,t.ONE,t.ONE,t.ONE)):(t.blendEquation(t.FUNC_ADD),t.blendFunc(t.SRC_ALPHA,t.ONE)):3===e?l?(t.blendEquationSeparate(t.FUNC_ADD,t.FUNC_ADD),t.blendFuncSeparate(t.ZERO,t.ZERO,t.ONE_MINUS_SRC_COLOR,t.ONE_MINUS_SRC_ALPHA)):(t.blendEquation(t.FUNC_ADD),t.blendFunc(t.ZERO,t.ONE_MINUS_SRC_COLOR)):4===e?l?(t.blendEquationSeparate(t.FUNC_ADD,t.FUNC_ADD),t.blendFuncSeparate(t.ZERO,t.SRC_COLOR,t.ZERO,t.SRC_ALPHA)):(t.blendEquation(t.FUNC_ADD),t.blendFunc(t.ZERO,t.SRC_COLOR)):l?(t.blendEquationSeparate(t.FUNC_ADD,t.FUNC_ADD),t.blendFuncSeparate(t.ONE,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA)):(t.blendEquationSeparate(t.FUNC_ADD,t.FUNC_ADD),t.blendFuncSeparate(t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA)),d=e,b=l),5===e?(a=a||i,s=s||r,c=c||o,i===p&&a===g||(t.blendEquationSeparate(n(i),n(a)),p=i,g=a),r===f&&o===m&&s===v&&c===y||(t.blendFuncSeparate(n(r),n(o),n(s),n(c)),f=r,m=o,v=s,y=c)):(p=null,f=null,m=null,g=null,v=null,y=null)}function N(t){r.setFunc(t)}function U(e){x!==e&&(e?t.frontFace(t.CW):t.frontFace(t.CCW),x=e)}function j(e){0!==e?(D(t.CULL_FACE),e!==w&&(1===e?t.cullFace(t.BACK):2===e?t.cullFace(t.FRONT):t.cullFace(t.FRONT_AND_BACK))):O(t.CULL_FACE),w=e}function B(e){void 0===e&&(e=t.TEXTURE0+M-1),C!==e&&(t.activeTexture(e),C=e)}function z(t,e,n,r){i.setClear(t,e,n,r)}function H(t){r.setClear(t)}function G(t){o.setClear(t)}return I[t.TEXTURE_2D]=k(t.TEXTURE_2D,t.TEXTURE_2D,1),I[t.TEXTURE_CUBE_MAP]=k(t.TEXTURE_CUBE_MAP,t.TEXTURE_CUBE_MAP_POSITIVE_X,6),{buffers:{color:i,depth:r,stencil:o},init:function(){z(0,0,0,1),H(1),G(0),D(t.DEPTH_TEST),N(3),U(!1),j(1),D(t.CULL_FACE),D(t.BLEND),F(1)},initAttributes:function(){for(var t=0,e=s.length;t<e;t++)s[t]=0},enableAttribute:function(n){s[n]=1,0===c[n]&&(t.enableVertexAttribArray(n),c[n]=1),0!==l[n]&&(e.get("ANGLE_instanced_arrays").vertexAttribDivisorANGLE(n,0),l[n]=0)},enableAttributeAndDivisor:function(e,n,i){s[e]=1,0===c[e]&&(t.enableVertexAttribArray(e),c[e]=1),l[e]!==n&&(i.vertexAttribDivisorANGLE(e,n),l[e]=n)},disableUnusedAttributes:function(){for(var e=0,n=c.length;e!==n;++e)c[e]!==s[e]&&(t.disableVertexAttribArray(e),c[e]=0)},enable:D,disable:O,getCompressedTextureFormats:function(){if(null===u&&(u=[],e.get("WEBGL_compressed_texture_pvrtc")||e.get("WEBGL_compressed_texture_s3tc")||e.get("WEBGL_compressed_texture_etc1")))for(var n=t.getParameter(t.COMPRESSED_TEXTURE_FORMATS),i=0;i<n.length;i++)u.push(n[i]);return u},setBlending:F,setColorWrite:function(t){i.setMask(t)},setDepthTest:function(t){r.setTest(t)},setDepthWrite:function(t){r.setMask(t)},setDepthFunc:N,setStencilTest:function(t){o.setTest(t)},setStencilWrite:function(t){o.setMask(t)},setStencilFunc:function(t,e,n){o.setFunc(t,e,n)},setStencilOp:function(t,e,n){o.setOp(t,e,n)},setFlipSided:U,setCullFace:j,setLineWidth:function(e){e!==S&&(t.lineWidth(e),S=e)},setPolygonOffset:function(e,n,i){e?(D(t.POLYGON_OFFSET_FILL),E===n&&A===i||(t.polygonOffset(n,i),E=n,A=i)):O(t.POLYGON_OFFSET_FILL)},getScissorTest:function(){return T},setScissorTest:function(e){T=e,e?D(t.SCISSOR_TEST):O(t.SCISSOR_TEST)},activeTexture:B,bindTexture:function(e,n){null===C&&B();var i=P[C];void 0===i&&(i={type:void 0,texture:void 0},P[C]=i),i.type===e&&i.texture===n||(t.bindTexture(e,n||I[e]),i.type=e,i.texture=n)},compressedTexImage2D:function(){try{t.compressedTexImage2D.apply(t,arguments)}catch(t){console.error(t)}},texImage2D:function(){try{t.texImage2D.apply(t,arguments)}catch(t){console.error(t)}},clearColor:z,clearDepth:H,clearStencil:G,scissor:function(e){!1===R.equals(e)&&(t.scissor(e.x,e.y,e.z,e.w),R.copy(e))},viewport:function(e){!1===L.equals(e)&&(t.viewport(e.x,e.y,e.z,e.w),L.copy(e))},reset:function(){for(var e=0;e<c.length;e++)1===c[e]&&(t.disableVertexAttribArray(e),c[e]=0);h={},u=null,C=null,P={},d=null,x=null,w=null,i.reset(),r.reset(),o.reset()}}}function ze(t,e,n){var i;function r(e){if("highp"===e){if(t.getShaderPrecisionFormat(t.VERTEX_SHADER,t.HIGH_FLOAT).precision>0&&t.getShaderPrecisionFormat(t.FRAGMENT_SHADER,t.HIGH_FLOAT).precision>0)return"highp";e="mediump"}return"mediump"===e&&t.getShaderPrecisionFormat(t.VERTEX_SHADER,t.MEDIUM_FLOAT).precision>0&&t.getShaderPrecisionFormat(t.FRAGMENT_SHADER,t.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}var o=void 0!==n.precision?n.precision:"highp",a=r(o);a!==o&&(console.warn("THREE.WebGLRenderer:",o,"not supported, using",a,"instead."),o=a);var s=!0===n.logarithmicDepthBuffer&&!!e.get("EXT_frag_depth"),c=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS),l=t.getParameter(t.MAX_VERTEX_TEXTURE_IMAGE_UNITS),h=t.getParameter(t.MAX_TEXTURE_SIZE),u=t.getParameter(t.MAX_CUBE_MAP_TEXTURE_SIZE),d=t.getParameter(t.MAX_VERTEX_ATTRIBS),p=t.getParameter(t.MAX_VERTEX_UNIFORM_VECTORS),f=t.getParameter(t.MAX_VARYING_VECTORS),m=t.getParameter(t.MAX_FRAGMENT_UNIFORM_VECTORS),g=l>0,v=!!e.get("OES_texture_float");return{getMaxAnisotropy:function(){if(void 0!==i)return i;var n=e.get("EXT_texture_filter_anisotropic");return i=null!==n?t.getParameter(n.MAX_TEXTURE_MAX_ANISOTROPY_EXT):0},getMaxPrecision:r,precision:o,logarithmicDepthBuffer:s,maxTextures:c,maxVertexTextures:l,maxTextureSize:h,maxCubemapSize:u,maxAttributes:d,maxVertexUniforms:p,maxVaryings:f,maxFragmentUniforms:m,vertexTextures:g,floatFragmentTextures:v,floatVertexTextures:g&&v}}function He(t){var e={};return{get:function(n){if(void 0!==e[n])return e[n];var i;switch(n){case"WEBGL_depth_texture":i=t.getExtension("WEBGL_depth_texture")||t.getExtension("MOZ_WEBGL_depth_texture")||t.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":i=t.getExtension("EXT_texture_filter_anisotropic")||t.getExtension("MOZ_EXT_texture_filter_anisotropic")||t.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":i=t.getExtension("WEBGL_compressed_texture_s3tc")||t.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":i=t.getExtension("WEBGL_compressed_texture_pvrtc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;case"WEBGL_compressed_texture_etc1":i=t.getExtension("WEBGL_compressed_texture_etc1");break;default:i=t.getExtension(n)}return null===i&&console.warn("THREE.WebGLRenderer: "+n+" extension not supported."),e[n]=i,i}}}function Ge(){var t=this,e=null,n=0,i=!1,r=!1,o=new Ht,a=new zt,s={value:null,needsUpdate:!1};function c(){s.value!==e&&(s.value=e,s.needsUpdate=n>0),t.numPlanes=n}function l(e,n,i,r){var c=null!==e?e.length:0,l=null;if(0!==c){if(l=s.value,!0!==r||null===l){var h=i+4*c,u=n.matrixWorldInverse;a.getNormalMatrix(u),(null===l||l.length<h)&&(l=new Float32Array(h));for(var d=0,p=i;d!==c;++d,p+=4)o.copy(e[d]).applyMatrix4(u,a),o.normal.toArray(l,p),l[p+3]=o.constant}s.value=l,s.needsUpdate=!0}return t.numPlanes=c,l}this.uniform=s,this.numPlanes=0,this.init=function(t,r,o){var a=0!==t.length||r||0!==n||i;return i=r,e=l(t,o,0),n=t.length,a},this.beginShadows=function(){r=!0,l(null)},this.endShadows=function(){r=!1,c()},this.setState=function(t,o,a,h,u){if(!i||null===t||0===t.length||r&&!o)r?l(null):c();else{var d=r?0:n,p=4*d,f=h.clippingState||null;s.value=f,f=l(t,a,p,u);for(var m=0;m!==p;++m)f[m]=e[m];h.clippingState=f,this.numPlanes+=d}}}function Ve(e){console.log("THREE.WebGLRenderer","81");var n=void 0!==(e=e||{}).canvas?e.canvas:document.createElementNS("http://www.w3.org/1999/xhtml","canvas"),i=void 0!==e.context?e.context:null,r=void 0!==e.alpha&&e.alpha,o=void 0===e.depth||e.depth,a=void 0===e.stencil||e.stencil,s=void 0!==e.antialias&&e.antialias,c=void 0===e.premultipliedAlpha||e.premultipliedAlpha,l=void 0!==e.preserveDrawingBuffer&&e.preserveDrawingBuffer,h=[],u=[],d=-1,p=[],f=-1,m=new Float32Array(8),g=[],v=[];this.domElement=n,this.context=null,this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.gammaFactor=2,this.gammaInput=!1,this.gammaOutput=!1,this.physicallyCorrectLights=!1,this.toneMapping=1,this.toneMappingExposure=1,this.toneMappingWhitePoint=1,this.maxMorphTargets=8,this.maxMorphNormals=4;var y,b=this,x=null,w=null,S=null,E=-1,A="",C=null,P=new _,R=null,L=new _,k=0,I=new pt(0),D=0,O=n.width,F=n.height,N=1,U=new _(0,0,O,F),j=!1,B=new _(0,0,O,F),z=new Gt,H=new Ge,G=!1,V=!1,W=new Bt,X=new M,q=new T,Y={hash:"",ambient:[0,0,0],directional:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotShadowMap:[],spotShadowMatrix:[],point:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],shadows:[]},Z={calls:0,vertices:0,faces:0,points:0};this.info={render:Z,memory:{geometries:0,textures:0},programs:null};try{var $={alpha:r,depth:o,stencil:a,antialias:s,premultipliedAlpha:c,preserveDrawingBuffer:l};if(null===(y=i||n.getContext("webgl",$)||n.getContext("experimental-webgl",$)))throw null!==n.getContext("webgl")?"Error creating WebGL context with your selected attributes.":"Error creating WebGL context.";void 0===y.getShaderPrecisionFormat&&(y.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}}),n.addEventListener("webglcontextlost",At,!1)}catch(t){console.error("THREE.WebGLRenderer: "+t)}var Q=new He(y);Q.get("WEBGL_depth_texture"),Q.get("OES_texture_float"),Q.get("OES_texture_float_linear"),Q.get("OES_texture_half_float"),Q.get("OES_texture_half_float_linear"),Q.get("OES_standard_derivatives"),Q.get("ANGLE_instanced_arrays"),Q.get("OES_element_index_uint")&&(pe.MaxIndex=4294967296);var J=new ze(y,Q,e),K=new Be(y,Q,jt),tt=new je,et=new Ue(y,Q,K,tt,J,jt,this.info),nt=new Ne(y,tt,this.info),it=new Oe(this,J),rt=new _e;this.info.programs=it.programs;var ot=new we(y,Q,Z),at=new xe(y,Q,Z),st=new be(-1,1,1,-1,0,1),ct=new ye,lt=new fe(new ge(2,2),new re({depthTest:!1,depthWrite:!1,fog:!1})),ht=mt.cube,dt=new fe(new me(5,5,5),new Nt({uniforms:ht.uniforms,vertexShader:ht.vertexShader,fragmentShader:ht.fragmentShader,side:1,depthTest:!1,depthWrite:!1,fog:!1}));function ft(){return null===w?N:1}function gt(t,e,n,i){!0===c&&(t*=i,e*=i,n*=i),K.clearColor(t,e,n,i)}function bt(){K.init(),K.scissor(P.copy(U).multiplyScalar(N)),K.viewport(L.copy(B).multiplyScalar(N)),gt(I.r,I.g,I.b,D)}function xt(){x=null,C=null,A="",E=-1,K.reset()}bt(),this.context=y,this.capabilities=J,this.extensions=Q,this.properties=tt,this.state=K;var wt=new Vt(this,Y,nt,J);this.shadowMap=wt;var _t,St=new yt(this,g),Et=new vt(this,v);function At(t){t.preventDefault(),xt(),bt(),tt.clear()}function Tt(t){var e=t.target;e.removeEventListener("dispose",Tt),function(t){Mt(t),tt.delete(t)}(e)}function Mt(t){var e=tt.get(t).program;t.program=void 0,void 0!==e&&it.releaseProgram(e)}function Ct(t,e){return Math.abs(e[0])-Math.abs(t[0])}function Pt(t,e){return t.object.renderOrder!==e.object.renderOrder?t.object.renderOrder-e.object.renderOrder:t.material.program&&e.material.program&&t.material.program!==e.material.program?t.material.program.id-e.material.program.id:t.material.id!==e.material.id?t.material.id-e.material.id:t.z!==e.z?t.z-e.z:t.id-e.id}function Rt(t,e){return t.object.renderOrder!==e.object.renderOrder?t.object.renderOrder-e.object.renderOrder:t.z!==e.z?e.z-t.z:t.id-e.id}function Lt(t,e,n,i,r){var o,a;n.transparent?(o=p,a=++f):(o=u,a=++d);var s=o[a];void 0!==s?(s.id=t.id,s.object=t,s.geometry=e,s.material=n,s.z=q.z,s.group=r):(s={id:t.id,object:t,geometry:e,material:n,z:q.z,group:r},o.push(s))}function kt(t){if(!z.intersectsSphere(t))return!1;var e=H.numPlanes;if(0===e)return!0;var n=b.clippingPlanes,i=t.center,r=-t.radius,o=0;do{if(n[o].distanceToPoint(i)<r)return!1}while(++o!==e);return!0}function It(t,e,n,i){for(var r=0,o=t.length;r<o;r++){var a=t[r],s=a.object,c=a.geometry,l=void 0===i?a.material:i,h=a.group;if(s.modelViewMatrix.multiplyMatrices(e.matrixWorldInverse,s.matrixWorld),s.normalMatrix.getNormalMatrix(s.modelViewMatrix),s.isImmediateRenderObject){Dt(l);var u=Ot(e,n,l,s);A="",s.render((function(t){b.renderBufferImmediate(t,u,l)}))}else null!==s.onBeforeRender&&s.onBeforeRender(),b.renderBufferDirect(e,n,c,l,s,h)}}function Dt(t){2===t.side?K.disable(y.CULL_FACE):K.enable(y.CULL_FACE),K.setFlipSided(1===t.side),!0===t.transparent?K.setBlending(t.blending,t.blendEquation,t.blendSrc,t.blendDst,t.blendEquationAlpha,t.blendSrcAlpha,t.blendDstAlpha,t.premultipliedAlpha):K.setBlending(0),K.setDepthFunc(t.depthFunc),K.setDepthTest(t.depthTest),K.setDepthWrite(t.depthWrite),K.setColorWrite(t.colorWrite),K.setPolygonOffset(t.polygonOffset,t.polygonOffsetFactor,t.polygonOffsetUnits)}function Ot(e,i,r,o){k=0;var a=tt.get(r);if(G&&(V||e!==C)){var s=e===C&&r.id===E;H.setState(r.clippingPlanes,r.clipShadows,e,a,s)}!1===r.needsUpdate&&(void 0===a.program||r.fog&&a.fog!==i||r.lights&&a.lightsHash!==Y.hash||void 0!==a.numClippingPlanes&&a.numClippingPlanes!==H.numPlanes)&&(r.needsUpdate=!0),r.needsUpdate&&(function(e,n,i){var r=tt.get(e),o=it.getParameters(e,Y,n,H.numPlanes,i),a=it.getProgramCode(e,o),s=r.program,c=!0;if(void 0===s)e.addEventListener("dispose",Tt);else if(s.code!==a)Mt(e);else{if(void 0!==o.shaderID)return;c=!1}if(c){if(o.shaderID){var l=mt[o.shaderID];r.__webglShader={name:e.type,uniforms:t.UniformsUtils.clone(l.uniforms),vertexShader:l.vertexShader,fragmentShader:l.fragmentShader}}else r.__webglShader={name:e.type,uniforms:e.uniforms,vertexShader:e.vertexShader,fragmentShader:e.fragmentShader};e.__webglShader=r.__webglShader,s=it.acquireProgram(e,o,a),r.program=s,e.program=s}var h=s.getAttributes();if(e.morphTargets){e.numSupportedMorphTargets=0;for(var u=0;u<b.maxMorphTargets;u++)h["morphTarget"+u]>=0&&e.numSupportedMorphTargets++}if(e.morphNormals)for(e.numSupportedMorphNormals=0,u=0;u<b.maxMorphNormals;u++)h["morphNormal"+u]>=0&&e.numSupportedMorphNormals++;var d=r.__webglShader.uniforms;(e.isShaderMaterial||e.isRawShaderMaterial)&&!0!==e.clipping||(r.numClippingPlanes=H.numPlanes,d.clippingPlanes=H.uniform),r.fog=n,r.lightsHash=Y.hash,e.lights&&(d.ambientLightColor.value=Y.ambient,d.directionalLights.value=Y.directional,d.spotLights.value=Y.spot,d.pointLights.value=Y.point,d.hemisphereLights.value=Y.hemi,d.directionalShadowMap.value=Y.directionalShadowMap,d.directionalShadowMatrix.value=Y.directionalShadowMatrix,d.spotShadowMap.value=Y.spotShadowMap,d.spotShadowMatrix.value=Y.spotShadowMatrix,d.pointShadowMap.value=Y.pointShadowMap,d.pointShadowMatrix.value=Y.pointShadowMatrix);var p=r.program.getUniforms(),f=ut.seqWithValue(p.seq,d);r.uniformsList=f,r.dynamicUniforms=ut.splitDynamic(f,d)}(r,i,o),r.needsUpdate=!1);var c,l,h=!1,u=!1,d=!1,p=a.program,f=p.getUniforms(),m=a.__webglShader.uniforms;if(p.id!==x&&(y.useProgram(p.program),x=p.id,h=!0,u=!0,d=!0),r.id!==E&&(E=r.id,u=!0),h||e!==C){if(f.set(y,e,"projectionMatrix"),J.logarithmicDepthBuffer&&f.setValue(y,"logDepthBufFC",2/(Math.log(e.far+1)/Math.LN2)),e!==C&&(C=e,u=!0,d=!0),r.isShaderMaterial||r.isMeshPhongMaterial||r.isMeshStandardMaterial||r.envMap){var g=f.map.cameraPosition;void 0!==g&&g.setValue(y,q.setFromMatrixPosition(e.matrixWorld))}(r.isMeshPhongMaterial||r.isMeshLambertMaterial||r.isMeshBasicMaterial||r.isMeshStandardMaterial||r.isShaderMaterial||r.skinning)&&f.setValue(y,"viewMatrix",e.matrixWorldInverse),f.set(y,b,"toneMappingExposure"),f.set(y,b,"toneMappingWhitePoint")}if(r.skinning){f.setOptional(y,o,"bindMatrix"),f.setOptional(y,o,"bindMatrixInverse");var v=o.skeleton;v&&(J.floatVertexTextures&&v.useVertexTexture?(f.set(y,v,"boneTexture"),f.set(y,v,"boneTextureWidth"),f.set(y,v,"boneTextureHeight")):f.setOptional(y,v,"boneMatrices"))}u&&(r.lights&&(l=d,(c=m).ambientLightColor.needsUpdate=l,c.directionalLights.needsUpdate=l,c.pointLights.needsUpdate=l,c.spotLights.needsUpdate=l,c.hemisphereLights.needsUpdate=l),i&&r.fog&&function(t,e){t.fogColor.value=e.color,e.isFog?(t.fogNear.value=e.near,t.fogFar.value=e.far):e.isFogExp2&&(t.fogDensity.value=e.density)}(m,i),(r.isMeshBasicMaterial||r.isMeshLambertMaterial||r.isMeshPhongMaterial||r.isMeshStandardMaterial||r.isMeshDepthMaterial)&&function(t,e){var n;if(t.opacity.value=e.opacity,t.diffuse.value=e.color,e.emissive&&t.emissive.value.copy(e.emissive).multiplyScalar(e.emissiveIntensity),t.map.value=e.map,t.specularMap.value=e.specularMap,t.alphaMap.value=e.alphaMap,e.aoMap&&(t.aoMap.value=e.aoMap,t.aoMapIntensity.value=e.aoMapIntensity),e.map?n=e.map:e.specularMap?n=e.specularMap:e.displacementMap?n=e.displacementMap:e.normalMap?n=e.normalMap:e.bumpMap?n=e.bumpMap:e.roughnessMap?n=e.roughnessMap:e.metalnessMap?n=e.metalnessMap:e.alphaMap?n=e.alphaMap:e.emissiveMap&&(n=e.emissiveMap),void 0!==n){n.isWebGLRenderTarget&&(n=n.texture);var i=n.offset,r=n.repeat;t.offsetRepeat.value.set(i.x,i.y,r.x,r.y)}t.envMap.value=e.envMap,t.flipEnvMap.value=e.envMap&&e.envMap.isCubeTexture?-1:1,t.reflectivity.value=e.reflectivity,t.refractionRatio.value=e.refractionRatio}(m,r),r.isLineBasicMaterial?Ft(m,r):r.isLineDashedMaterial?(Ft(m,r),function(t,e){t.dashSize.value=e.dashSize,t.totalSize.value=e.dashSize+e.gapSize,t.scale.value=e.scale}(m,r)):r.isPointsMaterial?function(t,e){if(t.diffuse.value=e.color,t.opacity.value=e.opacity,t.size.value=e.size*N,t.scale.value=.5*n.clientHeight,t.map.value=e.map,null!==e.map){var i=e.map.offset,r=e.map.repeat;t.offsetRepeat.value.set(i.x,i.y,r.x,r.y)}}(m,r):r.isMeshLambertMaterial?function(t,e){e.lightMap&&(t.lightMap.value=e.lightMap,t.lightMapIntensity.value=e.lightMapIntensity),e.emissiveMap&&(t.emissiveMap.value=e.emissiveMap)}(m,r):r.isMeshPhongMaterial?function(t,e){t.specular.value=e.specular,t.shininess.value=Math.max(e.shininess,1e-4),e.lightMap&&(t.lightMap.value=e.lightMap,t.lightMapIntensity.value=e.lightMapIntensity),e.emissiveMap&&(t.emissiveMap.value=e.emissiveMap),e.bumpMap&&(t.bumpMap.value=e.bumpMap,t.bumpScale.value=e.bumpScale),e.normalMap&&(t.normalMap.value=e.normalMap,t.normalScale.value.copy(e.normalScale)),e.displacementMap&&(t.displacementMap.value=e.displacementMap,t.displacementScale.value=e.displacementScale,t.displacementBias.value=e.displacementBias)}(m,r):r.isMeshPhysicalMaterial?function(t,e){t.clearCoat.value=e.clearCoat,t.clearCoatRoughness.value=e.clearCoatRoughness,Ut(t,e)}(m,r):r.isMeshStandardMaterial?Ut(m,r):r.isMeshDepthMaterial?r.displacementMap&&(m.displacementMap.value=r.displacementMap,m.displacementScale.value=r.displacementScale,m.displacementBias.value=r.displacementBias):r.isMeshNormalMaterial&&(m.opacity.value=r.opacity),ut.upload(y,a.uniformsList,m,b)),f.set(y,o,"modelViewMatrix"),f.set(y,o,"normalMatrix"),f.setValue(y,"modelMatrix",o.matrixWorld);var w=a.dynamicUniforms;return null!==w&&(ut.evalDynamic(w,m,o,r,e),ut.upload(y,w,m,b)),p}function Ft(t,e){t.diffuse.value=e.color,t.opacity.value=e.opacity}function Ut(t,e){t.roughness.value=e.roughness,t.metalness.value=e.metalness,e.roughnessMap&&(t.roughnessMap.value=e.roughnessMap),e.metalnessMap&&(t.metalnessMap.value=e.metalnessMap),e.lightMap&&(t.lightMap.value=e.lightMap,t.lightMapIntensity.value=e.lightMapIntensity),e.emissiveMap&&(t.emissiveMap.value=e.emissiveMap),e.bumpMap&&(t.bumpMap.value=e.bumpMap,t.bumpScale.value=e.bumpScale),e.normalMap&&(t.normalMap.value=e.normalMap,t.normalScale.value.copy(e.normalScale)),e.displacementMap&&(t.displacementMap.value=e.displacementMap,t.displacementScale.value=e.displacementScale,t.displacementBias.value=e.displacementBias),e.envMap&&(t.envMapIntensity.value=e.envMapIntensity)}function jt(t){var e;if(1e3===t)return y.REPEAT;if(1001===t)return y.CLAMP_TO_EDGE;if(1002===t)return y.MIRRORED_REPEAT;if(1003===t)return y.NEAREST;if(1004===t)return y.NEAREST_MIPMAP_NEAREST;if(1005===t)return y.NEAREST_MIPMAP_LINEAR;if(1006===t)return y.LINEAR;if(1007===t)return y.LINEAR_MIPMAP_NEAREST;if(1008===t)return y.LINEAR_MIPMAP_LINEAR;if(1009===t)return y.UNSIGNED_BYTE;if(1017===t)return y.UNSIGNED_SHORT_4_4_4_4;if(1018===t)return y.UNSIGNED_SHORT_5_5_5_1;if(1019===t)return y.UNSIGNED_SHORT_5_6_5;if(1010===t)return y.BYTE;if(1011===t)return y.SHORT;if(1012===t)return y.UNSIGNED_SHORT;if(1013===t)return y.INT;if(1014===t)return y.UNSIGNED_INT;if(1015===t)return y.FLOAT;if(null!==(e=Q.get("OES_texture_half_float"))&&1016===t)return e.HALF_FLOAT_OES;if(1021===t)return y.ALPHA;if(1022===t)return y.RGB;if(1023===t)return y.RGBA;if(1024===t)return y.LUMINANCE;if(1025===t)return y.LUMINANCE_ALPHA;if(1026===t)return y.DEPTH_COMPONENT;if(1027===t)return y.DEPTH_STENCIL;if(100===t)return y.FUNC_ADD;if(101===t)return y.FUNC_SUBTRACT;if(102===t)return y.FUNC_REVERSE_SUBTRACT;if(200===t)return y.ZERO;if(201===t)return y.ONE;if(202===t)return y.SRC_COLOR;if(203===t)return y.ONE_MINUS_SRC_COLOR;if(204===t)return y.SRC_ALPHA;if(205===t)return y.ONE_MINUS_SRC_ALPHA;if(206===t)return y.DST_ALPHA;if(207===t)return y.ONE_MINUS_DST_ALPHA;if(208===t)return y.DST_COLOR;if(209===t)return y.ONE_MINUS_DST_COLOR;if(210===t)return y.SRC_ALPHA_SATURATE;if(null!==(e=Q.get("WEBGL_compressed_texture_s3tc"))){if(2001===t)return e.COMPRESSED_RGB_S3TC_DXT1_EXT;if(2002===t)return e.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(2003===t)return e.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(2004===t)return e.COMPRESSED_RGBA_S3TC_DXT5_EXT}if(null!==(e=Q.get("WEBGL_compressed_texture_pvrtc"))){if(2100===t)return e.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(2101===t)return e.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(2102===t)return e.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(2103===t)return e.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(null!==(e=Q.get("WEBGL_compressed_texture_etc1"))&&2151===t)return e.COMPRESSED_RGB_ETC1_WEBGL;if(null!==(e=Q.get("EXT_blend_minmax"))){if(103===t)return e.MIN_EXT;if(104===t)return e.MAX_EXT}return null!==(e=Q.get("WEBGL_depth_texture"))&&1020===t?e.UNSIGNED_INT_24_8_WEBGL:0}this.getContext=function(){return y},this.getContextAttributes=function(){return y.getContextAttributes()},this.forceContextLoss=function(){Q.get("WEBGL_lose_context").loseContext()},this.getMaxAnisotropy=function(){return J.getMaxAnisotropy()},this.getPrecision=function(){return J.precision},this.getPixelRatio=function(){return N},this.setPixelRatio=function(t){void 0!==t&&(N=t,this.setSize(B.z,B.w,!1))},this.getSize=function(){return{width:O,height:F}},this.setSize=function(t,e,i){O=t,F=e,n.width=t*N,n.height=e*N,!1!==i&&(n.style.width=t+"px",n.style.height=e+"px"),this.setViewport(0,0,t,e)},this.setViewport=function(t,e,n,i){K.viewport(B.set(t,e,n,i))},this.setScissor=function(t,e,n,i){K.scissor(U.set(t,e,n,i))},this.setScissorTest=function(t){K.setScissorTest(j=t)},this.getClearColor=function(){return I},this.setClearColor=function(t,e){I.set(t),D=void 0!==e?e:1,gt(I.r,I.g,I.b,D)},this.getClearAlpha=function(){return D},this.setClearAlpha=function(t){D=t,gt(I.r,I.g,I.b,D)},this.clear=function(t,e,n){var i=0;(void 0===t||t)&&(i|=y.COLOR_BUFFER_BIT),(void 0===e||e)&&(i|=y.DEPTH_BUFFER_BIT),(void 0===n||n)&&(i|=y.STENCIL_BUFFER_BIT),y.clear(i)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.clearTarget=function(t,e,n,i){this.setRenderTarget(t),this.clear(e,n,i)},this.resetGLState=xt,this.dispose=function(){p=[],f=-1,u=[],d=-1,n.removeEventListener("webglcontextlost",At,!1)},this.renderBufferImmediate=function(t,e,n){K.initAttributes();var i=tt.get(t);t.hasPositions&&!i.position&&(i.position=y.createBuffer()),t.hasNormals&&!i.normal&&(i.normal=y.createBuffer()),t.hasUvs&&!i.uv&&(i.uv=y.createBuffer()),t.hasColors&&!i.color&&(i.color=y.createBuffer());var r=e.getAttributes();if(t.hasPositions&&(y.bindBuffer(y.ARRAY_BUFFER,i.position),y.bufferData(y.ARRAY_BUFFER,t.positionArray,y.DYNAMIC_DRAW),K.enableAttribute(r.position),y.vertexAttribPointer(r.position,3,y.FLOAT,!1,0,0)),t.hasNormals){if(y.bindBuffer(y.ARRAY_BUFFER,i.normal),!n.isMeshPhongMaterial&&!n.isMeshStandardMaterial&&1===n.shading)for(var o=0,a=3*t.count;o<a;o+=9){var s=t.normalArray,c=(s[o+0]+s[o+3]+s[o+6])/3,l=(s[o+1]+s[o+4]+s[o+7])/3,h=(s[o+2]+s[o+5]+s[o+8])/3;s[o+0]=c,s[o+1]=l,s[o+2]=h,s[o+3]=c,s[o+4]=l,s[o+5]=h,s[o+6]=c,s[o+7]=l,s[o+8]=h}y.bufferData(y.ARRAY_BUFFER,t.normalArray,y.DYNAMIC_DRAW),K.enableAttribute(r.normal),y.vertexAttribPointer(r.normal,3,y.FLOAT,!1,0,0)}t.hasUvs&&n.map&&(y.bindBuffer(y.ARRAY_BUFFER,i.uv),y.bufferData(y.ARRAY_BUFFER,t.uvArray,y.DYNAMIC_DRAW),K.enableAttribute(r.uv),y.vertexAttribPointer(r.uv,2,y.FLOAT,!1,0,0)),t.hasColors&&0!==n.vertexColors&&(y.bindBuffer(y.ARRAY_BUFFER,i.color),y.bufferData(y.ARRAY_BUFFER,t.colorArray,y.DYNAMIC_DRAW),K.enableAttribute(r.color),y.vertexAttribPointer(r.color,3,y.FLOAT,!1,0,0)),K.disableUnusedAttributes(),y.drawArrays(y.TRIANGLES,0,t.count),t.count=0},this.renderBufferDirect=function(t,e,n,i,r,o){Dt(i);var a=Ot(t,e,i,r),s=!1,c=n.id+"_"+a.id+"_"+i.wireframe;c!==A&&(A=c,s=!0);var l=r.morphTargetInfluences;if(void 0!==l){for(var h=[],u=0,d=l.length;u<d;u++){var p=l[u];h.push([p,u])}h.sort(Ct),h.length>8&&(h.length=8);var f=n.morphAttributes;for(u=0,d=h.length;u<d;u++)if(p=h[u],m[u]=p[0],0!==p[0]){var g=p[1];!0===i.morphTargets&&f.position&&n.addAttribute("morphTarget"+u,f.position[g]),!0===i.morphNormals&&f.normal&&n.addAttribute("morphNormal"+u,f.normal[g])}else!0===i.morphTargets&&n.removeAttribute("morphTarget"+u),!0===i.morphNormals&&n.removeAttribute("morphNormal"+u);u=h.length;for(var v=m.length;u<v;u++)m[u]=0;a.getUniforms().setValue(y,"morphTargetInfluences",m),s=!0}g=n.index;var b,x=n.attributes.position,w=1;!0===i.wireframe&&(g=nt.getWireframeAttribute(n),w=2),null!==g?(b=at).setIndex(g):b=ot,s&&(function(t,e,n,i){var r;if(n&&n.isInstancedBufferGeometry&&null===(r=Q.get("ANGLE_instanced_arrays")))console.error("THREE.WebGLRenderer.setupVertexAttributes: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");else{void 0===i&&(i=0),K.initAttributes();var o=n.attributes,a=e.getAttributes(),s=t.defaultAttributeValues;for(var c in a){var l=a[c];if(l>=0){var h=o[c];if(void 0!==h){var u=y.FLOAT,d=h.array,p=h.normalized;d instanceof Float32Array?u=y.FLOAT:d instanceof Float64Array?console.warn("Unsupported data buffer format: Float64Array"):d instanceof Uint16Array?u=y.UNSIGNED_SHORT:d instanceof Int16Array?u=y.SHORT:d instanceof Uint32Array?u=y.UNSIGNED_INT:d instanceof Int32Array?u=y.INT:d instanceof Int8Array?u=y.BYTE:d instanceof Uint8Array&&(u=y.UNSIGNED_BYTE);var f=h.itemSize,m=nt.getAttributeBuffer(h);if(h&&h.isInterleavedBufferAttribute){var g=h.data,v=g.stride,b=h.offset;g&&g.isInstancedInterleavedBuffer?(K.enableAttributeAndDivisor(l,g.meshPerAttribute,r),void 0===n.maxInstancedCount&&(n.maxInstancedCount=g.meshPerAttribute*g.count)):K.enableAttribute(l),y.bindBuffer(y.ARRAY_BUFFER,m),y.vertexAttribPointer(l,f,u,p,v*g.array.BYTES_PER_ELEMENT,(i*v+b)*g.array.BYTES_PER_ELEMENT)}else h&&h.isInstancedBufferAttribute?(K.enableAttributeAndDivisor(l,h.meshPerAttribute,r),void 0===n.maxInstancedCount&&(n.maxInstancedCount=h.meshPerAttribute*h.count)):K.enableAttribute(l),y.bindBuffer(y.ARRAY_BUFFER,m),y.vertexAttribPointer(l,f,u,p,0,i*f*h.array.BYTES_PER_ELEMENT)}else if(void 0!==s){var x=s[c];if(void 0!==x)switch(x.length){case 2:y.vertexAttrib2fv(l,x);break;case 3:y.vertexAttrib3fv(l,x);break;case 4:y.vertexAttrib4fv(l,x);break;default:y.vertexAttrib1fv(l,x)}}}}K.disableUnusedAttributes()}}(i,a,n),null!==g&&y.bindBuffer(y.ELEMENT_ARRAY_BUFFER,nt.getAttributeBuffer(g)));var _=0;null!==g?_=g.count:void 0!==x&&(_=x.count);var S=n.drawRange.start*w,E=n.drawRange.count*w,T=null!==o?o.start*w:0,M=null!==o?o.count*w:1/0,C=Math.max(S,T),P=Math.min(_,S+E,T+M)-1,R=Math.max(0,P-C+1);if(0!==R){if(r.isMesh)if(!0===i.wireframe)K.setLineWidth(i.wireframeLinewidth*ft()),b.setMode(y.LINES);else switch(r.drawMode){case 0:b.setMode(y.TRIANGLES);break;case 1:b.setMode(y.TRIANGLE_STRIP);break;case 2:b.setMode(y.TRIANGLE_FAN)}else if(r.isLine){var L=i.linewidth;void 0===L&&(L=1),K.setLineWidth(L*ft()),r.isLineSegments?b.setMode(y.LINES):b.setMode(y.LINE_STRIP)}else r.isPoints&&b.setMode(y.POINTS);n&&n.isInstancedBufferGeometry?n.maxInstancedCount>0&&b.renderInstances(n,C,R):b.render(C,R)}},this.render=function(t,e,n,i){if(void 0===e||!0===e.isCamera){var r=t.fog;A="",E=-1,C=null,!0===t.autoUpdate&&t.updateMatrixWorld(),null===e.parent&&e.updateMatrixWorld(),e.matrixWorldInverse.getInverse(e.matrixWorld),X.multiplyMatrices(e.projectionMatrix,e.matrixWorldInverse),z.setFromMatrix(X),h.length=0,d=-1,f=-1,g.length=0,v.length=0,V=this.localClippingEnabled,G=H.init(this.clippingPlanes,V,e),function t(e,n){if(!1!==e.visible){if(0!=(e.layers.mask&n.layers.mask))if(e.isLight)h.push(e);else if(e.isSprite)!1!==e.frustumCulled&&!0!==(d=e,W.center.set(0,0,0),W.radius=.7071067811865476,W.applyMatrix4(d.matrixWorld),kt(W))||g.push(e);else if(e.isLensFlare)v.push(e);else if(e.isImmediateRenderObject)!0===b.sortObjects&&(q.setFromMatrixPosition(e.matrixWorld),q.applyProjection(X)),Lt(e,null,e.material,q.z,null);else if((e.isMesh||e.isLine||e.isPoints)&&(e.isSkinnedMesh&&e.skeleton.update(),!1===e.frustumCulled||!0===function(t){var e=t.geometry;return null===e.boundingSphere&&e.computeBoundingSphere(),W.copy(e.boundingSphere).applyMatrix4(t.matrixWorld),kt(W)}(e))){var i=e.material;if(!0===i.visible){!0===b.sortObjects&&(q.setFromMatrixPosition(e.matrixWorld),q.applyProjection(X));var r=nt.update(e);if(i.isMultiMaterial)for(var o=r.groups,a=i.materials,s=0,c=o.length;s<c;s++){var l=o[s],u=a[l.materialIndex];!0===u.visible&&Lt(e,r,u,q.z,l)}else Lt(e,r,i,q.z,null)}}var d,p=e.children;for(s=0,c=p.length;s<c;s++)t(p[s],n)}}(t,e),u.length=d+1,p.length=f+1,!0===b.sortObjects&&(u.sort(Pt),p.sort(Rt)),G&&H.beginShadows(),function(t){for(var e=0,n=0,i=t.length;n<i;n++){var r=t[n];r.castShadow&&(Y.shadows[e++]=r)}Y.shadows.length=e}(h),wt.render(t,e),function(t,e){var n,i,r,o,a,s,c,l=0,h=0,u=0,d=e.matrixWorldInverse,p=0,f=0,m=0,g=0;for(n=0,i=t.length;n<i;n++)if(r=t[n],o=r.color,a=r.intensity,s=r.distance,c=r.shadow&&r.shadow.map?r.shadow.map.texture:null,r.isAmbientLight)l+=o.r*a,h+=o.g*a,u+=o.b*a;else if(r.isDirectionalLight)(v=rt.get(r)).color.copy(r.color).multiplyScalar(r.intensity),v.direction.setFromMatrixPosition(r.matrixWorld),q.setFromMatrixPosition(r.target.matrixWorld),v.direction.sub(q),v.direction.transformDirection(d),v.shadow=r.castShadow,r.castShadow&&(v.shadowBias=r.shadow.bias,v.shadowRadius=r.shadow.radius,v.shadowMapSize=r.shadow.mapSize),Y.directionalShadowMap[p]=c,Y.directionalShadowMatrix[p]=r.shadow.matrix,Y.directional[p++]=v;else if(r.isSpotLight)(v=rt.get(r)).position.setFromMatrixPosition(r.matrixWorld),v.position.applyMatrix4(d),v.color.copy(o).multiplyScalar(a),v.distance=s,v.direction.setFromMatrixPosition(r.matrixWorld),q.setFromMatrixPosition(r.target.matrixWorld),v.direction.sub(q),v.direction.transformDirection(d),v.coneCos=Math.cos(r.angle),v.penumbraCos=Math.cos(r.angle*(1-r.penumbra)),v.decay=0===r.distance?0:r.decay,v.shadow=r.castShadow,r.castShadow&&(v.shadowBias=r.shadow.bias,v.shadowRadius=r.shadow.radius,v.shadowMapSize=r.shadow.mapSize),Y.spotShadowMap[m]=c,Y.spotShadowMatrix[m]=r.shadow.matrix,Y.spot[m++]=v;else if(r.isPointLight)(v=rt.get(r)).position.setFromMatrixPosition(r.matrixWorld),v.position.applyMatrix4(d),v.color.copy(r.color).multiplyScalar(r.intensity),v.distance=r.distance,v.decay=0===r.distance?0:r.decay,v.shadow=r.castShadow,r.castShadow&&(v.shadowBias=r.shadow.bias,v.shadowRadius=r.shadow.radius,v.shadowMapSize=r.shadow.mapSize),Y.pointShadowMap[f]=c,void 0===Y.pointShadowMatrix[f]&&(Y.pointShadowMatrix[f]=new M),q.setFromMatrixPosition(r.matrixWorld).negate(),Y.pointShadowMatrix[f].identity().setPosition(q),Y.point[f++]=v;else if(r.isHemisphereLight){var v;(v=rt.get(r)).direction.setFromMatrixPosition(r.matrixWorld),v.direction.transformDirection(d),v.direction.normalize(),v.skyColor.copy(r.color).multiplyScalar(a),v.groundColor.copy(r.groundColor).multiplyScalar(a),Y.hemi[g++]=v}Y.ambient[0]=l,Y.ambient[1]=h,Y.ambient[2]=u,Y.directional.length=p,Y.spot.length=m,Y.point.length=f,Y.hemi.length=g,Y.hash=p+","+f+","+m+","+g+","+Y.shadows.length}(h,e),G&&H.endShadows(),Z.calls=0,Z.vertices=0,Z.faces=0,Z.points=0,void 0===n&&(n=null),this.setRenderTarget(n);var o=t.background;if(null===o?gt(I.r,I.g,I.b,D):o&&o.isColor&&(gt(o.r,o.g,o.b,1),i=!0),(this.autoClear||i)&&this.clear(this.autoClearColor,this.autoClearDepth,this.autoClearStencil),o&&o.isCubeTexture?(ct.projectionMatrix.copy(e.projectionMatrix),ct.matrixWorld.extractRotation(e.matrixWorld),ct.matrixWorldInverse.getInverse(ct.matrixWorld),dt.material.uniforms.tCube.value=o,dt.modelViewMatrix.multiplyMatrices(ct.matrixWorldInverse,dt.matrixWorld),nt.update(dt),b.renderBufferDirect(ct,null,dt.geometry,dt.material,dt,null)):o&&o.isTexture&&(lt.material.map=o,nt.update(lt),b.renderBufferDirect(st,null,lt.geometry,lt.material,lt,null)),t.overrideMaterial){var a=t.overrideMaterial;It(u,e,r,a),It(p,e,r,a)}else K.setBlending(0),It(u,e,r),It(p,e,r);St.render(t,e),Et.render(t,e,L),n&&et.updateRenderTargetMipmap(n),K.setDepthTest(!0),K.setDepthWrite(!0),K.setColorWrite(!0)}else console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.")},this.setFaceCulling=function(t,e){K.setCullFace(t),K.setFlipSided(0===e)},this.allocTextureUnit=function(){var t=k;return t>=J.maxTextures&&console.warn("WebGLRenderer: trying to use "+t+" texture units while this GPU supports only "+J.maxTextures),k+=1,t},this.setTexture2D=(_t=!1,function(t,e){t&&t.isWebGLRenderTarget&&(_t||(console.warn("THREE.WebGLRenderer.setTexture2D: don't use render targets as textures. Use their .texture property instead."),_t=!0),t=t.texture),et.setTexture2D(t,e)}),this.setTexture=function(){var t=!1;return function(e,n){t||(console.warn("THREE.WebGLRenderer: .setTexture is deprecated, use setTexture2D instead."),t=!0),et.setTexture2D(e,n)}}(),this.setTextureCube=function(){var t=!1;return function(e,n){e&&e.isWebGLRenderTargetCube&&(t||(console.warn("THREE.WebGLRenderer.setTextureCube: don't use cube render targets as textures. Use their .texture property instead."),t=!0),e=e.texture),e&&e.isCubeTexture||Array.isArray(e.image)&&6===e.image.length?et.setTextureCube(e,n):et.setTextureCubeDynamic(e,n)}}(),this.getCurrentRenderTarget=function(){return w},this.setRenderTarget=function(t){w=t,t&&void 0===tt.get(t).__webglFramebuffer&&et.setupRenderTarget(t);var e,n=t&&t.isWebGLRenderTargetCube;if(t){var i=tt.get(t);e=n?i.__webglFramebuffer[t.activeCubeFace]:i.__webglFramebuffer,P.copy(t.scissor),R=t.scissorTest,L.copy(t.viewport)}else e=null,P.copy(U).multiplyScalar(N),R=j,L.copy(B).multiplyScalar(N);if(S!==e&&(y.bindFramebuffer(y.FRAMEBUFFER,e),S=e),K.scissor(P),K.setScissorTest(R),K.viewport(L),n){var r=tt.get(t.texture);y.framebufferTexture2D(y.FRAMEBUFFER,y.COLOR_ATTACHMENT0,y.TEXTURE_CUBE_MAP_POSITIVE_X+t.activeCubeFace,r.__webglTexture,t.activeMipMapLevel)}},this.readRenderTargetPixels=function(t,e,n,i,r,o){if(!1!==(t&&t.isWebGLRenderTarget)){var a=tt.get(t).__webglFramebuffer;if(a){var s=!1;a!==S&&(y.bindFramebuffer(y.FRAMEBUFFER,a),s=!0);try{var c=t.texture,l=c.format,h=c.type;if(1023!==l&&jt(l)!==y.getParameter(y.IMPLEMENTATION_COLOR_READ_FORMAT))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");if(!(1009===h||jt(h)===y.getParameter(y.IMPLEMENTATION_COLOR_READ_TYPE)||1015===h&&(Q.get("OES_texture_float")||Q.get("WEBGL_color_buffer_float"))||1016===h&&Q.get("EXT_color_buffer_half_float")))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");y.checkFramebufferStatus(y.FRAMEBUFFER)===y.FRAMEBUFFER_COMPLETE?e>=0&&e<=t.width-i&&n>=0&&n<=t.height-r&&y.readPixels(e,n,i,r,jt(l),jt(h),o):console.error("THREE.WebGLRenderer.readRenderTargetPixels: readPixels from renderTarget failed. Framebuffer not complete.")}finally{s&&y.bindFramebuffer(y.FRAMEBUFFER,S)}}}else console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.")}}function We(t,e){this.name="",this.color=new pt(t),this.density=void 0!==e?e:25e-5}function Xe(t,e,n){this.name="",this.color=new pt(t),this.near=void 0!==e?e:1,this.far=void 0!==n?n:1e3}function qe(){Yt.call(this),this.type="Scene",this.background=null,this.fog=null,this.overrideMaterial=null,this.autoUpdate=!0}function Ye(t,e,n,i,r){Yt.call(this),this.lensFlares=[],this.positionScreen=new T,this.customUpdateCallback=void 0,void 0!==t&&this.add(t,e,n,i,r)}function Ze(t){bt.call(this),this.type="SpriteMaterial",this.color=new pt(16777215),this.map=null,this.rotation=0,this.fog=!1,this.lights=!1,this.setValues(t)}function $e(t){Yt.call(this),this.type="Sprite",this.material=void 0!==t?t:new Ze}function Qe(){Yt.call(this),this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]}})}function Je(t,e,n,i,r,o,a,s,c,l,h,u){p.call(this,null,o,a,s,c,l,i,r,h,u),this.image={data:t,width:e,height:n},this.magFilter=void 0!==c?c:1003,this.minFilter=void 0!==l?l:1003,this.flipY=!1,this.generateMipmaps=!1}function Ke(e,n,i){if(this.useVertexTexture=void 0===i||i,this.identityMatrix=new M,e=e||[],this.bones=e.slice(0),this.useVertexTexture){var r=Math.sqrt(4*this.bones.length);r=t.Math.nextPowerOfTwo(Math.ceil(r)),r=Math.max(r,4),this.boneTextureWidth=r,this.boneTextureHeight=r,this.boneMatrices=new Float32Array(this.boneTextureWidth*this.boneTextureHeight*4),this.boneTexture=new Je(this.boneMatrices,this.boneTextureWidth,this.boneTextureHeight,1023,1015)}else this.boneMatrices=new Float32Array(16*this.bones.length);if(void 0===n)this.calculateInverses();else if(this.bones.length===n.length)this.boneInverses=n.slice(0);else{console.warn("THREE.Skeleton bonInverses is the wrong length."),this.boneInverses=[];for(var o=0,a=this.bones.length;o<a;o++)this.boneInverses.push(new M)}}function tn(t){Yt.call(this),this.type="Bone",this.skin=t}function en(t,e,n){fe.call(this,t,e),this.type="SkinnedMesh",this.bindMode="attached",this.bindMatrix=new M,this.bindMatrixInverse=new M;var i=[];if(this.geometry&&void 0!==this.geometry.bones){for(var r,o,a=0,s=this.geometry.bones.length;a<s;++a)o=this.geometry.bones[a],r=new tn(this),i.push(r),r.name=o.name,r.position.fromArray(o.pos),r.quaternion.fromArray(o.rotq),void 0!==o.scl&&r.scale.fromArray(o.scl);for(a=0,s=this.geometry.bones.length;a<s;++a)-1!==(o=this.geometry.bones[a]).parent&&null!==o.parent&&void 0!==i[o.parent]?i[o.parent].add(i[a]):this.add(i[a])}this.normalizeSkinWeights(),this.updateMatrixWorld(!0),this.bind(new Ke(i,void 0,n),this.matrixWorld)}function nn(t){bt.call(this),this.type="LineBasicMaterial",this.color=new pt(16777215),this.linewidth=1,this.linecap="round",this.linejoin="round",this.lights=!1,this.setValues(t)}function rn(t,e,n){if(1===n)return console.warn("THREE.Line: parameter THREE.LinePieces no longer supported. Created THREE.LineSegments instead."),new on(t,e);Yt.call(this),this.type="Line",this.geometry=void 0!==t?t:new pe,this.material=void 0!==e?e:new nn({color:16777215*Math.random()})}function on(t,e){rn.call(this,t,e),this.type="LineSegments"}function an(t){bt.call(this),this.type="PointsMaterial",this.color=new pt(16777215),this.map=null,this.size=1,this.sizeAttenuation=!0,this.lights=!1,this.setValues(t)}function sn(t,e){Yt.call(this),this.type="Points",this.geometry=void 0!==t?t:new pe,this.material=void 0!==e?e:new an({color:16777215*Math.random()})}function cn(){Yt.call(this),this.type="Group"}function ln(t,e,n,i,r,o,a,s,c){p.call(this,t,e,n,i,r,o,a,s,c),this.generateMipmaps=!1;var l=this;!function e(){requestAnimationFrame(e),t.readyState>=t.HAVE_CURRENT_DATA&&(l.needsUpdate=!0)}()}function hn(t,e,n,i,r,o,a,s,c,l,h,u){p.call(this,null,o,a,s,c,l,i,r,h,u),this.image={width:e,height:n},this.mipmaps=t,this.flipY=!1,this.generateMipmaps=!1}function un(t,e,n,i,r,o,a,s,c){p.call(this,t,e,n,i,r,o,a,s,c),this.needsUpdate=!0}function dn(t,e,n,i,r,o,a,s,c,l){if(1026!==(l=void 0!==l?l:1026)&&1027!==l)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");p.call(this,null,i,r,o,a,s,l,n,c),this.image={width:t,height:e},this.type=void 0!==n?n:1012,this.magFilter=void 0!==a?a:1003,this.minFilter=void 0!==s?s:1003,this.flipY=!1,this.generateMipmaps=!1}function pn(t){pe.call(this);var e=[0,0],n={};function i(t,e){return t-e}var r=["a","b","c"];if(t&&t.isGeometry){for(var o=t.vertices,a=t.faces,s=0,c=new Uint32Array(6*a.length),l=0,h=a.length;l<h;l++)for(var u=a[l],d=0;d<3;d++)e[0]=u[r[d]],e[1]=u[r[(d+1)%3]],e.sort(i),void 0===n[_=e.toString()]&&(c[2*s]=e[0],c[2*s+1]=e[1],n[_]=!0,s++);var p=new Float32Array(2*s*3);for(l=0,h=s;l<h;l++)for(d=0;d<2;d++){var f=o[c[2*l+d]];p[0+(S=6*l+3*d)]=f.x,p[S+1]=f.y,p[S+2]=f.z}this.addAttribute("position",new oe(p,3))}else if(t&&t.isBufferGeometry)if(null!==t.index){var m=t.index.array,g=(o=t.attributes.position,t.groups);s=0,0===g.length&&t.addGroup(0,m.length),c=new Uint32Array(2*m.length);for(var v=0,y=g.length;v<y;++v)for(var b=g[v],x=b.start,w=(l=x,x+b.count);l<w;l+=3)for(d=0;d<3;d++){var _;e[0]=m[l+d],e[1]=m[l+(d+1)%3],e.sort(i),void 0===n[_=e.toString()]&&(c[2*s]=e[0],c[2*s+1]=e[1],n[_]=!0,s++)}for(p=new Float32Array(2*s*3),l=0,h=s;l<h;l++)for(d=0;d<2;d++){var S=6*l+3*d,E=c[2*l+d];p[S+0]=o.getX(E),p[S+1]=o.getY(E),p[S+2]=o.getZ(E)}this.addAttribute("position",new oe(p,3))}else{var A=(s=(o=t.attributes.position.array).length/3)/3;for(p=new Float32Array(2*s*3),l=0,h=A;l<h;l++)for(d=0;d<3;d++){var T=9*l+3*d;p[0+(S=18*l+6*d)]=o[T],p[S+1]=o[T+1],p[S+2]=o[T+2],E=9*l+(d+1)%3*3,p[S+3]=o[E],p[S+4]=o[E+1],p[S+5]=o[E+2]}this.addAttribute("position",new oe(p,3))}}function fn(t,e,n){le.call(this),this.type="ParametricGeometry",this.parameters={func:t,slices:e,stacks:n};var i,r,o,a,s,c,l,h,u,p,f,m,g=this.vertices,v=this.faces,y=this.faceVertexUvs[0],b=e+1;for(i=0;i<=n;i++)for(a=i/n,r=0;r<=e;r++)o=t(r/e,a),g.push(o);for(i=0;i<n;i++)for(r=0;r<e;r++)s=i*b+r,c=i*b+r+1,l=(i+1)*b+r+1,h=(i+1)*b+r,u=new d(r/e,i/n),p=new d((r+1)/e,i/n),f=new d((r+1)/e,(i+1)/n),m=new d(r/e,(i+1)/n),v.push(new ie(s,c,h)),y.push([u,p,m]),v.push(new ie(c,l,h)),y.push([p.clone(),f,m.clone()]);this.computeFaceNormals(),this.computeVertexNormals()}function mn(t,e,n,i){le.call(this),this.type="PolyhedronGeometry",this.parameters={vertices:t,indices:e,radius:n,detail:i},n=n||1,i=i||0;for(var r=this,o=0,a=t.length;o<a;o+=3)w(new T(t[o],t[o+1],t[o+2]));var s=this.vertices,c=[],l=(o=0,0);for(a=e.length;o<a;o+=3,l++){var h=s[e[o]],u=s[e[o+1]],p=s[e[o+2]];c[l]=new ie(h.index,u.index,p.index,[h.clone(),u.clone(),p.clone()])}var f=new T;for(o=0,a=c.length;o<a;o++)S(c[o],i);for(o=0,a=this.faceVertexUvs[0].length;o<a;o++){var m=this.faceVertexUvs[0][o],g=m[0].x,v=m[1].x,y=m[2].x,b=Math.max(g,v,y),x=Math.min(g,v,y);b>.9&&x<.1&&(g<.2&&(m[0].x+=1),v<.2&&(m[1].x+=1),y<.2&&(m[2].x+=1))}for(o=0,a=this.vertices.length;o<a;o++)this.vertices[o].multiplyScalar(n);function w(t){var e=t.normalize().clone();e.index=r.vertices.push(e)-1;var n=E(t)/2/Math.PI+.5,i=function(t){return Math.atan2(-t.y,Math.sqrt(t.x*t.x+t.z*t.z))}(t)/Math.PI+.5;return e.uv=new d(n,1-i),e}function _(t,e,n){var i=new ie(t.index,e.index,n.index,[t.clone(),e.clone(),n.clone()]);r.faces.push(i),f.copy(t).add(e).add(n).divideScalar(3);var o=E(f);r.faceVertexUvs[0].push([A(t.uv,t,o),A(e.uv,e,o),A(n.uv,n,o)])}function S(t,e){for(var n=Math.pow(2,e),i=w(r.vertices[t.a]),o=w(r.vertices[t.b]),a=w(r.vertices[t.c]),s=[],c=0;c<=n;c++){s[c]=[];for(var l=w(i.clone().lerp(a,c/n)),h=w(o.clone().lerp(a,c/n)),u=n-c,d=0;d<=u;d++)s[c][d]=0===d&&c===n?l:w(l.clone().lerp(h,d/u))}for(c=0;c<n;c++)for(d=0;d<2*(n-c)-1;d++){var p=Math.floor(d/2);d%2==0?_(s[c][p+1],s[c+1][p],s[c][p]):_(s[c][p+1],s[c+1][p+1],s[c+1][p])}}function E(t){return Math.atan2(t.z,-t.x)}function A(t,e,n){return n<0&&1===t.x&&(t=new d(t.x-1,t.y)),0===e.x&&0===e.z&&(t=new d(n/2/Math.PI+.5,t.y)),t.clone()}this.mergeVertices(),this.computeFaceNormals(),this.boundingSphere=new Bt(new T,n)}function gn(t,e){mn.call(this,[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],[2,1,0,0,3,2,1,3,0,2,3,1],t,e),this.type="TetrahedronGeometry",this.parameters={radius:t,detail:e}}function vn(t,e){mn.call(this,[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2],t,e),this.type="OctahedronGeometry",this.parameters={radius:t,detail:e}}function yn(t,e){var n=(1+Math.sqrt(5))/2,i=[-1,n,0,1,n,0,-1,-n,0,1,-n,0,0,-1,n,0,1,n,0,-1,-n,0,1,-n,n,0,-1,n,0,1,-n,0,-1,-n,0,1];mn.call(this,i,[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1],t,e),this.type="IcosahedronGeometry",this.parameters={radius:t,detail:e}}function bn(t,e){var n=(1+Math.sqrt(5))/2,i=1/n,r=[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-i,-n,0,-i,n,0,i,-n,0,i,n,-i,-n,0,-i,n,0,i,-n,0,i,n,0,-n,0,-i,n,0,-i,-n,0,i,n,0,i];mn.call(this,r,[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9],t,e),this.type="DodecahedronGeometry",this.parameters={radius:t,detail:e}}function xn(t,e,n,i,r,o){le.call(this),this.type="TubeGeometry",this.parameters={path:t,segments:e,radius:n,radialSegments:i,closed:r,taper:o},e=e||64,n=n||1,i=i||8,r=r||!1,o=o||xn.NoTaper;var a,s,c,l,h,u,p,f,m,g,v,y,b,x,w,_,S,E,A,M,C=[],P=this,R=e+1,L=new T,k=new xn.FrenetFrames(t,e,r),I=k.tangents,D=k.normals,O=k.binormals;function F(t,e,n){return P.vertices.push(new T(t,e,n))-1}for(this.tangents=I,this.normals=D,this.binormals=O,m=0;m<R;m++)for(C[m]=[],c=m/(R-1),f=t.getPointAt(c),I[m],a=D[m],s=O[m],h=n*o(c),g=0;g<i;g++)l=g/i*2*Math.PI,u=-h*Math.cos(l),p=h*Math.sin(l),L.copy(f),L.x+=u*a.x+p*s.x,L.y+=u*a.y+p*s.y,L.z+=u*a.z+p*s.z,C[m][g]=F(L.x,L.y,L.z);for(m=0;m<e;m++)for(g=0;g<i;g++)v=r?(m+1)%e:m+1,y=(g+1)%i,b=C[m][g],x=C[v][g],w=C[v][y],_=C[m][y],S=new d(m/e,g/i),E=new d((m+1)/e,g/i),A=new d((m+1)/e,(g+1)/i),M=new d(m/e,(g+1)/i),this.faces.push(new ie(b,x,_)),this.faceVertexUvs[0].push([S,E,M]),this.faces.push(new ie(x,w,_)),this.faceVertexUvs[0].push([E.clone(),A,M.clone()]);this.computeFaceNormals(),this.computeVertexNormals()}function wn(t,e,n,i,r,o){pe.call(this),this.type="TorusKnotBufferGeometry",this.parameters={radius:t,tube:e,tubularSegments:n,radialSegments:i,p:r,q:o},t=t||100,e=e||40,n=Math.floor(n)||64,r=r||2,o=o||3;var a,s,c=((i=Math.floor(i)||8)+1)*(n+1),l=i*n*2*3,h=new oe(new(l>65535?Uint32Array:Uint16Array)(l),1),u=new oe(new Float32Array(3*c),3),p=new oe(new Float32Array(3*c),3),f=new oe(new Float32Array(2*c),2),m=0,g=0,v=new T,y=new T,b=new d,x=new T,w=new T,_=new T,S=new T,E=new T;for(a=0;a<=n;++a){var A=a/n*r*Math.PI*2;for(D(A,r,o,t,x),D(A+.01,r,o,t,w),S.subVectors(w,x),E.addVectors(w,x),_.crossVectors(S,E),E.crossVectors(_,S),_.normalize(),E.normalize(),s=0;s<=i;++s){var M=s/i*Math.PI*2,C=-e*Math.cos(M),P=e*Math.sin(M);v.x=x.x+(C*E.x+P*_.x),v.y=x.y+(C*E.y+P*_.y),v.z=x.z+(C*E.z+P*_.z),u.setXYZ(m,v.x,v.y,v.z),y.subVectors(v,x).normalize(),p.setXYZ(m,y.x,y.y,y.z),b.x=a/n,b.y=s/i,f.setXY(m,b.x,b.y),m++}}for(s=1;s<=n;s++)for(a=1;a<=i;a++){var R=(i+1)*(s-1)+(a-1),L=(i+1)*s+(a-1),k=(i+1)*s+a,I=(i+1)*(s-1)+a;h.setX(g,R),g++,h.setX(g,L),g++,h.setX(g,I),g++,h.setX(g,L),g++,h.setX(g,k),g++,h.setX(g,I),g++}function D(t,e,n,i,r){var o=Math.cos(t),a=Math.sin(t),s=n/e*t,c=Math.cos(s);r.x=i*(2+c)*.5*o,r.y=i*(2+c)*a*.5,r.z=i*Math.sin(s)*.5}this.setIndex(h),this.addAttribute("position",u),this.addAttribute("normal",p),this.addAttribute("uv",f)}function _n(t,e,n,i,r,o,a){le.call(this),this.type="TorusKnotGeometry",this.parameters={radius:t,tube:e,tubularSegments:n,radialSegments:i,p:r,q:o},void 0!==a&&console.warn("THREE.TorusKnotGeometry: heightScale has been deprecated. Use .scale( x, y, z ) instead."),this.fromBufferGeometry(new wn(t,e,n,i,r,o)),this.mergeVertices()}function Sn(t,e,n,i,r){pe.call(this),this.type="TorusBufferGeometry",this.parameters={radius:t,tube:e,radialSegments:n,tubularSegments:i,arc:r},t=t||100,e=e||40,n=Math.floor(n)||8,i=Math.floor(i)||6,r=r||2*Math.PI;var o,a,s=(n+1)*(i+1),c=n*i*2*3,l=new(c>65535?Uint32Array:Uint16Array)(c),h=new Float32Array(3*s),u=new Float32Array(3*s),d=new Float32Array(2*s),p=0,f=0,m=0,g=new T,v=new T,y=new T;for(o=0;o<=n;o++)for(a=0;a<=i;a++){var b=a/i*r,x=o/n*Math.PI*2;v.x=(t+e*Math.cos(x))*Math.cos(b),v.y=(t+e*Math.cos(x))*Math.sin(b),v.z=e*Math.sin(x),h[p]=v.x,h[p+1]=v.y,h[p+2]=v.z,g.x=t*Math.cos(b),g.y=t*Math.sin(b),y.subVectors(v,g).normalize(),u[p]=y.x,u[p+1]=y.y,u[p+2]=y.z,d[f]=a/i,d[f+1]=o/n,p+=3,f+=2}for(o=1;o<=n;o++)for(a=1;a<=i;a++){var w=(i+1)*o+a-1,_=(i+1)*(o-1)+a-1,S=(i+1)*(o-1)+a,E=(i+1)*o+a;l[m]=w,l[m+1]=_,l[m+2]=E,l[m+3]=_,l[m+4]=S,l[m+5]=E,m+=6}this.setIndex(new oe(l,1)),this.addAttribute("position",new oe(h,3)),this.addAttribute("normal",new oe(u,3)),this.addAttribute("uv",new oe(d,2))}function En(t,e,n,i,r){le.call(this),this.type="TorusGeometry",this.parameters={radius:t,tube:e,radialSegments:n,tubularSegments:i,arc:r},this.fromBufferGeometry(new Sn(t,e,n,i,r))}function An(t,e){void 0!==t?(le.call(this),this.type="ExtrudeGeometry",t=Array.isArray(t)?t:[t],this.addShapeList(t,e),this.computeFaceNormals()):t=[]}function Tn(t,e){var n=(e=e||{}).font;if(!1===(n&&n.isFont))return console.error("THREE.TextGeometry: font parameter is not an instance of THREE.Font."),new le;var i=n.generateShapes(t,e.size,e.curveSegments);e.amount=void 0!==e.height?e.height:50,void 0===e.bevelThickness&&(e.bevelThickness=10),void 0===e.bevelSize&&(e.bevelSize=8),void 0===e.bevelEnabled&&(e.bevelEnabled=!1),An.call(this,i,e),this.type="TextGeometry"}function Mn(t,e,n,i,r,o,a){pe.call(this),this.type="SphereBufferGeometry",this.parameters={radius:t,widthSegments:e,heightSegments:n,phiStart:i,phiLength:r,thetaStart:o,thetaLength:a},t=t||50,e=Math.max(3,Math.floor(e)||8),n=Math.max(2,Math.floor(n)||6),i=void 0!==i?i:0,r=void 0!==r?r:2*Math.PI;for(var s=(o=void 0!==o?o:0)+(a=void 0!==a?a:Math.PI),c=(e+1)*(n+1),l=new oe(new Float32Array(3*c),3),h=new oe(new Float32Array(3*c),3),u=new oe(new Float32Array(2*c),2),d=0,p=[],f=new T,m=0;m<=n;m++){for(var g=[],v=m/n,y=0;y<=e;y++){var b=y/e,x=-t*Math.cos(i+b*r)*Math.sin(o+v*a),w=t*Math.cos(o+v*a),_=t*Math.sin(i+b*r)*Math.sin(o+v*a);f.set(x,w,_).normalize(),l.setXYZ(d,x,w,_),h.setXYZ(d,f.x,f.y,f.z),u.setXY(d,b,1-v),g.push(d),d++}p.push(g)}var S=[];for(m=0;m<n;m++)for(y=0;y<e;y++){var E=p[m][y+1],A=p[m][y],M=p[m+1][y],C=p[m+1][y+1];(0!==m||o>0)&&S.push(E,A,C),(m!==n-1||s<Math.PI)&&S.push(A,M,C)}this.setIndex(new(l.count>65535?se:ae)(S,1)),this.addAttribute("position",l),this.addAttribute("normal",h),this.addAttribute("uv",u),this.boundingSphere=new Bt(new T,t)}function Cn(t,e,n,i,r,o,a){le.call(this),this.type="SphereGeometry",this.parameters={radius:t,widthSegments:e,heightSegments:n,phiStart:i,phiLength:r,thetaStart:o,thetaLength:a},this.fromBufferGeometry(new Mn(t,e,n,i,r,o,a))}function Pn(t,e,n,i,r,o){pe.call(this),this.type="RingBufferGeometry",this.parameters={innerRadius:t,outerRadius:e,thetaSegments:n,phiSegments:i,thetaStart:r,thetaLength:o},t=t||20,e=e||50,r=void 0!==r?r:0,o=void 0!==o?o:2*Math.PI;var a,s,c,l=((n=void 0!==n?Math.max(3,n):8)+1)*((i=void 0!==i?Math.max(1,i):1)+1),h=n*i*2*3,u=new oe(new(h>65535?Uint32Array:Uint16Array)(h),1),p=new oe(new Float32Array(3*l),3),f=new oe(new Float32Array(3*l),3),m=new oe(new Float32Array(2*l),2),g=0,v=0,y=t,b=(e-t)/i,x=new T,w=new d;for(s=0;s<=i;s++){for(c=0;c<=n;c++)a=r+c/n*o,x.x=y*Math.cos(a),x.y=y*Math.sin(a),p.setXYZ(g,x.x,x.y,x.z),f.setXYZ(g,0,0,1),w.x=(x.x/e+1)/2,w.y=(x.y/e+1)/2,m.setXY(g,w.x,w.y),g++;y+=b}for(s=0;s<i;s++){var _=s*(n+1);for(c=0;c<n;c++){var S=a=c+_,E=a+n+1,A=a+n+2,M=a+1;u.setX(v,S),v++,u.setX(v,E),v++,u.setX(v,A),v++,u.setX(v,S),v++,u.setX(v,A),v++,u.setX(v,M),v++}}this.setIndex(u),this.addAttribute("position",p),this.addAttribute("normal",f),this.addAttribute("uv",m)}function Rn(t,e,n,i,r,o){le.call(this),this.type="RingGeometry",this.parameters={innerRadius:t,outerRadius:e,thetaSegments:n,phiSegments:i,thetaStart:r,thetaLength:o},this.fromBufferGeometry(new Pn(t,e,n,i,r,o))}function Ln(t,e,n,i){le.call(this),this.type="PlaneGeometry",this.parameters={width:t,height:e,widthSegments:n,heightSegments:i},this.fromBufferGeometry(new ge(t,e,n,i))}function kn(e,n,i,r){pe.call(this),this.type="LatheBufferGeometry",this.parameters={points:e,segments:n,phiStart:i,phiLength:r},n=Math.floor(n)||12,i=i||0,r=r||2*Math.PI,r=t.Math.clamp(r,0,2*Math.PI);var o,a,s,c=(n+1)*e.length,l=n*e.length*2*3,h=new oe(new(l>65535?Uint32Array:Uint16Array)(l),1),u=new oe(new Float32Array(3*c),3),p=new oe(new Float32Array(2*c),2),f=0,m=0,g=1/n,v=new T,y=new d;for(a=0;a<=n;a++){var b=i+a*g*r,x=Math.sin(b),w=Math.cos(b);for(s=0;s<=e.length-1;s++)v.x=e[s].x*x,v.y=e[s].y,v.z=e[s].x*w,u.setXYZ(f,v.x,v.y,v.z),y.x=a/n,y.y=s/(e.length-1),p.setXY(f,y.x,y.y),f++}for(a=0;a<n;a++)for(s=0;s<e.length-1;s++){var _=o=s+a*e.length,S=o+e.length,E=o+e.length+1,A=o+1;h.setX(m,_),m++,h.setX(m,S),m++,h.setX(m,A),m++,h.setX(m,S),m++,h.setX(m,E),m++,h.setX(m,A),m++}if(this.setIndex(h),this.addAttribute("position",u),this.addAttribute("uv",p),this.computeVertexNormals(),r===2*Math.PI){var M=this.attributes.normal.array,C=new T,P=new T,R=new T;for(o=n*e.length*3,a=0,s=0;a<e.length;a++,s+=3)C.x=M[s+0],C.y=M[s+1],C.z=M[s+2],P.x=M[o+s+0],P.y=M[o+s+1],P.z=M[o+s+2],R.addVectors(C,P).normalize(),M[s+0]=M[o+s+0]=R.x,M[s+1]=M[o+s+1]=R.y,M[s+2]=M[o+s+2]=R.z}}function In(t,e,n,i){le.call(this),this.type="LatheGeometry",this.parameters={points:t,segments:e,phiStart:n,phiLength:i},this.fromBufferGeometry(new kn(t,e,n,i)),this.mergeVertices()}function Dn(t,e){le.call(this),this.type="ShapeGeometry",!1===Array.isArray(t)&&(t=[t]),this.addShapeList(t,e),this.computeFaceNormals()}function On(e,n){pe.call(this),n=void 0!==n?n:1;var i=Math.cos(t.Math.DEG2RAD*n),r=[0,0],o={};function a(t,e){return t-e}var s,c=["a","b","c"];e&&e.isBufferGeometry?(s=new le).fromBufferGeometry(e):s=e.clone(),s.mergeVertices(),s.computeFaceNormals();for(var l=s.vertices,h=s.faces,u=0,d=h.length;u<d;u++)for(var p=h[u],f=0;f<3;f++)r[0]=p[c[f]],r[1]=p[c[(f+1)%3]],r.sort(a),void 0===o[g=r.toString()]?o[g]={vert1:r[0],vert2:r[1],face1:u,face2:void 0}:o[g].face2=u;var m=[];for(var g in o){var v=o[g];if(void 0===v.face2||h[v.face1].normal.dot(h[v.face2].normal)<=i){var y=l[v.vert1];m.push(y.x),m.push(y.y),m.push(y.z),y=l[v.vert2],m.push(y.x),m.push(y.y),m.push(y.z)}}this.addAttribute("position",new oe(new Float32Array(m),3))}function Fn(t,e,n,i,r,o,a,s){pe.call(this),this.type="CylinderBufferGeometry",this.parameters={radiusTop:t,radiusBottom:e,height:n,radialSegments:i,heightSegments:r,openEnded:o,thetaStart:a,thetaLength:s};var c=this;t=void 0!==t?t:20,e=void 0!==e?e:20,n=void 0!==n?n:100,i=Math.floor(i)||8,r=Math.floor(r)||1,o=void 0!==o&&o,a=void 0!==a?a:0,s=void 0!==s?s:2*Math.PI;var l=0;!1===o&&(t>0&&l++,e>0&&l++);var h=function(){var t=(i+1)*(r+1);return!1===o&&(t+=(i+1)*l+i*l),t}(),u=function(){var t=i*r*2*3;return!1===o&&(t+=i*l*3),t}(),p=new oe(new(u>65535?Uint32Array:Uint16Array)(u),1),f=new oe(new Float32Array(3*h),3),m=new oe(new Float32Array(3*h),3),g=new oe(new Float32Array(2*h),2),v=0,y=0,b=[],x=n/2,w=0;function _(n){var r,o,l,h=new d,u=new T,b=0,_=!0===n?t:e,S=!0===n?1:-1;for(o=v,r=1;r<=i;r++)f.setXYZ(v,0,x*S,0),m.setXYZ(v,0,S,0),h.x=.5,h.y=.5,g.setXY(v,h.x,h.y),v++;for(l=v,r=0;r<=i;r++){var E=r/i*s+a,A=Math.cos(E),M=Math.sin(E);u.x=_*M,u.y=x*S,u.z=_*A,f.setXYZ(v,u.x,u.y,u.z),m.setXYZ(v,0,S,0),h.x=.5*A+.5,h.y=.5*M*S+.5,g.setXY(v,h.x,h.y),v++}for(r=0;r<i;r++){var C=o+r,P=l+r;!0===n?(p.setX(y,P),y++,p.setX(y,P+1),y++,p.setX(y,C),y++):(p.setX(y,P+1),y++,p.setX(y,P),y++,p.setX(y,C),y++),b+=3}c.addGroup(w,b,!0===n?1:2),w+=b}!function(){var o,l,h=new T,u=new T,d=0,_=(e-t)/n;for(l=0;l<=r;l++){var S=[],E=l/r,A=E*(e-t)+t;for(o=0;o<=i;o++){var M=o/i,C=M*s+a,P=Math.sin(C),R=Math.cos(C);u.x=A*P,u.y=-E*n+x,u.z=A*R,f.setXYZ(v,u.x,u.y,u.z),h.set(P,_,R).normalize(),m.setXYZ(v,h.x,h.y,h.z),g.setXY(v,M,1-E),S.push(v),v++}b.push(S)}for(o=0;o<i;o++)for(l=0;l<r;l++){var L=b[l][o],k=b[l+1][o],I=b[l+1][o+1],D=b[l][o+1];p.setX(y,L),y++,p.setX(y,k),y++,p.setX(y,D),y++,p.setX(y,k),y++,p.setX(y,I),y++,p.setX(y,D),y++,d+=6}c.addGroup(w,d,0),w+=d}(),!1===o&&(t>0&&_(!0),e>0&&_(!1)),this.setIndex(p),this.addAttribute("position",f),this.addAttribute("normal",m),this.addAttribute("uv",g)}function Nn(t,e,n,i,r,o,a,s){le.call(this),this.type="CylinderGeometry",this.parameters={radiusTop:t,radiusBottom:e,height:n,radialSegments:i,heightSegments:r,openEnded:o,thetaStart:a,thetaLength:s},this.fromBufferGeometry(new Fn(t,e,n,i,r,o,a,s)),this.mergeVertices()}function Un(t,e,n,i,r,o,a){Nn.call(this,0,t,e,n,i,r,o,a),this.type="ConeGeometry",this.parameters={radius:t,height:e,radialSegments:n,heightSegments:i,openEnded:r,thetaStart:o,thetaLength:a}}function jn(t,e,n,i,r,o,a){Fn.call(this,0,t,e,n,i,r,o,a),this.type="ConeBufferGeometry",this.parameters={radius:t,height:e,radialSegments:n,heightSegments:i,thetaStart:o,thetaLength:a}}function Bn(t,e,n,i){pe.call(this),this.type="CircleBufferGeometry",this.parameters={radius:t,segments:e,thetaStart:n,thetaLength:i},t=t||50,e=void 0!==e?Math.max(3,e):8,n=void 0!==n?n:0,i=void 0!==i?i:2*Math.PI;var r=e+2,o=new Float32Array(3*r),a=new Float32Array(3*r),s=new Float32Array(2*r);a[2]=1,s[0]=.5,s[1]=.5;for(var c=0,l=3,h=2;c<=e;c++,l+=3,h+=2){var u=n+c/e*i;o[l]=t*Math.cos(u),o[l+1]=t*Math.sin(u),a[l+2]=1,s[h]=(o[l]/t+1)/2,s[h+1]=(o[l+1]/t+1)/2}var d=[];for(l=1;l<=e;l++)d.push(l,l+1,0);this.setIndex(new oe(new Uint16Array(d),1)),this.addAttribute("position",new oe(o,3)),this.addAttribute("normal",new oe(a,3)),this.addAttribute("uv",new oe(s,2)),this.boundingSphere=new Bt(new T,t)}function zn(t,e,n,i){le.call(this),this.type="CircleGeometry",this.parameters={radius:t,segments:e,thetaStart:n,thetaLength:i},this.fromBufferGeometry(new Bn(t,e,n,i))}function Hn(t,e,n,i,r,o){le.call(this),this.type="BoxGeometry",this.parameters={width:t,height:e,depth:n,widthSegments:i,heightSegments:r,depthSegments:o},this.fromBufferGeometry(new me(t,e,n,i,r,o)),this.mergeVertices()}We.prototype.isFogExp2=!0,We.prototype.clone=function(){return new We(this.color.getHex(),this.density)},We.prototype.toJSON=function(t){return{type:"FogExp2",color:this.color.getHex(),density:this.density}},Xe.prototype.isFog=!0,Xe.prototype.clone=function(){return new Xe(this.color.getHex(),this.near,this.far)},Xe.prototype.toJSON=function(t){return{type:"Fog",color:this.color.getHex(),near:this.near,far:this.far}},qe.prototype=Object.create(Yt.prototype),qe.prototype.constructor=qe,qe.prototype.copy=function(t,e){return Yt.prototype.copy.call(this,t,e),null!==t.background&&(this.background=t.background.clone()),null!==t.fog&&(this.fog=t.fog.clone()),null!==t.overrideMaterial&&(this.overrideMaterial=t.overrideMaterial.clone()),this.autoUpdate=t.autoUpdate,this.matrixAutoUpdate=t.matrixAutoUpdate,this},qe.prototype.toJSON=function(t){var e=Yt.prototype.toJSON.call(this,t);return null!==this.background&&(e.object.background=this.background.toJSON(t)),null!==this.fog&&(e.object.fog=this.fog.toJSON()),e},Ye.prototype=Object.assign(Object.create(Yt.prototype),{constructor:Ye,isLensFlare:!0,copy:function(t){Yt.prototype.copy.call(this,t),this.positionScreen.copy(t.positionScreen),this.customUpdateCallback=t.customUpdateCallback;for(var e=0,n=t.lensFlares.length;e<n;e++)this.lensFlares.push(t.lensFlares[e]);return this},add:function(t,e,n,i,r,o){void 0===e&&(e=-1),void 0===n&&(n=0),void 0===o&&(o=1),void 0===r&&(r=new pt(16777215)),void 0===i&&(i=1),n=Math.min(n,Math.max(0,n)),this.lensFlares.push({texture:t,size:e,distance:n,x:0,y:0,z:0,scale:1,rotation:0,opacity:o,color:r,blending:i})},updateLensFlares:function(){var t,e,n=this.lensFlares.length,i=2*-this.positionScreen.x,r=2*-this.positionScreen.y;for(t=0;t<n;t++)(e=this.lensFlares[t]).x=this.positionScreen.x+i*e.distance,e.y=this.positionScreen.y+r*e.distance,e.wantedRotation=e.x*Math.PI*.25,e.rotation+=.25*(e.wantedRotation-e.rotation)}}),Ze.prototype=Object.create(bt.prototype),Ze.prototype.constructor=Ze,Ze.prototype.copy=function(t){return bt.prototype.copy.call(this,t),this.color.copy(t.color),this.map=t.map,this.rotation=t.rotation,this},$e.prototype=Object.assign(Object.create(Yt.prototype),{constructor:$e,isSprite:!0,raycast:(Ae=new T,function(t,e){Ae.setFromMatrixPosition(this.matrixWorld);var n=t.ray.distanceSqToPoint(Ae);n>this.scale.x*this.scale.y/4||e.push({distance:Math.sqrt(n),point:this.position,face:null,object:this})}),clone:function(){return new this.constructor(this.material).copy(this)}}),Qe.prototype=Object.assign(Object.create(Yt.prototype),{constructor:Qe,copy:function(t){Yt.prototype.copy.call(this,t,!1);for(var e=t.levels,n=0,i=e.length;n<i;n++){var r=e[n];this.addLevel(r.object.clone(),r.distance)}return this},addLevel:function(t,e){void 0===e&&(e=0),e=Math.abs(e);for(var n=this.levels,i=0;i<n.length&&!(e<n[i].distance);i++);n.splice(i,0,{distance:e,object:t}),this.add(t)},getObjectForDistance:function(t){for(var e=this.levels,n=1,i=e.length;n<i&&!(t<e[n].distance);n++);return e[n-1].object},raycast:function(){var t=new T;return function(e,n){t.setFromMatrixPosition(this.matrixWorld);var i=e.ray.origin.distanceTo(t);this.getObjectForDistance(i).raycast(e,n)}}(),update:function(){var t=new T,e=new T;return function(n){var i=this.levels;if(i.length>1){t.setFromMatrixPosition(n.matrixWorld),e.setFromMatrixPosition(this.matrixWorld);var r=t.distanceTo(e);i[0].object.visible=!0;for(var o=1,a=i.length;o<a&&r>=i[o].distance;o++)i[o-1].object.visible=!1,i[o].object.visible=!0;for(;o<a;o++)i[o].object.visible=!1}}}(),toJSON:function(t){var e=Yt.prototype.toJSON.call(this,t);e.object.levels=[];for(var n=this.levels,i=0,r=n.length;i<r;i++){var o=n[i];e.object.levels.push({object:o.object.uuid,distance:o.distance})}return e}}),Je.prototype=Object.create(p.prototype),Je.prototype.constructor=Je,Je.prototype.isDataTexture=!0,Object.assign(Ke.prototype,{calculateInverses:function(){this.boneInverses=[];for(var t=0,e=this.bones.length;t<e;t++){var n=new M;this.bones[t]&&n.getInverse(this.bones[t].matrixWorld),this.boneInverses.push(n)}},pose:function(){for(var t,e=0,n=this.bones.length;e<n;e++)(t=this.bones[e])&&t.matrixWorld.getInverse(this.boneInverses[e]);for(e=0,n=this.bones.length;e<n;e++)(t=this.bones[e])&&(t.parent&&t.parent.isBone?(t.matrix.getInverse(t.parent.matrixWorld),t.matrix.multiply(t.matrixWorld)):t.matrix.copy(t.matrixWorld),t.matrix.decompose(t.position,t.quaternion,t.scale))},update:(Ee=new M,function(){for(var t=0,e=this.bones.length;t<e;t++){var n=this.bones[t]?this.bones[t].matrixWorld:this.identityMatrix;Ee.multiplyMatrices(n,this.boneInverses[t]),Ee.toArray(this.boneMatrices,16*t)}this.useVertexTexture&&(this.boneTexture.needsUpdate=!0)}),clone:function(){return new Ke(this.bones,this.boneInverses,this.useVertexTexture)}}),tn.prototype=Object.assign(Object.create(Yt.prototype),{constructor:tn,isBone:!0,copy:function(t){return Yt.prototype.copy.call(this,t),this.skin=t.skin,this}}),en.prototype=Object.assign(Object.create(fe.prototype),{constructor:en,isSkinnedMesh:!0,bind:function(t,e){this.skeleton=t,void 0===e&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),e=this.matrixWorld),this.bindMatrix.copy(e),this.bindMatrixInverse.getInverse(e)},pose:function(){this.skeleton.pose()},normalizeSkinWeights:function(){if(this.geometry&&this.geometry.isGeometry)for(var t=0;t<this.geometry.skinWeights.length;t++){var e=this.geometry.skinWeights[t];(r=1/e.lengthManhattan())!=1/0?e.multiplyScalar(r):e.set(1,0,0,0)}else if(this.geometry&&this.geometry.isBufferGeometry){var n=new _,i=this.geometry.attributes.skinWeight;for(t=0;t<i.count;t++){var r;n.x=i.getX(t),n.y=i.getY(t),n.z=i.getZ(t),n.w=i.getW(t),(r=1/n.lengthManhattan())!=1/0?n.multiplyScalar(r):n.set(1,0,0,0),i.setXYZW(t,n.x,n.y,n.z,n.w)}}},updateMatrixWorld:function(t){fe.prototype.updateMatrixWorld.call(this,!0),"attached"===this.bindMode?this.bindMatrixInverse.getInverse(this.matrixWorld):"detached"===this.bindMode?this.bindMatrixInverse.getInverse(this.bindMatrix):console.warn("THREE.SkinnedMesh unrecognized bindMode: "+this.bindMode)},clone:function(){return new this.constructor(this.geometry,this.material,this.skeleton.useVertexTexture).copy(this)}}),nn.prototype=Object.create(bt.prototype),nn.prototype.constructor=nn,nn.prototype.isLineBasicMaterial=!0,nn.prototype.copy=function(t){return bt.prototype.copy.call(this,t),this.color.copy(t.color),this.linewidth=t.linewidth,this.linecap=t.linecap,this.linejoin=t.linejoin,this},rn.prototype=Object.assign(Object.create(Yt.prototype),{constructor:rn,isLine:!0,raycast:function(){var t=new M,e=new Wt,n=new Bt;return function(i,r){var o=i.linePrecision,a=o*o,s=this.geometry,c=this.matrixWorld;if(null===s.boundingSphere&&s.computeBoundingSphere(),n.copy(s.boundingSphere),n.applyMatrix4(c),!1!==i.ray.intersectsSphere(n)){t.getInverse(c),e.copy(i.ray).applyMatrix4(t);var l=new T,h=new T,u=new T,d=new T,p=this&&this.isLineSegments?2:1;if(s&&s.isBufferGeometry){var f=s.index,m=s.attributes.position.array;if(null!==f)for(var g=f.array,v=0,y=g.length-1;v<y;v+=p){var b=g[v],x=g[v+1];l.fromArray(m,3*b),h.fromArray(m,3*x),e.distanceSqToSegment(l,h,d,u)>a||(d.applyMatrix4(this.matrixWorld),(S=i.ray.origin.distanceTo(d))<i.near||S>i.far||r.push({distance:S,point:u.clone().applyMatrix4(this.matrixWorld),index:v,face:null,faceIndex:null,object:this}))}else for(v=0,y=m.length/3-1;v<y;v+=p)l.fromArray(m,3*v),h.fromArray(m,3*v+3),e.distanceSqToSegment(l,h,d,u)>a||(d.applyMatrix4(this.matrixWorld),(S=i.ray.origin.distanceTo(d))<i.near||S>i.far||r.push({distance:S,point:u.clone().applyMatrix4(this.matrixWorld),index:v,face:null,faceIndex:null,object:this}))}else if(s&&s.isGeometry){var w=s.vertices,_=w.length;for(v=0;v<_-1;v+=p){var S;e.distanceSqToSegment(w[v],w[v+1],d,u)>a||(d.applyMatrix4(this.matrixWorld),(S=i.ray.origin.distanceTo(d))<i.near||S>i.far||r.push({distance:S,point:u.clone().applyMatrix4(this.matrixWorld),index:v,face:null,faceIndex:null,object:this}))}}}}}(),clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}}),on.prototype=Object.assign(Object.create(rn.prototype),{constructor:on,isLineSegments:!0}),an.prototype=Object.create(bt.prototype),an.prototype.constructor=an,an.prototype.isPointsMaterial=!0,an.prototype.copy=function(t){return bt.prototype.copy.call(this,t),this.color.copy(t.color),this.map=t.map,this.size=t.size,this.sizeAttenuation=t.sizeAttenuation,this},sn.prototype=Object.assign(Object.create(Yt.prototype),{constructor:sn,isPoints:!0,raycast:function(){var t=new M,e=new Wt,n=new Bt;return function(i,r){var o=this,a=this.geometry,s=this.matrixWorld,c=i.params.Points.threshold;if(null===a.boundingSphere&&a.computeBoundingSphere(),n.copy(a.boundingSphere),n.applyMatrix4(s),!1!==i.ray.intersectsSphere(n)){t.getInverse(s),e.copy(i.ray).applyMatrix4(t);var l=c/((this.scale.x+this.scale.y+this.scale.z)/3),h=l*l,u=new T;if(a&&a.isBufferGeometry){var d=a.index,p=a.attributes.position.array;if(null!==d)for(var f=d.array,m=0,g=f.length;m<g;m++){var v=f[m];u.fromArray(p,3*v),x(u,v)}else{m=0;for(var y=p.length/3;m<y;m++)u.fromArray(p,3*m),x(u,m)}}else{var b=a.vertices;for(m=0,y=b.length;m<y;m++)x(b[m],m)}}function x(t,n){var a=e.distanceSqToPoint(t);if(a<h){var c=e.closestPointToPoint(t);c.applyMatrix4(s);var l=i.ray.origin.distanceTo(c);if(l<i.near||l>i.far)return;r.push({distance:l,distanceToRay:Math.sqrt(a),point:c.clone(),index:n,face:null,object:o})}}}}(),clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}}),cn.prototype=Object.assign(Object.create(Yt.prototype),{constructor:cn}),ln.prototype=Object.create(p.prototype),ln.prototype.constructor=ln,hn.prototype=Object.create(p.prototype),hn.prototype.constructor=hn,hn.prototype.isCompressedTexture=!0,un.prototype=Object.create(p.prototype),un.prototype.constructor=un,dn.prototype=Object.create(p.prototype),dn.prototype.constructor=dn,dn.prototype.isDepthTexture=!0,pn.prototype=Object.create(pe.prototype),pn.prototype.constructor=pn,fn.prototype=Object.create(le.prototype),fn.prototype.constructor=fn,mn.prototype=Object.create(le.prototype),mn.prototype.constructor=mn,gn.prototype=Object.create(mn.prototype),gn.prototype.constructor=gn,vn.prototype=Object.create(mn.prototype),vn.prototype.constructor=vn,yn.prototype=Object.create(mn.prototype),yn.prototype.constructor=yn,bn.prototype=Object.create(mn.prototype),bn.prototype.constructor=bn,xn.prototype=Object.create(le.prototype),xn.prototype.constructor=xn,xn.NoTaper=function(t){return 1},xn.SinusoidalTaper=function(t){return Math.sin(Math.PI*t)},xn.FrenetFrames=function(e,n,i){var r,o,a,s,c,l,h,u=new T,d=[],p=[],f=[],m=new T,g=new M,v=n+1;for(this.tangents=d,this.normals=p,this.binormals=f,l=0;l<v;l++)h=l/(v-1),d[l]=e.getTangentAt(h),d[l].normalize();for(p[0]=new T,f[0]=new T,o=Number.MAX_VALUE,a=Math.abs(d[0].x),s=Math.abs(d[0].y),c=Math.abs(d[0].z),a<=o&&(o=a,u.set(1,0,0)),s<=o&&(o=s,u.set(0,1,0)),c<=o&&u.set(0,0,1),m.crossVectors(d[0],u).normalize(),p[0].crossVectors(d[0],m),f[0].crossVectors(d[0],p[0]),l=1;l<v;l++)p[l]=p[l-1].clone(),f[l]=f[l-1].clone(),m.crossVectors(d[l-1],d[l]),m.length()>Number.EPSILON&&(m.normalize(),r=Math.acos(t.Math.clamp(d[l-1].dot(d[l]),-1,1)),p[l].applyMatrix4(g.makeRotationAxis(m,r))),f[l].crossVectors(d[l],p[l]);if(i)for(r=Math.acos(t.Math.clamp(p[0].dot(p[v-1]),-1,1)),r/=v-1,d[0].dot(m.crossVectors(p[0],p[v-1]))>0&&(r=-r),l=1;l<v;l++)p[l].applyMatrix4(g.makeRotationAxis(d[l],r*l)),f[l].crossVectors(d[l],p[l])},wn.prototype=Object.create(pe.prototype),wn.prototype.constructor=wn,_n.prototype=Object.create(le.prototype),_n.prototype.constructor=_n,Sn.prototype=Object.create(pe.prototype),Sn.prototype.constructor=Sn,En.prototype=Object.create(le.prototype),En.prototype.constructor=En,t.ShapeUtils={area:function(t){for(var e=t.length,n=0,i=e-1,r=0;r<e;i=r++)n+=t[i].x*t[r].y-t[r].x*t[i].y;return.5*n},triangulate:function(){function e(t,e,n,i,r,o){var a,s,c,l,h,u,d,p,f,m,g,v,y,b,x,w,_;if(s=t[o[e]].x,c=t[o[e]].y,l=t[o[n]].x,h=t[o[n]].y,u=t[o[i]].x,d=t[o[i]].y,Number.EPSILON>(l-s)*(d-c)-(h-c)*(u-s))return!1;for(m=u-l,g=d-h,v=s-u,y=c-d,b=l-s,x=h-c,a=0;a<r;a++)if(p=t[o[a]].x,f=t[o[a]].y,!(p===s&&f===c||p===l&&f===h||p===u&&f===d)&&(w=b*(f-c)-x*(p-s),_=v*(f-d)-y*(p-u),m*(f-h)-g*(p-l)>=-Number.EPSILON&&_>=-Number.EPSILON&&w>=-Number.EPSILON))return!1;return!0}return function(n,i){var r=n.length;if(r<3)return null;var o,a,s,c=[],l=[],h=[];if(t.ShapeUtils.area(n)>0)for(a=0;a<r;a++)l[a]=a;else for(a=0;a<r;a++)l[a]=r-1-a;var u=r,d=2*u;for(a=u-1;u>2;){if(d--<=0)return console.warn("THREE.ShapeUtils: Unable to triangulate polygon! in triangulate()"),i?h:c;if(u<=(o=a)&&(o=0),u<=(a=o+1)&&(a=0),u<=(s=a+1)&&(s=0),e(n,o,a,s,u,l)){var p,f,m,g,v;for(p=l[o],f=l[a],m=l[s],c.push([n[p],n[f],n[m]]),h.push([l[o],l[a],l[s]]),g=a,v=a+1;v<u;g++,v++)l[g]=l[v];d=2*--u}}return i?h:c}}(),triangulateShape:function(e,n){function i(t){var e=t.length;e>2&&t[e-1].equals(t[0])&&t.pop()}function r(t,e,n){return t.x!==e.x?t.x<e.x?t.x<=n.x&&n.x<=e.x:e.x<=n.x&&n.x<=t.x:t.y<e.y?t.y<=n.y&&n.y<=e.y:e.y<=n.y&&n.y<=t.y}function o(t,e,n,i,o){var a=e.x-t.x,s=e.y-t.y,c=i.x-n.x,l=i.y-n.y,h=t.x-n.x,u=t.y-n.y,d=s*c-a*l,p=s*h-a*u;if(Math.abs(d)>Number.EPSILON){var f;if(d>0){if(p<0||p>d)return[];if((f=l*h-c*u)<0||f>d)return[]}else{if(p>0||p<d)return[];if((f=l*h-c*u)>0||f<d)return[]}if(0===f)return!o||0!==p&&p!==d?[t]:[];if(f===d)return!o||0!==p&&p!==d?[e]:[];if(0===p)return[n];if(p===d)return[i];var m=f/d;return[{x:t.x+m*a,y:t.y+m*s}]}if(0!==p||l*h!=c*u)return[];var g,v,y,b,x,w,_,S,E=0===a&&0===s,A=0===c&&0===l;return E&&A?t.x!==n.x||t.y!==n.y?[]:[t]:E?r(n,i,t)?[t]:[]:A?r(t,e,n)?[n]:[]:(0!==a?(t.x<e.x?(g=t,y=t.x,v=e,b=e.x):(g=e,y=e.x,v=t,b=t.x),n.x<i.x?(x=n,_=n.x,w=i,S=i.x):(x=i,_=i.x,w=n,S=n.x)):(t.y<e.y?(g=t,y=t.y,v=e,b=e.y):(g=e,y=e.y,v=t,b=t.y),n.y<i.y?(x=n,_=n.y,w=i,S=i.y):(x=i,_=i.y,w=n,S=n.y)),y<=_?b<_?[]:b===_?o?[]:[x]:b<=S?[x,v]:[x,w]:y>S?[]:y===S?o?[]:[g]:b<=S?[g,v]:[g,w])}function a(t,e,n,i){var r=e.x-t.x,o=e.y-t.y,a=n.x-t.x,s=n.y-t.y,c=i.x-t.x,l=i.y-t.y,h=r*s-o*a,u=r*l-o*c;if(Math.abs(h)>Number.EPSILON){var d=c*s-l*a;return h>0?u>=0&&d>=0:u>=0||d>=0}return u>0}i(e),n.forEach(i);for(var s,c,l,h,u,d,p={},f=e.concat(),m=0,g=n.length;m<g;m++)Array.prototype.push.apply(f,n[m]);for(s=0,c=f.length;s<c;s++)void 0!==p[u=f[s].x+":"+f[s].y]&&console.warn("THREE.ShapeUtils: Duplicate point",u,s),p[u]=s;var v=function(t,e){var n,i=t.concat();function r(t,e){var r=i.length-1,o=t-1;o<0&&(o=r);var s=t+1;s>r&&(s=0);var c=a(i[t],i[o],i[s],n[e]);if(!c)return!1;var l=n.length-1,h=e-1;h<0&&(h=l);var u=e+1;return u>l&&(u=0),!!(c=a(n[e],n[h],n[u],i[t]))}function s(t,e){var n,r;for(n=0;n<i.length;n++)if(r=n+1,r%=i.length,o(t,e,i[n],i[r],!0).length>0)return!0;return!1}var c=[];function l(t,n){var i,r,a,s;for(i=0;i<c.length;i++)for(r=e[c[i]],a=0;a<r.length;a++)if(s=a+1,s%=r.length,o(t,n,r[a],r[s],!0).length>0)return!0;return!1}for(var h,u,d,p,f,m,g,v,y,b,x=[],w=0,_=e.length;w<_;w++)c.push(w);for(var S=0,E=2*c.length;c.length>0;){if(--E<0){console.log("Infinite Loop! Holes left:"+c.length+", Probably Hole outside Shape!");break}for(u=S;u<i.length;u++){for(d=i[u],h=-1,w=0;w<c.length;w++)if(f=c[w],void 0===x[m=d.x+":"+d.y+":"+f]){n=e[f];for(var A=0;A<n.length;A++)if(p=n[A],r(u,A)&&!s(d,p)&&!l(d,p)){h=A,c.splice(w,1),g=i.slice(0,u+1),v=i.slice(u),y=n.slice(h),b=n.slice(0,h+1),i=g.concat(y).concat(b).concat(v),S=u;break}if(h>=0)break;x[m]=!0}if(h>=0)break}}return i}(e,n),y=t.ShapeUtils.triangulate(v,!1);for(s=0,c=y.length;s<c;s++)for(h=y[s],l=0;l<3;l++)void 0!==(d=p[u=h[l].x+":"+h[l].y])&&(h[l]=d);return y.concat()},isClockWise:function(e){return t.ShapeUtils.area(e)<0},b2:function(t,e,n,i){return function(t,e){var n=1-t;return n*n*e}(t,e)+function(t,e){return 2*(1-t)*t*e}(t,n)+function(t,e){return t*t*e}(t,i)},b3:function(t,e,n,i,r){return function(t,e){var n=1-t;return n*n*n*e}(t,e)+function(t,e){var n=1-t;return 3*n*n*t*e}(t,n)+function(t,e){return 3*(1-t)*t*t*e}(t,i)+function(t,e){return t*t*t*e}(t,r)}},An.prototype=Object.create(le.prototype),An.prototype.constructor=An,An.prototype.addShapeList=function(t,e){for(var n=t.length,i=0;i<n;i++){var r=t[i];this.addShape(r,e)}},An.prototype.addShape=function(e,n){var i,r,o,a,s,c,l,h,u=void 0!==n.amount?n.amount:100,p=void 0!==n.bevelThickness?n.bevelThickness:6,f=void 0!==n.bevelSize?n.bevelSize:p-2,m=void 0!==n.bevelSegments?n.bevelSegments:3,g=void 0===n.bevelEnabled||n.bevelEnabled,v=void 0!==n.curveSegments?n.curveSegments:12,y=void 0!==n.steps?n.steps:1,b=n.extrudePath,x=!1,w=void 0!==n.UVGenerator?n.UVGenerator:An.WorldUVGenerator;b&&(i=b.getSpacedPoints(y),x=!0,g=!1,r=void 0!==n.frames?n.frames:new xn.FrenetFrames(b,y,!1),o=new T,a=new T,s=new T),g||(m=0,p=0,f=0);var _=this,S=this.vertices.length,E=e.extractPoints(v),A=E.shape,M=E.holes,C=!t.ShapeUtils.isClockWise(A);if(C){for(A=A.reverse(),l=0,h=M.length;l<h;l++)c=M[l],t.ShapeUtils.isClockWise(c)&&(M[l]=c.reverse());C=!1}var P=t.ShapeUtils.triangulateShape(A,M),R=A;for(l=0,h=M.length;l<h;l++)c=M[l],A=A.concat(c);function L(t,e,n){return e||console.error("THREE.ExtrudeGeometry: vec does not exist"),e.clone().multiplyScalar(n).add(t)}var k,I,D,O,F,N,U=A.length,j=P.length;function B(t,e,n){var i,r,o=1,a=t.x-e.x,s=t.y-e.y,c=n.x-t.x,l=n.y-t.y,h=a*a+s*s,u=a*l-s*c;if(Math.abs(u)>Number.EPSILON){var p=Math.sqrt(h),f=Math.sqrt(c*c+l*l),m=e.x-s/p,g=e.y+a/p,v=((n.x-l/f-m)*l-(n.y+c/f-g)*c)/(a*l-s*c),y=(i=m+a*v-t.x)*i+(r=g+s*v-t.y)*r;if(y<=2)return new d(i,r);o=Math.sqrt(y/2)}else{var b=!1;a>Number.EPSILON?c>Number.EPSILON&&(b=!0):a<-Number.EPSILON?c<-Number.EPSILON&&(b=!0):Math.sign(s)===Math.sign(l)&&(b=!0),b?(i=-s,r=a,o=Math.sqrt(h)):(i=a,r=s,o=Math.sqrt(h/2))}return new d(i/o,r/o)}for(var z=[],H=0,G=R.length,V=G-1,W=H+1;H<G;H++,V++,W++)V===G&&(V=0),W===G&&(W=0),z[H]=B(R[H],R[V],R[W]);var X,q,Y=[],Z=z.concat();for(l=0,h=M.length;l<h;l++){for(c=M[l],X=[],H=0,V=(G=c.length)-1,W=H+1;H<G;H++,V++,W++)V===G&&(V=0),W===G&&(W=0),X[H]=B(c[H],c[V],c[W]);Y.push(X),Z=Z.concat(X)}for(k=0;k<m;k++){for(D=k/m,O=p*Math.cos(D*Math.PI/2),I=f*Math.sin(D*Math.PI/2),H=0,G=R.length;H<G;H++)Q((F=L(R[H],z[H],I)).x,F.y,-O);for(l=0,h=M.length;l<h;l++)for(c=M[l],X=Y[l],H=0,G=c.length;H<G;H++)Q((F=L(c[H],X[H],I)).x,F.y,-O)}for(I=f,H=0;H<U;H++)F=g?L(A[H],Z[H],I):A[H],x?(a.copy(r.normals[0]).multiplyScalar(F.x),o.copy(r.binormals[0]).multiplyScalar(F.y),s.copy(i[0]).add(a).add(o),Q(s.x,s.y,s.z)):Q(F.x,F.y,0);for(q=1;q<=y;q++)for(H=0;H<U;H++)F=g?L(A[H],Z[H],I):A[H],x?(a.copy(r.normals[q]).multiplyScalar(F.x),o.copy(r.binormals[q]).multiplyScalar(F.y),s.copy(i[q]).add(a).add(o),Q(s.x,s.y,s.z)):Q(F.x,F.y,u/y*q);for(k=m-1;k>=0;k--){for(D=k/m,O=p*Math.cos(D*Math.PI/2),I=f*Math.sin(D*Math.PI/2),H=0,G=R.length;H<G;H++)Q((F=L(R[H],z[H],I)).x,F.y,u+O);for(l=0,h=M.length;l<h;l++)for(c=M[l],X=Y[l],H=0,G=c.length;H<G;H++)F=L(c[H],X[H],I),x?Q(F.x,F.y+i[y-1].y,i[y-1].x+O):Q(F.x,F.y,u+O)}function $(t,e){var n,i;for(H=t.length;--H>=0;){n=H,(i=H-1)<0&&(i=t.length-1);var r=0,o=y+2*m;for(r=0;r<o;r++){var a=U*r,s=U*(r+1);K(e+n+a,e+i+a,e+i+s,e+n+s)}}}function Q(t,e,n){_.vertices.push(new T(t,e,n))}function J(t,e,n){t+=S,e+=S,n+=S,_.faces.push(new ie(t,e,n,null,null,0));var i=w.generateTopUV(_,t,e,n);_.faceVertexUvs[0].push(i)}function K(t,e,n,i,r,o,a,s,c){t+=S,e+=S,n+=S,i+=S,_.faces.push(new ie(t,e,i,null,null,1)),_.faces.push(new ie(e,n,i,null,null,1));var l=w.generateSideWallUV(_,t,e,n,i);_.faceVertexUvs[0].push([l[0],l[1],l[3]]),_.faceVertexUvs[0].push([l[1],l[2],l[3]])}!function(){if(g){var t=0,e=U*t;for(H=0;H<j;H++)J((N=P[H])[2]+e,N[1]+e,N[0]+e);for(e=U*(t=y+2*m),H=0;H<j;H++)J((N=P[H])[0]+e,N[1]+e,N[2]+e)}else{for(H=0;H<j;H++)J((N=P[H])[2],N[1],N[0]);for(H=0;H<j;H++)J((N=P[H])[0]+U*y,N[1]+U*y,N[2]+U*y)}}(),function(){var t=0;for($(R,t),t+=R.length,l=0,h=M.length;l<h;l++)$(c=M[l],t),t+=c.length}()},An.WorldUVGenerator={generateTopUV:function(t,e,n,i){var r=t.vertices,o=r[e],a=r[n],s=r[i];return[new d(o.x,o.y),new d(a.x,a.y),new d(s.x,s.y)]},generateSideWallUV:function(t,e,n,i,r){var o=t.vertices,a=o[e],s=o[n],c=o[i],l=o[r];return Math.abs(a.y-s.y)<.01?[new d(a.x,1-a.z),new d(s.x,1-s.z),new d(c.x,1-c.z),new d(l.x,1-l.z)]:[new d(a.y,1-a.z),new d(s.y,1-s.z),new d(c.y,1-c.z),new d(l.y,1-l.z)]}},Tn.prototype=Object.create(An.prototype),Tn.prototype.constructor=Tn,Mn.prototype=Object.create(pe.prototype),Mn.prototype.constructor=Mn,Cn.prototype=Object.create(le.prototype),Cn.prototype.constructor=Cn,Pn.prototype=Object.create(pe.prototype),Pn.prototype.constructor=Pn,Rn.prototype=Object.create(le.prototype),Rn.prototype.constructor=Rn,Ln.prototype=Object.create(le.prototype),Ln.prototype.constructor=Ln,kn.prototype=Object.create(pe.prototype),kn.prototype.constructor=kn,In.prototype=Object.create(le.prototype),In.prototype.constructor=In,Dn.prototype=Object.create(le.prototype),Dn.prototype.constructor=Dn,Dn.prototype.addShapeList=function(t,e){for(var n=0,i=t.length;n<i;n++)this.addShape(t[n],e);return this},Dn.prototype.addShape=function(e,n){void 0===n&&(n={});var i,r,o,a=void 0!==n.curveSegments?n.curveSegments:12,s=n.material,c=void 0===n.UVGenerator?An.WorldUVGenerator:n.UVGenerator,l=this.vertices.length,h=e.extractPoints(a),u=h.shape,d=h.holes,p=!t.ShapeUtils.isClockWise(u);if(p){for(u=u.reverse(),i=0,r=d.length;i<r;i++)o=d[i],t.ShapeUtils.isClockWise(o)&&(d[i]=o.reverse());p=!1}var f=t.ShapeUtils.triangulateShape(u,d);for(i=0,r=d.length;i<r;i++)o=d[i],u=u.concat(o);var m,g,v=u.length,y=f.length;for(i=0;i<v;i++)m=u[i],this.vertices.push(new T(m.x,m.y,0));for(i=0;i<y;i++){var b=(g=f[i])[0]+l,x=g[1]+l,w=g[2]+l;this.faces.push(new ie(b,x,w,null,null,s)),this.faceVertexUvs[0].push(c.generateTopUV(this,b,x,w))}},On.prototype=Object.create(pe.prototype),On.prototype.constructor=On,Fn.prototype=Object.create(pe.prototype),Fn.prototype.constructor=Fn,Nn.prototype=Object.create(le.prototype),Nn.prototype.constructor=Nn,Un.prototype=Object.create(Nn.prototype),Un.prototype.constructor=Un,jn.prototype=Object.create(pe.prototype),jn.prototype.constructor=jn,Bn.prototype=Object.create(pe.prototype),Bn.prototype.constructor=Bn,zn.prototype=Object.create(le.prototype),zn.prototype.constructor=zn,Hn.prototype=Object.create(le.prototype),Hn.prototype.constructor=Hn;var Gn=Object.freeze({WireframeGeometry:pn,ParametricGeometry:fn,TetrahedronGeometry:gn,OctahedronGeometry:vn,IcosahedronGeometry:yn,DodecahedronGeometry:bn,PolyhedronGeometry:mn,TubeGeometry:xn,TorusKnotGeometry:_n,TorusKnotBufferGeometry:wn,TorusGeometry:En,TorusBufferGeometry:Sn,TextGeometry:Tn,SphereBufferGeometry:Mn,SphereGeometry:Cn,RingGeometry:Rn,RingBufferGeometry:Pn,PlaneBufferGeometry:ge,PlaneGeometry:Ln,LatheGeometry:In,LatheBufferGeometry:kn,ShapeGeometry:Dn,ExtrudeGeometry:An,EdgesGeometry:On,ConeGeometry:Un,ConeBufferGeometry:jn,CylinderGeometry:Nn,CylinderBufferGeometry:Fn,CircleBufferGeometry:Bn,CircleGeometry:zn,BoxBufferGeometry:me,BoxGeometry:Hn});function Vn(){Nt.call(this,{uniforms:t.UniformsUtils.merge([ft.lights,{opacity:{value:1}}]),vertexShader:dt.shadow_vert,fragmentShader:dt.shadow_frag}),this.lights=!0,this.transparent=!0,Object.defineProperties(this,{opacity:{enumerable:!0,get:function(){return this.uniforms.opacity.value},set:function(t){this.uniforms.opacity.value=t}}})}function Wn(t){Nt.call(this,t),this.type="RawShaderMaterial"}function Xn(e){this.uuid=t.Math.generateUUID(),this.type="MultiMaterial",this.materials=e instanceof Array?e:[],this.visible=!0}function qn(t){bt.call(this),this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new pt(16777215),this.roughness=.5,this.metalness=.5,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new pt(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalScale=new d(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(t)}function Yn(t){qn.call(this),this.defines={PHYSICAL:""},this.type="MeshPhysicalMaterial",this.reflectivity=.5,this.clearCoat=0,this.clearCoatRoughness=0,this.setValues(t)}function Zn(t){bt.call(this),this.type="MeshPhongMaterial",this.color=new pt(16777215),this.specular=new pt(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new pt(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalScale=new d(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(t)}function $n(t){bt.call(this,t),this.type="MeshNormalMaterial",this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.morphTargets=!1,this.setValues(t)}function Qn(t){bt.call(this),this.type="MeshLambertMaterial",this.color=new pt(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new pt(0),this.emissiveIntensity=1,this.emissiveMap=null,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(t)}function Jn(t){bt.call(this),this.type="LineDashedMaterial",this.color=new pt(16777215),this.linewidth=1,this.scale=1,this.dashSize=3,this.gapSize=1,this.lights=!1,this.setValues(t)}Vn.prototype=Object.create(Nt.prototype),Vn.prototype.constructor=Vn,Vn.prototype.isShadowMaterial=!0,Wn.prototype=Object.create(Nt.prototype),Wn.prototype.constructor=Wn,Wn.prototype.isRawShaderMaterial=!0,Xn.prototype={constructor:Xn,isMultiMaterial:!0,toJSON:function(t){for(var e={metadata:{version:4.2,type:"material",generator:"MaterialExporter"},uuid:this.uuid,type:this.type,materials:[]},n=this.materials,i=0,r=n.length;i<r;i++){var o=n[i].toJSON(t);delete o.metadata,e.materials.push(o)}return e.visible=this.visible,e},clone:function(){for(var t=new this.constructor,e=0;e<this.materials.length;e++)t.materials.push(this.materials[e].clone());return t.visible=this.visible,t}},qn.prototype=Object.create(bt.prototype),qn.prototype.constructor=qn,qn.prototype.isMeshStandardMaterial=!0,qn.prototype.copy=function(t){return bt.prototype.copy.call(this,t),this.defines={STANDARD:""},this.color.copy(t.color),this.roughness=t.roughness,this.metalness=t.metalness,this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.roughnessMap=t.roughnessMap,this.metalnessMap=t.metalnessMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.envMapIntensity=t.envMapIntensity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this},Yn.prototype=Object.create(qn.prototype),Yn.prototype.constructor=Yn,Yn.prototype.isMeshPhysicalMaterial=!0,Yn.prototype.copy=function(t){return qn.prototype.copy.call(this,t),this.defines={PHYSICAL:""},this.reflectivity=t.reflectivity,this.clearCoat=t.clearCoat,this.clearCoatRoughness=t.clearCoatRoughness,this},Zn.prototype=Object.create(bt.prototype),Zn.prototype.constructor=Zn,Zn.prototype.isMeshPhongMaterial=!0,Zn.prototype.copy=function(t){return bt.prototype.copy.call(this,t),this.color.copy(t.color),this.specular.copy(t.specular),this.shininess=t.shininess,this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this},$n.prototype=Object.create(bt.prototype),$n.prototype.constructor=$n,$n.prototype.isMeshNormalMaterial=!0,$n.prototype.copy=function(t){return bt.prototype.copy.call(this,t),this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this},Qn.prototype=Object.create(bt.prototype),Qn.prototype.constructor=Qn,Qn.prototype.isMeshLambertMaterial=!0,Qn.prototype.copy=function(t){return bt.prototype.copy.call(this,t),this.color.copy(t.color),this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this},Jn.prototype=Object.create(bt.prototype),Jn.prototype.constructor=Jn,Jn.prototype.isLineDashedMaterial=!0,Jn.prototype.copy=function(t){return bt.prototype.copy.call(this,t),this.color.copy(t.color),this.linewidth=t.linewidth,this.scale=t.scale,this.dashSize=t.dashSize,this.gapSize=t.gapSize,this};var Kn=Object.freeze({ShadowMaterial:Vn,SpriteMaterial:Ze,RawShaderMaterial:Wn,ShaderMaterial:Nt,PointsMaterial:an,MultiMaterial:Xn,MeshPhysicalMaterial:Yn,MeshStandardMaterial:qn,MeshPhongMaterial:Zn,MeshNormalMaterial:$n,MeshLambertMaterial:Qn,MeshDepthMaterial:Ut,MeshBasicMaterial:re,LineDashedMaterial:Jn,LineBasicMaterial:nn,Material:bt});function ti(t,e,n){var i=this,r=!1,o=0,a=0;this.onStart=void 0,this.onLoad=t,this.onProgress=e,this.onError=n,this.itemStart=function(t){a++,!1===r&&void 0!==i.onStart&&i.onStart(t,o,a),r=!0},this.itemEnd=function(t){o++,void 0!==i.onProgress&&i.onProgress(t,o,a),o===a&&(r=!1,void 0!==i.onLoad&&i.onLoad())},this.itemError=function(t){void 0!==i.onError&&i.onError(t)}}function ei(e){this.manager=void 0!==e?e:t.DefaultLoadingManager}function ni(e){this.manager=void 0!==e?e:t.DefaultLoadingManager,this._parser=null}t.Cache={enabled:!1,files:{},add:function(t,e){!1!==this.enabled&&(this.files[t]=e)},get:function(t){if(!1!==this.enabled)return this.files[t]},remove:function(t){delete this.files[t]},clear:function(){this.files={}}},t.DefaultLoadingManager=new ti,Object.assign(ei.prototype,{load:function(e,n,i,r){void 0!==this.path&&(e=this.path+e);var o=this,a=t.Cache.get(e);if(void 0!==a)return o.manager.itemStart(e),setTimeout((function(){n&&n(a),o.manager.itemEnd(e)}),0),a;var s=new XMLHttpRequest;return s.open("GET",e,!0),s.addEventListener("load",(function(i){var a=i.target.response;t.Cache.add(e,a),200===this.status?(n&&n(a),o.manager.itemEnd(e)):0===this.status?(console.warn("THREE.XHRLoader: HTTP Status 0 received."),n&&n(a),o.manager.itemEnd(e)):(r&&r(i),o.manager.itemError(e))}),!1),void 0!==i&&s.addEventListener("progress",(function(t){i(t)}),!1),s.addEventListener("error",(function(t){r&&r(t),o.manager.itemError(e)}),!1),void 0!==this.responseType&&(s.responseType=this.responseType),void 0!==this.withCredentials&&(s.withCredentials=this.withCredentials),s.overrideMimeType&&s.overrideMimeType("text/plain"),s.send(null),o.manager.itemStart(e),s},setPath:function(t){return this.path=t,this},setResponseType:function(t){return this.responseType=t,this},setWithCredentials:function(t){return this.withCredentials=t,this}}),Object.assign(ni.prototype,{load:function(t,e,n,i){var r=this,o=[],a=new hn;a.image=o;var s=new ei(this.manager);function c(c){s.load(t[c],(function(t){var n=r._parser(t,!0);o[c]={width:n.width,height:n.height,format:n.format,mipmaps:n.mipmaps},6===(l+=1)&&(1===n.mipmapCount&&(a.minFilter=1006),a.format=n.format,a.needsUpdate=!0,e&&e(a))}),n,i)}if(s.setPath(this.path),s.setResponseType("arraybuffer"),Array.isArray(t))for(var l=0,h=0,u=t.length;h<u;++h)c(h);else s.load(t,(function(t){var n=r._parser(t,!0);if(n.isCubemap)for(var i=n.mipmaps.length/n.mipmapCount,s=0;s<i;s++){o[s]={mipmaps:[]};for(var c=0;c<n.mipmapCount;c++)o[s].mipmaps.push(n.mipmaps[s*n.mipmapCount+c]),o[s].format=n.format,o[s].width=n.width,o[s].height=n.height}else a.image.width=n.width,a.image.height=n.height,a.mipmaps=n.mipmaps;1===n.mipmapCount&&(a.minFilter=1006),a.format=n.format,a.needsUpdate=!0,e&&e(a)}),n,i);return a},setPath:function(t){return this.path=t,this}});var ii,ri,oi,ai,si=ci;function ci(e){this.manager=void 0!==e?e:t.DefaultLoadingManager,this._parser=null}function li(e){this.manager=void 0!==e?e:t.DefaultLoadingManager}function hi(e){this.manager=void 0!==e?e:t.DefaultLoadingManager}function ui(e){this.manager=void 0!==e?e:t.DefaultLoadingManager}function di(t,e){Yt.call(this),this.type="Light",this.color=new pt(t),this.intensity=void 0!==e?e:1,this.receiveShadow=void 0}function pi(t,e,n){di.call(this,t,n),this.type="HemisphereLight",this.castShadow=void 0,this.position.copy(Yt.DefaultUp),this.updateMatrix(),this.groundColor=new pt(e)}function fi(t){this.camera=t,this.bias=0,this.radius=1,this.mapSize=new d(512,512),this.map=null,this.matrix=new M}function mi(){fi.call(this,new ye(50,1,.5,500))}function gi(t,e,n,i,r,o){di.call(this,t,e),this.type="SpotLight",this.position.copy(Yt.DefaultUp),this.updateMatrix(),this.target=new Yt,Object.defineProperty(this,"power",{get:function(){return this.intensity*Math.PI},set:function(t){this.intensity=t/Math.PI}}),this.distance=void 0!==n?n:0,this.angle=void 0!==i?i:Math.PI/3,this.penumbra=void 0!==r?r:0,this.decay=void 0!==o?o:1,this.shadow=new mi}function vi(t,e,n,i){di.call(this,t,e),this.type="PointLight",Object.defineProperty(this,"power",{get:function(){return 4*this.intensity*Math.PI},set:function(t){this.intensity=t/(4*Math.PI)}}),this.distance=void 0!==n?n:0,this.decay=void 0!==i?i:1,this.shadow=new fi(new ye(90,1,.5,500))}function yi(t){fi.call(this,new be(-5,5,5,-5,.5,500))}function bi(t,e){di.call(this,t,e),this.type="DirectionalLight",this.position.copy(Yt.DefaultUp),this.updateMatrix(),this.target=new Yt,this.shadow=new yi}function xi(t,e){di.call(this,t,e),this.type="AmbientLight",this.castShadow=void 0}function wi(t,e,n,i){this.parameterPositions=t,this._cachedIndex=0,this.resultBuffer=void 0!==i?i:new e.constructor(n),this.sampleValues=e,this.valueSize=n}function _i(t,e,n,i){wi.call(this,t,e,n,i),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0}function Si(t,e,n,i){wi.call(this,t,e,n,i)}function Ei(t,e,n,i){wi.call(this,t,e,n,i)}function Ai(e,n,i,r){if(void 0===e)throw new Error("track name is undefined");if(void 0===n||0===n.length)throw new Error("no keyframes in track named "+e);this.name=e,this.times=t.AnimationUtils.convertArray(n,this.TimeBufferType),this.values=t.AnimationUtils.convertArray(i,this.ValueBufferType),this.setInterpolation(r||this.DefaultInterpolation),this.validate(),this.optimize()}function Ti(t,e,n,i){Ai.call(this,t,e,n,i)}function Mi(t,e,n,i){wi.call(this,t,e,n,i)}function Ci(t,e,n,i){Ai.call(this,t,e,n,i)}function Pi(t,e,n,i){Ai.call(this,t,e,n,i)}function Ri(t,e,n,i){Ai.call(this,t,e,n,i)}function Li(t,e,n){Ai.call(this,t,e,n)}function ki(t,e,n,i){Ai.call(this,t,e,n,i)}function Ii(t,e,n,i){Ai.apply(this,arguments)}function Di(e,n,i){this.name=e,this.tracks=i,this.duration=void 0!==n?n:-1,this.uuid=t.Math.generateUUID(),this.duration<0&&this.resetDuration(),this.optimize()}function Oi(e){this.manager=void 0!==e?e:t.DefaultLoadingManager,this.textures={}}function Fi(e){this.manager=void 0!==e?e:t.DefaultLoadingManager}function Ni(){this.onLoadStart=function(){},this.onLoadProgress=function(){},this.onLoadComplete=function(){}}function Ui(e){"boolean"==typeof e&&(console.warn("THREE.JSONLoader: showStatus parameter has been removed from constructor."),e=void 0),this.manager=void 0!==e?e:t.DefaultLoadingManager,this.withCredentials=!1}function ji(e){this.manager=void 0!==e?e:t.DefaultLoadingManager,this.texturePath=""}function Bi(){}function zi(t,e){this.v1=t,this.v2=e}function Hi(){this.curves=[],this.autoClose=!1}function Gi(t,e,n,i,r,o,a,s){this.aX=t,this.aY=e,this.xRadius=n,this.yRadius=i,this.aStartAngle=r,this.aEndAngle=o,this.aClockwise=a,this.aRotation=s||0}function Vi(t){this.points=void 0===t?[]:t}function Wi(t,e,n,i){this.v0=t,this.v1=e,this.v2=n,this.v3=i}function Xi(t,e,n){this.v0=t,this.v1=e,this.v2=n}Object.assign(ci.prototype,{load:function(t,e,n,i){var r=this,o=new Je,a=new ei(this.manager);return a.setResponseType("arraybuffer"),a.load(t,(function(t){var n=r._parser(t);n&&(void 0!==n.image?o.image=n.image:void 0!==n.data&&(o.image.width=n.width,o.image.height=n.height,o.image.data=n.data),o.wrapS=void 0!==n.wrapS?n.wrapS:1001,o.wrapT=void 0!==n.wrapT?n.wrapT:1001,o.magFilter=void 0!==n.magFilter?n.magFilter:1006,o.minFilter=void 0!==n.minFilter?n.minFilter:1008,o.anisotropy=void 0!==n.anisotropy?n.anisotropy:1,void 0!==n.format&&(o.format=n.format),void 0!==n.type&&(o.type=n.type),void 0!==n.mipmaps&&(o.mipmaps=n.mipmaps),1===n.mipmapCount&&(o.minFilter=1006),o.needsUpdate=!0,e&&e(o,n))}),n,i),o}}),Object.assign(li.prototype,{load:function(t,e,n,i){var r=this,o=document.createElementNS("http://www.w3.org/1999/xhtml","img");if(o.onload=function(){o.onload=null,URL.revokeObjectURL(o.src),e&&e(o),r.manager.itemEnd(t)},0===t.indexOf("data:"))o.src=t;else{var a=new ei;a.setPath(this.path),a.setResponseType("blob"),a.setWithCredentials(this.withCredentials),a.load(t,(function(t){o.src=URL.createObjectURL(t)}),n,i)}return r.manager.itemStart(t),o},setCrossOrigin:function(t){return this.crossOrigin=t,this},setWithCredentials:function(t){return this.withCredentials=t,this},setPath:function(t){return this.path=t,this}}),Object.assign(hi.prototype,{load:function(t,e,n,i){var r=new C,o=new li(this.manager);o.setCrossOrigin(this.crossOrigin),o.setPath(this.path);var a=0;function s(n){o.load(t[n],(function(t){r.images[n]=t,6==++a&&(r.needsUpdate=!0,e&&e(r))}),void 0,i)}for(var c=0;c<t.length;++c)s(c);return r},setCrossOrigin:function(t){return this.crossOrigin=t,this},setPath:function(t){return this.path=t,this}}),Object.assign(ui.prototype,{load:function(t,e,n,i){var r=new p,o=new li(this.manager);return o.setCrossOrigin(this.crossOrigin),o.setWithCredentials(this.withCredentials),o.setPath(this.path),o.load(t,(function(n){var i=t.search(/\.(jpg|jpeg)$/)>0||0===t.search(/^data\:image\/jpeg/);r.format=i?1022:1023,r.image=n,r.needsUpdate=!0,void 0!==e&&e(r)}),n,i),r},setCrossOrigin:function(t){return this.crossOrigin=t,this},setWithCredentials:function(t){return this.withCredentials=t,this},setPath:function(t){return this.path=t,this}}),di.prototype=Object.assign(Object.create(Yt.prototype),{constructor:di,isLight:!0,copy:function(t){return Yt.prototype.copy.call(this,t),this.color.copy(t.color),this.intensity=t.intensity,this},toJSON:function(t){var e=Yt.prototype.toJSON.call(this,t);return e.object.color=this.color.getHex(),e.object.intensity=this.intensity,void 0!==this.groundColor&&(e.object.groundColor=this.groundColor.getHex()),void 0!==this.distance&&(e.object.distance=this.distance),void 0!==this.angle&&(e.object.angle=this.angle),void 0!==this.decay&&(e.object.decay=this.decay),void 0!==this.penumbra&&(e.object.penumbra=this.penumbra),void 0!==this.shadow&&(e.object.shadow=this.shadow.toJSON()),e}}),pi.prototype=Object.assign(Object.create(di.prototype),{constructor:pi,isHemisphereLight:!0,copy:function(t){return di.prototype.copy.call(this,t),this.groundColor.copy(t.groundColor),this}}),Object.assign(fi.prototype,{copy:function(t){return this.camera=t.camera.clone(),this.bias=t.bias,this.radius=t.radius,this.mapSize.copy(t.mapSize),this},clone:function(){return(new this.constructor).copy(this)},toJSON:function(){var t={};return 0!==this.bias&&(t.bias=this.bias),1!==this.radius&&(t.radius=this.radius),512===this.mapSize.x&&512===this.mapSize.y||(t.mapSize=this.mapSize.toArray()),t.camera=this.camera.toJSON(!1).object,delete t.camera.matrix,t}}),mi.prototype=Object.assign(Object.create(fi.prototype),{constructor:mi,isSpotLightShadow:!0,update:function(e){var n=2*t.Math.RAD2DEG*e.angle,i=this.mapSize.width/this.mapSize.height,r=e.distance||500,o=this.camera;n===o.fov&&i===o.aspect&&r===o.far||(o.fov=n,o.aspect=i,o.far=r,o.updateProjectionMatrix())}}),gi.prototype=Object.assign(Object.create(di.prototype),{constructor:gi,isSpotLight:!0,copy:function(t){return di.prototype.copy.call(this,t),this.distance=t.distance,this.angle=t.angle,this.penumbra=t.penumbra,this.decay=t.decay,this.target=t.target.clone(),this.shadow=t.shadow.clone(),this}}),vi.prototype=Object.assign(Object.create(di.prototype),{constructor:vi,isPointLight:!0,copy:function(t){return di.prototype.copy.call(this,t),this.distance=t.distance,this.decay=t.decay,this.shadow=t.shadow.clone(),this}}),yi.prototype=Object.assign(Object.create(fi.prototype),{constructor:yi}),bi.prototype=Object.assign(Object.create(di.prototype),{constructor:bi,isDirectionalLight:!0,copy:function(t){return di.prototype.copy.call(this,t),this.target=t.target.clone(),this.shadow=t.shadow.clone(),this}}),xi.prototype=Object.assign(Object.create(di.prototype),{constructor:xi,isAmbientLight:!0}),t.AnimationUtils={arraySlice:function(e,n,i){return t.AnimationUtils.isTypedArray(e)?new e.constructor(e.subarray(n,i)):e.slice(n,i)},convertArray:function(t,e,n){return!t||!n&&t.constructor===e?t:"number"==typeof e.BYTES_PER_ELEMENT?new e(t):Array.prototype.slice.call(t)},isTypedArray:function(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)},getKeyframeOrder:function(t){for(var e=t.length,n=new Array(e),i=0;i!==e;++i)n[i]=i;return n.sort((function(e,n){return t[e]-t[n]})),n},sortedArray:function(t,e,n){for(var i=t.length,r=new t.constructor(i),o=0,a=0;a!==i;++o)for(var s=n[o]*e,c=0;c!==e;++c)r[a++]=t[s+c];return r},flattenJSON:function(t,e,n,i){for(var r=1,o=t[0];void 0!==o&&void 0===o[i];)o=t[r++];if(void 0!==o){var a=o[i];if(void 0!==a)if(Array.isArray(a))do{void 0!==(a=o[i])&&(e.push(o.time),n.push.apply(n,a)),o=t[r++]}while(void 0!==o);else if(void 0!==a.toArray)do{void 0!==(a=o[i])&&(e.push(o.time),a.toArray(n,n.length)),o=t[r++]}while(void 0!==o);else do{void 0!==(a=o[i])&&(e.push(o.time),n.push(a)),o=t[r++]}while(void 0!==o)}}},wi.prototype={constructor:wi,evaluate:function(t){var e=this.parameterPositions,n=this._cachedIndex,i=e[n],r=e[n-1];t:{e:{var o;n:{i:if(!(t<i)){for(var a=n+2;;){if(void 0===i){if(t<r)break i;return n=e.length,this._cachedIndex=n,this.afterEnd_(n-1,t,r)}if(n===a)break;if(r=i,t<(i=e[++n]))break e}o=e.length;break n}if(t>=r)break t;var s=e[1];for(t<s&&(n=2,r=s),a=n-2;;){if(void 0===r)return this._cachedIndex=0,this.beforeStart_(0,t,i);if(n===a)break;if(i=r,t>=(r=e[--n-1]))break e}o=n,n=0}for(;n<o;){var c=n+o>>>1;t<e[c]?o=c:n=c+1}if(i=e[n],void 0===(r=e[n-1]))return this._cachedIndex=0,this.beforeStart_(0,t,i);if(void 0===i)return n=e.length,this._cachedIndex=n,this.afterEnd_(n-1,r,t)}this._cachedIndex=n,this.intervalChanged_(n,r,i)}return this.interpolate_(n,r,t,i)},settings:null,DefaultSettings_:{},getSettings_:function(){return this.settings||this.DefaultSettings_},copySampleValue_:function(t){for(var e=this.resultBuffer,n=this.sampleValues,i=this.valueSize,r=t*i,o=0;o!==i;++o)e[o]=n[r+o];return e},interpolate_:function(t,e,n,i){throw new Error("call to abstract method")},intervalChanged_:function(t,e,n){}},Object.assign(wi.prototype,{beforeStart_:wi.prototype.copySampleValue_,afterEnd_:wi.prototype.copySampleValue_}),_i.prototype=Object.assign(Object.create(wi.prototype),{constructor:_i,DefaultSettings_:{endingStart:2400,endingEnd:2400},intervalChanged_:function(t,e,n){var i=this.parameterPositions,r=t-2,o=t+1,a=i[r],s=i[o];if(void 0===a)switch(this.getSettings_().endingStart){case 2401:r=t,a=2*e-n;break;case 2402:a=e+i[r=i.length-2]-i[r+1];break;default:r=t,a=n}if(void 0===s)switch(this.getSettings_().endingEnd){case 2401:o=t,s=2*n-e;break;case 2402:o=1,s=n+i[1]-i[0];break;default:o=t-1,s=e}var c=.5*(n-e),l=this.valueSize;this._weightPrev=c/(e-a),this._weightNext=c/(s-n),this._offsetPrev=r*l,this._offsetNext=o*l},interpolate_:function(t,e,n,i){for(var r=this.resultBuffer,o=this.sampleValues,a=this.valueSize,s=t*a,c=s-a,l=this._offsetPrev,h=this._offsetNext,u=this._weightPrev,d=this._weightNext,p=(n-e)/(i-e),f=p*p,m=f*p,g=-u*m+2*u*f-u*p,v=(1+u)*m+(-1.5-2*u)*f+(-.5+u)*p+1,y=(-1-d)*m+(1.5+d)*f+.5*p,b=d*m-d*f,x=0;x!==a;++x)r[x]=g*o[l+x]+v*o[c+x]+y*o[s+x]+b*o[h+x];return r}}),Si.prototype=Object.assign(Object.create(wi.prototype),{constructor:Si,interpolate_:function(t,e,n,i){for(var r=this.resultBuffer,o=this.sampleValues,a=this.valueSize,s=t*a,c=s-a,l=(n-e)/(i-e),h=1-l,u=0;u!==a;++u)r[u]=o[c+u]*h+o[s+u]*l;return r}}),Ei.prototype=Object.assign(Object.create(wi.prototype),{constructor:Ei,interpolate_:function(t,e,n,i){return this.copySampleValue_(t-1)}}),ii={TimeBufferType:Float32Array,ValueBufferType:Float32Array,DefaultInterpolation:2301,InterpolantFactoryMethodDiscrete:function(t){return new Ei(this.times,this.values,this.getValueSize(),t)},InterpolantFactoryMethodLinear:function(t){return new Si(this.times,this.values,this.getValueSize(),t)},InterpolantFactoryMethodSmooth:function(t){return new _i(this.times,this.values,this.getValueSize(),t)},setInterpolation:function(t){var e;switch(t){case 2300:e=this.InterpolantFactoryMethodDiscrete;break;case 2301:e=this.InterpolantFactoryMethodLinear;break;case 2302:e=this.InterpolantFactoryMethodSmooth}if(void 0!==e)this.createInterpolant=e;else{var n="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(void 0===this.createInterpolant){if(t===this.DefaultInterpolation)throw new Error(n);this.setInterpolation(this.DefaultInterpolation)}console.warn(n)}},getInterpolation:function(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return 2300;case this.InterpolantFactoryMethodLinear:return 2301;case this.InterpolantFactoryMethodSmooth:return 2302}},getValueSize:function(){return this.values.length/this.times.length},shift:function(t){if(0!==t)for(var e=this.times,n=0,i=e.length;n!==i;++n)e[n]+=t;return this},scale:function(t){if(1!==t)for(var e=this.times,n=0,i=e.length;n!==i;++n)e[n]*=t;return this},trim:function(e,n){for(var i=this.times,r=i.length,o=0,a=r-1;o!==r&&i[o]<e;)++o;for(;-1!==a&&i[a]>n;)--a;if(++a,0!==o||a!==r){o>=a&&(o=(a=Math.max(a,1))-1);var s=this.getValueSize();this.times=t.AnimationUtils.arraySlice(i,o,a),this.values=t.AnimationUtils.arraySlice(this.values,o*s,a*s)}return this},validate:function(){var e=!0,n=this.getValueSize();n-Math.floor(n)!=0&&(console.error("invalid value size in track",this),e=!1);var i=this.times,r=this.values,o=i.length;0===o&&(console.error("track is empty",this),e=!1);for(var a=null,s=0;s!==o;s++){var c=i[s];if("number"==typeof c&&isNaN(c)){console.error("time is not a valid number",this,s,c),e=!1;break}if(null!==a&&a>c){console.error("out of order keys",this,s,c,a),e=!1;break}a=c}if(void 0!==r&&t.AnimationUtils.isTypedArray(r)){s=0;for(var l=r.length;s!==l;++s){var h=r[s];if(isNaN(h)){console.error("value is not a valid number",this,s,h),e=!1;break}}}return e},optimize:function(){for(var e=this.times,n=this.values,i=this.getValueSize(),r=2302===this.getInterpolation(),o=1,a=e.length-1,s=1;s<a;++s){var c=!1,l=e[s];if(l!==e[s+1]&&(1!==s||l!==l[0]))if(r)c=!0;else for(var h=s*i,u=h-i,d=h+i,p=0;p!==i;++p){var f=n[h+p];if(f!==n[u+p]||f!==n[d+p]){c=!0;break}}if(c){if(s!==o){e[o]=e[s];var m=s*i,g=o*i;for(p=0;p!==i;++p)n[g+p]=n[m+p]}++o}}if(a>0){for(e[o]=e[a],m=a*i,g=o*i,p=0;p!==i;++p)n[g+p]=n[m+p];++o}return o!==e.length&&(this.times=t.AnimationUtils.arraySlice(e,0,o),this.values=t.AnimationUtils.arraySlice(n,0,o*i)),this}},Ti.prototype=Object.assign(Object.create(ii),{constructor:Ti,ValueTypeName:"vector"}),Mi.prototype=Object.assign(Object.create(wi.prototype),{constructor:Mi,interpolate_:function(t,e,n,i){for(var r=this.resultBuffer,o=this.sampleValues,a=this.valueSize,s=t*a,c=(n-e)/(i-e),l=s+a;s!==l;s+=4)A.slerpFlat(r,0,o,s-a,o,s,c);return r}}),Ci.prototype=Object.assign(Object.create(ii),{constructor:Ci,ValueTypeName:"quaternion",DefaultInterpolation:2301,InterpolantFactoryMethodLinear:function(t){return new Mi(this.times,this.values,this.getValueSize(),t)},InterpolantFactoryMethodSmooth:void 0}),Pi.prototype=Object.assign(Object.create(ii),{constructor:Pi,ValueTypeName:"number"}),Ri.prototype=Object.assign(Object.create(ii),{constructor:Ri,ValueTypeName:"string",ValueBufferType:Array,DefaultInterpolation:2300,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0}),Li.prototype=Object.assign(Object.create(ii),{constructor:Li,ValueTypeName:"bool",ValueBufferType:Array,DefaultInterpolation:2300,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0}),ki.prototype=Object.assign(Object.create(ii),{constructor:ki,ValueTypeName:"color"}),Ii.prototype=ii,ii.constructor=Ii,Object.assign(Ii,{parse:function(e){if(void 0===e.type)throw new Error("track type undefined, can not parse");var n=Ii._getTrackTypeForValueTypeName(e.type);if(void 0===e.times){var i=[],r=[];t.AnimationUtils.flattenJSON(e.keys,i,r,"value"),e.times=i,e.values=r}return void 0!==n.parse?n.parse(e):new n(e.name,e.times,e.values,e.interpolation)},toJSON:function(e){var n,i=e.constructor;if(void 0!==i.toJSON)n=i.toJSON(e);else{n={name:e.name,times:t.AnimationUtils.convertArray(e.times,Array),values:t.AnimationUtils.convertArray(e.values,Array)};var r=e.getInterpolation();r!==e.DefaultInterpolation&&(n.interpolation=r)}return n.type=e.ValueTypeName,n},_getTrackTypeForValueTypeName:function(t){switch(t.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return Pi;case"vector":case"vector2":case"vector3":case"vector4":return Ti;case"color":return ki;case"quaternion":return Ci;case"bool":case"boolean":return Li;case"string":return Ri}throw new Error("Unsupported typeName: "+t)}}),Di.prototype={constructor:Di,resetDuration:function(){for(var t=0,e=0,n=this.tracks.length;e!==n;++e){var i=this.tracks[e];t=Math.max(t,i.times[i.times.length-1])}this.duration=t},trim:function(){for(var t=0;t<this.tracks.length;t++)this.tracks[t].trim(0,this.duration);return this},optimize:function(){for(var t=0;t<this.tracks.length;t++)this.tracks[t].optimize();return this}},Object.assign(Di,{parse:function(t){for(var e=[],n=t.tracks,i=1/(t.fps||1),r=0,o=n.length;r!==o;++r)e.push(Ii.parse(n[r]).scale(i));return new Di(t.name,t.duration,e)},toJSON:function(t){for(var e=[],n=t.tracks,i={name:t.name,duration:t.duration,tracks:e},r=0,o=n.length;r!==o;++r)e.push(Ii.toJSON(n[r]));return i},CreateFromMorphTargetSequence:function(e,n,i,r){for(var o=n.length,a=[],s=0;s<o;s++){var c=[],l=[];c.push((s+o-1)%o,s,(s+1)%o),l.push(0,1,0);var h=t.AnimationUtils.getKeyframeOrder(c);c=t.AnimationUtils.sortedArray(c,1,h),l=t.AnimationUtils.sortedArray(l,1,h),r||0!==c[0]||(c.push(o),l.push(l[0])),a.push(new Pi(".morphTargetInfluences["+n[s].name+"]",c,l).scale(1/i))}return new Di(e,-1,a)},findByName:function(t,e){var n=t;if(!Array.isArray(t)){var i=t;n=i.geometry&&i.geometry.animations||i.animations}for(var r=0;r<n.length;r++)if(n[r].name===e)return n[r];return null},CreateClipsFromMorphTargetSequences:function(t,e,n){for(var i={},r=/^([\w-]*?)([\d]+)$/,o=0,a=t.length;o<a;o++){var s=t[o],c=s.name.match(r);if(c&&c.length>1){var l=i[u=c[1]];l||(i[u]=l=[]),l.push(s)}}var h=[];for(var u in i)h.push(Di.CreateFromMorphTargetSequence(u,i[u],e,n));return h},parseAnimation:function(e,n){if(!e)return console.error("  no animation in JSONLoader data"),null;for(var i=function(e,n,i,r,o){if(0!==i.length){var a=[],s=[];t.AnimationUtils.flattenJSON(i,a,s,r),0!==a.length&&o.push(new e(n,a,s))}},r=[],o=e.name||"default",a=e.length||-1,s=e.fps||30,c=e.hierarchy||[],l=0;l<c.length;l++){var h=c[l].keys;if(h&&0!==h.length)if(h[0].morphTargets){for(var u={},d=0;d<h.length;d++)if(h[d].morphTargets)for(var p=0;p<h[d].morphTargets.length;p++)u[h[d].morphTargets[p]]=-1;for(var f in u){var m=[],g=[];for(p=0;p!==h[d].morphTargets.length;++p){var v=h[d];m.push(v.time),g.push(v.morphTarget===f?1:0)}r.push(new Pi(".morphTargetInfluence["+f+"]",m,g))}a=u.length*(s||1)}else{var y=".bones["+n[l].name+"]";i(Ti,y+".position",h,"pos",r),i(Ci,y+".quaternion",h,"rot",r),i(Ti,y+".scale",h,"scl",r)}}return 0===r.length?null:new Di(o,a,r)}}),Object.assign(Oi.prototype,{load:function(t,e,n,i){var r=this;new ei(r.manager).load(t,(function(t){e(r.parse(JSON.parse(t)))}),n,i)},setTextures:function(t){this.textures=t},parse:function(t){var e=this.textures;function n(t){return void 0===e[t]&&console.warn("THREE.MaterialLoader: Undefined texture",t),e[t]}var i=new Kn[t.type];if(void 0!==t.uuid&&(i.uuid=t.uuid),void 0!==t.name&&(i.name=t.name),void 0!==t.color&&i.color.setHex(t.color),void 0!==t.roughness&&(i.roughness=t.roughness),void 0!==t.metalness&&(i.metalness=t.metalness),void 0!==t.emissive&&i.emissive.setHex(t.emissive),void 0!==t.specular&&i.specular.setHex(t.specular),void 0!==t.shininess&&(i.shininess=t.shininess),void 0!==t.uniforms&&(i.uniforms=t.uniforms),void 0!==t.vertexShader&&(i.vertexShader=t.vertexShader),void 0!==t.fragmentShader&&(i.fragmentShader=t.fragmentShader),void 0!==t.vertexColors&&(i.vertexColors=t.vertexColors),void 0!==t.fog&&(i.fog=t.fog),void 0!==t.shading&&(i.shading=t.shading),void 0!==t.blending&&(i.blending=t.blending),void 0!==t.side&&(i.side=t.side),void 0!==t.opacity&&(i.opacity=t.opacity),void 0!==t.transparent&&(i.transparent=t.transparent),void 0!==t.alphaTest&&(i.alphaTest=t.alphaTest),void 0!==t.depthTest&&(i.depthTest=t.depthTest),void 0!==t.depthWrite&&(i.depthWrite=t.depthWrite),void 0!==t.colorWrite&&(i.colorWrite=t.colorWrite),void 0!==t.wireframe&&(i.wireframe=t.wireframe),void 0!==t.wireframeLinewidth&&(i.wireframeLinewidth=t.wireframeLinewidth),void 0!==t.wireframeLinecap&&(i.wireframeLinecap=t.wireframeLinecap),void 0!==t.wireframeLinejoin&&(i.wireframeLinejoin=t.wireframeLinejoin),void 0!==t.skinning&&(i.skinning=t.skinning),void 0!==t.morphTargets&&(i.morphTargets=t.morphTargets),void 0!==t.size&&(i.size=t.size),void 0!==t.sizeAttenuation&&(i.sizeAttenuation=t.sizeAttenuation),void 0!==t.map&&(i.map=n(t.map)),void 0!==t.alphaMap&&(i.alphaMap=n(t.alphaMap),i.transparent=!0),void 0!==t.bumpMap&&(i.bumpMap=n(t.bumpMap)),void 0!==t.bumpScale&&(i.bumpScale=t.bumpScale),void 0!==t.normalMap&&(i.normalMap=n(t.normalMap)),void 0!==t.normalScale){var r=t.normalScale;!1===Array.isArray(r)&&(r=[r,r]),i.normalScale=(new d).fromArray(r)}if(void 0!==t.displacementMap&&(i.displacementMap=n(t.displacementMap)),void 0!==t.displacementScale&&(i.displacementScale=t.displacementScale),void 0!==t.displacementBias&&(i.displacementBias=t.displacementBias),void 0!==t.roughnessMap&&(i.roughnessMap=n(t.roughnessMap)),void 0!==t.metalnessMap&&(i.metalnessMap=n(t.metalnessMap)),void 0!==t.emissiveMap&&(i.emissiveMap=n(t.emissiveMap)),void 0!==t.emissiveIntensity&&(i.emissiveIntensity=t.emissiveIntensity),void 0!==t.specularMap&&(i.specularMap=n(t.specularMap)),void 0!==t.envMap&&(i.envMap=n(t.envMap)),void 0!==t.reflectivity&&(i.reflectivity=t.reflectivity),void 0!==t.lightMap&&(i.lightMap=n(t.lightMap)),void 0!==t.lightMapIntensity&&(i.lightMapIntensity=t.lightMapIntensity),void 0!==t.aoMap&&(i.aoMap=n(t.aoMap)),void 0!==t.aoMapIntensity&&(i.aoMapIntensity=t.aoMapIntensity),void 0!==t.materials)for(var o=0,a=t.materials.length;o<a;o++)i.materials.push(this.parse(t.materials[o]));return i}}),Object.assign(Fi.prototype,{load:function(t,e,n,i){var r=this;new ei(r.manager).load(t,(function(t){e(r.parse(JSON.parse(t)))}),n,i)},parse:function(t){var e=new pe,n=t.data.index,i={Int8Array:Int8Array,Uint8Array:Uint8Array,Uint8ClampedArray:Uint8ClampedArray,Int16Array:Int16Array,Uint16Array:Uint16Array,Int32Array:Int32Array,Uint32Array:Uint32Array,Float32Array:Float32Array,Float64Array:Float64Array};if(void 0!==n){var r=new i[n.type](n.array);e.setIndex(new oe(r,1))}var o=t.data.attributes;for(var a in o){var s=o[a];r=new i[s.type](s.array),e.addAttribute(a,new oe(r,s.itemSize,s.normalized))}var c=t.data.groups||t.data.drawcalls||t.data.offsets;if(void 0!==c)for(var l=0,h=c.length;l!==h;++l){var u=c[l];e.addGroup(u.start,u.count,u.materialIndex)}var d=t.data.boundingSphere;if(void 0!==d){var p=new T;void 0!==d.center&&p.fromArray(d.center),e.boundingSphere=new Bt(p,d.radius)}return e}}),Ni.prototype={constructor:Ni,crossOrigin:void 0,extractUrlBase:function(t){var e=t.split("/");return 1===e.length?"./":(e.pop(),e.join("/")+"/")},initMaterials:function(t,e,n){for(var i=[],r=0;r<t.length;++r)i[r]=this.createMaterial(t[r],e,n);return i},createMaterial:function(e,n,i){void 0===ri&&(ri=new pt),void 0===oi&&(oi=new ui),void 0===ai&&(ai=new Oi);var r={};function o(e,o,a,s,c){var l,h=n+e,u=Ni.Handlers.get(h);null!==u?l=u.load(h):(oi.setCrossOrigin(i),l=oi.load(h)),void 0!==o&&(l.repeat.fromArray(o),1!==o[0]&&(l.wrapS=1e3),1!==o[1]&&(l.wrapT=1e3)),void 0!==a&&l.offset.fromArray(a),void 0!==s&&("repeat"===s[0]&&(l.wrapS=1e3),"mirror"===s[0]&&(l.wrapS=1002),"repeat"===s[1]&&(l.wrapT=1e3),"mirror"===s[1]&&(l.wrapT=1002)),void 0!==c&&(l.anisotropy=c);var d=t.Math.generateUUID();return r[d]=l,d}var a={uuid:t.Math.generateUUID(),type:"MeshLambertMaterial"};for(var s in e){var l=e[s];switch(s){case"DbgColor":case"DbgIndex":case"opticalDensity":case"illumination":break;case"DbgName":a.name=l;break;case"blending":a.blending=c[l];break;case"colorAmbient":case"mapAmbient":console.warn("THREE.Loader.createMaterial:",s,"is no longer supported.");break;case"colorDiffuse":a.color=ri.fromArray(l).getHex();break;case"colorSpecular":a.specular=ri.fromArray(l).getHex();break;case"colorEmissive":a.emissive=ri.fromArray(l).getHex();break;case"specularCoef":a.shininess=l;break;case"shading":"basic"===l.toLowerCase()&&(a.type="MeshBasicMaterial"),"phong"===l.toLowerCase()&&(a.type="MeshPhongMaterial"),"standard"===l.toLowerCase()&&(a.type="MeshStandardMaterial");break;case"mapDiffuse":a.map=o(l,e.mapDiffuseRepeat,e.mapDiffuseOffset,e.mapDiffuseWrap,e.mapDiffuseAnisotropy);break;case"mapDiffuseRepeat":case"mapDiffuseOffset":case"mapDiffuseWrap":case"mapDiffuseAnisotropy":break;case"mapEmissive":a.emissiveMap=o(l,e.mapEmissiveRepeat,e.mapEmissiveOffset,e.mapEmissiveWrap,e.mapEmissiveAnisotropy);break;case"mapEmissiveRepeat":case"mapEmissiveOffset":case"mapEmissiveWrap":case"mapEmissiveAnisotropy":break;case"mapLight":a.lightMap=o(l,e.mapLightRepeat,e.mapLightOffset,e.mapLightWrap,e.mapLightAnisotropy);break;case"mapLightRepeat":case"mapLightOffset":case"mapLightWrap":case"mapLightAnisotropy":break;case"mapAO":a.aoMap=o(l,e.mapAORepeat,e.mapAOOffset,e.mapAOWrap,e.mapAOAnisotropy);break;case"mapAORepeat":case"mapAOOffset":case"mapAOWrap":case"mapAOAnisotropy":break;case"mapBump":a.bumpMap=o(l,e.mapBumpRepeat,e.mapBumpOffset,e.mapBumpWrap,e.mapBumpAnisotropy);break;case"mapBumpScale":a.bumpScale=l;break;case"mapBumpRepeat":case"mapBumpOffset":case"mapBumpWrap":case"mapBumpAnisotropy":break;case"mapNormal":a.normalMap=o(l,e.mapNormalRepeat,e.mapNormalOffset,e.mapNormalWrap,e.mapNormalAnisotropy);break;case"mapNormalFactor":a.normalScale=[l,l];break;case"mapNormalRepeat":case"mapNormalOffset":case"mapNormalWrap":case"mapNormalAnisotropy":break;case"mapSpecular":a.specularMap=o(l,e.mapSpecularRepeat,e.mapSpecularOffset,e.mapSpecularWrap,e.mapSpecularAnisotropy);break;case"mapSpecularRepeat":case"mapSpecularOffset":case"mapSpecularWrap":case"mapSpecularAnisotropy":break;case"mapMetalness":a.metalnessMap=o(l,e.mapMetalnessRepeat,e.mapMetalnessOffset,e.mapMetalnessWrap,e.mapMetalnessAnisotropy);break;case"mapMetalnessRepeat":case"mapMetalnessOffset":case"mapMetalnessWrap":case"mapMetalnessAnisotropy":break;case"mapRoughness":a.roughnessMap=o(l,e.mapRoughnessRepeat,e.mapRoughnessOffset,e.mapRoughnessWrap,e.mapRoughnessAnisotropy);break;case"mapRoughnessRepeat":case"mapRoughnessOffset":case"mapRoughnessWrap":case"mapRoughnessAnisotropy":break;case"mapAlpha":a.alphaMap=o(l,e.mapAlphaRepeat,e.mapAlphaOffset,e.mapAlphaWrap,e.mapAlphaAnisotropy);break;case"mapAlphaRepeat":case"mapAlphaOffset":case"mapAlphaWrap":case"mapAlphaAnisotropy":break;case"flipSided":a.side=1;break;case"doubleSided":a.side=2;break;case"transparency":console.warn("THREE.Loader.createMaterial: transparency has been renamed to opacity"),a.opacity=l;break;case"depthTest":case"depthWrite":case"colorWrite":case"opacity":case"reflectivity":case"transparent":case"visible":case"wireframe":a[s]=l;break;case"vertexColors":!0===l&&(a.vertexColors=2),"face"===l&&(a.vertexColors=1);break;default:console.error("THREE.Loader.createMaterial: Unsupported",s,l)}}return"MeshBasicMaterial"===a.type&&delete a.emissive,"MeshPhongMaterial"!==a.type&&delete a.specular,a.opacity<1&&(a.transparent=!0),ai.setTextures(r),ai.parse(a)}},Ni.Handlers={handlers:[],add:function(t,e){this.handlers.push(t,e)},get:function(t){for(var e=this.handlers,n=0,i=e.length;n<i;n+=2){var r=e[n],o=e[n+1];if(r.test(t))return o}return null}},Object.assign(Ui.prototype,{load:function(t,e,n,i){var r=this,o=this.texturePath&&"string"==typeof this.texturePath?this.texturePath:Ni.prototype.extractUrlBase(t),a=new ei(this.manager);a.setWithCredentials(this.withCredentials),a.load(t,(function(n){var i=JSON.parse(n),a=i.metadata;if(void 0!==a){var s=a.type;if(void 0!==s){if("object"===s.toLowerCase())return void console.error("THREE.JSONLoader: "+t+" should be loaded with THREE.ObjectLoader instead.");if("scene"===s.toLowerCase())return void console.error("THREE.JSONLoader: "+t+" should be loaded with THREE.SceneLoader instead.")}}var c=r.parse(i,o);e(c.geometry,c.materials)}),n,i)},setTexturePath:function(t){this.texturePath=t},parse:function(t,e){var n=new le,i=void 0!==t.scale?1/t.scale:1;if(function(e){function i(t,e){return t&1<<e}var r,o,a,s,c,l,h,u,p,f,m,g,v,y,b,x,w,_,S,E,A,M,C,P,R,L,k,I=t.faces,D=t.vertices,O=t.normals,F=t.colors,N=0;if(void 0!==t.uvs){for(r=0;r<t.uvs.length;r++)t.uvs[r].length&&N++;for(r=0;r<N;r++)n.faceVertexUvs[r]=[]}for(s=0,c=D.length;s<c;)(_=new T).x=D[s++]*e,_.y=D[s++]*e,_.z=D[s++]*e,n.vertices.push(_);for(s=0,c=I.length;s<c;)if(f=I[s++],m=i(f,0),g=i(f,1),v=i(f,3),y=i(f,4),b=i(f,5),x=i(f,6),w=i(f,7),m){if((E=new ie).a=I[s],E.b=I[s+1],E.c=I[s+3],(A=new ie).a=I[s+1],A.b=I[s+2],A.c=I[s+3],s+=4,g&&(p=I[s++],E.materialIndex=p,A.materialIndex=p),a=n.faces.length,v)for(r=0;r<N;r++)for(P=t.uvs[r],n.faceVertexUvs[r][a]=[],n.faceVertexUvs[r][a+1]=[],o=0;o<4;o++)u=I[s++],L=P[2*u],k=P[2*u+1],R=new d(L,k),2!==o&&n.faceVertexUvs[r][a].push(R),0!==o&&n.faceVertexUvs[r][a+1].push(R);if(y&&(h=3*I[s++],E.normal.set(O[h++],O[h++],O[h]),A.normal.copy(E.normal)),b)for(r=0;r<4;r++)h=3*I[s++],C=new T(O[h++],O[h++],O[h]),2!==r&&E.vertexNormals.push(C),0!==r&&A.vertexNormals.push(C);if(x&&(l=I[s++],M=F[l],E.color.setHex(M),A.color.setHex(M)),w)for(r=0;r<4;r++)l=I[s++],M=F[l],2!==r&&E.vertexColors.push(new pt(M)),0!==r&&A.vertexColors.push(new pt(M));n.faces.push(E),n.faces.push(A)}else{if((S=new ie).a=I[s++],S.b=I[s++],S.c=I[s++],g&&(p=I[s++],S.materialIndex=p),a=n.faces.length,v)for(r=0;r<N;r++)for(P=t.uvs[r],n.faceVertexUvs[r][a]=[],o=0;o<3;o++)u=I[s++],L=P[2*u],k=P[2*u+1],R=new d(L,k),n.faceVertexUvs[r][a].push(R);if(y&&(h=3*I[s++],S.normal.set(O[h++],O[h++],O[h])),b)for(r=0;r<3;r++)h=3*I[s++],C=new T(O[h++],O[h++],O[h]),S.vertexNormals.push(C);if(x&&(l=I[s++],S.color.setHex(F[l])),w)for(r=0;r<3;r++)l=I[s++],S.vertexColors.push(new pt(F[l]));n.faces.push(S)}}(i),function(){var e=void 0!==t.influencesPerVertex?t.influencesPerVertex:2;if(t.skinWeights)for(var i=0,r=t.skinWeights.length;i<r;i+=e){var o=t.skinWeights[i],a=e>1?t.skinWeights[i+1]:0,s=e>2?t.skinWeights[i+2]:0,c=e>3?t.skinWeights[i+3]:0;n.skinWeights.push(new _(o,a,s,c))}if(t.skinIndices)for(i=0,r=t.skinIndices.length;i<r;i+=e){var l=t.skinIndices[i],h=e>1?t.skinIndices[i+1]:0,u=e>2?t.skinIndices[i+2]:0,d=e>3?t.skinIndices[i+3]:0;n.skinIndices.push(new _(l,h,u,d))}n.bones=t.bones,n.bones&&n.bones.length>0&&(n.skinWeights.length!==n.skinIndices.length||n.skinIndices.length!==n.vertices.length)&&console.warn("When skinning, number of vertices ("+n.vertices.length+"), skinIndices ("+n.skinIndices.length+"), and skinWeights ("+n.skinWeights.length+") should match.")}(),function(e){if(void 0!==t.morphTargets)for(var i=0,r=t.morphTargets.length;i<r;i++){n.morphTargets[i]={},n.morphTargets[i].name=t.morphTargets[i].name,n.morphTargets[i].vertices=[];for(var o=n.morphTargets[i].vertices,a=t.morphTargets[i].vertices,s=0,c=a.length;s<c;s+=3){var l=new T;l.x=a[s]*e,l.y=a[s+1]*e,l.z=a[s+2]*e,o.push(l)}}if(void 0!==t.morphColors&&t.morphColors.length>0){console.warn('THREE.JSONLoader: "morphColors" no longer supported. Using them as face colors.');var h=n.faces,u=t.morphColors[0].colors;for(i=0,r=h.length;i<r;i++)h[i].color.fromArray(u,3*i)}}(i),function(){var e=[],i=[];void 0!==t.animation&&i.push(t.animation),void 0!==t.animations&&(t.animations.length?i=i.concat(t.animations):i.push(t.animations));for(var r=0;r<i.length;r++){var o=Di.parseAnimation(i[r],n.bones);o&&e.push(o)}if(n.morphTargets){var a=Di.CreateClipsFromMorphTargetSequences(n.morphTargets,10);e=e.concat(a)}e.length>0&&(n.animations=e)}(),n.computeFaceNormals(),n.computeBoundingSphere(),void 0===t.materials||0===t.materials.length)return{geometry:n};var r=Ni.prototype.initMaterials(t.materials,e,this.crossOrigin);return{geometry:n,materials:r}}}),Object.assign(ji.prototype,{load:function(t,e,n,i){""===this.texturePath&&(this.texturePath=t.substring(0,t.lastIndexOf("/")+1));var r=this;new ei(r.manager).load(t,(function(t){r.parse(JSON.parse(t),e)}),n,i)},setTexturePath:function(t){this.texturePath=t},setCrossOrigin:function(t){this.crossOrigin=t},parse:function(t,e){var n=this.parseGeometries(t.geometries),i=this.parseImages(t.images,(function(){void 0!==e&&e(a)})),r=this.parseTextures(t.textures,i),o=this.parseMaterials(t.materials,r),a=this.parseObject(t.object,n,o);return t.animations&&(a.animations=this.parseAnimations(t.animations)),void 0!==t.images&&0!==t.images.length||void 0!==e&&e(a),a},parseGeometries:function(t){var e={};if(void 0!==t)for(var n=new Ui,i=new Fi,r=0,o=t.length;r<o;r++){var a,s=t[r];switch(s.type){case"PlaneGeometry":case"PlaneBufferGeometry":a=new Gn[s.type](s.width,s.height,s.widthSegments,s.heightSegments);break;case"BoxGeometry":case"BoxBufferGeometry":case"CubeGeometry":a=new Gn[s.type](s.width,s.height,s.depth,s.widthSegments,s.heightSegments,s.depthSegments);break;case"CircleGeometry":case"CircleBufferGeometry":a=new Gn[s.type](s.radius,s.segments,s.thetaStart,s.thetaLength);break;case"CylinderGeometry":case"CylinderBufferGeometry":a=new Gn[s.type](s.radiusTop,s.radiusBottom,s.height,s.radialSegments,s.heightSegments,s.openEnded,s.thetaStart,s.thetaLength);break;case"ConeGeometry":case"ConeBufferGeometry":a=new Gn[s.type](s.radius,s.height,s.radialSegments,s.heightSegments,s.openEnded,s.thetaStart,s.thetaLength);break;case"SphereGeometry":case"SphereBufferGeometry":a=new Gn[s.type](s.radius,s.widthSegments,s.heightSegments,s.phiStart,s.phiLength,s.thetaStart,s.thetaLength);break;case"DodecahedronGeometry":case"IcosahedronGeometry":case"OctahedronGeometry":case"TetrahedronGeometry":a=new Gn[s.type](s.radius,s.detail);break;case"RingGeometry":case"RingBufferGeometry":a=new Gn[s.type](s.innerRadius,s.outerRadius,s.thetaSegments,s.phiSegments,s.thetaStart,s.thetaLength);break;case"TorusGeometry":case"TorusBufferGeometry":a=new Gn[s.type](s.radius,s.tube,s.radialSegments,s.tubularSegments,s.arc);break;case"TorusKnotGeometry":case"TorusKnotBufferGeometry":a=new Gn[s.type](s.radius,s.tube,s.tubularSegments,s.radialSegments,s.p,s.q);break;case"LatheGeometry":case"LatheBufferGeometry":a=new Gn[s.type](s.points,s.segments,s.phiStart,s.phiLength);break;case"BufferGeometry":a=i.parse(s);break;case"Geometry":a=n.parse(s.data,this.texturePath).geometry;break;default:console.warn('THREE.ObjectLoader: Unsupported geometry type "'+s.type+'"');continue}a.uuid=s.uuid,void 0!==s.name&&(a.name=s.name),e[s.uuid]=a}return e},parseMaterials:function(t,e){var n={};if(void 0!==t){var i=new Oi;i.setTextures(e);for(var r=0,o=t.length;r<o;r++){var a=i.parse(t[r]);n[a.uuid]=a}}return n},parseAnimations:function(t){for(var e=[],n=0;n<t.length;n++){var i=Di.parse(t[n]);e.push(i)}return e},parseImages:function(t,e){var n=this,i={};function r(t){return n.manager.itemStart(t),o.load(t,(function(){n.manager.itemEnd(t)}),void 0,(function(){n.manager.itemError(t)}))}if(void 0!==t&&t.length>0){var o=new li(new ti(e));o.setCrossOrigin(this.crossOrigin);for(var a=0,s=t.length;a<s;a++){var c=t[a],l=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(c.url)?c.url:n.texturePath+c.url;i[c.uuid]=r(l)}}return i},parseTextures:function(t,e){function n(t,e){return"number"==typeof t?t:(console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",t),e[t])}var i={};if(void 0!==t)for(var r=0,o=t.length;r<o;r++){var a=t[r];void 0===a.image&&console.warn('THREE.ObjectLoader: No "image" specified for',a.uuid),void 0===e[a.image]&&console.warn("THREE.ObjectLoader: Undefined image",a.image);var s=new p(e[a.image]);s.needsUpdate=!0,s.uuid=a.uuid,void 0!==a.name&&(s.name=a.name),void 0!==a.mapping&&(s.mapping=n(a.mapping,l)),void 0!==a.offset&&s.offset.fromArray(a.offset),void 0!==a.repeat&&s.repeat.fromArray(a.repeat),void 0!==a.wrap&&(s.wrapS=n(a.wrap[0],h),s.wrapT=n(a.wrap[1],h)),void 0!==a.minFilter&&(s.minFilter=n(a.minFilter,u)),void 0!==a.magFilter&&(s.magFilter=n(a.magFilter,u)),void 0!==a.anisotropy&&(s.anisotropy=a.anisotropy),void 0!==a.flipY&&(s.flipY=a.flipY),i[a.uuid]=s}return i},parseObject:function(){var t=new M;return function(e,n,i){var r;function o(t){return void 0===n[t]&&console.warn("THREE.ObjectLoader: Undefined geometry",t),n[t]}function a(t){if(void 0!==t)return void 0===i[t]&&console.warn("THREE.ObjectLoader: Undefined material",t),i[t]}switch(e.type){case"Scene":r=new qe,void 0!==e.background&&Number.isInteger(e.background)&&(r.background=new pt(e.background)),void 0!==e.fog&&("Fog"===e.fog.type?r.fog=new Xe(e.fog.color,e.fog.near,e.fog.far):"FogExp2"===e.fog.type&&(r.fog=new We(e.fog.color,e.fog.density)));break;case"PerspectiveCamera":r=new ye(e.fov,e.aspect,e.near,e.far),void 0!==e.focus&&(r.focus=e.focus),void 0!==e.zoom&&(r.zoom=e.zoom),void 0!==e.filmGauge&&(r.filmGauge=e.filmGauge),void 0!==e.filmOffset&&(r.filmOffset=e.filmOffset),void 0!==e.view&&(r.view=Object.assign({},e.view));break;case"OrthographicCamera":r=new be(e.left,e.right,e.top,e.bottom,e.near,e.far);break;case"AmbientLight":r=new xi(e.color,e.intensity);break;case"DirectionalLight":r=new bi(e.color,e.intensity);break;case"PointLight":r=new vi(e.color,e.intensity,e.distance,e.decay);break;case"SpotLight":r=new gi(e.color,e.intensity,e.distance,e.angle,e.penumbra,e.decay);break;case"HemisphereLight":r=new pi(e.color,e.groundColor,e.intensity);break;case"Mesh":var s=o(e.geometry),c=a(e.material);r=s.bones&&s.bones.length>0?new en(s,c):new fe(s,c);break;case"LOD":r=new Qe;break;case"Line":r=new rn(o(e.geometry),a(e.material),e.mode);break;case"LineSegments":r=new on(o(e.geometry),a(e.material));break;case"PointCloud":case"Points":r=new sn(o(e.geometry),a(e.material));break;case"Sprite":r=new $e(a(e.material));break;case"Group":r=new cn;break;default:r=new Yt}if(r.uuid=e.uuid,void 0!==e.name&&(r.name=e.name),void 0!==e.matrix?(t.fromArray(e.matrix),t.decompose(r.position,r.quaternion,r.scale)):(void 0!==e.position&&r.position.fromArray(e.position),void 0!==e.rotation&&r.rotation.fromArray(e.rotation),void 0!==e.quaternion&&r.quaternion.fromArray(e.quaternion),void 0!==e.scale&&r.scale.fromArray(e.scale)),void 0!==e.castShadow&&(r.castShadow=e.castShadow),void 0!==e.receiveShadow&&(r.receiveShadow=e.receiveShadow),e.shadow&&(void 0!==e.shadow.bias&&(r.shadow.bias=e.shadow.bias),void 0!==e.shadow.radius&&(r.shadow.radius=e.shadow.radius),void 0!==e.shadow.mapSize&&r.shadow.mapSize.fromArray(e.shadow.mapSize),void 0!==e.shadow.camera&&(r.shadow.camera=this.parseObject(e.shadow.camera))),void 0!==e.visible&&(r.visible=e.visible),void 0!==e.userData&&(r.userData=e.userData),void 0!==e.children)for(var l in e.children)r.add(this.parseObject(e.children[l],n,i));if("LOD"===e.type)for(var h=e.levels,u=0;u<h.length;u++){var d=h[u];void 0!==(l=r.getObjectByProperty("uuid",d.object))&&r.addLevel(l,d.distance)}return r}}()}),Bi.prototype={constructor:Bi,getPoint:function(t){return console.warn("THREE.Curve: Warning, getPoint() not implemented!"),null},getPointAt:function(t){var e=this.getUtoTmapping(t);return this.getPoint(e)},getPoints:function(t){t||(t=5);for(var e=[],n=0;n<=t;n++)e.push(this.getPoint(n/t));return e},getSpacedPoints:function(t){t||(t=5);for(var e=[],n=0;n<=t;n++)e.push(this.getPointAt(n/t));return e},getLength:function(){var t=this.getLengths();return t[t.length-1]},getLengths:function(t){if(t||(t=this.__arcLengthDivisions?this.__arcLengthDivisions:200),this.cacheArcLengths&&this.cacheArcLengths.length===t+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;var e,n,i=[],r=this.getPoint(0),o=0;for(i.push(0),n=1;n<=t;n++)o+=(e=this.getPoint(n/t)).distanceTo(r),i.push(o),r=e;return this.cacheArcLengths=i,i},updateArcLengths:function(){this.needsUpdate=!0,this.getLengths()},getUtoTmapping:function(t,e){var n,i=this.getLengths(),r=0,o=i.length;n=e||t*i[o-1];for(var a,s=0,c=o-1;s<=c;)if((a=i[r=Math.floor(s+(c-s)/2)]-n)<0)s=r+1;else{if(!(a>0)){c=r;break}c=r-1}if(i[r=c]===n)return r/(o-1);var l=i[r];return(r+(n-l)/(i[r+1]-l))/(o-1)},getTangent:function(t){var e=t-1e-4,n=t+1e-4;e<0&&(e=0),n>1&&(n=1);var i=this.getPoint(e);return this.getPoint(n).clone().sub(i).normalize()},getTangentAt:function(t){var e=this.getUtoTmapping(t);return this.getTangent(e)}},Bi.create=function(t,e){return t.prototype=Object.create(Bi.prototype),t.prototype.constructor=t,t.prototype.getPoint=e,t},zi.prototype=Object.create(Bi.prototype),zi.prototype.constructor=zi,zi.prototype.isLineCurve=!0,zi.prototype.getPoint=function(t){if(1===t)return this.v2.clone();var e=this.v2.clone().sub(this.v1);return e.multiplyScalar(t).add(this.v1),e},zi.prototype.getPointAt=function(t){return this.getPoint(t)},zi.prototype.getTangent=function(t){return this.v2.clone().sub(this.v1).normalize()},Hi.prototype=Object.assign(Object.create(Bi.prototype),{constructor:Hi,add:function(t){this.curves.push(t)},closePath:function(){var t=this.curves[0].getPoint(0),e=this.curves[this.curves.length-1].getPoint(1);t.equals(e)||this.curves.push(new zi(e,t))},getPoint:function(t){for(var e=t*this.getLength(),n=this.getCurveLengths(),i=0;i<n.length;){if(n[i]>=e){var r=n[i]-e,o=this.curves[i],a=o.getLength(),s=0===a?0:1-r/a;return o.getPointAt(s)}i++}return null},getLength:function(){var t=this.getCurveLengths();return t[t.length-1]},updateArcLengths:function(){this.needsUpdate=!0,this.cacheLengths=null,this.getLengths()},getCurveLengths:function(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;for(var t=[],e=0,n=0,i=this.curves.length;n<i;n++)e+=this.curves[n].getLength(),t.push(e);return this.cacheLengths=t,t},getSpacedPoints:function(t){t||(t=40);for(var e=[],n=0;n<=t;n++)e.push(this.getPoint(n/t));return this.autoClose&&e.push(e[0]),e},getPoints:function(t){t=t||12;for(var e,n=[],i=0,r=this.curves;i<r.length;i++)for(var o=r[i],a=o&&o.isEllipseCurve?2*t:o&&o.isLineCurve?1:o&&o.isSplineCurve?t*o.points.length:t,s=o.getPoints(a),c=0;c<s.length;c++){var l=s[c];e&&e.equals(l)||(n.push(l),e=l)}return this.autoClose&&n.length>1&&!n[n.length-1].equals(n[0])&&n.push(n[0]),n},createPointsGeometry:function(t){var e=this.getPoints(t);return this.createGeometry(e)},createSpacedPointsGeometry:function(t){var e=this.getSpacedPoints(t);return this.createGeometry(e)},createGeometry:function(t){for(var e=new le,n=0,i=t.length;n<i;n++){var r=t[n];e.vertices.push(new T(r.x,r.y,r.z||0))}return e}}),Gi.prototype=Object.create(Bi.prototype),Gi.prototype.constructor=Gi,Gi.prototype.isEllipseCurve=!0,Gi.prototype.getPoint=function(t){for(var e=2*Math.PI,n=this.aEndAngle-this.aStartAngle,i=Math.abs(n)<Number.EPSILON;n<0;)n+=e;for(;n>e;)n-=e;n<Number.EPSILON&&(n=i?0:e),!0!==this.aClockwise||i||(n===e?n=-e:n-=e);var r=this.aStartAngle+t*n,o=this.aX+this.xRadius*Math.cos(r),a=this.aY+this.yRadius*Math.sin(r);if(0!==this.aRotation){var s=Math.cos(this.aRotation),c=Math.sin(this.aRotation),l=o-this.aX,h=a-this.aY;o=l*s-h*c+this.aX,a=l*c+h*s+this.aY}return new d(o,a)},t.CurveUtils={tangentQuadraticBezier:function(t,e,n,i){return 2*(1-t)*(n-e)+2*t*(i-n)},tangentCubicBezier:function(t,e,n,i,r){return-3*e*(1-t)*(1-t)+3*n*(1-t)*(1-t)-6*t*n*(1-t)+6*t*i*(1-t)-3*t*t*i+3*t*t*r},tangentSpline:function(t,e,n,i,r){return 6*t*t-6*t+(3*t*t-4*t+1)+(-6*t*t+6*t)+(3*t*t-2*t)},interpolate:function(t,e,n,i,r){var o=.5*(n-t),a=.5*(i-e),s=r*r;return(2*e-2*n+o+a)*(r*s)+(-3*e+3*n-2*o-a)*s+o*r+e}},Vi.prototype=Object.create(Bi.prototype),Vi.prototype.constructor=Vi,Vi.prototype.isSplineCurve=!0,Vi.prototype.getPoint=function(e){var n=this.points,i=(n.length-1)*e,r=Math.floor(i),o=i-r,a=n[0===r?r:r-1],s=n[r],c=n[r>n.length-2?n.length-1:r+1],l=n[r>n.length-3?n.length-1:r+2],h=t.CurveUtils.interpolate;return new d(h(a.x,s.x,c.x,l.x,o),h(a.y,s.y,c.y,l.y,o))},Wi.prototype=Object.create(Bi.prototype),Wi.prototype.constructor=Wi,Wi.prototype.getPoint=function(e){var n=t.ShapeUtils.b3;return new d(n(e,this.v0.x,this.v1.x,this.v2.x,this.v3.x),n(e,this.v0.y,this.v1.y,this.v2.y,this.v3.y))},Wi.prototype.getTangent=function(e){var n=t.CurveUtils.tangentCubicBezier;return new d(n(e,this.v0.x,this.v1.x,this.v2.x,this.v3.x),n(e,this.v0.y,this.v1.y,this.v2.y,this.v3.y)).normalize()},Xi.prototype=Object.create(Bi.prototype),Xi.prototype.constructor=Xi,Xi.prototype.getPoint=function(e){var n=t.ShapeUtils.b2;return new d(n(e,this.v0.x,this.v1.x,this.v2.x),n(e,this.v0.y,this.v1.y,this.v2.y))},Xi.prototype.getTangent=function(e){var n=t.CurveUtils.tangentQuadraticBezier;return new d(n(e,this.v0.x,this.v1.x,this.v2.x),n(e,this.v0.y,this.v1.y,this.v2.y)).normalize()};var qi,Yi,Zi,$i,Qi,Ji,Ki,tr,er,nr,ir,rr,or=Object.assign(Object.create(Hi.prototype),{fromPoints:function(t){this.moveTo(t[0].x,t[0].y);for(var e=1,n=t.length;e<n;e++)this.lineTo(t[e].x,t[e].y)},moveTo:function(t,e){this.currentPoint.set(t,e)},lineTo:function(t,e){var n=new zi(this.currentPoint.clone(),new d(t,e));this.curves.push(n),this.currentPoint.set(t,e)},quadraticCurveTo:function(t,e,n,i){var r=new Xi(this.currentPoint.clone(),new d(t,e),new d(n,i));this.curves.push(r),this.currentPoint.set(n,i)},bezierCurveTo:function(t,e,n,i,r,o){var a=new Wi(this.currentPoint.clone(),new d(t,e),new d(n,i),new d(r,o));this.curves.push(a),this.currentPoint.set(r,o)},splineThru:function(t){var e=new Vi([this.currentPoint.clone()].concat(t));this.curves.push(e),this.currentPoint.copy(t[t.length-1])},arc:function(t,e,n,i,r,o){var a=this.currentPoint.x,s=this.currentPoint.y;this.absarc(t+a,e+s,n,i,r,o)},absarc:function(t,e,n,i,r,o){this.absellipse(t,e,n,n,i,r,o)},ellipse:function(t,e,n,i,r,o,a,s){var c=this.currentPoint.x,l=this.currentPoint.y;this.absellipse(t+c,e+l,n,i,r,o,a,s)},absellipse:function(t,e,n,i,r,o,a,s){var c=new Gi(t,e,n,i,r,o,a,s);if(this.curves.length>0){var l=c.getPoint(0);l.equals(this.currentPoint)||this.lineTo(l.x,l.y)}this.curves.push(c);var h=c.getPoint(1);this.currentPoint.copy(h)}});function ar(){sr.apply(this,arguments),this.holes=[]}function sr(t){Hi.call(this),this.currentPoint=new d,t&&this.fromPoints(t)}function cr(){this.subPaths=[],this.currentPath=null}function lr(t){this.data=t}function hr(e){this.manager=void 0!==e?e:t.DefaultLoadingManager}function ur(){return void 0===qi&&(qi=new(window.AudioContext||window.webkitAudioContext)),qi}function dr(e){this.manager=void 0!==e?e:t.DefaultLoadingManager}function pr(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new ye,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new ye,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1}function fr(t,e,n){Yt.call(this),this.type="CubeCamera";var i=new ye(90,1,t,e);i.up.set(0,-1,0),i.lookAt(new T(1,0,0)),this.add(i);var r=new ye(90,1,t,e);r.up.set(0,-1,0),r.lookAt(new T(-1,0,0)),this.add(r);var o=new ye(90,1,t,e);o.up.set(0,0,1),o.lookAt(new T(0,1,0)),this.add(o);var a=new ye(90,1,t,e);a.up.set(0,0,-1),a.lookAt(new T(0,-1,0)),this.add(a);var s=new ye(90,1,t,e);s.up.set(0,-1,0),s.lookAt(new T(0,0,1)),this.add(s);var c=new ye(90,1,t,e);c.up.set(0,-1,0),c.lookAt(new T(0,0,-1)),this.add(c);var l={format:1022,magFilter:1006,minFilter:1006};this.renderTarget=new E(n,n,l),this.updateCubeMap=function(t,e){null===this.parent&&this.updateMatrixWorld();var n=this.renderTarget,l=n.texture.generateMipmaps;n.texture.generateMipmaps=!1,n.activeCubeFace=0,t.render(e,i,n),n.activeCubeFace=1,t.render(e,r,n),n.activeCubeFace=2,t.render(e,o,n),n.activeCubeFace=3,t.render(e,a,n),n.activeCubeFace=4,t.render(e,s,n),n.texture.generateMipmaps=l,n.activeCubeFace=5,t.render(e,c,n),t.setRenderTarget(null)}}function mr(){Yt.call(this),this.type="AudioListener",this.context=ur(),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.filter=null}function gr(t){Yt.call(this),this.type="Audio",this.context=t.context,this.source=this.context.createBufferSource(),this.source.onended=this.onEnded.bind(this),this.gain=this.context.createGain(),this.gain.connect(t.getInput()),this.autoplay=!1,this.startTime=0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.sourceType="empty",this.filters=[]}function vr(t){gr.call(this,t),this.panner=this.context.createPanner(),this.panner.connect(this.gain)}function yr(t,e){this.analyser=t.context.createAnalyser(),this.analyser.fftSize=void 0!==e?e:2048,this.data=new Uint8Array(this.analyser.frequencyBinCount),t.getOutput().connect(this.analyser)}function br(t,e,n){this.binding=t,this.valueSize=n;var i,r=Float64Array;switch(e){case"quaternion":i=this._slerp;break;case"string":case"bool":r=Array,i=this._select;break;default:i=this._lerp}this.buffer=new r(4*n),this._mixBufferRegion=i,this.cumulativeWeight=0,this.useCount=0,this.referenceCount=0}function xr(t,e,n){this.path=e,this.parsedPath=n||xr.parseTrackName(e),this.node=xr.findNode(t,this.parsedPath.nodeName)||t,this.rootNode=t}function wr(e){this.uuid=t.Math.generateUUID(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;var n={};this._indicesByUUID=n;for(var i=0,r=arguments.length;i!==r;++i)n[arguments[i].uuid]=i;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};var o=this;this.stats={objects:{get total(){return o._objects.length},get inUse(){return this.total-o.nCachedObjects_}},get bindingsPerObject(){return o._bindings.length}}}function _r(t,e,n){this._mixer=t,this._clip=e,this._localRoot=n||null;for(var i=e.tracks,r=i.length,o=new Array(r),a={endingStart:2400,endingEnd:2400},s=0;s!==r;++s){var c=i[s].createInterpolant(null);o[s]=c,c.settings=a}this._interpolantSettings=a,this._interpolants=o,this._propertyBindings=new Array(r),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=2201,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}function Sr(t){this._root=t,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}function Er(t){"string"==typeof t&&(console.warn("THREE.Uniform: Type parameter is no longer needed."),t=arguments[1]),this.value=t,this.dynamic=!1}function Ar(){pe.call(this),this.type="InstancedBufferGeometry",this.maxInstancedCount=void 0}function Tr(e,n,i,r){this.uuid=t.Math.generateUUID(),this.data=e,this.itemSize=n,this.offset=i,this.normalized=!0===r}function Mr(e,n){this.uuid=t.Math.generateUUID(),this.array=e,this.stride=n,this.count=void 0!==e?e.length/n:0,this.dynamic=!1,this.updateRange={offset:0,count:-1},this.version=0}function Cr(t,e,n){Mr.call(this,t,e),this.meshPerAttribute=n||1}function Pr(t,e,n){oe.call(this,t,e),this.meshPerAttribute=n||1}function Rr(t,e,n,i){this.ray=new Wt(t,e),this.near=n||0,this.far=i||1/0,this.params={Mesh:{},Line:{},LOD:{},Points:{threshold:1},Sprite:{}},Object.defineProperties(this.params,{PointCloud:{get:function(){return console.warn("THREE.Raycaster: params.PointCloud has been renamed to params.Points."),this.Points}}})}function Lr(t,e){return t.distance-e.distance}function kr(t,e,n,i){if(!1!==t.visible&&(t.raycast(e,n),!0===i))for(var r=t.children,o=0,a=r.length;o<a;o++)kr(r[o],e,n,!0)}function Ir(t){this.autoStart=void 0===t||t,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}function Dr(t,e,n){return this.radius=void 0!==t?t:1,this.phi=void 0!==e?e:0,this.theta=void 0!==n?n:0,this}function Or(t,e){fe.call(this,t,e),this.animationsMap={},this.animationsList=[];var n=this.geometry.morphTargets.length,i=n-1,r=n/1;this.createAnimation("__default",0,i,r),this.setAnimationWeight("__default",1)}function Fr(t){Yt.call(this),this.material=t,this.render=function(t){}}function Nr(t,e,n,i){this.object=t,this.size=void 0!==e?e:1;var r=void 0!==n?n:16711680,o=void 0!==i?i:1,a=0,s=this.object.geometry;s&&s.isGeometry?a=3*s.faces.length:s&&s.isBufferGeometry&&(a=s.attributes.normal.count);var c=new pe,l=new ce(2*a*3,3);c.addAttribute("position",l),on.call(this,c,new nn({color:r,linewidth:o})),this.matrixAutoUpdate=!1,this.update()}function Ur(t){Yt.call(this),this.light=t,this.light.updateMatrixWorld(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1;for(var e=new pe,n=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1],i=0,r=1;i<32;i++,r++){var o=i/32*Math.PI*2,a=r/32*Math.PI*2;n.push(Math.cos(o),Math.sin(o),1,Math.cos(a),Math.sin(a),1)}e.addAttribute("position",new ce(n,3));var s=new nn({fog:!1});this.cone=new on(e,s),this.add(this.cone),this.update()}function jr(t){this.bones=this.getBoneList(t);for(var e=new le,n=0;n<this.bones.length;n++){var i=this.bones[n];i.parent&&i.parent.isBone&&(e.vertices.push(new T),e.vertices.push(new T),e.colors.push(new pt(0,0,1)),e.colors.push(new pt(0,1,0)))}e.dynamic=!0;var r=new nn({vertexColors:2,depthTest:!1,depthWrite:!1,transparent:!0});on.call(this,e,r),this.root=t,this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.update()}function Br(t,e){this.light=t,this.light.updateMatrixWorld();var n=new Mn(e,4,2),i=new re({wireframe:!0,fog:!1});i.color.copy(this.light.color).multiplyScalar(this.light.intensity),fe.call(this,n,i),this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1}function zr(t,e){Yt.call(this),this.light=t,this.light.updateMatrixWorld(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.colors=[new pt,new pt];var n=new Cn(e,4,2);n.rotateX(-Math.PI/2);for(var i=0;i<8;i++)n.faces[i].color=this.colors[i<4?0:1];var r=new re({vertexColors:1,wireframe:!0});this.lightSphere=new fe(n,r),this.add(this.lightSphere),this.update()}function Hr(t,e,n,i){e=e||1,n=new pt(void 0!==n?n:4473924),i=new pt(void 0!==i?i:8947848);for(var r=e/2,o=2*t/e,a=[],s=[],c=0,l=0,h=-t;c<=e;c++,h+=o){a.push(-t,0,h,t,0,h),a.push(h,0,-t,h,0,t);var u=c===r?n:i;u.toArray(s,l),l+=3,u.toArray(s,l),l+=3,u.toArray(s,l),l+=3,u.toArray(s,l),l+=3}var d=new pe;d.addAttribute("position",new ce(a,3)),d.addAttribute("color",new ce(s,3));var p=new nn({vertexColors:2});on.call(this,d,p)}function Gr(t,e,n,i){this.object=t,this.size=void 0!==e?e:1;var r=void 0!==n?n:16776960,o=void 0!==i?i:1,a=0,s=this.object.geometry;s&&s.isGeometry?a=s.faces.length:console.warn("THREE.FaceNormalsHelper: only THREE.Geometry is supported. Use THREE.VertexNormalsHelper, instead.");var c=new pe,l=new ce(2*a*3,3);c.addAttribute("position",l),on.call(this,c,new nn({color:r,linewidth:o})),this.matrixAutoUpdate=!1,this.update()}function Vr(t,e){Yt.call(this),this.light=t,this.light.updateMatrixWorld(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,void 0===e&&(e=1);var n=new pe;n.addAttribute("position",new ce([-e,e,0,e,e,0,e,-e,0,-e,-e,0,-e,e,0],3));var i=new nn({fog:!1});this.add(new rn(n,i)),(n=new pe).addAttribute("position",new ce([0,0,0,0,0,1],3)),this.add(new rn(n,i)),this.update()}function Wr(t){var e=new le,n=new nn({color:16777215,vertexColors:1}),i={};function r(t,e,n){o(t,n),o(e,n)}function o(t,n){e.vertices.push(new T),e.colors.push(new pt(n)),void 0===i[t]&&(i[t]=[]),i[t].push(e.vertices.length-1)}r("n1","n2",16755200),r("n2","n4",16755200),r("n4","n3",16755200),r("n3","n1",16755200),r("f1","f2",16755200),r("f2","f4",16755200),r("f4","f3",16755200),r("f3","f1",16755200),r("n1","f1",16755200),r("n2","f2",16755200),r("n3","f3",16755200),r("n4","f4",16755200),r("p","n1",16711680),r("p","n2",16711680),r("p","n3",16711680),r("p","n4",16711680),r("u1","u2",43775),r("u2","u3",43775),r("u3","u1",43775),r("c","t",16777215),r("p","c",3355443),r("cn1","cn2",3355443),r("cn3","cn4",3355443),r("cf1","cf2",3355443),r("cf3","cf4",3355443),on.call(this,e,n),this.camera=t,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=i,this.update()}function Xr(t,e){var n=void 0!==e?e:8947848;this.object=t,this.box=new jt,fe.call(this,new Hn(1,1,1),new re({color:n,wireframe:!0}))}function qr(t,e){void 0===e&&(e=16776960);var n=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),i=new Float32Array(24),r=new pe;r.setIndex(new oe(n,1)),r.addAttribute("position",new oe(i,3)),on.call(this,r,new nn({color:e})),void 0!==t&&this.update(t)}ar.prototype=Object.assign(Object.create(or),{constructor:ar,getPointsHoles:function(t){for(var e=[],n=0,i=this.holes.length;n<i;n++)e[n]=this.holes[n].getPoints(t);return e},extractAllPoints:function(t){return{shape:this.getPoints(t),holes:this.getPointsHoles(t)}},extractPoints:function(t){return this.extractAllPoints(t)}}),sr.prototype=or,or.constructor=sr,cr.prototype={moveTo:function(t,e){this.currentPath=new sr,this.subPaths.push(this.currentPath),this.currentPath.moveTo(t,e)},lineTo:function(t,e){this.currentPath.lineTo(t,e)},quadraticCurveTo:function(t,e,n,i){this.currentPath.quadraticCurveTo(t,e,n,i)},bezierCurveTo:function(t,e,n,i,r,o){this.currentPath.bezierCurveTo(t,e,n,i,r,o)},splineThru:function(t){this.currentPath.splineThru(t)},toShapes:function(e,n){function i(t){for(var e=[],n=0,i=t.length;n<i;n++){var r=t[n],o=new ar;o.curves=r.curves,e.push(o)}return e}function r(t,e){for(var n=e.length,i=!1,r=n-1,o=0;o<n;r=o++){var a=e[r],s=e[o],c=s.x-a.x,l=s.y-a.y;if(Math.abs(l)>Number.EPSILON){if(l<0&&(a=e[o],c=-c,s=e[r],l=-l),t.y<a.y||t.y>s.y)continue;if(t.y===a.y){if(t.x===a.x)return!0}else{var h=l*(t.x-a.x)-c*(t.y-a.y);if(0===h)return!0;if(h<0)continue;i=!i}}else{if(t.y!==a.y)continue;if(s.x<=t.x&&t.x<=a.x||a.x<=t.x&&t.x<=s.x)return!0}}return i}var o=t.ShapeUtils.isClockWise,a=this.subPaths;if(0===a.length)return[];if(!0===n)return i(a);var s,c,l,h=[];if(1===a.length)return c=a[0],(l=new ar).curves=c.curves,h.push(l),h;var u=!o(a[0].getPoints());u=e?!u:u;var d,p,f=[],m=[],g=[],v=0;m[v]=void 0,g[v]=[];for(var y=0,b=a.length;y<b;y++)s=o(d=(c=a[y]).getPoints()),(s=e?!s:s)?(!u&&m[v]&&v++,m[v]={s:new ar,p:d},m[v].s.curves=c.curves,u&&v++,g[v]=[]):g[v].push({h:c,p:d[0]});if(!m[0])return i(a);if(m.length>1){for(var x=!1,w=[],_=0,S=m.length;_<S;_++)f[_]=[];for(_=0,S=m.length;_<S;_++)for(var E=g[_],A=0;A<E.length;A++){for(var T=E[A],M=!0,C=0;C<m.length;C++)r(T.p,m[C].p)&&(_!==C&&w.push({froms:_,tos:C,hole:A}),M?(M=!1,f[C].push(T)):x=!0);M&&f[_].push(T)}w.length>0&&(x||(g=f))}y=0;for(var P=m.length;y<P;y++){l=m[y].s,h.push(l);for(var R=0,L=(p=g[y]).length;R<L;R++)l.holes.push(p[R].h)}return h}},Object.assign(lr.prototype,{isFont:!0,generateShapes:function(e,n,i){function r(e,n,r){var a=o.glyphs[e]||o.glyphs["?"];if(a){var s,c,l,h,u,d,p,f,m,g,v,y=new cr,b=[],x=t.ShapeUtils.b2,w=t.ShapeUtils.b3;if(a.o)for(var _=a._cachedOutline||(a._cachedOutline=a.o.split(" ")),S=0,E=_.length;S<E;)switch(_[S++]){case"m":s=_[S++]*n+r,c=_[S++]*n,y.moveTo(s,c);break;case"l":s=_[S++]*n+r,c=_[S++]*n,y.lineTo(s,c);break;case"q":if(l=_[S++]*n+r,h=_[S++]*n,p=_[S++]*n+r,f=_[S++]*n,y.quadraticCurveTo(p,f,l,h),v=b[b.length-1]){u=v.x,d=v.y;for(var A=1;A<=i;A++)x(T=A/i,u,p,l),x(T,d,f,h)}break;case"b":if(l=_[S++]*n+r,h=_[S++]*n,p=_[S++]*n+r,f=_[S++]*n,m=_[S++]*n+r,g=_[S++]*n,y.bezierCurveTo(p,f,m,g,l,h),v=b[b.length-1])for(u=v.x,d=v.y,A=1;A<=i;A++){var T;w(T=A/i,u,p,m,l),w(T,d,f,g,h)}}return{offset:a.ha*n,path:y}}}void 0===n&&(n=100),void 0===i&&(i=4);for(var o=this.data,a=function(t){for(var e=String(t).split(""),i=n/o.resolution,a=0,s=[],c=0;c<e.length;c++){var l=r(e[c],i,a);a+=l.offset,s.push(l.path)}return s}(e),s=[],c=0,l=a.length;c<l;c++)Array.prototype.push.apply(s,a[c].toShapes());return s}}),Object.assign(hr.prototype,{load:function(t,e,n,i){var r=this;new ei(this.manager).load(t,(function(t){var n;try{n=JSON.parse(t)}catch(e){console.warn("THREE.FontLoader: typeface.js support is being deprecated. Use typeface.json instead."),n=JSON.parse(t.substring(65,t.length-2))}var i=r.parse(n);e&&e(i)}),n,i)},parse:function(t){return new lr(t)}}),Object.assign(dr.prototype,{load:function(t,e,n,i){var r=new ei(this.manager);r.setResponseType("arraybuffer"),r.load(t,(function(t){ur().decodeAudioData(t,(function(t){e(t)}))}),n,i)}}),Object.assign(pr.prototype,{update:(ir=new M,rr=new M,function(e){if($i!==this||Qi!==e.focus||Ji!==e.fov||Ki!==e.aspect*this.aspect||tr!==e.near||er!==e.far||nr!==e.zoom){$i=this,Qi=e.focus,Ji=e.fov,Ki=e.aspect*this.aspect,tr=e.near,er=e.far,nr=e.zoom;var n,i,r=e.projectionMatrix.clone(),o=this.eyeSep/2,a=o*tr/Qi,s=tr*Math.tan(t.Math.DEG2RAD*Ji*.5)/nr;rr.elements[12]=-o,ir.elements[12]=o,n=-s*Ki+a,i=s*Ki+a,r.elements[0]=2*tr/(i-n),r.elements[8]=(i+n)/(i-n),this.cameraL.projectionMatrix.copy(r),n=-s*Ki-a,i=s*Ki-a,r.elements[0]=2*tr/(i-n),r.elements[8]=(i+n)/(i-n),this.cameraR.projectionMatrix.copy(r)}this.cameraL.matrixWorld.copy(e.matrixWorld).multiply(rr),this.cameraR.matrixWorld.copy(e.matrixWorld).multiply(ir)})}),fr.prototype=Object.create(Yt.prototype),fr.prototype.constructor=fr,mr.prototype=Object.assign(Object.create(Yt.prototype),{constructor:mr,getInput:function(){return this.gain},removeFilter:function(){null!==this.filter&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null)},getFilter:function(){return this.filter},setFilter:function(t){null!==this.filter?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=t,this.gain.connect(this.filter),this.filter.connect(this.context.destination)},getMasterVolume:function(){return this.gain.gain.value},setMasterVolume:function(t){this.gain.gain.value=t},updateMatrixWorld:function(){var t=new T,e=new A,n=new T,i=new T;return function(r){Yt.prototype.updateMatrixWorld.call(this,r);var o=this.context.listener,a=this.up;this.matrixWorld.decompose(t,e,n),i.set(0,0,-1).applyQuaternion(e),o.setPosition(t.x,t.y,t.z),o.setOrientation(i.x,i.y,i.z,a.x,a.y,a.z)}}()}),gr.prototype=Object.assign(Object.create(Yt.prototype),{constructor:gr,getOutput:function(){return this.gain},setNodeSource:function(t){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=t,this.connect(),this},setBuffer:function(t){return this.source.buffer=t,this.sourceType="buffer",this.autoplay&&this.play(),this},play:function(){if(!0!==this.isPlaying){if(!1!==this.hasPlaybackControl){var t=this.context.createBufferSource();return t.buffer=this.source.buffer,t.loop=this.source.loop,t.onended=this.source.onended,t.start(0,this.startTime),t.playbackRate.value=this.playbackRate,this.isPlaying=!0,this.source=t,this.connect()}console.warn("THREE.Audio: this Audio has no playback control.")}else console.warn("THREE.Audio: Audio is already playing.")},pause:function(){if(!1!==this.hasPlaybackControl)return this.source.stop(),this.startTime=this.context.currentTime,this.isPlaying=!1,this;console.warn("THREE.Audio: this Audio has no playback control.")},stop:function(){if(!1!==this.hasPlaybackControl)return this.source.stop(),this.startTime=0,this.isPlaying=!1,this;console.warn("THREE.Audio: this Audio has no playback control.")},connect:function(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(var t=1,e=this.filters.length;t<e;t++)this.filters[t-1].connect(this.filters[t]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this},disconnect:function(){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(var t=1,e=this.filters.length;t<e;t++)this.filters[t-1].disconnect(this.filters[t]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this},getFilters:function(){return this.filters},setFilters:function(t){return t||(t=[]),!0===this.isPlaying?(this.disconnect(),this.filters=t,this.connect()):this.filters=t,this},getFilter:function(){return this.getFilters()[0]},setFilter:function(t){return this.setFilters(t?[t]:[])},setPlaybackRate:function(t){if(!1!==this.hasPlaybackControl)return this.playbackRate=t,!0===this.isPlaying&&(this.source.playbackRate.value=this.playbackRate),this;console.warn("THREE.Audio: this Audio has no playback control.")},getPlaybackRate:function(){return this.playbackRate},onEnded:function(){this.isPlaying=!1},getLoop:function(){return!1===this.hasPlaybackControl?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.source.loop},setLoop:function(t){!1!==this.hasPlaybackControl?this.source.loop=t:console.warn("THREE.Audio: this Audio has no playback control.")},getVolume:function(){return this.gain.gain.value},setVolume:function(t){return this.gain.gain.value=t,this}}),vr.prototype=Object.assign(Object.create(gr.prototype),{constructor:vr,getOutput:function(){return this.panner},getRefDistance:function(){return this.panner.refDistance},setRefDistance:function(t){this.panner.refDistance=t},getRolloffFactor:function(){return this.panner.rolloffFactor},setRolloffFactor:function(t){this.panner.rolloffFactor=t},getDistanceModel:function(){return this.panner.distanceModel},setDistanceModel:function(t){this.panner.distanceModel=t},getMaxDistance:function(){return this.panner.maxDistance},setMaxDistance:function(t){this.panner.maxDistance=t},updateMatrixWorld:function(){var t=new T;return function(e){Yt.prototype.updateMatrixWorld.call(this,e),t.setFromMatrixPosition(this.matrixWorld),this.panner.setPosition(t.x,t.y,t.z)}}()}),Object.assign(yr.prototype,{getFrequencyData:function(){return this.analyser.getByteFrequencyData(this.data),this.data},getAverageFrequency:function(){for(var t=0,e=this.getFrequencyData(),n=0;n<e.length;n++)t+=e[n];return t/e.length}}),br.prototype={constructor:br,accumulate:function(t,e){var n=this.buffer,i=this.valueSize,r=t*i+i,o=this.cumulativeWeight;if(0===o){for(var a=0;a!==i;++a)n[r+a]=n[a];o=e}else{var s=e/(o+=e);this._mixBufferRegion(n,r,0,s,i)}this.cumulativeWeight=o},apply:function(t){var e=this.valueSize,n=this.buffer,i=t*e+e,r=this.cumulativeWeight,o=this.binding;if(this.cumulativeWeight=0,r<1){var a=3*e;this._mixBufferRegion(n,i,a,1-r,e)}for(var s=e,c=e+e;s!==c;++s)if(n[s]!==n[s+e]){o.setValue(n,i);break}},saveOriginalState:function(){var t=this.binding,e=this.buffer,n=this.valueSize,i=3*n;t.getValue(e,i);for(var r=n,o=i;r!==o;++r)e[r]=e[i+r%n];this.cumulativeWeight=0},restoreOriginalState:function(){var t=3*this.valueSize;this.binding.setValue(this.buffer,t)},_select:function(t,e,n,i,r){if(i>=.5)for(var o=0;o!==r;++o)t[e+o]=t[n+o]},_slerp:function(t,e,n,i,r){A.slerpFlat(t,e,t,e,t,n,i)},_lerp:function(t,e,n,i,r){for(var o=1-i,a=0;a!==r;++a){var s=e+a;t[s]=t[s]*o+t[n+a]*i}}},xr.prototype={constructor:xr,getValue:function(t,e){this.bind(),this.getValue(t,e)},setValue:function(t,e){this.bind(),this.setValue(t,e)},bind:function(){var t=this.node,e=this.parsedPath,n=e.objectName,i=e.propertyName,r=e.propertyIndex;if(t||(t=xr.findNode(this.rootNode,e.nodeName)||this.rootNode,this.node=t),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,t){if(n){var o=e.objectIndex;switch(n){case"materials":if(!t.material)return void console.error("  can not bind to material as node does not have a material",this);if(!t.material.materials)return void console.error("  can not bind to material.materials as node.material does not have a materials array",this);t=t.material.materials;break;case"bones":if(!t.skeleton)return void console.error("  can not bind to bones as node does not have a skeleton",this);t=t.skeleton.bones;for(var a=0;a<t.length;a++)if(t[a].name===o){o=a;break}break;default:if(void 0===t[n])return void console.error("  can not bind to objectName of node, undefined",this);t=t[n]}if(void 0!==o){if(void 0===t[o])return void console.error("  trying to bind to objectIndex of objectName, but is undefined:",this,t);t=t[o]}}var s=t[i];if(void 0!==s){var c=this.Versioning.None;void 0!==t.needsUpdate?(c=this.Versioning.NeedsUpdate,this.targetObject=t):void 0!==t.matrixWorldNeedsUpdate&&(c=this.Versioning.MatrixWorldNeedsUpdate,this.targetObject=t);var l=this.BindingType.Direct;if(void 0!==r){if("morphTargetInfluences"===i){if(!t.geometry)return void console.error("  can not bind to morphTargetInfluences becasuse node does not have a geometry",this);if(!t.geometry.morphTargets)return void console.error("  can not bind to morphTargetInfluences becasuse node does not have a geometry.morphTargets",this);for(a=0;a<this.node.geometry.morphTargets.length;a++)if(t.geometry.morphTargets[a].name===r){r=a;break}}l=this.BindingType.ArrayElement,this.resolvedProperty=s,this.propertyIndex=r}else void 0!==s.fromArray&&void 0!==s.toArray?(l=this.BindingType.HasFromToArray,this.resolvedProperty=s):void 0!==s.length?(l=this.BindingType.EntireArray,this.resolvedProperty=s):this.propertyName=i;this.getValue=this.GetterByBindingType[l],this.setValue=this.SetterByBindingTypeAndVersioning[l][c]}else{var h=e.nodeName;console.error("  trying to update property for track: "+h+"."+i+" but it wasn't found.",t)}}else console.error("  trying to update node for track: "+this.path+" but it wasn't found.")},unbind:function(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}},Object.assign(xr.prototype,{_getValue_unavailable:function(){},_setValue_unavailable:function(){},_getValue_unbound:xr.prototype.getValue,_setValue_unbound:xr.prototype.setValue,BindingType:{Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},Versioning:{None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},GetterByBindingType:[function(t,e){t[e]=this.node[this.propertyName]},function(t,e){for(var n=this.resolvedProperty,i=0,r=n.length;i!==r;++i)t[e++]=n[i]},function(t,e){t[e]=this.resolvedProperty[this.propertyIndex]},function(t,e){this.resolvedProperty.toArray(t,e)}],SetterByBindingTypeAndVersioning:[[function(t,e){this.node[this.propertyName]=t[e]},function(t,e){this.node[this.propertyName]=t[e],this.targetObject.needsUpdate=!0},function(t,e){this.node[this.propertyName]=t[e],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(t,e){for(var n=this.resolvedProperty,i=0,r=n.length;i!==r;++i)n[i]=t[e++]},function(t,e){for(var n=this.resolvedProperty,i=0,r=n.length;i!==r;++i)n[i]=t[e++];this.targetObject.needsUpdate=!0},function(t,e){for(var n=this.resolvedProperty,i=0,r=n.length;i!==r;++i)n[i]=t[e++];this.targetObject.matrixWorldNeedsUpdate=!0}],[function(t,e){this.resolvedProperty[this.propertyIndex]=t[e]},function(t,e){this.resolvedProperty[this.propertyIndex]=t[e],this.targetObject.needsUpdate=!0},function(t,e){this.resolvedProperty[this.propertyIndex]=t[e],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(t,e){this.resolvedProperty.fromArray(t,e)},function(t,e){this.resolvedProperty.fromArray(t,e),this.targetObject.needsUpdate=!0},function(t,e){this.resolvedProperty.fromArray(t,e),this.targetObject.matrixWorldNeedsUpdate=!0}]]}),xr.Composite=function(t,e,n){var i=n||xr.parseTrackName(e);this._targetGroup=t,this._bindings=t.subscribe_(e,i)},xr.Composite.prototype={constructor:xr.Composite,getValue:function(t,e){this.bind();var n=this._targetGroup.nCachedObjects_,i=this._bindings[n];void 0!==i&&i.getValue(t,e)},setValue:function(t,e){for(var n=this._bindings,i=this._targetGroup.nCachedObjects_,r=n.length;i!==r;++i)n[i].setValue(t,e)},bind:function(){for(var t=this._bindings,e=this._targetGroup.nCachedObjects_,n=t.length;e!==n;++e)t[e].bind()},unbind:function(){for(var t=this._bindings,e=this._targetGroup.nCachedObjects_,n=t.length;e!==n;++e)t[e].unbind()}},xr.create=function(t,e,n){return t&&t.isAnimationObjectGroup?new xr.Composite(t,e,n):new xr(t,e,n)},xr.parseTrackName=function(t){var e=/^((?:\w+[\/:])*)(\w+)?(?:\.(\w+)(?:\[(.+)\])?)?\.(\w+)(?:\[(.+)\])?$/.exec(t);if(!e)throw new Error("cannot parse trackName at all: "+t);var n={nodeName:e[2],objectName:e[3],objectIndex:e[4],propertyName:e[5],propertyIndex:e[6]};if(null===n.propertyName||0===n.propertyName.length)throw new Error("can not parse propertyName from trackName: "+t);return n},xr.findNode=function(t,e){if(!e||""===e||"root"===e||"."===e||-1===e||e===t.name||e===t.uuid)return t;if(t.skeleton){var n=function(t){for(var n=0;n<t.bones.length;n++){var i=t.bones[n];if(i.name===e)return i}return null}(t.skeleton);if(n)return n}if(t.children){var i=function(t){for(var n=0;n<t.length;n++){var r=t[n];if(r.name===e||r.uuid===e)return r;var o=i(r.children);if(o)return o}return null},r=i(t.children);if(r)return r}return null},wr.prototype={constructor:wr,isAnimationObjectGroup:!0,add:function(t){for(var e=this._objects,n=e.length,i=this.nCachedObjects_,r=this._indicesByUUID,o=this._paths,a=this._parsedPaths,s=this._bindings,c=s.length,l=0,h=arguments.length;l!==h;++l){var u=arguments[l],d=u.uuid,p=r[d];if(void 0===p){p=n++,r[d]=p,e.push(u);for(var f=0,m=c;f!==m;++f)s[f].push(new xr(u,o[f],a[f]))}else if(p<i){var g=e[p],v=--i,y=e[v];for(r[y.uuid]=p,e[p]=y,r[d]=v,e[v]=u,f=0,m=c;f!==m;++f){var b=s[f],x=b[v],w=b[p];b[p]=x,void 0===w&&(w=new xr(u,o[f],a[f])),b[v]=w}}else e[p]!==g&&console.error("Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes...")}this.nCachedObjects_=i},remove:function(t){for(var e=this._objects,n=this.nCachedObjects_,i=this._indicesByUUID,r=this._bindings,o=r.length,a=0,s=arguments.length;a!==s;++a){var c=arguments[a],l=c.uuid,h=i[l];if(void 0!==h&&h>=n){var u=n++,d=e[u];i[d.uuid]=h,e[h]=d,i[l]=u,e[u]=c;for(var p=0,f=o;p!==f;++p){var m=r[p],g=m[u],v=m[h];m[h]=g,m[u]=v}}}this.nCachedObjects_=n},uncache:function(t){for(var e=this._objects,n=e.length,i=this.nCachedObjects_,r=this._indicesByUUID,o=this._bindings,a=o.length,s=0,c=arguments.length;s!==c;++s){var l=arguments[s],h=l.uuid,u=r[h];if(void 0!==u)if(delete r[h],u<i){var d=--i,p=e[d],f=e[b=--n];r[p.uuid]=u,e[u]=p,r[f.uuid]=d,e[d]=f,e.pop();for(var m=0,g=a;m!==g;++m){var v=(x=o[m])[d],y=x[b];x[u]=v,x[d]=y,x.pop()}}else{var b;for(r[(f=e[b=--n]).uuid]=u,e[u]=f,e.pop(),m=0,g=a;m!==g;++m){var x;(x=o[m])[u]=x[b],x.pop()}}}this.nCachedObjects_=i},subscribe_:function(t,e){var n=this._bindingsIndicesByPath,i=n[t],r=this._bindings;if(void 0!==i)return r[i];var o=this._paths,a=this._parsedPaths,s=this._objects,c=s.length,l=this.nCachedObjects_,h=new Array(c);i=r.length,n[t]=i,o.push(t),a.push(e),r.push(h);for(var u=l,d=s.length;u!==d;++u){var p=s[u];h[u]=new xr(p,t,e)}return h},unsubscribe_:function(t){var e=this._bindingsIndicesByPath,n=e[t];if(void 0!==n){var i=this._paths,r=this._parsedPaths,o=this._bindings,a=o.length-1,s=o[a];e[t[a]]=n,o[n]=s,o.pop(),r[n]=r[a],r.pop(),i[n]=i[a],i.pop()}}},_r.prototype={constructor:_r,play:function(){return this._mixer._activateAction(this),this},stop:function(){return this._mixer._deactivateAction(this),this.reset()},reset:function(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()},isRunning:function(){return this.enabled&&!this.paused&&0!==this.timeScale&&null===this._startTime&&this._mixer._isActiveAction(this)},isScheduled:function(){return this._mixer._isActiveAction(this)},startAt:function(t){return this._startTime=t,this},setLoop:function(t,e){return this.loop=t,this.repetitions=e,this},setEffectiveWeight:function(t){return this.weight=t,this._effectiveWeight=this.enabled?t:0,this.stopFading()},getEffectiveWeight:function(){return this._effectiveWeight},fadeIn:function(t){return this._scheduleFading(t,0,1)},fadeOut:function(t){return this._scheduleFading(t,1,0)},crossFadeFrom:function(t,e,n){if(t.fadeOut(e),this.fadeIn(e),n){var i=this._clip.duration,r=t._clip.duration,o=r/i,a=i/r;t.warp(1,o,e),this.warp(a,1,e)}return this},crossFadeTo:function(t,e,n){return t.crossFadeFrom(this,e,n)},stopFading:function(){var t=this._weightInterpolant;return null!==t&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(t)),this},setEffectiveTimeScale:function(t){return this.timeScale=t,this._effectiveTimeScale=this.paused?0:t,this.stopWarping()},getEffectiveTimeScale:function(){return this._effectiveTimeScale},setDuration:function(t){return this.timeScale=this._clip.duration/t,this.stopWarping()},syncWith:function(t){return this.time=t.time,this.timeScale=t.timeScale,this.stopWarping()},halt:function(t){return this.warp(this._effectiveTimeScale,0,t)},warp:function(t,e,n){var i=this._mixer,r=i.time,o=this._timeScaleInterpolant,a=this.timeScale;null===o&&(o=i._lendControlInterpolant(),this._timeScaleInterpolant=o);var s=o.parameterPositions,c=o.sampleValues;return s[0]=r,s[1]=r+n,c[0]=t/a,c[1]=e/a,this},stopWarping:function(){var t=this._timeScaleInterpolant;return null!==t&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(t)),this},getMixer:function(){return this._mixer},getClip:function(){return this._clip},getRoot:function(){return this._localRoot||this._mixer._root},_update:function(t,e,n,i){var r=this._startTime;if(null!==r){var o=(t-r)*n;if(o<0||0===n)return;this._startTime=null,e=n*o}e*=this._updateTimeScale(t);var a=this._updateTime(e),s=this._updateWeight(t);if(s>0)for(var c=this._interpolants,l=this._propertyBindings,h=0,u=c.length;h!==u;++h)c[h].evaluate(a),l[h].accumulate(i,s)},_updateWeight:function(t){var e=0;if(this.enabled){e=this.weight;var n=this._weightInterpolant;if(null!==n){var i=n.evaluate(t)[0];e*=i,t>n.parameterPositions[1]&&(this.stopFading(),0===i&&(this.enabled=!1))}}return this._effectiveWeight=e,e},_updateTimeScale:function(t){var e=0;if(!this.paused){e=this.timeScale;var n=this._timeScaleInterpolant;null!==n&&(e*=n.evaluate(t)[0],t>n.parameterPositions[1]&&(this.stopWarping(),0===e?this.paused=!0:this.timeScale=e))}return this._effectiveTimeScale=e,e},_updateTime:function(t){var e=this.time+t;if(0===t)return e;var n=this._clip.duration,i=this.loop,r=this._loopCount;if(2200===i){-1===r&&(this.loopCount=0,this._setEndings(!0,!0,!1));t:{if(e>=n)e=n;else{if(!(e<0))break t;e=0}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this._mixer.dispatchEvent({type:"finished",action:this,direction:t<0?-1:1})}}else{var o=2202===i;if(-1===r&&(t>=0?(r=0,this._setEndings(!0,0===this.repetitions,o)):this._setEndings(0===this.repetitions,!0,o)),e>=n||e<0){var a=Math.floor(e/n);e-=n*a,r+=Math.abs(a);var s=this.repetitions-r;if(s<0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,e=t>0?n:0,this._mixer.dispatchEvent({type:"finished",action:this,direction:t>0?1:-1});else{if(0===s){var c=t<0;this._setEndings(c,!c,o)}else this._setEndings(!1,!1,o);this._loopCount=r,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:a})}}if(o&&1==(1&r))return this.time=e,n-e}return this.time=e,e},_setEndings:function(t,e,n){var i=this._interpolantSettings;n?(i.endingStart=2401,i.endingEnd=2401):(i.endingStart=t?this.zeroSlopeAtStart?2401:2400:2402,i.endingEnd=e?this.zeroSlopeAtEnd?2401:2400:2402)},_scheduleFading:function(t,e,n){var i=this._mixer,r=i.time,o=this._weightInterpolant;null===o&&(o=i._lendControlInterpolant(),this._weightInterpolant=o);var a=o.parameterPositions,s=o.sampleValues;return a[0]=r,s[0]=e,a[1]=r+t,s[1]=n,this}},Object.assign(Sr.prototype,e.prototype,{clipAction:function(t,e){var n=e||this._root,i=n.uuid,r="string"==typeof t?Di.findByName(n,t):t,o=null!==r?r.uuid:t,a=this._actionsByClip[o],s=null;if(void 0!==a){var c=a.actionByRoot[i];if(void 0!==c)return c;s=a.knownActions[0],null===r&&(r=s._clip)}if(null===r)return null;var l=new _r(this,r,e);return this._bindAction(l,s),this._addInactiveAction(l,o,i),l},existingAction:function(t,e){var n=e||this._root,i=n.uuid,r="string"==typeof t?Di.findByName(n,t):t,o=r?r.uuid:t,a=this._actionsByClip[o];return void 0!==a&&a.actionByRoot[i]||null},stopAllAction:function(){var t=this._actions,e=this._nActiveActions,n=this._bindings,i=this._nActiveBindings;this._nActiveActions=0,this._nActiveBindings=0;for(var r=0;r!==e;++r)t[r].reset();for(r=0;r!==i;++r)n[r].useCount=0;return this},update:function(t){t*=this.timeScale;for(var e=this._actions,n=this._nActiveActions,i=this.time+=t,r=Math.sign(t),o=this._accuIndex^=1,a=0;a!==n;++a){var s=e[a];s.enabled&&s._update(i,t,r,o)}var c=this._bindings,l=this._nActiveBindings;for(a=0;a!==l;++a)c[a].apply(o);return this},getRoot:function(){return this._root},uncacheClip:function(t){var e=this._actions,n=t.uuid,i=this._actionsByClip,r=i[n];if(void 0!==r){for(var o=r.knownActions,a=0,s=o.length;a!==s;++a){var c=o[a];this._deactivateAction(c);var l=c._cacheIndex,h=e[e.length-1];c._cacheIndex=null,c._byClipCacheIndex=null,h._cacheIndex=l,e[l]=h,e.pop(),this._removeInactiveBindingsForAction(c)}delete i[n]}},uncacheRoot:function(t){var e=t.uuid,n=this._actionsByClip;for(var i in n){var r=n[i].actionByRoot[e];void 0!==r&&(this._deactivateAction(r),this._removeInactiveAction(r))}var o=this._bindingsByRootAndName[e];if(void 0!==o)for(var a in o){var s=o[a];s.restoreOriginalState(),this._removeInactiveBinding(s)}},uncacheAction:function(t,e){var n=this.existingAction(t,e);null!==n&&(this._deactivateAction(n),this._removeInactiveAction(n))}}),Object.assign(Sr.prototype,{_bindAction:function(t,e){var n=t._localRoot||this._root,i=t._clip.tracks,r=i.length,o=t._propertyBindings,a=t._interpolants,s=n.uuid,c=this._bindingsByRootAndName,l=c[s];void 0===l&&(l={},c[s]=l);for(var h=0;h!==r;++h){var u=i[h],d=u.name,p=l[d];if(void 0!==p)o[h]=p;else{if(void 0!==(p=o[h])){null===p._cacheIndex&&(++p.referenceCount,this._addInactiveBinding(p,s,d));continue}var f=e&&e._propertyBindings[h].binding.parsedPath;++(p=new br(xr.create(n,d,f),u.ValueTypeName,u.getValueSize())).referenceCount,this._addInactiveBinding(p,s,d),o[h]=p}a[h].resultBuffer=p.buffer}},_activateAction:function(t){if(!this._isActiveAction(t)){if(null===t._cacheIndex){var e=(t._localRoot||this._root).uuid,n=t._clip.uuid,i=this._actionsByClip[n];this._bindAction(t,i&&i.knownActions[0]),this._addInactiveAction(t,n,e)}for(var r=t._propertyBindings,o=0,a=r.length;o!==a;++o){var s=r[o];0==s.useCount++&&(this._lendBinding(s),s.saveOriginalState())}this._lendAction(t)}},_deactivateAction:function(t){if(this._isActiveAction(t)){for(var e=t._propertyBindings,n=0,i=e.length;n!==i;++n){var r=e[n];0==--r.useCount&&(r.restoreOriginalState(),this._takeBackBinding(r))}this._takeBackAction(t)}},_initMemoryManager:function(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;var t=this;this.stats={actions:{get total(){return t._actions.length},get inUse(){return t._nActiveActions}},bindings:{get total(){return t._bindings.length},get inUse(){return t._nActiveBindings}},controlInterpolants:{get total(){return t._controlInterpolants.length},get inUse(){return t._nActiveControlInterpolants}}}},_isActiveAction:function(t){var e=t._cacheIndex;return null!==e&&e<this._nActiveActions},_addInactiveAction:function(t,e,n){var i=this._actions,r=this._actionsByClip,o=r[e];if(void 0===o)o={knownActions:[t],actionByRoot:{}},t._byClipCacheIndex=0,r[e]=o;else{var a=o.knownActions;t._byClipCacheIndex=a.length,a.push(t)}t._cacheIndex=i.length,i.push(t),o.actionByRoot[n]=t},_removeInactiveAction:function(t){var e=this._actions,n=e[e.length-1],i=t._cacheIndex;n._cacheIndex=i,e[i]=n,e.pop(),t._cacheIndex=null;var r=t._clip.uuid,o=this._actionsByClip,a=o[r],s=a.knownActions,c=s[s.length-1],l=t._byClipCacheIndex;c._byClipCacheIndex=l,s[l]=c,s.pop(),t._byClipCacheIndex=null,delete a.actionByRoot[(e._localRoot||this._root).uuid],0===s.length&&delete o[r],this._removeInactiveBindingsForAction(t)},_removeInactiveBindingsForAction:function(t){for(var e=t._propertyBindings,n=0,i=e.length;n!==i;++n){var r=e[n];0==--r.referenceCount&&this._removeInactiveBinding(r)}},_lendAction:function(t){var e=this._actions,n=t._cacheIndex,i=this._nActiveActions++,r=e[i];t._cacheIndex=i,e[i]=t,r._cacheIndex=n,e[n]=r},_takeBackAction:function(t){var e=this._actions,n=t._cacheIndex,i=--this._nActiveActions,r=e[i];t._cacheIndex=i,e[i]=t,r._cacheIndex=n,e[n]=r},_addInactiveBinding:function(t,e,n){var i=this._bindingsByRootAndName,r=i[e],o=this._bindings;void 0===r&&(r={},i[e]=r),r[n]=t,t._cacheIndex=o.length,o.push(t)},_removeInactiveBinding:function(t){var e=this._bindings,n=t.binding,i=n.rootNode.uuid,r=n.path,o=this._bindingsByRootAndName,a=o[i],s=e[e.length-1],c=t._cacheIndex;s._cacheIndex=c,e[c]=s,e.pop(),delete a[r];t:{for(var l in a)break t;delete o[i]}},_lendBinding:function(t){var e=this._bindings,n=t._cacheIndex,i=this._nActiveBindings++,r=e[i];t._cacheIndex=i,e[i]=t,r._cacheIndex=n,e[n]=r},_takeBackBinding:function(t){var e=this._bindings,n=t._cacheIndex,i=--this._nActiveBindings,r=e[i];t._cacheIndex=i,e[i]=t,r._cacheIndex=n,e[n]=r},_lendControlInterpolant:function(){var t=this._controlInterpolants,e=this._nActiveControlInterpolants++,n=t[e];return void 0===n&&((n=new Si(new Float32Array(2),new Float32Array(2),1,this._controlInterpolantsResultBuffer)).__cacheIndex=e,t[e]=n),n},_takeBackControlInterpolant:function(t){var e=this._controlInterpolants,n=t.__cacheIndex,i=--this._nActiveControlInterpolants,r=e[i];t.__cacheIndex=i,e[i]=t,r.__cacheIndex=n,e[n]=r},_controlInterpolantsResultBuffer:new Float32Array(1)}),Er.prototype={constructor:Er,onUpdate:function(t){return this.dynamic=!0,this.onUpdateCallback=t,this}},Ar.prototype=Object.create(pe.prototype),Ar.prototype.constructor=Ar,Ar.prototype.isInstancedBufferGeometry=!0,Ar.prototype.addGroup=function(t,e,n){this.groups.push({start:t,count:e,instances:n})},Ar.prototype.copy=function(t){var e=t.index;null!==e&&this.setIndex(e.clone());var n=t.attributes;for(var i in n){var r=n[i];this.addAttribute(i,r.clone())}for(var o=t.groups,a=0,s=o.length;a<s;a++){var c=o[a];this.addGroup(c.start,c.count,c.instances)}return this},Tr.prototype={constructor:Tr,isInterleavedBufferAttribute:!0,get count(){return this.data.count},get array(){return this.data.array},setX:function(t,e){return this.data.array[t*this.data.stride+this.offset]=e,this},setY:function(t,e){return this.data.array[t*this.data.stride+this.offset+1]=e,this},setZ:function(t,e){return this.data.array[t*this.data.stride+this.offset+2]=e,this},setW:function(t,e){return this.data.array[t*this.data.stride+this.offset+3]=e,this},getX:function(t){return this.data.array[t*this.data.stride+this.offset]},getY:function(t){return this.data.array[t*this.data.stride+this.offset+1]},getZ:function(t){return this.data.array[t*this.data.stride+this.offset+2]},getW:function(t){return this.data.array[t*this.data.stride+this.offset+3]},setXY:function(t,e,n){return t=t*this.data.stride+this.offset,this.data.array[t+0]=e,this.data.array[t+1]=n,this},setXYZ:function(t,e,n,i){return t=t*this.data.stride+this.offset,this.data.array[t+0]=e,this.data.array[t+1]=n,this.data.array[t+2]=i,this},setXYZW:function(t,e,n,i,r){return t=t*this.data.stride+this.offset,this.data.array[t+0]=e,this.data.array[t+1]=n,this.data.array[t+2]=i,this.data.array[t+3]=r,this}},Mr.prototype={constructor:Mr,isInterleavedBuffer:!0,set needsUpdate(t){!0===t&&this.version++},setDynamic:function(t){return this.dynamic=t,this},copy:function(t){return this.array=new t.array.constructor(t.array),this.count=t.count,this.stride=t.stride,this.dynamic=t.dynamic,this},copyAt:function(t,e,n){t*=this.stride,n*=e.stride;for(var i=0,r=this.stride;i<r;i++)this.array[t+i]=e.array[n+i];return this},set:function(t,e){return void 0===e&&(e=0),this.array.set(t,e),this},clone:function(){return(new this.constructor).copy(this)}},Cr.prototype=Object.create(Mr.prototype),Cr.prototype.constructor=Cr,Cr.prototype.isInstancedInterleavedBuffer=!0,Cr.prototype.copy=function(t){return Mr.prototype.copy.call(this,t),this.meshPerAttribute=t.meshPerAttribute,this},Pr.prototype=Object.create(oe.prototype),Pr.prototype.constructor=Pr,Pr.prototype.isInstancedBufferAttribute=!0,Pr.prototype.copy=function(t){return oe.prototype.copy.call(this,t),this.meshPerAttribute=t.meshPerAttribute,this},Rr.prototype={constructor:Rr,linePrecision:1,set:function(t,e){this.ray.set(t,e)},setFromCamera:function(t,e){e&&e.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(e.matrixWorld),this.ray.direction.set(t.x,t.y,.5).unproject(e).sub(this.ray.origin).normalize()):e&&e.isOrthographicCamera?(this.ray.origin.set(t.x,t.y,(e.near+e.far)/(e.near-e.far)).unproject(e),this.ray.direction.set(0,0,-1).transformDirection(e.matrixWorld)):console.error("THREE.Raycaster: Unsupported camera type.")},intersectObject:function(t,e){var n=[];return kr(t,this,n,e),n.sort(Lr),n},intersectObjects:function(t,e){var n=[];if(!1===Array.isArray(t))return console.warn("THREE.Raycaster.intersectObjects: objects is not an Array."),n;for(var i=0,r=t.length;i<r;i++)kr(t[i],this,n,e);return n.sort(Lr),n}},Ir.prototype={constructor:Ir,start:function(){this.startTime=(performance||Date).now(),this.oldTime=this.startTime,this.running=!0},stop:function(){this.getElapsedTime(),this.running=!1},getElapsedTime:function(){return this.getDelta(),this.elapsedTime},getDelta:function(){var t=0;if(this.autoStart&&!this.running&&this.start(),this.running){var e=(performance||Date).now();t=(e-this.oldTime)/1e3,this.oldTime=e,this.elapsedTime+=t}return t}},Dr.prototype={constructor:Dr,set:function(t,e,n){return this.radius=t,this.phi=e,this.theta=n,this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.radius.copy(t.radius),this.phi.copy(t.phi),this.theta.copy(t.theta),this},makeSafe:function(){return this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi)),this},setFromVector3:function(e){return this.radius=e.length(),0===this.radius?(this.theta=0,this.phi=0):(this.theta=Math.atan2(e.x,e.z),this.phi=Math.acos(t.Math.clamp(e.y/this.radius,-1,1))),this}},Or.prototype=Object.create(fe.prototype),Or.prototype.constructor=Or,Or.prototype.createAnimation=function(t,e,n,i){var r={start:e,end:n,length:n-e+1,fps:i,duration:(n-e)/i,lastFrame:0,currentFrame:0,active:!1,time:0,direction:1,weight:1,directionBackwards:!1,mirroredLoop:!1};this.animationsMap[t]=r,this.animationsList.push(r)},Or.prototype.autoCreateAnimations=function(t){for(var e,n=/([a-z]+)_?(\d+)/i,i={},r=this.geometry,o=0,a=r.morphTargets.length;o<a;o++){var s=r.morphTargets[o].name.match(n);s&&s.length>1&&(i[c=s[1]]||(i[c]={start:1/0,end:-1/0}),o<(l=i[c]).start&&(l.start=o),o>l.end&&(l.end=o),e||(e=c))}for(var c in i){var l=i[c];this.createAnimation(c,l.start,l.end,t)}this.firstAnimation=e},Or.prototype.setAnimationDirectionForward=function(t){var e=this.animationsMap[t];e&&(e.direction=1,e.directionBackwards=!1)},Or.prototype.setAnimationDirectionBackward=function(t){var e=this.animationsMap[t];e&&(e.direction=-1,e.directionBackwards=!0)},Or.prototype.setAnimationFPS=function(t,e){var n=this.animationsMap[t];n&&(n.fps=e,n.duration=(n.end-n.start)/n.fps)},Or.prototype.setAnimationDuration=function(t,e){var n=this.animationsMap[t];n&&(n.duration=e,n.fps=(n.end-n.start)/n.duration)},Or.prototype.setAnimationWeight=function(t,e){var n=this.animationsMap[t];n&&(n.weight=e)},Or.prototype.setAnimationTime=function(t,e){var n=this.animationsMap[t];n&&(n.time=e)},Or.prototype.getAnimationTime=function(t){var e=0,n=this.animationsMap[t];return n&&(e=n.time),e},Or.prototype.getAnimationDuration=function(t){var e=-1,n=this.animationsMap[t];return n&&(e=n.duration),e},Or.prototype.playAnimation=function(t){var e=this.animationsMap[t];e?(e.time=0,e.active=!0):console.warn("THREE.MorphBlendMesh: animation["+t+"] undefined in .playAnimation()")},Or.prototype.stopAnimation=function(t){var e=this.animationsMap[t];e&&(e.active=!1)},Or.prototype.update=function(e){for(var n=0,i=this.animationsList.length;n<i;n++){var r=this.animationsList[n];if(r.active){var o=r.duration/r.length;r.time+=r.direction*e,r.mirroredLoop?(r.time>r.duration||r.time<0)&&(r.direction*=-1,r.time>r.duration&&(r.time=r.duration,r.directionBackwards=!0),r.time<0&&(r.time=0,r.directionBackwards=!1)):(r.time=r.time%r.duration,r.time<0&&(r.time+=r.duration));var a=r.start+t.Math.clamp(Math.floor(r.time/o),0,r.length-1),s=r.weight;a!==r.currentFrame&&(this.morphTargetInfluences[r.lastFrame]=0,this.morphTargetInfluences[r.currentFrame]=1*s,this.morphTargetInfluences[a]=0,r.lastFrame=r.currentFrame,r.currentFrame=a);var c=r.time%o/o;r.directionBackwards&&(c=1-c),r.currentFrame!==r.lastFrame?(this.morphTargetInfluences[r.currentFrame]=c*s,this.morphTargetInfluences[r.lastFrame]=(1-c)*s):this.morphTargetInfluences[r.currentFrame]=s}}},Fr.prototype=Object.create(Yt.prototype),Fr.prototype.constructor=Fr,Fr.prototype.isImmediateRenderObject=!0,Nr.prototype=Object.create(on.prototype),Nr.prototype.constructor=Nr,Nr.prototype.update=function(){var t=new T,e=new T,n=new zt;return function(){var i=["a","b","c"];this.object.updateMatrixWorld(!0),n.getNormalMatrix(this.object.matrixWorld);var r=this.object.matrixWorld,o=this.geometry.attributes.position,a=this.object.geometry;if(a&&a.isGeometry)for(var s=a.vertices,c=a.faces,l=0,h=0,u=c.length;h<u;h++)for(var d=c[h],p=0,f=d.vertexNormals.length;p<f;p++){var m=s[d[i[p]]],g=d.vertexNormals[p];t.copy(m).applyMatrix4(r),e.copy(g).applyMatrix3(n).normalize().multiplyScalar(this.size).add(t),o.setXYZ(l,t.x,t.y,t.z),l+=1,o.setXYZ(l,e.x,e.y,e.z),l+=1}else if(a&&a.isBufferGeometry){var v=a.attributes.position,y=a.attributes.normal;for(l=0,p=0,f=v.count;p<f;p++)t.set(v.getX(p),v.getY(p),v.getZ(p)).applyMatrix4(r),e.set(y.getX(p),y.getY(p),y.getZ(p)),e.applyMatrix3(n).normalize().multiplyScalar(this.size).add(t),o.setXYZ(l,t.x,t.y,t.z),l+=1,o.setXYZ(l,e.x,e.y,e.z),l+=1}return o.needsUpdate=!0,this}}(),Ur.prototype=Object.create(Yt.prototype),Ur.prototype.constructor=Ur,Ur.prototype.dispose=function(){this.cone.geometry.dispose(),this.cone.material.dispose()},Ur.prototype.update=(Yi=new T,Zi=new T,function(){var t=this.light.distance?this.light.distance:1e3,e=t*Math.tan(this.light.angle);this.cone.scale.set(e,e,t),Yi.setFromMatrixPosition(this.light.matrixWorld),Zi.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(Zi.sub(Yi)),this.cone.material.color.copy(this.light.color).multiplyScalar(this.light.intensity)}),jr.prototype=Object.create(on.prototype),jr.prototype.constructor=jr,jr.prototype.getBoneList=function(t){var e=[];t&&t.isBone&&e.push(t);for(var n=0;n<t.children.length;n++)e.push.apply(e,this.getBoneList(t.children[n]));return e},jr.prototype.update=function(){for(var t=this.geometry,e=(new M).getInverse(this.root.matrixWorld),n=new M,i=0,r=0;r<this.bones.length;r++){var o=this.bones[r];o.parent&&o.parent.isBone&&(n.multiplyMatrices(e,o.matrixWorld),t.vertices[i].setFromMatrixPosition(n),n.multiplyMatrices(e,o.parent.matrixWorld),t.vertices[i+1].setFromMatrixPosition(n),i+=2)}t.verticesNeedUpdate=!0,t.computeBoundingSphere()},Br.prototype=Object.create(fe.prototype),Br.prototype.constructor=Br,Br.prototype.dispose=function(){this.geometry.dispose(),this.material.dispose()},Br.prototype.update=function(){this.material.color.copy(this.light.color).multiplyScalar(this.light.intensity)},zr.prototype=Object.create(Yt.prototype),zr.prototype.constructor=zr,zr.prototype.dispose=function(){this.lightSphere.geometry.dispose(),this.lightSphere.material.dispose()},zr.prototype.update=function(){var t=new T;return function(){this.colors[0].copy(this.light.color).multiplyScalar(this.light.intensity),this.colors[1].copy(this.light.groundColor).multiplyScalar(this.light.intensity),this.lightSphere.lookAt(t.setFromMatrixPosition(this.light.matrixWorld).negate()),this.lightSphere.geometry.colorsNeedUpdate=!0}}(),Hr.prototype=Object.create(on.prototype),Hr.prototype.constructor=Hr,Hr.prototype.setColors=function(){console.error("THREE.GridHelper: setColors() has been deprecated, pass them in the constructor instead.")},Gr.prototype=Object.create(on.prototype),Gr.prototype.constructor=Gr,Gr.prototype.update=function(){var t=new T,e=new T,n=new zt;return function(){this.object.updateMatrixWorld(!0),n.getNormalMatrix(this.object.matrixWorld);for(var i=this.object.matrixWorld,r=this.geometry.attributes.position,o=this.object.geometry,a=o.vertices,s=o.faces,c=0,l=0,h=s.length;l<h;l++){var u=s[l],d=u.normal;t.copy(a[u.a]).add(a[u.b]).add(a[u.c]).divideScalar(3).applyMatrix4(i),e.copy(d).applyMatrix3(n).normalize().multiplyScalar(this.size).add(t),r.setXYZ(c,t.x,t.y,t.z),c+=1,r.setXYZ(c,e.x,e.y,e.z),c+=1}return r.needsUpdate=!0,this}}(),Vr.prototype=Object.create(Yt.prototype),Vr.prototype.constructor=Vr,Vr.prototype.dispose=function(){var t=this.children[0],e=this.children[1];t.geometry.dispose(),t.material.dispose(),e.geometry.dispose(),e.material.dispose()},Vr.prototype.update=function(){var t=new T,e=new T,n=new T;return function(){t.setFromMatrixPosition(this.light.matrixWorld),e.setFromMatrixPosition(this.light.target.matrixWorld),n.subVectors(e,t);var i=this.children[0],r=this.children[1];i.lookAt(n),i.material.color.copy(this.light.color).multiplyScalar(this.light.intensity),r.lookAt(n),r.scale.z=n.length()}}(),Wr.prototype=Object.create(on.prototype),Wr.prototype.constructor=Wr,Wr.prototype.update=function(){var t,e,n=new T,i=new ve;function r(r,o,a,s){n.set(o,a,s).unproject(i);var c=e[r];if(void 0!==c)for(var l=0,h=c.length;l<h;l++)t.vertices[c[l]].copy(n)}return function(){t=this.geometry,e=this.pointMap,i.projectionMatrix.copy(this.camera.projectionMatrix),r("c",0,0,-1),r("t",0,0,1),r("n1",-1,-1,-1),r("n2",1,-1,-1),r("n3",-1,1,-1),r("n4",1,1,-1),r("f1",-1,-1,1),r("f2",1,-1,1),r("f3",-1,1,1),r("f4",1,1,1),r("u1",.7,1.1,-1),r("u2",-.7,1.1,-1),r("u3",0,2,-1),r("cf1",-1,0,1),r("cf2",1,0,1),r("cf3",0,-1,1),r("cf4",0,1,1),r("cn1",-1,0,-1),r("cn2",1,0,-1),r("cn3",0,-1,-1),r("cn4",0,1,-1),t.verticesNeedUpdate=!0}}(),Xr.prototype=Object.create(fe.prototype),Xr.prototype.constructor=Xr,Xr.prototype.update=function(){this.box.setFromObject(this.object),this.box.size(this.scale),this.box.getCenter(this.position)},qr.prototype=Object.create(on.prototype),qr.prototype.constructor=qr,qr.prototype.update=function(){var t=new jt;return function(e){if(e&&e.isBox3?t.copy(e):t.setFromObject(e),!t.isEmpty()){var n=t.min,i=t.max,r=this.geometry.attributes.position,o=r.array;o[0]=i.x,o[1]=i.y,o[2]=i.z,o[3]=n.x,o[4]=i.y,o[5]=i.z,o[6]=n.x,o[7]=n.y,o[8]=i.z,o[9]=i.x,o[10]=n.y,o[11]=i.z,o[12]=i.x,o[13]=i.y,o[14]=n.z,o[15]=n.x,o[16]=i.y,o[17]=n.z,o[18]=n.x,o[19]=n.y,o[20]=n.z,o[21]=i.x,o[22]=n.y,o[23]=n.z,r.needsUpdate=!0,this.geometry.computeBoundingSphere()}}}();var Yr=new pe;Yr.addAttribute("position",new ce([0,0,0,0,1,0],3));var Zr,$r,Qr=new Fn(0,.5,1,5,1);function Jr(t,e,n,i,r,o){Yt.call(this),void 0===i&&(i=16776960),void 0===n&&(n=1),void 0===r&&(r=.2*n),void 0===o&&(o=.2*r),this.position.copy(e),this.line=new rn(Yr,new nn({color:i})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new fe(Qr,new re({color:i})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(t),this.setLength(n,r,o)}function Kr(t){t=t||1;var e=new Float32Array([0,0,0,t,0,0,0,0,0,0,t,0,0,0,0,0,0,t]),n=new Float32Array([1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1]),i=new pe;i.addAttribute("position",new oe(e,3)),i.addAttribute("color",new oe(n,3));var r=new nn({vertexColors:2});on.call(this,i,r)}function to(e){console.warn("THREE.ClosedSplineCurve3 has been deprecated. Please use THREE.CatmullRomCurve3."),t.CatmullRomCurve3.call(this,e),this.type="catmullrom",this.closed=!0}Qr.translate(0,-.5,0),Jr.prototype=Object.create(Yt.prototype),Jr.prototype.constructor=Jr,Jr.prototype.setDirection=($r=new T,function(t){t.y>.99999?this.quaternion.set(0,0,0,1):t.y<-.99999?this.quaternion.set(1,0,0,0):($r.set(t.z,0,-t.x).normalize(),Zr=Math.acos(t.y),this.quaternion.setFromAxisAngle($r,Zr))}),Jr.prototype.setLength=function(t,e,n){void 0===e&&(e=.2*t),void 0===n&&(n=.2*e),this.line.scale.set(1,Math.max(0,t-e),1),this.line.updateMatrix(),this.cone.scale.set(n,e,n),this.cone.position.y=t,this.cone.updateMatrix()},Jr.prototype.setColor=function(t){this.line.material.color.copy(t),this.cone.material.color.copy(t)},Kr.prototype=Object.create(on.prototype),Kr.prototype.constructor=Kr,t.CatmullRomCurve3=function(){var t=new T,e=new r,n=new r,i=new r;function r(){}return r.prototype.init=function(t,e,n,i){this.c0=t,this.c1=n,this.c2=-3*t+3*e-2*n-i,this.c3=2*t-2*e+n+i},r.prototype.initNonuniformCatmullRom=function(t,e,n,i,r,o,a){var s=(e-t)/r-(n-t)/(r+o)+(n-e)/o,c=(n-e)/o-(i-e)/(o+a)+(i-n)/a;s*=o,c*=o,this.init(e,n,s,c)},r.prototype.initCatmullRom=function(t,e,n,i,r){this.init(e,n,r*(n-t),r*(i-e))},r.prototype.calc=function(t){var e=t*t,n=e*t;return this.c0+this.c1*t+this.c2*e+this.c3*n},Bi.create((function(t){this.points=t||[],this.closed=!1}),(function(r){var o,a,s,c,l,h,u,d,p=this.points;if((c=p.length)<2&&console.log("duh, you need at least 2 points"),s=(o=(c-(this.closed?0:1))*r)-(a=Math.floor(o)),this.closed?a+=a>0?0:(Math.floor(Math.abs(a)/p.length)+1)*p.length:0===s&&a===c-1&&(a=c-2,s=1),this.closed||a>0?l=p[(a-1)%c]:(t.subVectors(p[0],p[1]).add(p[0]),l=t),h=p[a%c],u=p[(a+1)%c],this.closed||a+2<c?d=p[(a+2)%c]:(t.subVectors(p[c-1],p[c-2]).add(p[c-1]),d=t),void 0===this.type||"centripetal"===this.type||"chordal"===this.type){var f="chordal"===this.type?.5:.25,m=Math.pow(l.distanceToSquared(h),f),g=Math.pow(h.distanceToSquared(u),f),v=Math.pow(u.distanceToSquared(d),f);g<1e-4&&(g=1),m<1e-4&&(m=g),v<1e-4&&(v=g),e.initNonuniformCatmullRom(l.x,h.x,u.x,d.x,m,g,v),n.initNonuniformCatmullRom(l.y,h.y,u.y,d.y,m,g,v),i.initNonuniformCatmullRom(l.z,h.z,u.z,d.z,m,g,v)}else if("catmullrom"===this.type){var y=void 0!==this.tension?this.tension:.5;e.initCatmullRom(l.x,h.x,u.x,d.x,y),n.initCatmullRom(l.y,h.y,u.y,d.y,y),i.initCatmullRom(l.z,h.z,u.z,d.z,y)}return new T(e.calc(s),n.calc(s),i.calc(s))}))}(),to.prototype=Object.create(t.CatmullRomCurve3.prototype);var eo=Bi.create((function(t){console.warn("THREE.SplineCurve3 will be deprecated. Please use THREE.CatmullRomCurve3"),this.points=void 0===t?[]:t}),(function(e){var n=this.points,i=(n.length-1)*e,r=Math.floor(i),o=i-r,a=n[0==r?r:r-1],s=n[r],c=n[r>n.length-2?n.length-1:r+1],l=n[r>n.length-3?n.length-1:r+2],h=t.CurveUtils.interpolate;return new T(h(a.x,s.x,c.x,l.x,o),h(a.y,s.y,c.y,l.y,o),h(a.z,s.z,c.z,l.z,o))}));function no(t,e,n,i,r,o){Gi.call(this,t,e,n,n,i,r,o)}t.CubicBezierCurve3=Bi.create((function(t,e,n,i){this.v0=t,this.v1=e,this.v2=n,this.v3=i}),(function(e){var n=t.ShapeUtils.b3;return new T(n(e,this.v0.x,this.v1.x,this.v2.x,this.v3.x),n(e,this.v0.y,this.v1.y,this.v2.y,this.v3.y),n(e,this.v0.z,this.v1.z,this.v2.z,this.v3.z))})),t.QuadraticBezierCurve3=Bi.create((function(t,e,n){this.v0=t,this.v1=e,this.v2=n}),(function(e){var n=t.ShapeUtils.b2;return new T(n(e,this.v0.x,this.v1.x,this.v2.x),n(e,this.v0.y,this.v1.y,this.v2.y),n(e,this.v0.z,this.v1.z,this.v2.z))})),t.LineCurve3=Bi.create((function(t,e){this.v1=t,this.v2=e}),(function(t){if(1===t)return this.v2.clone();var e=new T;return e.subVectors(this.v2,this.v1),e.multiplyScalar(t),e.add(this.v1),e})),no.prototype=Object.create(Gi.prototype),no.prototype.constructor=no,t.SceneUtils={createMultiMaterialObject:function(t,e){for(var n=new cn,i=0,r=e.length;i<r;i++)n.add(new fe(t,e[i]));return n},detach:function(t,e,n){t.applyMatrix(e.matrixWorld),e.remove(t),n.add(t)},attach:function(t,e,n){var i=new M;i.getInverse(n.matrixWorld),t.applyMatrix(i),e.remove(t),n.add(t)}},Object.assign(gt.prototype,{center:function(t){return console.warn("THREE.Box2: .center() has been renamed to .getCenter()."),this.getCenter(t)},empty:function(){return console.warn("THREE.Box2: .empty() has been renamed to .isEmpty()."),this.isEmpty()},isIntersectionBox:function(t){return console.warn("THREE.Box2: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(t)},size:function(t){return console.warn("THREE.Box2: .size() has been renamed to .getSize()."),this.getSize(t)}}),Object.assign(jt.prototype,{center:function(t){return console.warn("THREE.Box3: .center() has been renamed to .getCenter()."),this.getCenter(t)},empty:function(){return console.warn("THREE.Box3: .empty() has been renamed to .isEmpty()."),this.isEmpty()},isIntersectionBox:function(t){return console.warn("THREE.Box3: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(t)},isIntersectionSphere:function(t){return console.warn("THREE.Box3: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(t)},size:function(t){return console.warn("THREE.Box3: .size() has been renamed to .getSize()."),this.getSize(t)}}),Object.assign(ee.prototype,{center:function(t){return console.warn("THREE.Line3: .center() has been renamed to .getCenter()."),this.getCenter(t)}}),Object.assign(zt.prototype,{multiplyVector3:function(t){return console.warn("THREE.Matrix3: .multiplyVector3() has been removed. Use vector.applyMatrix3( matrix ) instead."),t.applyMatrix3(this)},multiplyVector3Array:function(t){return console.warn("THREE.Matrix3: .multiplyVector3Array() has been renamed. Use matrix.applyToVector3Array( array ) instead."),this.applyToVector3Array(t)}}),Object.assign(M.prototype,{extractPosition:function(t){return console.warn("THREE.Matrix4: .extractPosition() has been renamed to .copyPosition()."),this.copyPosition(t)},setRotationFromQuaternion:function(t){return console.warn("THREE.Matrix4: .setRotationFromQuaternion() has been renamed to .makeRotationFromQuaternion()."),this.makeRotationFromQuaternion(t)},multiplyVector3:function(t){return console.warn("THREE.Matrix4: .multiplyVector3() has been removed. Use vector.applyMatrix4( matrix ) or vector.applyProjection( matrix ) instead."),t.applyProjection(this)},multiplyVector4:function(t){return console.warn("THREE.Matrix4: .multiplyVector4() has been removed. Use vector.applyMatrix4( matrix ) instead."),t.applyMatrix4(this)},multiplyVector3Array:function(t){return console.warn("THREE.Matrix4: .multiplyVector3Array() has been renamed. Use matrix.applyToVector3Array( array ) instead."),this.applyToVector3Array(t)},rotateAxis:function(t){console.warn("THREE.Matrix4: .rotateAxis() has been removed. Use Vector3.transformDirection( matrix ) instead."),t.transformDirection(this)},crossVector:function(t){return console.warn("THREE.Matrix4: .crossVector() has been removed. Use vector.applyMatrix4( matrix ) instead."),t.applyMatrix4(this)},translate:function(t){console.error("THREE.Matrix4: .translate() has been removed.")},rotateX:function(t){console.error("THREE.Matrix4: .rotateX() has been removed.")},rotateY:function(t){console.error("THREE.Matrix4: .rotateY() has been removed.")},rotateZ:function(t){console.error("THREE.Matrix4: .rotateZ() has been removed.")},rotateByAxis:function(t,e){console.error("THREE.Matrix4: .rotateByAxis() has been removed.")}}),Object.assign(Ht.prototype,{isIntersectionLine:function(t){return console.warn("THREE.Plane: .isIntersectionLine() has been renamed to .intersectsLine()."),this.intersectsLine(t)}}),Object.assign(A.prototype,{multiplyVector3:function(t){return console.warn("THREE.Quaternion: .multiplyVector3() has been removed. Use is now vector.applyQuaternion( quaternion ) instead."),t.applyQuaternion(this)}}),Object.assign(Wt.prototype,{isIntersectionBox:function(t){return console.warn("THREE.Ray: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(t)},isIntersectionPlane:function(t){return console.warn("THREE.Ray: .isIntersectionPlane() has been renamed to .intersectsPlane()."),this.intersectsPlane(t)},isIntersectionSphere:function(t){return console.warn("THREE.Ray: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(t)}}),Object.assign(ar.prototype,{extrude:function(t){return console.warn("THREE.Shape: .extrude() has been removed. Use ExtrudeGeometry() instead."),new An(this,t)},makeGeometry:function(t){return console.warn("THREE.Shape: .makeGeometry() has been removed. Use ShapeGeometry() instead."),new Dn(this,t)}}),Object.assign(T.prototype,{setEulerFromRotationMatrix:function(){console.error("THREE.Vector3: .setEulerFromRotationMatrix() has been removed. Use Euler.setFromRotationMatrix() instead.")},setEulerFromQuaternion:function(){console.error("THREE.Vector3: .setEulerFromQuaternion() has been removed. Use Euler.setFromQuaternion() instead.")},getPositionFromMatrix:function(t){return console.warn("THREE.Vector3: .getPositionFromMatrix() has been renamed to .setFromMatrixPosition()."),this.setFromMatrixPosition(t)},getScaleFromMatrix:function(t){return console.warn("THREE.Vector3: .getScaleFromMatrix() has been renamed to .setFromMatrixScale()."),this.setFromMatrixScale(t)},getColumnFromMatrix:function(t,e){return console.warn("THREE.Vector3: .getColumnFromMatrix() has been renamed to .setFromMatrixColumn()."),this.setFromMatrixColumn(e,t)}}),Object.assign(Yt.prototype,{getChildByName:function(t){return console.warn("THREE.Object3D: .getChildByName() has been renamed to .getObjectByName()."),this.getObjectByName(t)},renderDepth:function(t){console.warn("THREE.Object3D: .renderDepth has been removed. Use .renderOrder, instead.")},translate:function(t,e){return console.warn("THREE.Object3D: .translate() has been removed. Use .translateOnAxis( axis, distance ) instead."),this.translateOnAxis(e,t)}}),Object.defineProperties(Yt.prototype,{eulerOrder:{get:function(){return console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order},set:function(t){console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order=t}},useQuaternion:{get:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")},set:function(t){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")}}}),Object.defineProperties(Qe.prototype,{objects:{get:function(){return console.warn("THREE.LOD: .objects has been renamed to .levels."),this.levels}}}),ye.prototype.setLens=function(t,e){console.warn("THREE.PerspectiveCamera.setLens is deprecated. Use .setFocalLength and .filmGauge for a photographic setup."),void 0!==e&&(this.filmGauge=e),this.setFocalLength(t)},Object.defineProperties(di.prototype,{onlyShadow:{set:function(t){console.warn("THREE.Light: .onlyShadow has been removed.")}},shadowCameraFov:{set:function(t){console.warn("THREE.Light: .shadowCameraFov is now .shadow.camera.fov."),this.shadow.camera.fov=t}},shadowCameraLeft:{set:function(t){console.warn("THREE.Light: .shadowCameraLeft is now .shadow.camera.left."),this.shadow.camera.left=t}},shadowCameraRight:{set:function(t){console.warn("THREE.Light: .shadowCameraRight is now .shadow.camera.right."),this.shadow.camera.right=t}},shadowCameraTop:{set:function(t){console.warn("THREE.Light: .shadowCameraTop is now .shadow.camera.top."),this.shadow.camera.top=t}},shadowCameraBottom:{set:function(t){console.warn("THREE.Light: .shadowCameraBottom is now .shadow.camera.bottom."),this.shadow.camera.bottom=t}},shadowCameraNear:{set:function(t){console.warn("THREE.Light: .shadowCameraNear is now .shadow.camera.near."),this.shadow.camera.near=t}},shadowCameraFar:{set:function(t){console.warn("THREE.Light: .shadowCameraFar is now .shadow.camera.far."),this.shadow.camera.far=t}},shadowCameraVisible:{set:function(t){console.warn("THREE.Light: .shadowCameraVisible has been removed. Use new THREE.CameraHelper( light.shadow.camera ) instead.")}},shadowBias:{set:function(t){console.warn("THREE.Light: .shadowBias is now .shadow.bias."),this.shadow.bias=t}},shadowDarkness:{set:function(t){console.warn("THREE.Light: .shadowDarkness has been removed.")}},shadowMapWidth:{set:function(t){console.warn("THREE.Light: .shadowMapWidth is now .shadow.mapSize.width."),this.shadow.mapSize.width=t}},shadowMapHeight:{set:function(t){console.warn("THREE.Light: .shadowMapHeight is now .shadow.mapSize.height."),this.shadow.mapSize.height=t}}}),Object.defineProperties(oe.prototype,{length:{get:function(){return console.warn("THREE.BufferAttribute: .length has been deprecated. Please use .count."),this.array.length}}}),Object.assign(pe.prototype,{addIndex:function(t){console.warn("THREE.BufferGeometry: .addIndex() has been renamed to .setIndex()."),this.setIndex(t)},addDrawCall:function(t,e,n){void 0!==n&&console.warn("THREE.BufferGeometry: .addDrawCall() no longer supports indexOffset."),console.warn("THREE.BufferGeometry: .addDrawCall() is now .addGroup()."),this.addGroup(t,e)},clearDrawCalls:function(){console.warn("THREE.BufferGeometry: .clearDrawCalls() is now .clearGroups()."),this.clearGroups()},computeTangents:function(){console.warn("THREE.BufferGeometry: .computeTangents() has been removed.")},computeOffsets:function(){console.warn("THREE.BufferGeometry: .computeOffsets() has been removed.")}}),Object.defineProperties(pe.prototype,{drawcalls:{get:function(){return console.error("THREE.BufferGeometry: .drawcalls has been renamed to .groups."),this.groups}},offsets:{get:function(){return console.warn("THREE.BufferGeometry: .offsets has been renamed to .groups."),this.groups}}}),Object.defineProperties(bt.prototype,{wrapAround:{get:function(){console.warn("THREE."+this.type+": .wrapAround has been removed.")},set:function(t){console.warn("THREE."+this.type+": .wrapAround has been removed.")}},wrapRGB:{get:function(){return console.warn("THREE."+this.type+": .wrapRGB has been removed."),new pt}}}),Object.defineProperties(Zn.prototype,{metal:{get:function(){return console.warn("THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead."),!1},set:function(t){console.warn("THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead")}}}),Object.defineProperties(Nt.prototype,{derivatives:{get:function(){return console.warn("THREE.ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives},set:function(t){console.warn("THREE. ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives=t}}}),e.prototype=Object.assign(Object.create({constructor:e,apply:function(t){console.warn("THREE.EventDispatcher: .apply is deprecated, just inherit or Object.assign the prototype to mix-in."),Object.assign(t,this)}}),e.prototype),Object.assign(Ve.prototype,{supportsFloatTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsFloatTextures() is now .extensions.get( 'OES_texture_float' )."),this.extensions.get("OES_texture_float")},supportsHalfFloatTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsHalfFloatTextures() is now .extensions.get( 'OES_texture_half_float' )."),this.extensions.get("OES_texture_half_float")},supportsStandardDerivatives:function(){return console.warn("THREE.WebGLRenderer: .supportsStandardDerivatives() is now .extensions.get( 'OES_standard_derivatives' )."),this.extensions.get("OES_standard_derivatives")},supportsCompressedTextureS3TC:function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTextureS3TC() is now .extensions.get( 'WEBGL_compressed_texture_s3tc' )."),this.extensions.get("WEBGL_compressed_texture_s3tc")},supportsCompressedTexturePVRTC:function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTexturePVRTC() is now .extensions.get( 'WEBGL_compressed_texture_pvrtc' )."),this.extensions.get("WEBGL_compressed_texture_pvrtc")},supportsBlendMinMax:function(){return console.warn("THREE.WebGLRenderer: .supportsBlendMinMax() is now .extensions.get( 'EXT_blend_minmax' )."),this.extensions.get("EXT_blend_minmax")},supportsVertexTextures:function(){return this.capabilities.vertexTextures},supportsInstancedArrays:function(){return console.warn("THREE.WebGLRenderer: .supportsInstancedArrays() is now .extensions.get( 'ANGLE_instanced_arrays' )."),this.extensions.get("ANGLE_instanced_arrays")},enableScissorTest:function(t){console.warn("THREE.WebGLRenderer: .enableScissorTest() is now .setScissorTest()."),this.setScissorTest(t)},initMaterial:function(){console.warn("THREE.WebGLRenderer: .initMaterial() has been removed.")},addPrePlugin:function(){console.warn("THREE.WebGLRenderer: .addPrePlugin() has been removed.")},addPostPlugin:function(){console.warn("THREE.WebGLRenderer: .addPostPlugin() has been removed.")},updateShadowMap:function(){console.warn("THREE.WebGLRenderer: .updateShadowMap() has been removed.")}}),Object.defineProperties(Ve.prototype,{shadowMapEnabled:{get:function(){return this.shadowMap.enabled},set:function(t){console.warn("THREE.WebGLRenderer: .shadowMapEnabled is now .shadowMap.enabled."),this.shadowMap.enabled=t}},shadowMapType:{get:function(){return this.shadowMap.type},set:function(t){console.warn("THREE.WebGLRenderer: .shadowMapType is now .shadowMap.type."),this.shadowMap.type=t}},shadowMapCullFace:{get:function(){return this.shadowMap.cullFace},set:function(t){console.warn("THREE.WebGLRenderer: .shadowMapCullFace is now .shadowMap.cullFace."),this.shadowMap.cullFace=t}}}),Object.defineProperties(Vt.prototype,{cullFace:{get:function(){return this.renderReverseSided?2:1},set:function(t){var e=1!==t;console.warn("WebGLRenderer: .shadowMap.cullFace is deprecated. Set .shadowMap.renderReverseSided to "+e+"."),this.renderReverseSided=e}}}),Object.defineProperties(S.prototype,{wrapS:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS},set:function(t){console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS=t}},wrapT:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT},set:function(t){console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT=t}},magFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter},set:function(t){console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter=t}},minFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter},set:function(t){console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter=t}},anisotropy:{get:function(){return console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy},set:function(t){console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy=t}},offset:{get:function(){return console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset},set:function(t){console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset=t}},repeat:{get:function(){return console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat},set:function(t){console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat=t}},format:{get:function(){return console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format},set:function(t){console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format=t}},type:{get:function(){return console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type},set:function(t){console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type=t}},generateMipmaps:{get:function(){return console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps},set:function(t){console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps=t}}}),Object.assign(gr.prototype,{load:function(t){console.warn("THREE.Audio: .load has been deprecated. Please use THREE.AudioLoader.");var e=this;return(new dr).load(t,(function(t){e.setBuffer(t)})),this}}),Object.assign(yr.prototype,{getData:function(t){return console.warn("THREE.AudioAnalyser: .getData() is now .getFrequencyData()."),this.getFrequencyData()}});var io={merge:function(t,e,n){var i;console.warn("THREE.GeometryUtils: .merge() has been moved to Geometry. Use geometry.merge( geometry2, matrix, materialIndexOffset ) instead."),e.isMesh&&(e.matrixAutoUpdate&&e.updateMatrix(),i=e.matrix,e=e.geometry),t.merge(e,i,n)},center:function(t){return console.warn("THREE.GeometryUtils: .center() has been moved to Geometry. Use geometry.center() instead."),t.center()}},ro={crossOrigin:void 0,loadTexture:function(t,e,n,i){console.warn("THREE.ImageUtils.loadTexture has been deprecated. Use THREE.TextureLoader() instead.");var r=new ui;r.setCrossOrigin(this.crossOrigin);var o=r.load(t,n,void 0,i);return e&&(o.mapping=e),o},loadTextureCube:function(t,e,n,i){console.warn("THREE.ImageUtils.loadTextureCube has been deprecated. Use THREE.CubeTextureLoader() instead.");var r=new hi;r.setCrossOrigin(this.crossOrigin);var o=r.load(t,n,void 0,i);return e&&(o.mapping=e),o},loadCompressedTexture:function(){console.error("THREE.ImageUtils.loadCompressedTexture has been removed. Use THREE.DDSLoader instead.")},loadCompressedTextureCube:function(){console.error("THREE.ImageUtils.loadCompressedTextureCube has been removed. Use THREE.DDSLoader instead.")}};Object.defineProperty(t,"AudioContext",{get:function(){return t.getAudioContext()}}),t.WebGLRenderTargetCube=E,t.WebGLRenderTarget=S,t.WebGLRenderer=Ve,t.ShaderLib=mt,t.UniformsLib=ft,t.ShaderChunk=dt,t.FogExp2=We,t.Fog=Xe,t.Scene=qe,t.LensFlare=Ye,t.Sprite=$e,t.LOD=Qe,t.SkinnedMesh=en,t.Skeleton=Ke,t.Bone=tn,t.Mesh=fe,t.LineSegments=on,t.Line=rn,t.Points=sn,t.Group=cn,t.VideoTexture=ln,t.DataTexture=Je,t.CompressedTexture=hn,t.CubeTexture=C,t.CanvasTexture=un,t.DepthTexture=dn,t.TextureIdCount=w,t.Texture=p,t.MaterialIdCount=Ft,t.CompressedTextureLoader=ni,t.BinaryTextureLoader=ci,t.DataTextureLoader=si,t.CubeTextureLoader=hi,t.TextureLoader=ui,t.ObjectLoader=ji,t.MaterialLoader=Oi,t.BufferGeometryLoader=Fi,t.LoadingManager=ti,t.JSONLoader=Ui,t.ImageLoader=li,t.FontLoader=hr,t.XHRLoader=ei,t.Loader=Ni,t.AudioLoader=dr,t.SpotLightShadow=mi,t.SpotLight=gi,t.PointLight=vi,t.HemisphereLight=pi,t.DirectionalLightShadow=yi,t.DirectionalLight=bi,t.AmbientLight=xi,t.LightShadow=fi,t.Light=di,t.StereoCamera=pr,t.PerspectiveCamera=ye,t.OrthographicCamera=be,t.CubeCamera=fr,t.Camera=ve,t.AudioListener=mr,t.PositionalAudio=vr,t.getAudioContext=ur,t.AudioAnalyser=yr,t.Audio=gr,t.VectorKeyframeTrack=Ti,t.StringKeyframeTrack=Ri,t.QuaternionKeyframeTrack=Ci,t.NumberKeyframeTrack=Pi,t.ColorKeyframeTrack=ki,t.BooleanKeyframeTrack=Li,t.PropertyMixer=br,t.PropertyBinding=xr,t.KeyframeTrack=Ii,t.AnimationObjectGroup=wr,t.AnimationMixer=Sr,t.AnimationClip=Di,t.Uniform=Er,t.InstancedBufferGeometry=Ar,t.BufferGeometry=pe,t.GeometryIdCount=ue,t.Geometry=le,t.InterleavedBufferAttribute=Tr,t.InstancedInterleavedBuffer=Cr,t.InterleavedBuffer=Mr,t.InstancedBufferAttribute=Pr,t.DynamicBufferAttribute=function(t,e){return console.warn("THREE.DynamicBufferAttribute has been removed. Use new THREE.BufferAttribute().setDynamic( true ) instead."),new oe(t,e).setDynamic(!0)},t.Float64Attribute=function(t,e){return new oe(new Float64Array(t),e)},t.Float32Attribute=ce,t.Uint32Attribute=se,t.Int32Attribute=function(t,e){return new oe(new Int32Array(t),e)},t.Uint16Attribute=ae,t.Int16Attribute=function(t,e){return new oe(new Int16Array(t),e)},t.Uint8ClampedAttribute=function(t,e){return new oe(new Uint8ClampedArray(t),e)},t.Uint8Attribute=function(t,e){return new oe(new Uint8Array(t),e)},t.Int8Attribute=function(t,e){return new oe(new Int8Array(t),e)},t.BufferAttribute=oe,t.Face3=ie,t.Object3DIdCount=te,t.Object3D=Yt,t.Raycaster=Rr,t.Layers=qt,t.EventDispatcher=e,t.Clock=Ir,t.QuaternionLinearInterpolant=Mi,t.LinearInterpolant=Si,t.DiscreteInterpolant=Ei,t.CubicInterpolant=_i,t.Interpolant=wi,t.Triangle=ne,t.Spline=function(t){this.points=t;var e,n,i,r,o,a,s,c,l,h=[],u={x:0,y:0,z:0};function d(t,e,n,i,r,o,a){var s=.5*(n-t),c=.5*(i-e);return(2*(e-n)+s+c)*a+(-3*(e-n)-2*s-c)*o+s*r+e}this.initFromArray=function(t){this.points=[];for(var e=0;e<t.length;e++)this.points[e]={x:t[e][0],y:t[e][1],z:t[e][2]}},this.getPoint=function(t){return e=(this.points.length-1)*t,n=Math.floor(e),i=e-n,h[0]=0===n?n:n-1,h[1]=n,h[2]=n>this.points.length-2?this.points.length-1:n+1,h[3]=n>this.points.length-3?this.points.length-1:n+2,a=this.points[h[0]],s=this.points[h[1]],c=this.points[h[2]],l=this.points[h[3]],o=i*(r=i*i),u.x=d(a.x,s.x,c.x,l.x,i,r,o),u.y=d(a.y,s.y,c.y,l.y,i,r,o),u.z=d(a.z,s.z,c.z,l.z,i,r,o),u},this.getControlPointsArray=function(){var t,e,n=this.points.length,i=[];for(t=0;t<n;t++)e=this.points[t],i[t]=[e.x,e.y,e.z];return i},this.getLength=function(t){var e,n,i,r,o=0,a=0,s=0,c=new T,l=new T,h=[],u=0;for(h[0]=0,t||(t=100),i=this.points.length*t,c.copy(this.points[0]),e=1;e<i;e++)n=e/i,r=this.getPoint(n),l.copy(r),u+=l.distanceTo(c),c.copy(r),o=(this.points.length-1)*n,(a=Math.floor(o))!==s&&(h[a]=u,s=a);return h[h.length]=u,{chunks:h,total:u}},this.reparametrizeByArcLength=function(t){var e,n,i,r,o,a,s,c,l=[],h=new T,u=this.getLength();for(l.push(h.copy(this.points[0]).clone()),e=1;e<this.points.length;e++){for(a=u.chunks[e]-u.chunks[e-1],s=Math.ceil(t*a/u.total),r=(e-1)/(this.points.length-1),o=e/(this.points.length-1),n=1;n<s-1;n++)i=r+n*(1/s)*(o-r),c=this.getPoint(i),l.push(h.copy(c).clone());l.push(h.copy(this.points[e]).clone())}this.points=l}},t.Spherical=Dr,t.Plane=Ht,t.Frustum=Gt,t.Sphere=Bt,t.Ray=Wt,t.Matrix4=M,t.Matrix3=zt,t.Box3=jt,t.Box2=gt,t.Line3=ee,t.Euler=Xt,t.Vector4=_,t.Vector3=T,t.Vector2=d,t.Quaternion=A,t.Color=pt,t.MorphBlendMesh=Or,t.ImmediateRenderObject=Fr,t.VertexNormalsHelper=Nr,t.SpotLightHelper=Ur,t.SkeletonHelper=jr,t.PointLightHelper=Br,t.HemisphereLightHelper=zr,t.GridHelper=Hr,t.FaceNormalsHelper=Gr,t.DirectionalLightHelper=Vr,t.CameraHelper=Wr,t.BoundingBoxHelper=Xr,t.BoxHelper=qr,t.ArrowHelper=Jr,t.AxisHelper=Kr,t.ClosedSplineCurve3=to,t.SplineCurve3=eo,t.ArcCurve=no,t.EllipseCurve=Gi,t.SplineCurve=Vi,t.CubicBezierCurve=Wi,t.QuadraticBezierCurve=Xi,t.LineCurve=zi,t.Shape=ar,t.ShapePath=cr,t.Path=sr,t.Font=lr,t.CurvePath=Hi,t.Curve=Bi,t.WireframeGeometry=pn,t.ParametricGeometry=fn,t.TetrahedronGeometry=gn,t.OctahedronGeometry=vn,t.IcosahedronGeometry=yn,t.DodecahedronGeometry=bn,t.PolyhedronGeometry=mn,t.TubeGeometry=xn,t.TorusKnotGeometry=_n,t.TorusKnotBufferGeometry=wn,t.TorusGeometry=En,t.TorusBufferGeometry=Sn,t.TextGeometry=Tn,t.SphereBufferGeometry=Mn,t.SphereGeometry=Cn,t.RingGeometry=Rn,t.RingBufferGeometry=Pn,t.PlaneBufferGeometry=ge,t.PlaneGeometry=Ln,t.LatheGeometry=In,t.LatheBufferGeometry=kn,t.ShapeGeometry=Dn,t.ExtrudeGeometry=An,t.EdgesGeometry=On,t.ConeGeometry=Un,t.ConeBufferGeometry=jn,t.CylinderGeometry=Nn,t.CylinderBufferGeometry=Fn,t.CircleBufferGeometry=Bn,t.CircleGeometry=zn,t.BoxBufferGeometry=me,t.BoxGeometry=Hn,t.ShadowMaterial=Vn,t.SpriteMaterial=Ze,t.RawShaderMaterial=Wn,t.ShaderMaterial=Nt,t.PointsMaterial=an,t.MultiMaterial=Xn,t.MeshPhysicalMaterial=Yn,t.MeshStandardMaterial=qn,t.MeshPhongMaterial=Zn,t.MeshNormalMaterial=$n,t.MeshLambertMaterial=Qn,t.MeshDepthMaterial=Ut,t.MeshBasicMaterial=re,t.LineDashedMaterial=Jn,t.LineBasicMaterial=nn,t.Material=bt,t.REVISION="81",t.MOUSE={LEFT:0,MIDDLE:1,RIGHT:2},t.CullFaceNone=0,t.CullFaceBack=1,t.CullFaceFront=2,t.CullFaceFrontBack=3,t.FrontFaceDirectionCW=0,t.FrontFaceDirectionCCW=1,t.BasicShadowMap=0,t.PCFShadowMap=1,t.PCFSoftShadowMap=2,t.FrontSide=0,t.BackSide=1,t.DoubleSide=2,t.FlatShading=1,t.SmoothShading=2,t.NoColors=0,t.FaceColors=1,t.VertexColors=2,t.NoBlending=0,t.NormalBlending=1,t.AdditiveBlending=2,t.SubtractiveBlending=3,t.MultiplyBlending=4,t.CustomBlending=5,t.BlendingMode=c,t.AddEquation=100,t.SubtractEquation=101,t.ReverseSubtractEquation=102,t.MinEquation=103,t.MaxEquation=104,t.ZeroFactor=200,t.OneFactor=201,t.SrcColorFactor=202,t.OneMinusSrcColorFactor=203,t.SrcAlphaFactor=204,t.OneMinusSrcAlphaFactor=205,t.DstAlphaFactor=206,t.OneMinusDstAlphaFactor=207,t.DstColorFactor=208,t.OneMinusDstColorFactor=209,t.SrcAlphaSaturateFactor=210,t.NeverDepth=0,t.AlwaysDepth=1,t.LessDepth=2,t.LessEqualDepth=3,t.EqualDepth=4,t.GreaterEqualDepth=5,t.GreaterDepth=6,t.NotEqualDepth=7,t.MultiplyOperation=0,t.MixOperation=1,t.AddOperation=2,t.NoToneMapping=0,t.LinearToneMapping=1,t.ReinhardToneMapping=2,t.Uncharted2ToneMapping=3,t.CineonToneMapping=4,t.UVMapping=300,t.CubeReflectionMapping=301,t.CubeRefractionMapping=302,t.EquirectangularReflectionMapping=303,t.EquirectangularRefractionMapping=304,t.SphericalReflectionMapping=305,t.CubeUVReflectionMapping=306,t.CubeUVRefractionMapping=307,t.TextureMapping=l,t.RepeatWrapping=1e3,t.ClampToEdgeWrapping=1001,t.MirroredRepeatWrapping=1002,t.TextureWrapping=h,t.NearestFilter=1003,t.NearestMipMapNearestFilter=1004,t.NearestMipMapLinearFilter=1005,t.LinearFilter=1006,t.LinearMipMapNearestFilter=1007,t.LinearMipMapLinearFilter=1008,t.TextureFilter=u,t.UnsignedByteType=1009,t.ByteType=1010,t.ShortType=1011,t.UnsignedShortType=1012,t.IntType=1013,t.UnsignedIntType=1014,t.FloatType=1015,t.HalfFloatType=1016,t.UnsignedShort4444Type=1017,t.UnsignedShort5551Type=1018,t.UnsignedShort565Type=1019,t.UnsignedInt248Type=1020,t.AlphaFormat=1021,t.RGBFormat=1022,t.RGBAFormat=1023,t.LuminanceFormat=1024,t.LuminanceAlphaFormat=1025,t.RGBEFormat=1023,t.DepthFormat=1026,t.DepthStencilFormat=1027,t.RGB_S3TC_DXT1_Format=2001,t.RGBA_S3TC_DXT1_Format=2002,t.RGBA_S3TC_DXT3_Format=2003,t.RGBA_S3TC_DXT5_Format=2004,t.RGB_PVRTC_4BPPV1_Format=2100,t.RGB_PVRTC_2BPPV1_Format=2101,t.RGBA_PVRTC_4BPPV1_Format=2102,t.RGBA_PVRTC_2BPPV1_Format=2103,t.RGB_ETC1_Format=2151,t.LoopOnce=2200,t.LoopRepeat=2201,t.LoopPingPong=2202,t.InterpolateDiscrete=2300,t.InterpolateLinear=2301,t.InterpolateSmooth=2302,t.ZeroCurvatureEnding=2400,t.ZeroSlopeEnding=2401,t.WrapAroundEnding=2402,t.TrianglesDrawMode=0,t.TriangleStripDrawMode=1,t.TriangleFanDrawMode=2,t.LinearEncoding=3e3,t.sRGBEncoding=3001,t.GammaEncoding=3007,t.RGBEEncoding=3002,t.LogLuvEncoding=3003,t.RGBM7Encoding=3004,t.RGBM16Encoding=3005,t.RGBDEncoding=3006,t.BasicDepthPacking=3200,t.RGBADepthPacking=3201,t.CubeGeometry=Hn,t.Face4=function(t,e,n,i,r,o,a){return console.warn("THREE.Face4 has been removed. A THREE.Face3 will be created instead."),new ie(t,e,n,r,o,a)},t.LineStrip=0,t.LinePieces=1,t.MeshFaceMaterial=Xn,t.PointCloud=function(t,e){return console.warn("THREE.PointCloud has been renamed to THREE.Points."),new sn(t,e)},t.Particle=$e,t.ParticleSystem=function(t,e){return console.warn("THREE.ParticleSystem has been renamed to THREE.Points."),new sn(t,e)},t.PointCloudMaterial=function(t){return console.warn("THREE.PointCloudMaterial has been renamed to THREE.PointsMaterial."),new an(t)},t.ParticleBasicMaterial=function(t){return console.warn("THREE.ParticleBasicMaterial has been renamed to THREE.PointsMaterial."),new an(t)},t.ParticleSystemMaterial=function(t){return console.warn("THREE.ParticleSystemMaterial has been renamed to THREE.PointsMaterial."),new an(t)},t.Vertex=function(t,e,n){return console.warn("THREE.Vertex has been removed. Use THREE.Vector3 instead."),new T(t,e,n)},t.EdgesHelper=function(t,e){return console.warn("THREE.EdgesHelper has been removed. Use THREE.EdgesGeometry instead."),new on(new On(t.geometry),new nn({color:void 0!==e?e:16777215}))},t.WireframeHelper=function(t,e){return console.warn("THREE.WireframeHelper has been removed. Use THREE.WireframeGeometry instead."),new on(new pn(t.geometry),new nn({color:void 0!==e?e:16777215}))},t.GeometryUtils=io,t.ImageUtils=ro,t.Projector=function(){console.error("THREE.Projector has been moved to /examples/js/renderers/Projector.js."),this.projectVector=function(t,e){console.warn("THREE.Projector: .projectVector() is now vector.project()."),t.project(e)},this.unprojectVector=function(t,e){console.warn("THREE.Projector: .unprojectVector() is now vector.unproject()."),t.unproject(e)},this.pickingRay=function(t,e){console.error("THREE.Projector: .pickingRay() is now raycaster.setFromCamera().")}},t.CanvasRenderer=function(){console.error("THREE.CanvasRenderer has been moved to /examples/js/renderers/CanvasRenderer.js"),this.domElement=document.createElementNS("http://www.w3.org/1999/xhtml","canvas"),this.clear=function(){},this.render=function(){},this.setClearColor=function(){},this.setSize=function(){}},Object.defineProperty(t,"__esModule",{value:!0})}(e)},function(t,e,n){"use strict";(function(t,i,r,o){n.d(e,"a",(function(){return a}));var a=t,s=i,c=r,l=o;console.log("Jquery",a),console.log("Html2Canvas",s),console.log("Three",c),console.log("PDFJS",l)}).call(this,n(1),n(2),n(3),n(6))},,function(t,e,n){(function(i){var r,o,a;!function(s,c){"use strict";o=[e],void 0===(a="function"==typeof(r=function(t){var e="undefined"!=typeof document&&document.currentScript?document.currentScript.src:null,r={};(function(){!function(t,e){!function(t){var e="undefined"!=typeof window?window:void 0!==i?i:"undefined"!=typeof self?self:this,n={errors:0,warnings:1,infos:5},r=n.warnings;function o(t){r>=n.warnings&&console.log("Warning: "+t)}function a(t){throw r>=n.errors&&(console.log("Error: "+t),console.log(function(){try{throw new Error}catch(t){return t.stack?t.stack.split("\n").slice(2).join("\n"):""}}())),new Error(t)}function s(t,e){t||a(e)}var c=function(){function t(t,e){this.name="PasswordException",this.message=t,this.code=e}return t.prototype=new Error,t.constructor=t,t}(),l=function(){function t(t,e){this.name="UnknownErrorException",this.message=t,this.details=e}return t.prototype=new Error,t.constructor=t,t}(),h=function(){function t(t){this.name="InvalidPDFException",this.message=t}return t.prototype=new Error,t.constructor=t,t}(),u=function(){function t(t){this.name="MissingPDFException",this.message=t}return t.prototype=new Error,t.constructor=t,t}(),d=function(){function t(t,e){this.name="UnexpectedResponseException",this.message=t,this.status=e}return t.prototype=new Error,t.constructor=t,t}(),p=function(){function t(t){this.message=t}return t.prototype=new Error,t.prototype.name="NotImplementedException",t.constructor=t,t}(),f=function(){function t(t,e){this.begin=t,this.end=e,this.message="Missing data ["+t+", "+e+")"}return t.prototype=new Error,t.prototype.name="MissingDataException",t.constructor=t,t}(),m=function(){function t(t){this.message=t}return t.prototype=new Error,t.prototype.name="XRefParseException",t.constructor=t,t}(),g=/\x00/g;function v(t){s("string"==typeof t,"Invalid argument for stringToBytes");for(var e=t.length,n=new Uint8Array(e),i=0;i<e;++i)n[i]=255&t.charCodeAt(i);return n}function y(t){return void 0!==t.length?t.length:(s(void 0!==t.byteLength),t.byteLength)}var b=function(){function t(i,r){this.buffer=i,this.byteLength=i.length,this.length=void 0===r?this.byteLength>>2:r,function(i){for(;e<i;)Object.defineProperty(t.prototype,e,n(e)),e++}(this.length)}t.prototype=Object.create(null);var e=0;function n(t){return{get:function(){var e=this.buffer,n=t<<2;return(e[n]|e[n+1]<<8|e[n+2]<<16|e[n+3]<<24)>>>0},set:function(e){var n=this.buffer,i=t<<2;n[i]=255&e,n[i+1]=e>>8&255,n[i+2]=e>>16&255,n[i+3]=e>>>24&255}}}return t}();t.Uint32ArrayView=b;var x=function(){function t(){}var e=["rgb(",0,",",0,",",0,")"];t.makeCssRgb=function(t,n,i){return e[1]=t,e[3]=n,e[5]=i,e.join("")},t.transform=function(t,e){return[t[0]*e[0]+t[2]*e[1],t[1]*e[0]+t[3]*e[1],t[0]*e[2]+t[2]*e[3],t[1]*e[2]+t[3]*e[3],t[0]*e[4]+t[2]*e[5]+t[4],t[1]*e[4]+t[3]*e[5]+t[5]]},t.applyTransform=function(t,e){return[t[0]*e[0]+t[1]*e[2]+e[4],t[0]*e[1]+t[1]*e[3]+e[5]]},t.applyInverseTransform=function(t,e){var n=e[0]*e[3]-e[1]*e[2];return[(t[0]*e[3]-t[1]*e[2]+e[2]*e[5]-e[4]*e[3])/n,(-t[0]*e[1]+t[1]*e[0]+e[4]*e[1]-e[5]*e[0])/n]},t.getAxialAlignedBoundingBox=function(e,n){var i=t.applyTransform(e,n),r=t.applyTransform(e.slice(2,4),n),o=t.applyTransform([e[0],e[3]],n),a=t.applyTransform([e[2],e[1]],n);return[Math.min(i[0],r[0],o[0],a[0]),Math.min(i[1],r[1],o[1],a[1]),Math.max(i[0],r[0],o[0],a[0]),Math.max(i[1],r[1],o[1],a[1])]},t.inverseTransform=function(t){var e=t[0]*t[3]-t[1]*t[2];return[t[3]/e,-t[1]/e,-t[2]/e,t[0]/e,(t[2]*t[5]-t[4]*t[3])/e,(t[4]*t[1]-t[5]*t[0])/e]},t.apply3dTransform=function(t,e){return[t[0]*e[0]+t[1]*e[1]+t[2]*e[2],t[3]*e[0]+t[4]*e[1]+t[5]*e[2],t[6]*e[0]+t[7]*e[1]+t[8]*e[2]]},t.singularValueDecompose2dScale=function(t){var e=[t[0],t[2],t[1],t[3]],n=t[0]*e[0]+t[1]*e[2],i=t[0]*e[1]+t[1]*e[3],r=t[2]*e[0]+t[3]*e[2],o=t[2]*e[1]+t[3]*e[3],a=(n+o)/2,s=Math.sqrt((n+o)*(n+o)-4*(n*o-r*i))/2,c=a+s||1,l=a-s||1;return[Math.sqrt(c),Math.sqrt(l)]},t.normalizeRect=function(t){var e=t.slice(0);return t[0]>t[2]&&(e[0]=t[2],e[2]=t[0]),t[1]>t[3]&&(e[1]=t[3],e[3]=t[1]),e},t.intersect=function(e,n){function i(t,e){return t-e}var r=[e[0],e[2],n[0],n[2]].sort(i),o=[e[1],e[3],n[1],n[3]].sort(i),a=[];return e=t.normalizeRect(e),n=t.normalizeRect(n),(r[0]===e[0]&&r[1]===n[0]||r[0]===n[0]&&r[1]===e[0])&&(a[0]=r[1],a[2]=r[2],(o[0]===e[1]&&o[1]===n[1]||o[0]===n[1]&&o[1]===e[1])&&(a[1]=o[1],a[3]=o[2],a))},t.sign=function(t){return t<0?-1:1};var n=["","C","CC","CCC","CD","D","DC","DCC","DCCC","CM","","X","XX","XXX","XL","L","LX","LXX","LXXX","XC","","I","II","III","IV","V","VI","VII","VIII","IX"];return t.toRoman=function(t,e){s(S(t)&&t>0,"The number should be a positive integer.");for(var i,r=[];t>=1e3;)t-=1e3,r.push("M");i=t/100|0,t%=100,r.push(n[i]),i=t/10|0,t%=10,r.push(n[10+i]),r.push(n[20+t]);var o=r.join("");return e?o.toLowerCase():o},t.appendToArray=function(t,e){Array.prototype.push.apply(t,e)},t.prependToArray=function(t,e){Array.prototype.unshift.apply(t,e)},t.extendObj=function(t,e){for(var n in e)t[n]=e[n]},t.getInheritableProperty=function(t,e,n){for(;t&&!t.has(e);)t=t.get("Parent");return t?n?t.getArray(e):t.get(e):null},t.inherit=function(t,e,n){for(var i in t.prototype=Object.create(e.prototype),t.prototype.constructor=t,n)t.prototype[i]=n[i]},t.loadScript=function(t,e){var n=document.createElement("script"),i=!1;n.setAttribute("src",t),e&&(n.onload=function(){i||e(),i=!0}),document.getElementsByTagName("head")[0].appendChild(n)},t}(),w=function(){function t(t,e,n,i,r,o){this.viewBox=t,this.scale=e,this.rotation=n,this.offsetX=i,this.offsetY=r;var a,s,c,l,h,u,d,p,f=(t[2]+t[0])/2,m=(t[3]+t[1])/2;switch(n=(n%=360)<0?n+360:n){case 180:a=-1,s=0,c=0,l=1;break;case 90:a=0,s=1,c=1,l=0;break;case 270:a=0,s=-1,c=-1,l=0;break;default:a=1,s=0,c=0,l=-1}o&&(c=-c,l=-l),0===a?(h=Math.abs(m-t[1])*e+i,u=Math.abs(f-t[0])*e+r,d=Math.abs(t[3]-t[1])*e,p=Math.abs(t[2]-t[0])*e):(h=Math.abs(f-t[0])*e+i,u=Math.abs(m-t[1])*e+r,d=Math.abs(t[2]-t[0])*e,p=Math.abs(t[3]-t[1])*e),this.transform=[a*e,s*e,c*e,l*e,h-a*e*f-c*e*m,u-s*e*f-l*e*m],this.width=d,this.height=p,this.fontScale=e}return t.prototype={clone:function(e){var n="scale"in(e=e||{})?e.scale:this.scale,i="rotation"in e?e.rotation:this.rotation;return new t(this.viewBox.slice(),n,i,this.offsetX,this.offsetY,e.dontFlip)},convertToViewportPoint:function(t,e){return x.applyTransform([t,e],this.transform)},convertToViewportRectangle:function(t){var e=x.applyTransform([t[0],t[1]],this.transform),n=x.applyTransform([t[2],t[3]],this.transform);return[e[0],e[1],n[0],n[1]]},convertToPdfPoint:function(t,e){return x.applyInverseTransform([t,e],this.transform)}},t}(),_=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,728,711,710,729,733,731,730,732,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,8226,8224,8225,8230,8212,8211,402,8260,8249,8250,8722,8240,8222,8220,8221,8216,8217,8218,8482,64257,64258,321,338,352,376,381,305,322,339,353,382,0,8364];function S(t){return"number"==typeof t&&(0|t)===t}function E(){var t={};return t.promise=new Promise((function(e,n){t.resolve=e,t.reject=n})),t}(function(){if(e.Promise)return"function"!=typeof e.Promise.all&&(e.Promise.all=function(t){var n,i,r=0,o=[],a=new e.Promise((function(t,e){n=t,i=e}));return t.forEach((function(t,e){r++,t.then((function(t){o[e]=t,0===--r&&n(o)}),i)})),0===r&&n(o),a}),"function"!=typeof e.Promise.resolve&&(e.Promise.resolve=function(t){return new e.Promise((function(e){e(t)}))}),"function"!=typeof e.Promise.reject&&(e.Promise.reject=function(t){return new e.Promise((function(e,n){n(t)}))}),void("function"!=typeof e.Promise.prototype.catch&&(e.Promise.prototype.catch=function(t){return e.Promise.prototype.then(void 0,t)}));var t={handlers:[],running:!1,unhandledRejections:[],pendingRejectionCheck:!1,scheduleHandlers:function(t){0!==t._status&&(this.handlers=this.handlers.concat(t._handlers),t._handlers=[],this.running||(this.running=!0,setTimeout(this.runHandlers.bind(this),0)))},runHandlers:function(){for(var t=Date.now()+1;this.handlers.length>0;){var e=this.handlers.shift(),n=e.thisPromise._status,i=e.thisPromise._value;try{1===n?"function"==typeof e.onResolve&&(i=e.onResolve(i)):"function"==typeof e.onReject&&(i=e.onReject(i),n=1,e.thisPromise._unhandledRejection&&this.removeUnhandeledRejection(e.thisPromise))}catch(t){n=2,i=t}if(e.nextPromise._updateStatus(n,i),Date.now()>=t)break}this.handlers.length>0?setTimeout(this.runHandlers.bind(this),0):this.running=!1},addUnhandledRejection:function(t){this.unhandledRejections.push({promise:t,time:Date.now()}),this.scheduleRejectionCheck()},removeUnhandeledRejection:function(t){t._unhandledRejection=!1;for(var e=0;e<this.unhandledRejections.length;e++)this.unhandledRejections[e].promise===t&&(this.unhandledRejections.splice(e),e--)},scheduleRejectionCheck:function(){this.pendingRejectionCheck||(this.pendingRejectionCheck=!0,setTimeout(function(){this.pendingRejectionCheck=!1;for(var t=Date.now(),e=0;e<this.unhandledRejections.length;e++)if(t-this.unhandledRejections[e].time>500){var n=this.unhandledRejections[e].promise._value,i="Unhandled rejection: "+n;n.stack&&(i+="\n"+n.stack),o(i),this.unhandledRejections.splice(e),e--}this.unhandledRejections.length&&this.scheduleRejectionCheck()}.bind(this),500))}},n=function(t){this._status=0,this._handlers=[];try{t.call(this,this._resolve.bind(this),this._reject.bind(this))}catch(t){this._reject(t)}};n.all=function(t){var e,i,r=new n((function(t,n){e=t,i=n})),o=t.length,a=[];if(0===o)return e(a),r;function s(t){2!==r._status&&(a=[],i(t))}for(var c=0,l=t.length;c<l;++c){var h=t[c],u=function(t){return function(n){2!==r._status&&(a[t]=n,0===--o&&e(a))}}(c);n.isPromise(h)?h.then(u,s):u(h)}return r},n.isPromise=function(t){return t&&"function"==typeof t.then},n.resolve=function(t){return new n((function(e){e(t)}))},n.reject=function(t){return new n((function(e,n){n(t)}))},n.prototype={_status:null,_value:null,_handlers:null,_unhandledRejection:null,_updateStatus:function(e,i){1!==this._status&&2!==this._status&&(1===e&&n.isPromise(i)?i.then(this._updateStatus.bind(this,1),this._updateStatus.bind(this,2)):(this._status=e,this._value=i,2===e&&0===this._handlers.length&&(this._unhandledRejection=!0,t.addUnhandledRejection(this)),t.scheduleHandlers(this)))},_resolve:function(t){this._updateStatus(1,t)},_reject:function(t){this._updateStatus(2,t)},then:function(e,i){var r=new n((function(t,e){this.resolve=t,this.reject=e}));return this._handlers.push({thisPromise:this,onResolve:e,onReject:i,nextPromise:r}),t.scheduleHandlers(this),r},catch:function(t){return this.then(void 0,t)}},e.Promise=n})(),function(){if(!e.WeakMap){var t=0;n.prototype={has:function(t){return!!Object.getOwnPropertyDescriptor(t,this.id)},get:function(t,e){return this.has(t)?t[this.id]:e},set:function(t,e){Object.defineProperty(t,this.id,{value:e,enumerable:!1,configurable:!0})},delete:function(t){delete t[this.id]}},e.WeakMap=n}function n(){this.id="$weakmap"+t++}}();var A=function(){function t(t,e,n){for(;t.length<n;)t+=e;return t}function e(){this.started=Object.create(null),this.times=[],this.enabled=!0}return e.prototype={time:function(t){this.enabled&&(t in this.started&&o("Timer is already running for "+t),this.started[t]=Date.now())},timeEnd:function(t){this.enabled&&(t in this.started||o("Timer has not been started for "+t),this.times.push({name:t,start:this.started[t],end:Date.now()}),delete this.started[t])},toString:function(){var e,n,i=this.times,r="",o=0;for(e=0,n=i.length;e<n;++e){var a=i[e].name;a.length>o&&(o=a.length)}for(e=0,n=i.length;e<n;++e){var s=i[e],c=s.end-s.start;r+=t(s.name," ",o)+" "+c+"ms\n"}return r}},e}(),T=function(t,e){if("undefined"!=typeof Blob)return new Blob([t],{type:e});o('The "Blob" constructor is not supported.')},M=(C="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",function(t,e,n){if(!n&&"undefined"!=typeof URL&&URL.createObjectURL){var i=T(t,e);return URL.createObjectURL(i)}for(var r="data:"+e+";base64,",o=0,a=t.length;o<a;o+=3){var s=255&t[o],c=255&t[o+1],l=255&t[o+2];r+=C[s>>2]+C[(3&s)<<4|c>>4]+C[o+1<a?(15&c)<<2|l>>6:64]+C[o+2<a?63&l:64]}return r});var C;function P(t,e,n){this.sourceName=t,this.targetName=e,this.comObj=n,this.callbackIndex=1,this.postMessageTransfers=!0;var i=this.callbacksCapabilities=Object.create(null),r=this.actionHandler=Object.create(null);this._onComObjOnMessage=function(t){var e=t.data;if(e.targetName===this.sourceName)if(e.isReply){var o=e.callbackId;if(e.callbackId in i){var s=i[o];delete i[o],"error"in e?s.reject(e.error):s.resolve(e.data)}else a("Cannot resolve callback "+o)}else if(e.action in r){var c=r[e.action];if(e.callbackId){var l=this.sourceName,h=e.sourceName;Promise.resolve().then((function(){return c[0].call(c[1],e.data)})).then((function(t){n.postMessage({sourceName:l,targetName:h,isReply:!0,callbackId:e.callbackId,data:t})}),(function(t){t instanceof Error&&(t+=""),n.postMessage({sourceName:l,targetName:h,isReply:!0,callbackId:e.callbackId,error:t})}))}else c[0].call(c[1],e.data)}else a("Unknown action from worker: "+e.action)}.bind(this),n.addEventListener("message",this._onComObjOnMessage)}P.prototype={on:function(t,e,n){var i=this.actionHandler;i[t]&&a('There is already an actionName called "'+t+'"'),i[t]=[e,n]},send:function(t,e,n){var i={sourceName:this.sourceName,targetName:this.targetName,action:t,data:e};this.postMessage(i,n)},sendWithPromise:function(t,e,n){var i=this.callbackIndex++,r={sourceName:this.sourceName,targetName:this.targetName,action:t,data:e,callbackId:i},o=E();this.callbacksCapabilities[i]=o;try{this.postMessage(r,n)}catch(t){o.reject(t)}return o.promise},postMessage:function(t,e){e&&this.postMessageTransfers?this.comObj.postMessage(t,e):this.comObj.postMessage(t)},destroy:function(){this.comObj.removeEventListener("message",this._onComObjOnMessage)}},function(t){var e=!1;try{if("function"==typeof URL&&"object"==typeof URL.prototype&&"origin"in URL.prototype){var n=new URL("b","http://a");n.pathname="c%20d",e="http://a/c%20d"===n.href}}catch(t){}if(!e){var i=Object.create(null);i.ftp=21,i.file=0,i.gopher=70,i.http=80,i.https=443,i.ws=80,i.wss=443;var r=Object.create(null);r["%2e"]=".",r[".%2e"]="..",r["%2e."]="..",r["%2e%2e"]="..";var o,a=/[a-zA-Z]/,s=/[a-zA-Z0-9\+\-\.]/;g.prototype={toString:function(){return this.href},get href(){if(this._isInvalid)return this._url;var t="";return""===this._username&&null===this._password||(t=this._username+(null!==this._password?":"+this._password:"")+"@"),this.protocol+(this._isRelative?"//"+t+this.host:"")+this.pathname+this._query+this._fragment},set href(t){m.call(this),f.call(this,t)},get protocol(){return this._scheme+":"},set protocol(t){this._isInvalid||f.call(this,t+":","scheme start")},get host(){return this._isInvalid?"":this._port?this._host+":"+this._port:this._host},set host(t){!this._isInvalid&&this._isRelative&&f.call(this,t,"host")},get hostname(){return this._host},set hostname(t){!this._isInvalid&&this._isRelative&&f.call(this,t,"hostname")},get port(){return this._port},set port(t){!this._isInvalid&&this._isRelative&&f.call(this,t,"port")},get pathname(){return this._isInvalid?"":this._isRelative?"/"+this._path.join("/"):this._schemeData},set pathname(t){!this._isInvalid&&this._isRelative&&(this._path=[],f.call(this,t,"relative path start"))},get search(){return this._isInvalid||!this._query||"?"===this._query?"":this._query},set search(t){!this._isInvalid&&this._isRelative&&(this._query="?","?"===t[0]&&(t=t.slice(1)),f.call(this,t,"query"))},get hash(){return this._isInvalid||!this._fragment||"#"===this._fragment?"":this._fragment},set hash(t){this._isInvalid||(this._fragment="#","#"===t[0]&&(t=t.slice(1)),f.call(this,t,"fragment"))},get origin(){var t;if(this._isInvalid||!this._scheme)return"";switch(this._scheme){case"data":case"file":case"javascript":case"mailto":return"null"}return(t=this.host)?this._scheme+"://"+t:""}};var c=t.URL;c&&(g.createObjectURL=function(t){return c.createObjectURL.apply(c,arguments)},g.revokeObjectURL=function(t){c.revokeObjectURL(t)}),t.URL=g}function l(t){return void 0!==i[t]}function h(){m.call(this),this._isInvalid=!0}function u(t){return""===t&&h.call(this),t.toLowerCase()}function d(t){var e=t.charCodeAt(0);return e>32&&e<127&&-1===[34,35,60,62,63,96].indexOf(e)?t:encodeURIComponent(t)}function p(t){var e=t.charCodeAt(0);return e>32&&e<127&&-1===[34,35,60,62,96].indexOf(e)?t:encodeURIComponent(t)}function f(t,e,n){function c(t){b.push(t)}var f=e||"scheme start",m=0,g="",v=!1,y=!1,b=[];t:for(;(t[m-1]!==o||0===m)&&!this._isInvalid;){var x=t[m];switch(f){case"scheme start":if(!x||!a.test(x)){if(e){c("Invalid scheme.");break t}g="",f="no scheme";continue}g+=x.toLowerCase(),f="scheme";break;case"scheme":if(x&&s.test(x))g+=x.toLowerCase();else{if(":"!==x){if(e){if(o===x)break t;c("Code point not allowed in scheme: "+x);break t}g="",m=0,f="no scheme";continue}if(this._scheme=g,g="",e)break t;l(this._scheme)&&(this._isRelative=!0),f="file"===this._scheme?"relative":this._isRelative&&n&&n._scheme===this._scheme?"relative or authority":this._isRelative?"authority first slash":"scheme data"}break;case"scheme data":"?"===x?(this._query="?",f="query"):"#"===x?(this._fragment="#",f="fragment"):o!==x&&"\t"!==x&&"\n"!==x&&"\r"!==x&&(this._schemeData+=d(x));break;case"no scheme":if(n&&l(n._scheme)){f="relative";continue}c("Missing scheme."),h.call(this);break;case"relative or authority":if("/"!==x||"/"!==t[m+1]){c("Expected /, got: "+x),f="relative";continue}f="authority ignore slashes";break;case"relative":if(this._isRelative=!0,"file"!==this._scheme&&(this._scheme=n._scheme),o===x){this._host=n._host,this._port=n._port,this._path=n._path.slice(),this._query=n._query,this._username=n._username,this._password=n._password;break t}if("/"===x||"\\"===x)"\\"===x&&c("\\ is an invalid code point."),f="relative slash";else if("?"===x)this._host=n._host,this._port=n._port,this._path=n._path.slice(),this._query="?",this._username=n._username,this._password=n._password,f="query";else{if("#"!==x){var w=t[m+1],_=t[m+2];("file"!==this._scheme||!a.test(x)||":"!==w&&"|"!==w||o!==_&&"/"!==_&&"\\"!==_&&"?"!==_&&"#"!==_)&&(this._host=n._host,this._port=n._port,this._username=n._username,this._password=n._password,this._path=n._path.slice(),this._path.pop()),f="relative path";continue}this._host=n._host,this._port=n._port,this._path=n._path.slice(),this._query=n._query,this._fragment="#",this._username=n._username,this._password=n._password,f="fragment"}break;case"relative slash":if("/"!==x&&"\\"!==x){"file"!==this._scheme&&(this._host=n._host,this._port=n._port,this._username=n._username,this._password=n._password),f="relative path";continue}"\\"===x&&c("\\ is an invalid code point."),f="file"===this._scheme?"file host":"authority ignore slashes";break;case"authority first slash":if("/"!==x){c("Expected '/', got: "+x),f="authority ignore slashes";continue}f="authority second slash";break;case"authority second slash":if(f="authority ignore slashes","/"!==x){c("Expected '/', got: "+x);continue}break;case"authority ignore slashes":if("/"!==x&&"\\"!==x){f="authority";continue}c("Expected authority, got: "+x);break;case"authority":if("@"===x){v&&(c("@ already seen."),g+="%40"),v=!0;for(var S=0;S<g.length;S++){var E=g[S];if("\t"!==E&&"\n"!==E&&"\r"!==E)if(":"!==E||null!==this._password){var A=d(E);null!==this._password?this._password+=A:this._username+=A}else this._password="";else c("Invalid whitespace in authority.")}g=""}else{if(x===o||"/"===x||"\\"===x||"?"===x||"#"===x){m-=g.length,g="",f="host";continue}g+=x}break;case"file host":if(x===o||"/"===x||"\\"===x||"?"===x||"#"===x){2!==g.length||!a.test(g[0])||":"!==g[1]&&"|"!==g[1]?(0===g.length||(this._host=u.call(this,g),g=""),f="relative path start"):f="relative path";continue}"\t"===x||"\n"===x||"\r"===x?c("Invalid whitespace in file host."):g+=x;break;case"host":case"hostname":if(":"!==x||y){if(x===o||"/"===x||"\\"===x||"?"===x||"#"===x){if(this._host=u.call(this,g),g="",f="relative path start",e)break t;continue}"\t"!==x&&"\n"!==x&&"\r"!==x?("["===x?y=!0:"]"===x&&(y=!1),g+=x):c("Invalid code point in host/hostname: "+x)}else if(this._host=u.call(this,g),g="",f="port","hostname"===e)break t;break;case"port":if(/[0-9]/.test(x))g+=x;else{if(x===o||"/"===x||"\\"===x||"?"===x||"#"===x||e){if(""!==g){var T=parseInt(g,10);T!==i[this._scheme]&&(this._port=T+""),g=""}if(e)break t;f="relative path start";continue}"\t"===x||"\n"===x||"\r"===x?c("Invalid code point in port: "+x):h.call(this)}break;case"relative path start":if("\\"===x&&c("'\\' not allowed in path."),f="relative path","/"!==x&&"\\"!==x)continue;break;case"relative path":var M;if(x!==o&&"/"!==x&&"\\"!==x&&(e||"?"!==x&&"#"!==x))"\t"!==x&&"\n"!==x&&"\r"!==x&&(g+=d(x));else"\\"===x&&c("\\ not allowed in relative path."),(M=r[g.toLowerCase()])&&(g=M),".."===g?(this._path.pop(),"/"!==x&&"\\"!==x&&this._path.push("")):"."===g&&"/"!==x&&"\\"!==x?this._path.push(""):"."!==g&&("file"===this._scheme&&0===this._path.length&&2===g.length&&a.test(g[0])&&"|"===g[1]&&(g=g[0]+":"),this._path.push(g)),g="","?"===x?(this._query="?",f="query"):"#"===x&&(this._fragment="#",f="fragment");break;case"query":e||"#"!==x?o!==x&&"\t"!==x&&"\n"!==x&&"\r"!==x&&(this._query+=p(x)):(this._fragment="#",f="fragment");break;case"fragment":o!==x&&"\t"!==x&&"\n"!==x&&"\r"!==x&&(this._fragment+=x)}m++}}function m(){this._scheme="",this._schemeData="",this._username="",this._password=null,this._host="",this._port="",this._path=[],this._query="",this._fragment="",this._isInvalid=!1,this._isRelative=!1}function g(t,e){void 0===e||e instanceof g||(e=new g(String(e))),this._url=t,m.call(this);var n=t.replace(/^[ \t\r\n\f]+|[ \t\r\n\f]+$/g,"");f.call(this,n,null,e)}}(e),t.FONT_IDENTITY_MATRIX=[.001,0,0,.001,0,0],t.IDENTITY_MATRIX=[1,0,0,1,0,0],t.OPS={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotations:78,endAnnotations:79,beginAnnotation:80,endAnnotation:81,paintJpegXObject:82,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91},t.VERBOSITY_LEVELS=n,t.UNSUPPORTED_FEATURES={unknown:"unknown",forms:"forms",javaScript:"javaScript",smask:"smask",shadingPattern:"shadingPattern",font:"font"},t.AnnotationBorderStyleType={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5},t.AnnotationFieldFlag={READONLY:1,REQUIRED:2,NOEXPORT:4,MULTILINE:4096,PASSWORD:8192,NOTOGGLETOOFF:16384,RADIO:32768,PUSHBUTTON:65536,COMBO:131072,EDIT:262144,SORT:524288,FILESELECT:1048576,MULTISELECT:2097152,DONOTSPELLCHECK:4194304,DONOTSCROLL:8388608,COMB:16777216,RICHTEXT:33554432,RADIOSINUNISON:33554432,COMMITONSELCHANGE:67108864},t.AnnotationFlag={INVISIBLE:1,HIDDEN:2,PRINT:4,NOZOOM:8,NOROTATE:16,NOVIEW:32,READONLY:64,LOCKED:128,TOGGLENOVIEW:256,LOCKEDCONTENTS:512},t.AnnotationType={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26},t.FontType={UNKNOWN:0,TYPE1:1,TYPE1C:2,CIDFONTTYPE0:3,CIDFONTTYPE0C:4,TRUETYPE:5,CIDFONTTYPE2:6,TYPE3:7,OPENTYPE:8,TYPE0:9,MMTYPE1:10},t.ImageKind={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3},t.InvalidPDFException=h,t.MessageHandler=P,t.MissingDataException=f,t.MissingPDFException=u,t.NotImplementedException=p,t.PageViewport=w,t.PasswordException=c,t.PasswordResponses={NEED_PASSWORD:1,INCORRECT_PASSWORD:2},t.StatTimer=A,t.StreamType={UNKNOWN:0,FLATE:1,LZW:2,DCT:3,JPX:4,JBIG:5,A85:6,AHX:7,CCF:8,RL:9},t.TextRenderingMode={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_ADD_TO_PATH:4,STROKE_ADD_TO_PATH:5,FILL_STROKE_ADD_TO_PATH:6,ADD_TO_PATH:7,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4},t.UnexpectedResponseException=d,t.UnknownErrorException=l,t.Util=x,t.XRefParseException=m,t.arrayByteLength=y,t.arraysToBytes=function(t){if(1===t.length&&t[0]instanceof Uint8Array)return t[0];var e,n,i,r=0,o=t.length;for(e=0;e<o;e++)r+=i=y(n=t[e]);var a=0,s=new Uint8Array(r);for(e=0;e<o;e++)(n=t[e])instanceof Uint8Array||(n="string"==typeof n?v(n):new Uint8Array(n)),i=n.byteLength,s.set(n,a),a+=i;return s},t.assert=s,t.bytesToString=function(t){s(null!==t&&"object"==typeof t&&void 0!==t.length,"Invalid argument for bytesToString");var e=t.length;if(e<8192)return String.fromCharCode.apply(null,t);for(var n=[],i=0;i<e;i+=8192){var r=Math.min(i+8192,e),o=t.subarray(i,r);n.push(String.fromCharCode.apply(null,o))}return n.join("")},t.createBlob=T,t.createPromiseCapability=E,t.createObjectURL=M,t.deprecated=function(t){console.log("Deprecated API usage: "+t)},t.error=a,t.getLookupTableFactory=function(t){var e;return function(){return t&&(e=Object.create(null),t(e),t=null),e}},t.getVerbosityLevel=function(){return r},t.globalScope=e,t.info=function(t){r>=n.infos&&console.log("Info: "+t)},t.isArray=function(t){return t instanceof Array},t.isArrayBuffer=function(t){return"object"==typeof t&&null!==t&&void 0!==t.byteLength},t.isBool=function(t){return"boolean"==typeof t},t.isEmptyObj=function(t){for(var e in t)return!1;return!0},t.isInt=S,t.isNum=function(t){return"number"==typeof t},t.isString=function(t){return"string"==typeof t},t.isSpace=function(t){return 32===t||9===t||13===t||10===t},t.isSameOrigin=function(t,e){try{var n=new URL(t);if(!n.origin||"null"===n.origin)return!1}catch(t){return!1}var i=new URL(e,n);return n.origin===i.origin},t.createValidAbsoluteUrl=function(t,e){if(!t)return null;try{var n=e?new URL(t,e):new URL(t);if(function(t){if(!t)return!1;switch(t.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}(n))return n}catch(t){}return null},t.isLittleEndian=function(){var t=new Uint8Array(2);return t[0]=1,1===new Uint16Array(t.buffer)[0]},t.isEvalSupported=function(){try{return new Function(""),!0}catch(t){return!1}},t.loadJpegStream=function(t,e,n){var i=new Image;i.onload=function(){n.resolve(t,i)},i.onerror=function(){n.resolve(t,null),o("Error during JPEG image loading")},i.src=e},t.log2=function(t){for(var e=1,n=0;t>e;)e<<=1,n++;return n},t.readInt8=function(t,e){return t[e]<<24>>24},t.readUint16=function(t,e){return t[e]<<8|t[e+1]},t.readUint32=function(t,e){return(t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3])>>>0},t.removeNullCharacters=function(t){return"string"!=typeof t?(o("The argument for removeNullCharacters must be a string."),t):t.replace(g,"")},t.setVerbosityLevel=function(t){r=t},t.shadow=function(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!1}),n},t.string32=function(t){return String.fromCharCode(t>>24&255,t>>16&255,t>>8&255,255&t)},t.stringToBytes=v,t.stringToPDFString=function(t){var e,n=t.length,i=[];if("Ã¾"===t[0]&&"Ã¿"===t[1])for(e=2;e<n;e+=2)i.push(String.fromCharCode(t.charCodeAt(e)<<8|t.charCodeAt(e+1)));else for(e=0;e<n;++e){var r=_[t.charCodeAt(e)];i.push(r?String.fromCharCode(r):t.charAt(e))}return i.join("")},t.stringToUTF8String=function(t){return decodeURIComponent(escape(t))},t.utf8StringToString=function(t){return unescape(encodeURIComponent(t))},t.warn=o}(t.pdfjsSharedUtil={})}(this),function(t,e){!function(t,e){var n,i=e.removeNullCharacters,r=e.warn,o=e.deprecated,a=e.createValidAbsoluteUrl,s=function(){var t=["ms","Moz","Webkit","O"],e=Object.create(null);function n(){}return n.getProp=function(n,i){if(1===arguments.length&&"string"==typeof e[n])return e[n];var r,o,a=(i=i||document.documentElement).style;if("string"==typeof a[n])return e[n]=n;o=n.charAt(0).toUpperCase()+n.slice(1);for(var s=0,c=t.length;s<c;s++)if("string"==typeof a[r=t[s]+o])return e[n]=r;return e[n]="undefined"},n.setProp=function(t,e,n){var i=this.getProp(t);"undefined"!==i&&(e.style[i]=n)},n}();n=function(){var t=document.createElement("canvas");return t.width=t.height=1,void 0!==t.getContext("2d").createImageData(1,1).data.buffer};var c={NONE:0,SELF:1,BLANK:2,PARENT:3,TOP:4},l=["","_self","_blank","_parent","_top"];function h(t){var n=e.globalScope.PDFJS;switch(t){case"pdfBug":return!!n&&n.pdfBug;case"disableAutoFetch":return!!n&&n.disableAutoFetch;case"disableStream":return!!n&&n.disableStream;case"disableRange":return!!n&&n.disableRange;case"disableFontFace":return!!n&&n.disableFontFace;case"disableCreateObjectURL":return!!n&&n.disableCreateObjectURL;case"disableWebGL":return!n||n.disableWebGL;case"cMapUrl":return n?n.cMapUrl:null;case"cMapPacked":return!!n&&n.cMapPacked;case"postMessageTransfers":return!n||n.postMessageTransfers;case"workerSrc":return n?n.workerSrc:null;case"disableWorker":return!!n&&n.disableWorker;case"maxImageSize":return n?n.maxImageSize:-1;case"imageResourcesPath":return n?n.imageResourcesPath:"";case"isEvalSupported":return!n||n.isEvalSupported;case"externalLinkTarget":if(!n)return c.NONE;switch(n.externalLinkTarget){case c.NONE:case c.SELF:case c.BLANK:case c.PARENT:case c.TOP:return n.externalLinkTarget}return r("PDFJS.externalLinkTarget is invalid: "+n.externalLinkTarget),n.externalLinkTarget=c.NONE,c.NONE;case"externalLinkRel":return n?n.externalLinkRel:"noopener noreferrer nofollow";case"enableStats":return!(!n||!n.enableStats);default:throw new Error("Unknown default setting: "+t)}}t.CustomStyle=s,t.addLinkAttributes=function(t,e){var n=e&&e.url;if(t.href=t.title=n?i(n):"",n){var r=e.target;void 0===r&&(r=h("externalLinkTarget")),t.target=l[r];var o=e.rel;void 0===o&&(o=h("externalLinkRel")),t.rel=o}},t.isExternalLinkTargetSet=function(){switch(h("externalLinkTarget")){case c.NONE:return!1;case c.SELF:case c.BLANK:case c.PARENT:case c.TOP:return!0}},t.isValidUrl=function(t,e){return o("isValidUrl(), please use createValidAbsoluteUrl() instead."),null!==a(t,e?"http://example.com":null)},t.getFilenameFromUrl=function(t){var e=t.indexOf("#"),n=t.indexOf("?"),i=Math.min(e>0?e:t.length,n>0?n:t.length);return t.substring(t.lastIndexOf("/",i)+1,i)},t.LinkTarget=c,t.hasCanvasTypedArrays=n,t.getDefaultSetting=h,t.DEFAULT_LINK_REL="noopener noreferrer nofollow"}(t.pdfjsDisplayDOMUtils={},t.pdfjsSharedUtil)}(this),function(t,e){!function(t,e){var n=e.assert,i=e.bytesToString,r=e.string32,o=e.shadow,a=e.warn;function s(t){this.docId=t,this.styleElement=null,this.nativeFontFaces=[],this.loadTestFontId=0,this.loadingContext={requests:[],nextRequestId:0}}s.prototype={insertRule:function(t){var e=this.styleElement;e||((e=this.styleElement=document.createElement("style")).id="PDFJS_FONT_STYLE_TAG_"+this.docId,document.documentElement.getElementsByTagName("head")[0].appendChild(e));var n=e.sheet;n.insertRule(t,n.cssRules.length)},clear:function(){var t=this.styleElement;t&&(t.parentNode.removeChild(t),t=this.styleElement=null),this.nativeFontFaces.forEach((function(t){document.fonts.delete(t)})),this.nativeFontFaces.length=0}};Object.defineProperty(s.prototype,"loadTestFont",{get:function(){return o(this,"loadTestFont",atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA=="))},configurable:!0}),s.prototype.addNativeFontFace=function(t){this.nativeFontFaces.push(t),document.fonts.add(t)},s.prototype.bind=function(t,e){for(var n=[],i=[],r=[],o=function(t){return t.loaded.catch((function(e){a('Failed to load font "'+t.family+'": '+e)}))},c=s.isFontLoadingAPISupported&&!s.isSyncFontLoadingSupported,l=0,h=t.length;l<h;l++){var u=t[l];if(!u.attached&&!1!==u.loading)if(u.attached=!0,c){var d=u.createNativeFontFace();d&&(this.addNativeFontFace(d),r.push(o(d)))}else{var p=u.createFontFaceRule();p&&(this.insertRule(p),n.push(p),i.push(u))}}var f=this.queueLoadingCallback(e);c?Promise.all(r).then((function(){f.complete()})):n.length>0&&!s.isSyncFontLoadingSupported?this.prepareFontLoadEvent(n,i,f):f.complete()},s.prototype.queueLoadingCallback=function(t){var e=this.loadingContext,i={id:"pdfjs-font-loading-"+e.nextRequestId++,complete:function(){for(n(!i.end,"completeRequest() cannot be called twice"),i.end=Date.now();e.requests.length>0&&e.requests[0].end;){var t=e.requests.shift();setTimeout(t.callback,0)}},callback:t,started:Date.now()};return e.requests.push(i),i},s.prototype.prepareFontLoadEvent=function(t,e,n){function i(t,e){return t.charCodeAt(e)<<24|t.charCodeAt(e+1)<<16|t.charCodeAt(e+2)<<8|255&t.charCodeAt(e+3)}function o(t,e,n,i){return t.substr(0,e)+i+t.substr(e+n)}var s,c,l=document.createElement("canvas");l.width=1,l.height=1;var h=l.getContext("2d"),u=0;var d="lt"+Date.now()+this.loadTestFontId++,p=this.loadTestFont,f=i(p=o(p,976,d.length,d),16);for(s=0,c=d.length-3;s<c;s+=4)f=f-1482184792+i(d,s)|0;s<d.length&&(f=f-1482184792+i(d+"XXX",s)|0),p=o(p,16,4,r(f));var m='@font-face { font-family:"'+d+'";src:'+("url(data:font/opentype;base64,"+btoa(p)+");")+"}";this.insertRule(m);var g=[];for(s=0,c=e.length;s<c;s++)g.push(e[s].loadedName);g.push(d);var v=document.createElement("div");for(v.setAttribute("style","visibility: hidden;width: 10px; height: 10px;position: absolute; top: 0px; left: 0px;"),s=0,c=g.length;s<c;++s){var y=document.createElement("span");y.textContent="Hi",y.style.fontFamily=g[s],v.appendChild(y)}document.body.appendChild(v),function t(e,n){if(++u>30)return a("Load test font never loaded."),void n();h.font="30px "+e,h.fillText(".",0,20),h.getImageData(0,0,1,1).data[3]>0?n():setTimeout(t.bind(null,e,n))}(d,(function(){document.body.removeChild(v),n.complete()}))},s.isFontLoadingAPISupported="undefined"!=typeof document&&!!document.fonts;Object.defineProperty(s,"isSyncFontLoadingSupported",{get:function(){return o(s,"isSyncFontLoadingSupported",function(){if("undefined"==typeof navigator)return!0;var t=!1,e=/Mozilla\/5.0.*?rv:(\d+).*? Gecko/.exec(navigator.userAgent);return e&&e[1]>=14&&(t=!0),t}())},enumerable:!0,configurable:!0});var c={get value(){return o(this,"value",e.isEvalSupported())}},l=function(){function t(t,e){for(var n in this.compiledGlyphs=Object.create(null),t)this[n]=t[n];this.options=e}return t.prototype={createNativeFontFace:function(){if(!this.data)return null;if(this.options.disableFontFace)return this.disableFontFace=!0,null;var t=new FontFace(this.loadedName,this.data,{});return this.options.fontRegistry&&this.options.fontRegistry.registerFont(this),t},createFontFaceRule:function(){if(!this.data)return null;if(this.options.disableFontFace)return this.disableFontFace=!0,null;var t=i(new Uint8Array(this.data)),e=this.loadedName,n="url(data:"+this.mimetype+";base64,"+btoa(t)+");",r='@font-face { font-family:"'+e+'";src:'+n+"}";return this.options.fontRegistry&&this.options.fontRegistry.registerFont(this,n),r},getPathGenerator:function(t,e){if(!(e in this.compiledGlyphs)){var n,i,r,o=t.get(this.loadedName+"_path_"+e);if(this.options.isEvalSupported&&c.value){var a,s="";for(i=0,r=o.length;i<r;i++)a=void 0!==(n=o[i]).args?n.args.join(","):"",s+="c."+n.cmd+"("+a+");\n";this.compiledGlyphs[e]=new Function("c","size",s)}else this.compiledGlyphs[e]=function(t,e){for(i=0,r=o.length;i<r;i++)"scale"===(n=o[i]).cmd&&(n.args=[e,-e]),t[n.cmd].apply(t,n.args)}}return this.compiledGlyphs[e]}},t}();t.FontFaceObject=l,t.FontLoader=s}(t.pdfjsDisplayFontLoader={},t.pdfjsSharedUtil)}(this),function(t,e){!function(t,e){var n=e.error;function i(t){"string"==typeof t?(t=function(t){return t.replace(/>\\376\\377([^<]+)/g,(function(t,e){for(var n=e.replace(/\\([0-3])([0-7])([0-7])/g,(function(t,e,n,i){return String.fromCharCode(64*e+8*n+1*i)})),i="",r=0;r<n.length;r+=2){var o=256*n.charCodeAt(r)+n.charCodeAt(r+1);i+=o>=32&&o<127&&60!==o&&62!==o&&38!==o?String.fromCharCode(o):"&#x"+(65536+o).toString(16).substring(1)+";"}return">"+i}))}(t),t=(new DOMParser).parseFromString(t,"application/xml")):t instanceof Document||n("Metadata: Invalid metadata object");this.metaDocument=t,this.metadata=Object.create(null),this.parse()}i.prototype={parse:function(){var t=this.metaDocument.documentElement;if("rdf:rdf"!==t.nodeName.toLowerCase())for(t=t.firstChild;t&&"rdf:rdf"!==t.nodeName.toLowerCase();)t=t.nextSibling;var e=t?t.nodeName.toLowerCase():null;if(t&&"rdf:rdf"===e&&t.hasChildNodes()){var n,i,r,o,a,s,c,l=t.childNodes;for(o=0,s=l.length;o<s;o++)if("rdf:description"===(n=l[o]).nodeName.toLowerCase())for(a=0,c=n.childNodes.length;a<c;a++)"#text"!==n.childNodes[a].nodeName.toLowerCase()&&(r=(i=n.childNodes[a]).nodeName.toLowerCase(),this.metadata[r]=i.textContent.trim())}},get:function(t){return this.metadata[t]||null},has:function(t){return void 0!==this.metadata[t]}},t.Metadata=i}(t.pdfjsDisplayMetadata={},t.pdfjsSharedUtil)}(this),function(t,e){!function(t,e){var n=e.FONT_IDENTITY_MATRIX,i=e.IDENTITY_MATRIX,r=e.ImageKind,o=e.OPS,a=e.Util,s=e.isNum,c=e.isArray,l=e.warn,h=e.createObjectURL,u="normal",d="normal",p="#000000",f=function(){for(var t=new Uint8Array([137,80,78,71,13,10,26,10]),e=new Int32Array(256),n=0;n<256;n++){for(var i=n,o=0;o<8;o++)i=1&i?3988292384^i>>1&2147483647:i>>1&2147483647;e[n]=i}function a(t,n,i,r){var o=r,a=n.length;i[o]=a>>24&255,i[o+1]=a>>16&255,i[o+2]=a>>8&255,i[o+3]=255&a,i[o+=4]=255&t.charCodeAt(0),i[o+1]=255&t.charCodeAt(1),i[o+2]=255&t.charCodeAt(2),i[o+3]=255&t.charCodeAt(3),o+=4,i.set(n,o);var s=function(t,n,i){for(var r=-1,o=n;o<i;o++){var a=255&(r^t[o]);r=r>>>8^e[a]}return-1^r}(i,r+4,o+=n.length);i[o]=s>>24&255,i[o+1]=s>>16&255,i[o+2]=s>>8&255,i[o+3]=255&s}return function(e,n){return function(e,n,i){var o,s,c,l=e.width,u=e.height,d=e.data;switch(n){case r.GRAYSCALE_1BPP:s=0,o=1,c=l+7>>3;break;case r.RGB_24BPP:s=2,o=8,c=3*l;break;case r.RGBA_32BPP:s=6,o=8,c=4*l;break;default:throw new Error("invalid format")}var p,f,m=new Uint8Array((1+c)*u),g=0,v=0;for(p=0;p<u;++p)m[g++]=0,m.set(d.subarray(v,v+c),g),v+=c,g+=c;if(n===r.GRAYSCALE_1BPP)for(g=0,p=0;p<u;p++)for(g++,f=0;f<c;f++)m[g++]^=255;var y=new Uint8Array([l>>24&255,l>>16&255,l>>8&255,255&l,u>>24&255,u>>16&255,u>>8&255,255&u,o,s,0,0,0]),b=m.length,x=Math.ceil(b/65535),w=new Uint8Array(2+b+5*x+4),_=0;w[_++]=120,w[_++]=156;for(var S=0;b>65535;)w[_++]=0,w[_++]=255,w[_++]=255,w[_++]=0,w[_++]=0,w.set(m.subarray(S,S+65535),_),_+=65535,S+=65535,b-=65535;w[_++]=1,w[_++]=255&b,w[_++]=b>>8&255,w[_++]=255&~b,w[_++]=(65535&~b)>>8&255,w.set(m.subarray(S),_),_+=m.length-S;var E=function(t,e,n){for(var i=1,r=0,o=e;o<n;++o)r=(r+(i=(i+(255&t[o]))%65521))%65521;return r<<16|i}(m,0,m.length);w[_++]=E>>24&255,w[_++]=E>>16&255,w[_++]=E>>8&255,w[_++]=255&E;var A=t.length+36+y.length+w.length,T=new Uint8Array(A),M=0;return T.set(t,M),a("IHDR",y,T,M+=t.length),a("IDATA",w,T,M+=12+y.length),M+=12+w.length,a("IEND",new Uint8Array(0),T,M),h(T,"image/png",i)}(e,void 0===e.kind?r.GRAYSCALE_1BPP:e.kind,n)}}(),m=function(){function t(){this.fontSizeScale=1,this.fontWeight=d,this.fontSize=0,this.textMatrix=i,this.fontMatrix=n,this.leading=0,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRise=0,this.fillColor=p,this.strokeColor="#000000",this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.lineJoin="",this.lineCap="",this.miterLimit=0,this.dashArray=[],this.dashPhase=0,this.dependencies=[],this.activeClipUrl=null,this.clipGroup=null,this.maskId=""}return t.prototype={clone:function(){return Object.create(this)},setCurrentPoint:function(t,e){this.x=t,this.y=e}},t}(),g=function(){function t(t){if(t===(0|t))return t.toString();var e=t.toFixed(10),n=e.length-1;if("0"!==e[n])return e;do{n--}while("0"===e[n]);return e.substr(0,"."===e[n]?n:n+1)}function e(e){if(0===e[4]&&0===e[5]){if(0===e[1]&&0===e[2])return 1===e[0]&&1===e[3]?"":"scale("+t(e[0])+" "+t(e[3])+")";if(e[0]===e[3]&&e[1]===-e[2])return"rotate("+t(180*Math.acos(e[0])/Math.PI)+")"}else if(1===e[0]&&0===e[1]&&0===e[2]&&1===e[3])return"translate("+t(e[4])+" "+t(e[5])+")";return"matrix("+t(e[0])+" "+t(e[1])+" "+t(e[2])+" "+t(e[3])+" "+t(e[4])+" "+t(e[5])+")"}function r(t,e,n){this.current=new m,this.transformMatrix=i,this.transformStack=[],this.extraStack=[],this.commonObjs=t,this.objs=e,this.pendingEOFill=!1,this.embedFonts=!1,this.embeddedFonts=Object.create(null),this.cssStyle=null,this.forceDataSchema=!!n}var g="http://www.w3.org/2000/svg",v="http://www.w3.org/1999/xlink",y=["butt","round","square"],b=["miter","round","bevel"],x=0,w=0;return r.prototype={save:function(){this.transformStack.push(this.transformMatrix);var t=this.current;this.extraStack.push(t),this.current=t.clone()},restore:function(){this.transformMatrix=this.transformStack.pop(),this.current=this.extraStack.pop(),this.tgrp=null},group:function(t){this.save(),this.executeOpTree(t),this.restore()},loadDependencies:function(t){for(var e=t.fnArray,n=e.length,i=t.argsArray,r=this,a=0;a<n;a++)if(o.dependency===e[a])for(var s=i[a],c=0,l=s.length;c<l;c++){var h,u=s[c],d="g_"===u.substring(0,2);h=new Promise(d?function(t){r.commonObjs.get(u,t)}:function(t){r.objs.get(u,t)}),this.current.dependencies.push(h)}return Promise.all(this.current.dependencies)},transform:function(t,e,n,i,r,o){var s=[t,e,n,i,r,o];this.transformMatrix=a.transform(this.transformMatrix,s),this.tgrp=null},getSVG:function(t,e){this.viewport=e;var n=this._initialize(e);return this.loadDependencies(t).then(function(){this.transformMatrix=i;var e=this.convertOpList(t);return this.executeOpTree(e),n}.bind(this))},convertOpList:function(t){var e=t.argsArray,n=t.fnArray,i=n.length,r=[],a=[];for(var s in o)r[o[s]]=s;for(var c=0;c<i;c++){var l=n[c];a.push({fnId:l,fn:r[l],args:e[c]})}return function(t){for(var e=[],n=[],i=t.length,r=0;r<i;r++)"save"!==t[r].fn?"restore"===t[r].fn?e=n.pop():e.push(t[r]):(e.push({fnId:92,fn:"group",items:[]}),n.push(e),e=e[e.length-1].items);return e}(a)},executeOpTree:function(t){for(var e=t.length,n=0;n<e;n++){var i=t[n].fn,r=t[n].fnId,a=t[n].args;switch(0|r){case o.beginText:this.beginText();break;case o.setLeading:this.setLeading(a);break;case o.setLeadingMoveText:this.setLeadingMoveText(a[0],a[1]);break;case o.setFont:this.setFont(a);break;case o.showText:case o.showSpacedText:this.showText(a[0]);break;case o.endText:this.endText();break;case o.moveText:this.moveText(a[0],a[1]);break;case o.setCharSpacing:this.setCharSpacing(a[0]);break;case o.setWordSpacing:this.setWordSpacing(a[0]);break;case o.setHScale:this.setHScale(a[0]);break;case o.setTextMatrix:this.setTextMatrix(a[0],a[1],a[2],a[3],a[4],a[5]);break;case o.setLineWidth:this.setLineWidth(a[0]);break;case o.setLineJoin:this.setLineJoin(a[0]);break;case o.setLineCap:this.setLineCap(a[0]);break;case o.setMiterLimit:this.setMiterLimit(a[0]);break;case o.setFillRGBColor:this.setFillRGBColor(a[0],a[1],a[2]);break;case o.setStrokeRGBColor:this.setStrokeRGBColor(a[0],a[1],a[2]);break;case o.setDash:this.setDash(a[0],a[1]);break;case o.setGState:this.setGState(a[0]);break;case o.fill:this.fill();break;case o.eoFill:this.eoFill();break;case o.stroke:this.stroke();break;case o.fillStroke:this.fillStroke();break;case o.eoFillStroke:this.eoFillStroke();break;case o.clip:this.clip("nonzero");break;case o.eoClip:this.clip("evenodd");break;case o.paintSolidColorImageMask:this.paintSolidColorImageMask();break;case o.paintJpegXObject:this.paintJpegXObject(a[0],a[1],a[2]);break;case o.paintImageXObject:this.paintImageXObject(a[0]);break;case o.paintInlineImageXObject:this.paintInlineImageXObject(a[0]);break;case o.paintImageMaskXObject:this.paintImageMaskXObject(a[0]);break;case o.paintFormXObjectBegin:this.paintFormXObjectBegin(a[0],a[1]);break;case o.paintFormXObjectEnd:this.paintFormXObjectEnd();break;case o.closePath:this.closePath();break;case o.closeStroke:this.closeStroke();break;case o.closeFillStroke:this.closeFillStroke();break;case o.nextLine:this.nextLine();break;case o.transform:this.transform(a[0],a[1],a[2],a[3],a[4],a[5]);break;case o.constructPath:this.constructPath(a[0],a[1]);break;case o.endPath:this.endPath();break;case 92:this.group(t[n].items);break;default:l("Unimplemented operator "+i)}}},setWordSpacing:function(t){this.current.wordSpacing=t},setCharSpacing:function(t){this.current.charSpacing=t},nextLine:function(){this.moveText(0,this.current.leading)},setTextMatrix:function(e,n,i,r,o,a){var s=this.current;this.current.textMatrix=this.current.lineMatrix=[e,n,i,r,o,a],this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0,s.xcoords=[],s.tspan=document.createElementNS(g,"svg:tspan"),s.tspan.setAttributeNS(null,"font-family",s.fontFamily),s.tspan.setAttributeNS(null,"font-size",t(s.fontSize)+"px"),s.tspan.setAttributeNS(null,"y",t(-s.y)),s.txtElement=document.createElementNS(g,"svg:text"),s.txtElement.appendChild(s.tspan)},beginText:function(){this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0,this.current.textMatrix=i,this.current.lineMatrix=i,this.current.tspan=document.createElementNS(g,"svg:tspan"),this.current.txtElement=document.createElementNS(g,"svg:text"),this.current.txtgrp=document.createElementNS(g,"svg:g"),this.current.xcoords=[]},moveText:function(e,n){var i=this.current;this.current.x=this.current.lineX+=e,this.current.y=this.current.lineY+=n,i.xcoords=[],i.tspan=document.createElementNS(g,"svg:tspan"),i.tspan.setAttributeNS(null,"font-family",i.fontFamily),i.tspan.setAttributeNS(null,"font-size",t(i.fontSize)+"px"),i.tspan.setAttributeNS(null,"y",t(-i.y))},showText:function(n){var i=this.current,r=i.font,o=i.fontSize;if(0!==o){var a,c=i.charSpacing,l=i.wordSpacing,h=i.fontDirection,f=i.textHScale*h,m=n.length,g=r.vertical,v=o*i.fontMatrix[0],y=0;for(a=0;a<m;++a){var b=n[a];if(null!==b)if(s(b))y+=-b*o*.001;else{i.xcoords.push(i.x+y*f);var x=b.width,w=b.fontChar;y+=x*v+c*h,i.tspan.textContent+=w}else y+=h*l}g?i.y-=y*f:i.x+=y*f,i.tspan.setAttributeNS(null,"x",i.xcoords.map(t).join(" ")),i.tspan.setAttributeNS(null,"y",t(-i.y)),i.tspan.setAttributeNS(null,"font-family",i.fontFamily),i.tspan.setAttributeNS(null,"font-size",t(i.fontSize)+"px"),i.fontStyle!==u&&i.tspan.setAttributeNS(null,"font-style",i.fontStyle),i.fontWeight!==d&&i.tspan.setAttributeNS(null,"font-weight",i.fontWeight),i.fillColor!==p&&i.tspan.setAttributeNS(null,"fill",i.fillColor),i.txtElement.setAttributeNS(null,"transform",e(i.textMatrix)+" scale(1, -1)"),i.txtElement.setAttributeNS("http://www.w3.org/XML/1998/namespace","xml:space","preserve"),i.txtElement.appendChild(i.tspan),i.txtgrp.appendChild(i.txtElement),this._ensureTransformGroup().appendChild(i.txtElement)}},setLeadingMoveText:function(t,e){this.setLeading(-e),this.moveText(t,e)},addFontStyle:function(t){this.cssStyle||(this.cssStyle=document.createElementNS(g,"svg:style"),this.cssStyle.setAttributeNS(null,"type","text/css"),this.defs.appendChild(this.cssStyle));var e=h(t.data,t.mimetype,this.forceDataSchema);this.cssStyle.textContent+='@font-face { font-family: "'+t.loadedName+'"; src: url('+e+"); }\n"},setFont:function(e){var i=this.current,r=this.commonObjs.get(e[0]),o=e[1];this.current.font=r,this.embedFonts&&r.data&&!this.embeddedFonts[r.loadedName]&&(this.addFontStyle(r),this.embeddedFonts[r.loadedName]=r),i.fontMatrix=r.fontMatrix?r.fontMatrix:n;var a=r.black?r.bold?"bolder":"bold":r.bold?"bold":"normal",s=r.italic?"italic":"normal";o<0?(o=-o,i.fontDirection=-1):i.fontDirection=1,i.fontSize=o,i.fontFamily=r.loadedName,i.fontWeight=a,i.fontStyle=s,i.tspan=document.createElementNS(g,"svg:tspan"),i.tspan.setAttributeNS(null,"y",t(-i.y)),i.xcoords=[]},endText:function(){},setLineWidth:function(t){this.current.lineWidth=t},setLineCap:function(t){this.current.lineCap=y[t]},setLineJoin:function(t){this.current.lineJoin=b[t]},setMiterLimit:function(t){this.current.miterLimit=t},setStrokeRGBColor:function(t,e,n){var i=a.makeCssRgb(t,e,n);this.current.strokeColor=i},setFillRGBColor:function(t,e,n){var i=a.makeCssRgb(t,e,n);this.current.fillColor=i,this.current.tspan=document.createElementNS(g,"svg:tspan"),this.current.xcoords=[]},setDash:function(t,e){this.current.dashArray=t,this.current.dashPhase=e},constructPath:function(e,n){var i=this.current,r=i.x,a=i.y;i.path=document.createElementNS(g,"svg:path");for(var s=[],c=e.length,l=0,h=0;l<c;l++)switch(0|e[l]){case o.rectangle:r=n[h++],a=n[h++];var u=r+n[h++],d=a+n[h++];s.push("M",t(r),t(a),"L",t(u),t(a),"L",t(u),t(d),"L",t(r),t(d),"Z");break;case o.moveTo:r=n[h++],a=n[h++],s.push("M",t(r),t(a));break;case o.lineTo:r=n[h++],a=n[h++],s.push("L",t(r),t(a));break;case o.curveTo:r=n[h+4],a=n[h+5],s.push("C",t(n[h]),t(n[h+1]),t(n[h+2]),t(n[h+3]),t(r),t(a)),h+=6;break;case o.curveTo2:r=n[h+2],a=n[h+3],s.push("C",t(r),t(a),t(n[h]),t(n[h+1]),t(n[h+2]),t(n[h+3])),h+=4;break;case o.curveTo3:r=n[h+2],a=n[h+3],s.push("C",t(n[h]),t(n[h+1]),t(r),t(a),t(r),t(a)),h+=4;break;case o.closePath:s.push("Z")}i.path.setAttributeNS(null,"d",s.join(" ")),i.path.setAttributeNS(null,"stroke-miterlimit",t(i.miterLimit)),i.path.setAttributeNS(null,"stroke-linecap",i.lineCap),i.path.setAttributeNS(null,"stroke-linejoin",i.lineJoin),i.path.setAttributeNS(null,"stroke-width",t(i.lineWidth)+"px"),i.path.setAttributeNS(null,"stroke-dasharray",i.dashArray.map(t).join(" ")),i.path.setAttributeNS(null,"stroke-dashoffset",t(i.dashPhase)+"px"),i.path.setAttributeNS(null,"fill","none"),this._ensureTransformGroup().appendChild(i.path),i.element=i.path,i.setCurrentPoint(r,a)},endPath:function(){},clip:function(t){var n=this.current,i="clippath"+x;x++;var r=document.createElementNS(g,"svg:clipPath");r.setAttributeNS(null,"id",i),r.setAttributeNS(null,"transform",e(this.transformMatrix));var o=n.element.cloneNode();"evenodd"===t?o.setAttributeNS(null,"clip-rule","evenodd"):o.setAttributeNS(null,"clip-rule","nonzero"),r.appendChild(o),this.defs.appendChild(r),n.activeClipUrl&&(n.clipGroup=null,this.extraStack.forEach((function(t){t.clipGroup=null}))),n.activeClipUrl="url(#"+i+")",this.tgrp=null},closePath:function(){var t=this.current,e=t.path.getAttributeNS(null,"d");e+="Z",t.path.setAttributeNS(null,"d",e)},setLeading:function(t){this.current.leading=-t},setTextRise:function(t){this.current.textRise=t},setHScale:function(t){this.current.textHScale=t/100},setGState:function(t){for(var e=0,n=t.length;e<n;e++){var i=t[e],r=i[0],o=i[1];switch(r){case"LW":this.setLineWidth(o);break;case"LC":this.setLineCap(o);break;case"LJ":this.setLineJoin(o);break;case"ML":this.setMiterLimit(o);break;case"D":this.setDash(o[0],o[1]);break;case"Font":this.setFont(o);break;default:l("Unimplemented graphic state "+r)}}},fill:function(){var t=this.current;t.element.setAttributeNS(null,"fill",t.fillColor)},stroke:function(){var t=this.current;t.element.setAttributeNS(null,"stroke",t.strokeColor),t.element.setAttributeNS(null,"fill","none")},eoFill:function(){var t=this.current;t.element.setAttributeNS(null,"fill",t.fillColor),t.element.setAttributeNS(null,"fill-rule","evenodd")},fillStroke:function(){this.stroke(),this.fill()},eoFillStroke:function(){this.current.element.setAttributeNS(null,"fill-rule","evenodd"),this.fillStroke()},closeStroke:function(){this.closePath(),this.stroke()},closeFillStroke:function(){this.closePath(),this.fillStroke()},paintSolidColorImageMask:function(){var t=this.current,e=document.createElementNS(g,"svg:rect");e.setAttributeNS(null,"x","0"),e.setAttributeNS(null,"y","0"),e.setAttributeNS(null,"width","1px"),e.setAttributeNS(null,"height","1px"),e.setAttributeNS(null,"fill",t.fillColor),this._ensureTransformGroup().appendChild(e)},paintJpegXObject:function(e,n,i){var r=this.objs.get(e),o=document.createElementNS(g,"svg:image");o.setAttributeNS(v,"xlink:href",r.src),o.setAttributeNS(null,"width",r.width+"px"),o.setAttributeNS(null,"height",r.height+"px"),o.setAttributeNS(null,"x","0"),o.setAttributeNS(null,"y",t(-i)),o.setAttributeNS(null,"transform","scale("+t(1/n)+" "+t(-1/i)+")"),this._ensureTransformGroup().appendChild(o)},paintImageXObject:function(t){var e=this.objs.get(t);e?this.paintInlineImageXObject(e):l("Dependent image isn't ready yet")},paintInlineImageXObject:function(e,n){var i=e.width,r=e.height,o=f(e,this.forceDataSchema),a=document.createElementNS(g,"svg:rect");a.setAttributeNS(null,"x","0"),a.setAttributeNS(null,"y","0"),a.setAttributeNS(null,"width",t(i)),a.setAttributeNS(null,"height",t(r)),this.current.element=a,this.clip("nonzero");var s=document.createElementNS(g,"svg:image");s.setAttributeNS(v,"xlink:href",o),s.setAttributeNS(null,"x","0"),s.setAttributeNS(null,"y",t(-r)),s.setAttributeNS(null,"width",t(i)+"px"),s.setAttributeNS(null,"height",t(r)+"px"),s.setAttributeNS(null,"transform","scale("+t(1/i)+" "+t(-1/r)+")"),n?n.appendChild(s):this._ensureTransformGroup().appendChild(s)},paintImageMaskXObject:function(e){var n=this.current,i=e.width,r=e.height,o=n.fillColor;n.maskId="mask"+w++;var a=document.createElementNS(g,"svg:mask");a.setAttributeNS(null,"id",n.maskId);var s=document.createElementNS(g,"svg:rect");s.setAttributeNS(null,"x","0"),s.setAttributeNS(null,"y","0"),s.setAttributeNS(null,"width",t(i)),s.setAttributeNS(null,"height",t(r)),s.setAttributeNS(null,"fill",o),s.setAttributeNS(null,"mask","url(#"+n.maskId+")"),this.defs.appendChild(a),this._ensureTransformGroup().appendChild(s),this.paintInlineImageXObject(e,a)},paintFormXObjectBegin:function(e,n){if(c(e)&&6===e.length&&this.transform(e[0],e[1],e[2],e[3],e[4],e[5]),c(n)&&4===n.length){var i=n[2]-n[0],r=n[3]-n[1],o=document.createElementNS(g,"svg:rect");o.setAttributeNS(null,"x",n[0]),o.setAttributeNS(null,"y",n[1]),o.setAttributeNS(null,"width",t(i)),o.setAttributeNS(null,"height",t(r)),this.current.element=o,this.clip("nonzero"),this.endPath()}},paintFormXObjectEnd:function(){},_initialize:function(t){var n=document.createElementNS(g,"svg:svg");n.setAttributeNS(null,"version","1.1"),n.setAttributeNS(null,"width",t.width+"px"),n.setAttributeNS(null,"height",t.height+"px"),n.setAttributeNS(null,"preserveAspectRatio","none"),n.setAttributeNS(null,"viewBox","0 0 "+t.width+" "+t.height);var i=document.createElementNS(g,"svg:defs");n.appendChild(i),this.defs=i;var r=document.createElementNS(g,"svg:g");return r.setAttributeNS(null,"transform",e(t.transform)),n.appendChild(r),this.svg=r,n},_ensureClipGroup:function(){if(!this.current.clipGroup){var t=document.createElementNS(g,"svg:g");t.setAttributeNS(null,"clip-path",this.current.activeClipUrl),this.svg.appendChild(t),this.current.clipGroup=t}return this.current.clipGroup},_ensureTransformGroup:function(){return this.tgrp||(this.tgrp=document.createElementNS(g,"svg:g"),this.tgrp.setAttributeNS(null,"transform",e(this.transformMatrix)),this.current.activeClipUrl?this._ensureClipGroup().appendChild(this.tgrp):this.svg.appendChild(this.tgrp)),this.tgrp}},r}();t.SVGGraphics=g}(t.pdfjsDisplaySVG={},t.pdfjsSharedUtil)}(this),function(t,e){!function(t,e,n){var i=e.AnnotationBorderStyleType,r=e.AnnotationType,o=e.Util,a=n.addLinkAttributes,s=n.LinkTarget,c=n.getFilenameFromUrl,l=e.warn,h=n.CustomStyle,u=n.getDefaultSetting;function d(){}d.prototype={create:function(t){switch(t.data.annotationType){case r.LINK:return new f(t);case r.TEXT:return new m(t);case r.WIDGET:switch(t.data.fieldType){case"Tx":return new v(t);case"Btn":if(t.data.radioButton)return new b(t);if(t.data.checkBox)return new y(t);l("Unimplemented button widget annotation: pushbutton");break;case"Ch":return new x(t)}return new g(t);case r.POPUP:return new w(t);case r.HIGHLIGHT:return new S(t);case r.UNDERLINE:return new E(t);case r.SQUIGGLY:return new A(t);case r.STRIKEOUT:return new T(t);case r.FILEATTACHMENT:return new M(t);default:return new p(t)}}};var p=function(){function t(t,e){this.isRenderable=e||!1,this.data=t.data,this.layer=t.layer,this.page=t.page,this.viewport=t.viewport,this.linkService=t.linkService,this.downloadManager=t.downloadManager,this.imageResourcesPath=t.imageResourcesPath,this.renderInteractiveForms=t.renderInteractiveForms,e&&(this.container=this._createContainer())}return t.prototype={_createContainer:function(){var t=this.data,e=this.page,n=this.viewport,r=document.createElement("section"),a=t.rect[2]-t.rect[0],s=t.rect[3]-t.rect[1];r.setAttribute("data-annotation-id",t.id);var c=o.normalizeRect([t.rect[0],e.view[3]-t.rect[1]+e.view[1],t.rect[2],e.view[3]-t.rect[3]+e.view[1]]);if(h.setProp("transform",r,"matrix("+n.transform.join(",")+")"),h.setProp("transformOrigin",r,-c[0]+"px "+-c[1]+"px"),t.borderStyle.width>0){r.style.borderWidth=t.borderStyle.width+"px",t.borderStyle.style!==i.UNDERLINE&&(a-=2*t.borderStyle.width,s-=2*t.borderStyle.width);var u=t.borderStyle.horizontalCornerRadius,d=t.borderStyle.verticalCornerRadius;if(u>0||d>0){var p=u+"px / "+d+"px";h.setProp("borderRadius",r,p)}switch(t.borderStyle.style){case i.SOLID:r.style.borderStyle="solid";break;case i.DASHED:r.style.borderStyle="dashed";break;case i.BEVELED:l("Unimplemented border style: beveled");break;case i.INSET:l("Unimplemented border style: inset");break;case i.UNDERLINE:r.style.borderBottomStyle="solid"}t.color?r.style.borderColor=o.makeCssRgb(0|t.color[0],0|t.color[1],0|t.color[2]):r.style.borderWidth=0}return r.style.left=c[0]+"px",r.style.top=c[1]+"px",r.style.width=a+"px",r.style.height=s+"px",r},_createPopup:function(t,e,n){e||((e=document.createElement("div")).style.height=t.style.height,e.style.width=t.style.width,t.appendChild(e));var i=new _({container:t,trigger:e,color:n.color,title:n.title,contents:n.contents,hideWrapper:!0}).render();i.style.left=t.style.width,t.appendChild(i)},render:function(){throw new Error("Abstract method AnnotationElement.render called")}},t}(),f=function(){function t(t){p.call(this,t,!0)}return o.inherit(t,p,{render:function(){this.container.className="linkAnnotation";var t=document.createElement("a");return a(t,{url:this.data.url,target:this.data.newWindow?s.BLANK:void 0}),this.data.url||(this.data.action?this._bindNamedAction(t,this.data.action):this._bindLink(t,this.data.dest)),this.container.appendChild(t),this.container},_bindLink:function(t,e){var n=this;t.href=this.linkService.getDestinationHash(e),t.onclick=function(){return e&&n.linkService.navigateTo(e),!1},e&&(t.className="internalLink")},_bindNamedAction:function(t,e){var n=this;t.href=this.linkService.getAnchorUrl(""),t.onclick=function(){return n.linkService.executeNamedAction(e),!1},t.className="internalLink"}}),t}(),m=function(){function t(t){var e=!!(t.data.hasPopup||t.data.title||t.data.contents);p.call(this,t,e)}return o.inherit(t,p,{render:function(){this.container.className="textAnnotation";var t=document.createElement("img");return t.style.height=this.container.style.height,t.style.width=this.container.style.width,t.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",t.alt="[{{type}} Annotation]",t.dataset.l10nId="text_annotation_type",t.dataset.l10nArgs=JSON.stringify({type:this.data.name}),this.data.hasPopup||this._createPopup(this.container,t,this.data),this.container.appendChild(t),this.container}}),t}(),g=function(){function t(t,e){p.call(this,t,e)}return o.inherit(t,p,{render:function(){return this.container}}),t}(),v=function(){var t=["left","center","right"];function e(t){var e=t.renderInteractiveForms||!t.data.hasAppearance&&!!t.data.fieldValue;g.call(this,t,e)}return o.inherit(e,g,{render:function(){this.container.className="textWidgetAnnotation";var e=null;if(this.renderInteractiveForms){if(this.data.multiLine?(e=document.createElement("textarea")).textContent=this.data.fieldValue:((e=document.createElement("input")).type="text",e.setAttribute("value",this.data.fieldValue)),e.disabled=this.data.readOnly,null!==this.data.maxLen&&(e.maxLength=this.data.maxLen),this.data.comb){var n=(this.data.rect[2]-this.data.rect[0])/this.data.maxLen;e.classList.add("comb"),e.style.letterSpacing="calc("+n+"px - 1ch)"}}else{(e=document.createElement("div")).textContent=this.data.fieldValue,e.style.verticalAlign="middle",e.style.display="table-cell";var i=null;this.data.fontRefName&&(i=this.page.commonObjs.getData(this.data.fontRefName)),this._setTextStyle(e,i)}return null!==this.data.textAlignment&&(e.style.textAlign=t[this.data.textAlignment]),this.container.appendChild(e),this.container},_setTextStyle:function(t,e){var n=t.style;if(n.fontSize=this.data.fontSize+"px",n.direction=this.data.fontDirection<0?"rtl":"ltr",e){n.fontWeight=e.black?e.bold?"900":"bold":e.bold?"bold":"normal",n.fontStyle=e.italic?"italic":"normal";var i=e.loadedName?'"'+e.loadedName+'", ':"",r=e.fallbackName||"Helvetica, sans-serif";n.fontFamily=i+r}}}),e}(),y=function(){function t(t){g.call(this,t,t.renderInteractiveForms)}return o.inherit(t,g,{render:function(){this.container.className="buttonWidgetAnnotation checkBox";var t=document.createElement("input");return t.disabled=this.data.readOnly,t.type="checkbox",this.data.fieldValue&&"Off"!==this.data.fieldValue&&t.setAttribute("checked",!0),this.container.appendChild(t),this.container}}),t}(),b=function(){function t(t){g.call(this,t,t.renderInteractiveForms)}return o.inherit(t,g,{render:function(){this.container.className="buttonWidgetAnnotation radioButton";var t=document.createElement("input");return t.disabled=this.data.readOnly,t.type="radio",t.name=this.data.fieldName,this.data.fieldValue===this.data.buttonValue&&t.setAttribute("checked",!0),this.container.appendChild(t),this.container}}),t}(),x=function(){function t(t){g.call(this,t,t.renderInteractiveForms)}return o.inherit(t,g,{render:function(){this.container.className="choiceWidgetAnnotation";var t=document.createElement("select");t.disabled=this.data.readOnly,this.data.combo||(t.size=this.data.options.length,this.data.multiSelect&&(t.multiple=!0));for(var e=0,n=this.data.options.length;e<n;e++){var i=this.data.options[e],r=document.createElement("option");r.textContent=i.displayValue,r.value=i.exportValue,this.data.fieldValue.indexOf(i.displayValue)>=0&&r.setAttribute("selected",!0),t.appendChild(r)}return this.container.appendChild(t),this.container}}),t}(),w=function(){function t(t){var e=!(!t.data.title&&!t.data.contents);p.call(this,t,e)}return o.inherit(t,p,{render:function(){this.container.className="popupAnnotation";var t='[data-annotation-id="'+this.data.parentId+'"]',e=this.layer.querySelector(t);if(!e)return this.container;var n=new _({container:this.container,trigger:e,color:this.data.color,title:this.data.title,contents:this.data.contents}),i=parseFloat(e.style.left),r=parseFloat(e.style.width);return h.setProp("transformOrigin",this.container,-(i+r)+"px -"+e.style.top),this.container.style.left=i+r+"px",this.container.appendChild(n.render()),this.container}}),t}(),_=function(){function t(t){this.container=t.container,this.trigger=t.trigger,this.color=t.color,this.title=t.title,this.contents=t.contents,this.hideWrapper=t.hideWrapper||!1,this.pinned=!1}return t.prototype={render:function(){var t=document.createElement("div");t.className="popupWrapper",this.hideElement=this.hideWrapper?t:this.container,this.hideElement.setAttribute("hidden",!0);var e=document.createElement("div");e.className="popup";var n=this.color;if(n){var i=.7*(255-n[0])+n[0],r=.7*(255-n[1])+n[1],a=.7*(255-n[2])+n[2];e.style.backgroundColor=o.makeCssRgb(0|i,0|r,0|a)}var s=this._formatContents(this.contents),c=document.createElement("h1");return c.textContent=this.title,this.trigger.addEventListener("click",this._toggle.bind(this)),this.trigger.addEventListener("mouseover",this._show.bind(this,!1)),this.trigger.addEventListener("mouseout",this._hide.bind(this,!1)),e.addEventListener("click",this._hide.bind(this,!0)),e.appendChild(c),e.appendChild(s),t.appendChild(e),t},_formatContents:function(t){for(var e=document.createElement("p"),n=t.split(/(?:\r\n?|\n)/),i=0,r=n.length;i<r;++i){var o=n[i];e.appendChild(document.createTextNode(o)),i<r-1&&e.appendChild(document.createElement("br"))}return e},_toggle:function(){this.pinned?this._hide(!0):this._show(!0)},_show:function(t){t&&(this.pinned=!0),this.hideElement.hasAttribute("hidden")&&(this.hideElement.removeAttribute("hidden"),this.container.style.zIndex+=1)},_hide:function(t){t&&(this.pinned=!1),this.hideElement.hasAttribute("hidden")||this.pinned||(this.hideElement.setAttribute("hidden",!0),this.container.style.zIndex-=1)}},t}(),S=function(){function t(t){var e=!!(t.data.hasPopup||t.data.title||t.data.contents);p.call(this,t,e)}return o.inherit(t,p,{render:function(){return this.container.className="highlightAnnotation",this.data.hasPopup||this._createPopup(this.container,null,this.data),this.container}}),t}(),E=function(){function t(t){var e=!!(t.data.hasPopup||t.data.title||t.data.contents);p.call(this,t,e)}return o.inherit(t,p,{render:function(){return this.container.className="underlineAnnotation",this.data.hasPopup||this._createPopup(this.container,null,this.data),this.container}}),t}(),A=function(){function t(t){var e=!!(t.data.hasPopup||t.data.title||t.data.contents);p.call(this,t,e)}return o.inherit(t,p,{render:function(){return this.container.className="squigglyAnnotation",this.data.hasPopup||this._createPopup(this.container,null,this.data),this.container}}),t}(),T=function(){function t(t){var e=!!(t.data.hasPopup||t.data.title||t.data.contents);p.call(this,t,e)}return o.inherit(t,p,{render:function(){return this.container.className="strikeoutAnnotation",this.data.hasPopup||this._createPopup(this.container,null,this.data),this.container}}),t}(),M=function(){function t(t){p.call(this,t,!0),this.filename=c(t.data.file.filename),this.content=t.data.file.content}return o.inherit(t,p,{render:function(){this.container.className="fileAttachmentAnnotation";var t=document.createElement("div");return t.style.height=this.container.style.height,t.style.width=this.container.style.width,t.addEventListener("dblclick",this._download.bind(this)),this.data.hasPopup||!this.data.title&&!this.data.contents||this._createPopup(this.container,t,this.data),this.container.appendChild(t),this.container},_download:function(){this.downloadManager?this.downloadManager.downloadData(this.content,this.filename,""):l("Download cannot be started due to unavailable download manager")}}),t}(),C={render:function(t){for(var e=new d,n=0,i=t.annotations.length;n<i;n++){var r=t.annotations[n];if(r){var o={data:r,layer:t.div,page:t.page,viewport:t.viewport,linkService:t.linkService,downloadManager:t.downloadManager,imageResourcesPath:t.imageResourcesPath||u("imageResourcesPath"),renderInteractiveForms:t.renderInteractiveForms||!1},a=e.create(o);a.isRenderable&&t.div.appendChild(a.render())}}},update:function(t){for(var e=0,n=t.annotations.length;e<n;e++){var i=t.annotations[e],r=t.div.querySelector('[data-annotation-id="'+i.id+'"]');r&&h.setProp("transform",r,"matrix("+t.viewport.transform.join(",")+")")}t.div.removeAttribute("hidden")}};t.AnnotationLayer=C}(t.pdfjsDisplayAnnotationLayer={},t.pdfjsSharedUtil,t.pdfjsDisplayDOMUtils)}(this),function(t,e){!function(t,e,n){var i=e.Util,r=e.createPromiseCapability,o=n.CustomStyle,a=n.getDefaultSetting,s=function(){var t=/\S/;var e=["left: ",0,"px; top: ",0,"px; font-size: ",0,"px; font-family: ","",";"];function n(n,r,o){var s,c=document.createElement("div"),l={style:null,angle:0,canvasWidth:0,isWhitespace:!1,originalTransform:null,paddingBottom:0,paddingLeft:0,paddingRight:0,paddingTop:0,scale:1};if(n._textDivs.push(c),s=r.str,!t.test(s))return l.isWhitespace=!0,void n._textDivProperties.set(c,l);var h=i.transform(n._viewport.transform,r.transform),u=Math.atan2(h[1],h[0]),d=o[r.fontName];d.vertical&&(u+=Math.PI/2);var p,f,m=Math.sqrt(h[2]*h[2]+h[3]*h[3]),g=m;if(d.ascent?g=d.ascent*g:d.descent&&(g=(1+d.descent)*g),0===u?(p=h[4],f=h[5]-g):(p=h[4]+g*Math.sin(u),f=h[5]-g*Math.cos(u)),e[1]=p,e[3]=f,e[5]=m,e[7]=d.fontFamily,l.style=e.join(""),c.setAttribute("style",l.style),c.textContent=r.str,a("pdfBug")&&(c.dataset.fontName=r.fontName),0!==u&&(l.angle=u*(180/Math.PI)),r.str.length>1&&(d.vertical?l.canvasWidth=r.height*n._viewport.scale:l.canvasWidth=r.width*n._viewport.scale),n._textDivProperties.set(c,l),n._enhanceTextSelection){var v=1,y=0;0!==u&&(v=Math.cos(u),y=Math.sin(u));var b,x,w=(d.vertical?r.height:r.width)*n._viewport.scale,_=m;0!==u?(b=[v,y,-y,v,p,f],x=i.getAxialAlignedBoundingBox([0,0,w,_],b)):x=[p,f,p+w,f+_],n._bounds.push({left:x[0],top:x[1],right:x[2],bottom:x[3],div:c,size:[w,_],m:b})}}function s(t){if(!t._canceled){var e=t._container,n=t._textDivs,i=t._capability,r=n.length;if(r>1e5)return t._renderingDone=!0,void i.resolve();var a=document.createElement("canvas");a.mozOpaque=!0;for(var s,c,l=a.getContext("2d",{alpha:!1}),h=0;h<r;h++){var u=n[h],d=t._textDivProperties.get(u);if(!d.isWhitespace){var p=u.style.fontSize,f=u.style.fontFamily;p===s&&f===c||(l.font=p+" "+f,s=p,c=f);var m=l.measureText(u.textContent).width;e.appendChild(u);var g="";0!==d.canvasWidth&&m>0&&(d.scale=d.canvasWidth/m,g="scaleX("+d.scale+")"),0!==d.angle&&(g="rotate("+d.angle+"deg) "+g),""!==g&&(d.originalTransform=g,o.setProp("transform",u,g)),t._textDivProperties.set(u,d)}}t._renderingDone=!0,i.resolve()}}function c(t){for(var e=t._bounds,n=t._viewport,r=function(t,e,n){var i=n.map((function(t,e){return{x1:t.left,y1:t.top,x2:t.right,y2:t.bottom,index:e,x1New:void 0,x2New:void 0}}));l(t,i);var r=new Array(n.length);return i.forEach((function(t){var e=t.index;r[e]={left:t.x1New,top:0,right:t.x2New,bottom:0}})),n.map((function(e,n){var o=r[n],a=i[n];a.x1=e.top,a.y1=t-o.right,a.x2=e.bottom,a.y2=t-o.left,a.index=n,a.x1New=void 0,a.x2New=void 0})),l(e,i),i.forEach((function(t){var e=t.index;r[e].top=t.x1New,r[e].bottom=t.x2New})),r}(n.width,n.height,e),o=0;o<r.length;o++){var a=e[o].div,s=t._textDivProperties.get(a);if(0!==s.angle){var c=r[o],h=e[o],u=h.m,d=u[0],p=u[1],f=[[0,0],[0,h.size[1]],[h.size[0],0],h.size],m=new Float64Array(64);f.forEach((function(t,e){var n=i.applyTransform(t,u);m[e+0]=d&&(c.left-n[0])/d,m[e+4]=p&&(c.top-n[1])/p,m[e+8]=d&&(c.right-n[0])/d,m[e+12]=p&&(c.bottom-n[1])/p,m[e+16]=p&&(c.left-n[0])/-p,m[e+20]=d&&(c.top-n[1])/d,m[e+24]=p&&(c.right-n[0])/-p,m[e+28]=d&&(c.bottom-n[1])/d,m[e+32]=d&&(c.left-n[0])/-d,m[e+36]=p&&(c.top-n[1])/-p,m[e+40]=d&&(c.right-n[0])/-d,m[e+44]=p&&(c.bottom-n[1])/-p,m[e+48]=p&&(c.left-n[0])/p,m[e+52]=d&&(c.top-n[1])/-d,m[e+56]=p&&(c.right-n[0])/p,m[e+60]=d&&(c.bottom-n[1])/-d}));var g=function(t,e,n){for(var i=0,r=0;r<n;r++){var o=t[e++];o>0&&(i=i?Math.min(o,i):o)}return i},v=1+Math.min(Math.abs(d),Math.abs(p));s.paddingLeft=g(m,32,16)/v,s.paddingTop=g(m,48,16)/v,s.paddingRight=g(m,0,16)/v,s.paddingBottom=g(m,16,16)/v,t._textDivProperties.set(a,s)}else s.paddingLeft=e[o].left-r[o].left,s.paddingTop=e[o].top-r[o].top,s.paddingRight=r[o].right-e[o].right,s.paddingBottom=r[o].bottom-e[o].bottom,t._textDivProperties.set(a,s)}}function l(t,e){e.sort((function(t,e){return t.x1-e.x1||t.index-e.index}));var n=[{start:-1/0,end:1/0,boundary:{x1:-1/0,y1:-1/0,x2:0,y2:1/0,index:-1,x1New:0,x2New:0}}];e.forEach((function(t){for(var e=0;e<n.length&&n[e].end<=t.y1;)e++;for(var i,r,o=n.length-1;o>=0&&n[o].start>=t.y2;)o--;var a,s,c=-1/0;for(a=e;a<=o;a++){var l;(l=(r=(i=n[a]).boundary).x2>t.x1?r.index>t.index?r.x1New:t.x1:void 0===r.x2New?(r.x2+t.x1)/2:r.x2New)>c&&(c=l)}for(t.x1New=c,a=e;a<=o;a++)void 0===(r=(i=n[a]).boundary).x2New?r.x2>t.x1?r.index>t.index&&(r.x2New=r.x2):r.x2New=c:r.x2New>c&&(r.x2New=Math.max(c,r.x2));var h=[],u=null;for(a=e;a<=o;a++){var d=(r=(i=n[a]).boundary).x2>t.x2?r:t;u===d?h[h.length-1].end=i.end:(h.push({start:i.start,end:i.end,boundary:d}),u=d)}for(n[e].start<t.y1&&(h[0].start=t.y1,h.unshift({start:n[e].start,end:t.y1,boundary:n[e].boundary})),t.y2<n[o].end&&(h[h.length-1].end=t.y2,h.push({start:t.y2,end:n[o].end,boundary:n[o].boundary})),a=e;a<=o;a++)if(void 0===(r=(i=n[a]).boundary).x2New){var p=!1;for(s=e-1;!p&&s>=0&&n[s].start>=r.y1;s--)p=n[s].boundary===r;for(s=o+1;!p&&s<n.length&&n[s].end<=r.y2;s++)p=n[s].boundary===r;for(s=0;!p&&s<h.length;s++)p=h[s].boundary===r;p||(r.x2New=c)}Array.prototype.splice.apply(n,[e,o-e+1].concat(h))})),n.forEach((function(e){var n=e.boundary;void 0===n.x2New&&(n.x2New=Math.max(t,n.x2))}))}function h(t,e,n,i,o){this._textContent=t,this._container=e,this._viewport=n,this._textDivs=i||[],this._textDivProperties=new WeakMap,this._renderingDone=!1,this._canceled=!1,this._capability=r(),this._renderTimer=null,this._bounds=[],this._enhanceTextSelection=!!o}return h.prototype={get promise(){return this._capability.promise},cancel:function(){this._canceled=!0,null!==this._renderTimer&&(clearTimeout(this._renderTimer),this._renderTimer=null),this._capability.reject("canceled")},_render:function(t){for(var e=this._textContent.items,i=this._textContent.styles,r=0,o=e.length;r<o;r++)n(this,e[r],i);if(t){var a=this;this._renderTimer=setTimeout((function(){s(a),a._renderTimer=null}),t)}else s(this)},expandTextDivs:function(t){if(this._enhanceTextSelection&&this._renderingDone){null!==this._bounds&&(c(this),this._bounds=null);for(var e=0,n=this._textDivs.length;e<n;e++){var i=this._textDivs[e],r=this._textDivProperties.get(i);if(!r.isWhitespace)if(t){var a="",s="";1!==r.scale&&(a="scaleX("+r.scale+")"),0!==r.angle&&(a="rotate("+r.angle+"deg) "+a),0!==r.paddingLeft&&(s+=" padding-left: "+r.paddingLeft/r.scale+"px;",a+=" translateX("+-r.paddingLeft/r.scale+"px)"),0!==r.paddingTop&&(s+=" padding-top: "+r.paddingTop+"px;",a+=" translateY("+-r.paddingTop+"px)"),0!==r.paddingRight&&(s+=" padding-right: "+r.paddingRight/r.scale+"px;"),0!==r.paddingBottom&&(s+=" padding-bottom: "+r.paddingBottom+"px;"),""!==s&&i.setAttribute("style",r.style+s),""!==a&&o.setProp("transform",i,a)}else i.style.padding=0,o.setProp("transform",i,r.originalTransform||"")}}}},function(t){var e=new h(t.textContent,t.container,t.viewport,t.textDivs,t.enhanceTextSelection);return e._render(t.timeout),e}}();t.renderTextLayer=s}(t.pdfjsDisplayTextLayer={},t.pdfjsSharedUtil,t.pdfjsDisplayDOMUtils)}(this),function(t,e){!function(t,e,n){var i=e.shadow,r=n.getDefaultSetting,o=function(){function t(t,e,n){var i=t.createShader(n);if(t.shaderSource(i,e),t.compileShader(i),!t.getShaderParameter(i,t.COMPILE_STATUS)){var r=t.getShaderInfoLog(i);throw new Error("Error during shader compilation: "+r)}return i}function e(e,n){return t(e,n,e.VERTEX_SHADER)}function n(e,n){return t(e,n,e.FRAGMENT_SHADER)}function o(t,e){for(var n=t.createProgram(),i=0,r=e.length;i<r;++i)t.attachShader(n,e[i]);if(t.linkProgram(n),!t.getProgramParameter(n,t.LINK_STATUS)){var o=t.getProgramInfoLog(n);throw new Error("Error during program linking: "+o)}return n}function a(t,e,n){t.activeTexture(n);var i=t.createTexture();return t.bindTexture(t.TEXTURE_2D,i),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.NEAREST),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,e),i}var s,c;function l(){s||(c=document.createElement("canvas"),s=c.getContext("webgl",{premultipliedalpha:!1}))}var h=null;var u=null;return{get isEnabled(){if(r("disableWebGL"))return!1;var t=!1;try{l(),t=!!s}catch(t){}return i(this,"isEnabled",t)},composeSMask:function(t,i,r){var u=t.width,d=t.height;h||function(){var t,i;l(),t=c,c=null,i=s,s=null;var r=o(i,[e(i,"  attribute vec2 a_position;                                      attribute vec2 a_texCoord;                                                                                                      uniform vec2 u_resolution;                                                                                                      varying vec2 v_texCoord;                                                                                                        void main() {                                                     vec2 clipSpace = (a_position / u_resolution) * 2.0 - 1.0;       gl_Position = vec4(clipSpace * vec2(1, -1), 0, 1);                                                                              v_texCoord = a_texCoord;                                      }                                                             "),n(i,"  precision mediump float;                                                                                                        uniform vec4 u_backdrop;                                        uniform int u_subtype;                                          uniform sampler2D u_image;                                      uniform sampler2D u_mask;                                                                                                       varying vec2 v_texCoord;                                                                                                        void main() {                                                     vec4 imageColor = texture2D(u_image, v_texCoord);               vec4 maskColor = texture2D(u_mask, v_texCoord);                 if (u_backdrop.a > 0.0) {                                         maskColor.rgb = maskColor.rgb * maskColor.a +                                   u_backdrop.rgb * (1.0 - maskColor.a);         }                                                               float lum;                                                      if (u_subtype == 0) {                                             lum = maskColor.a;                                            } else {                                                          lum = maskColor.r * 0.3 + maskColor.g * 0.59 +                        maskColor.b * 0.11;                                     }                                                               imageColor.a *= lum;                                            imageColor.rgb *= imageColor.a;                                 gl_FragColor = imageColor;                                    }                                                             ")]);i.useProgram(r);var a={};a.gl=i,a.canvas=t,a.resolutionLocation=i.getUniformLocation(r,"u_resolution"),a.positionLocation=i.getAttribLocation(r,"a_position"),a.backdropLocation=i.getUniformLocation(r,"u_backdrop"),a.subtypeLocation=i.getUniformLocation(r,"u_subtype");var u=i.getAttribLocation(r,"a_texCoord"),d=i.getUniformLocation(r,"u_image"),p=i.getUniformLocation(r,"u_mask"),f=i.createBuffer();i.bindBuffer(i.ARRAY_BUFFER,f),i.bufferData(i.ARRAY_BUFFER,new Float32Array([0,0,1,0,0,1,0,1,1,0,1,1]),i.STATIC_DRAW),i.enableVertexAttribArray(u),i.vertexAttribPointer(u,2,i.FLOAT,!1,0,0),i.uniform1i(d,0),i.uniform1i(p,1),h=a}();var p=h,f=p.canvas,m=p.gl;f.width=u,f.height=d,m.viewport(0,0,m.drawingBufferWidth,m.drawingBufferHeight),m.uniform2f(p.resolutionLocation,u,d),r.backdrop?m.uniform4f(p.resolutionLocation,r.backdrop[0],r.backdrop[1],r.backdrop[2],1):m.uniform4f(p.resolutionLocation,0,0,0,0),m.uniform1i(p.subtypeLocation,"Luminosity"===r.subtype?1:0);var g=a(m,t,m.TEXTURE0),v=a(m,i,m.TEXTURE1),y=m.createBuffer();return m.bindBuffer(m.ARRAY_BUFFER,y),m.bufferData(m.ARRAY_BUFFER,new Float32Array([0,0,u,0,0,d,0,d,u,0,u,d]),m.STATIC_DRAW),m.enableVertexAttribArray(p.positionLocation),m.vertexAttribPointer(p.positionLocation,2,m.FLOAT,!1,0,0),m.clearColor(0,0,0,0),m.enable(m.BLEND),m.blendFunc(m.ONE,m.ONE_MINUS_SRC_ALPHA),m.clear(m.COLOR_BUFFER_BIT),m.drawArrays(m.TRIANGLES,0,6),m.flush(),m.deleteTexture(g),m.deleteTexture(v),m.deleteBuffer(y),f},drawFigures:function(t,i,r,a,h){u||function(){var t,i;l(),t=c,c=null,i=s,s=null;var r=o(i,[e(i,"  attribute vec2 a_position;                                      attribute vec3 a_color;                                                                                                         uniform vec2 u_resolution;                                      uniform vec2 u_scale;                                           uniform vec2 u_offset;                                                                                                          varying vec4 v_color;                                                                                                           void main() {                                                     vec2 position = (a_position + u_offset) * u_scale;              vec2 clipSpace = (position / u_resolution) * 2.0 - 1.0;         gl_Position = vec4(clipSpace * vec2(1, -1), 0, 1);                                                                              v_color = vec4(a_color / 255.0, 1.0);                         }                                                             "),n(i,"  precision mediump float;                                                                                                        varying vec4 v_color;                                                                                                           void main() {                                                     gl_FragColor = v_color;                                       }                                                             ")]);i.useProgram(r);var a={};a.gl=i,a.canvas=t,a.resolutionLocation=i.getUniformLocation(r,"u_resolution"),a.scaleLocation=i.getUniformLocation(r,"u_scale"),a.offsetLocation=i.getUniformLocation(r,"u_offset"),a.positionLocation=i.getAttribLocation(r,"a_position"),a.colorLocation=i.getAttribLocation(r,"a_color"),u=a}();var d=u,p=d.canvas,f=d.gl;p.width=t,p.height=i,f.viewport(0,0,f.drawingBufferWidth,f.drawingBufferHeight),f.uniform2f(d.resolutionLocation,t,i);var m,g,v,y=0;for(m=0,g=a.length;m<g;m++)switch(a[m].type){case"lattice":y+=((v=a[m].coords.length/a[m].verticesPerRow|0)-1)*(a[m].verticesPerRow-1)*6;break;case"triangles":y+=a[m].coords.length}var b=new Float32Array(2*y),x=new Uint8Array(3*y),w=h.coords,_=h.colors,S=0,E=0;for(m=0,g=a.length;m<g;m++){var A=a[m],T=A.coords,M=A.colors;switch(A.type){case"lattice":var C=A.verticesPerRow;v=T.length/C|0;for(var P=1;P<v;P++)for(var R=P*C+1,L=1;L<C;L++,R++)b[S]=w[T[R-C-1]],b[S+1]=w[T[R-C-1]+1],b[S+2]=w[T[R-C]],b[S+3]=w[T[R-C]+1],b[S+4]=w[T[R-1]],b[S+5]=w[T[R-1]+1],x[E]=_[M[R-C-1]],x[E+1]=_[M[R-C-1]+1],x[E+2]=_[M[R-C-1]+2],x[E+3]=_[M[R-C]],x[E+4]=_[M[R-C]+1],x[E+5]=_[M[R-C]+2],x[E+6]=_[M[R-1]],x[E+7]=_[M[R-1]+1],x[E+8]=_[M[R-1]+2],b[S+6]=b[S+2],b[S+7]=b[S+3],b[S+8]=b[S+4],b[S+9]=b[S+5],b[S+10]=w[T[R]],b[S+11]=w[T[R]+1],x[E+9]=x[E+3],x[E+10]=x[E+4],x[E+11]=x[E+5],x[E+12]=x[E+6],x[E+13]=x[E+7],x[E+14]=x[E+8],x[E+15]=_[M[R]],x[E+16]=_[M[R]+1],x[E+17]=_[M[R]+2],S+=12,E+=18;break;case"triangles":for(var k=0,I=T.length;k<I;k++)b[S]=w[T[k]],b[S+1]=w[T[k]+1],x[E]=_[M[k]],x[E+1]=_[M[k]+1],x[E+2]=_[M[k]+2],S+=2,E+=3}}r?f.clearColor(r[0]/255,r[1]/255,r[2]/255,1):f.clearColor(0,0,0,0),f.clear(f.COLOR_BUFFER_BIT);var D=f.createBuffer();f.bindBuffer(f.ARRAY_BUFFER,D),f.bufferData(f.ARRAY_BUFFER,b,f.STATIC_DRAW),f.enableVertexAttribArray(d.positionLocation),f.vertexAttribPointer(d.positionLocation,2,f.FLOAT,!1,0,0);var O=f.createBuffer();return f.bindBuffer(f.ARRAY_BUFFER,O),f.bufferData(f.ARRAY_BUFFER,x,f.STATIC_DRAW),f.enableVertexAttribArray(d.colorLocation),f.vertexAttribPointer(d.colorLocation,3,f.UNSIGNED_BYTE,!1,0,0),f.uniform2f(d.scaleLocation,h.scaleX,h.scaleY),f.uniform2f(d.offsetLocation,h.offsetX,h.offsetY),f.drawArrays(f.TRIANGLES,0,y),f.flush(),f.deleteBuffer(D),f.deleteBuffer(O),p},clear:function(){h&&h.canvas&&(h.canvas.width=0,h.canvas.height=0),u&&u.canvas&&(u.canvas.width=0,u.canvas.height=0),h=null,u=null}}}();t.WebGLUtils=o}(t.pdfjsDisplayWebGL={},t.pdfjsSharedUtil,t.pdfjsDisplayDOMUtils)}(this),function(t,e){!function(t,e,n){var i=e.Util,r=e.info,o=e.isArray,a=e.error,s=n.WebGLUtils,c={RadialAxial:{fromIR:function(t){var e=t[1],n=t[2],i=t[3],r=t[4],o=t[5],a=t[6];return{type:"Pattern",getPattern:function(t){var s;"axial"===e?s=t.createLinearGradient(i[0],i[1],r[0],r[1]):"radial"===e&&(s=t.createRadialGradient(i[0],i[1],o,r[0],r[1],a));for(var c=0,l=n.length;c<l;++c){var h=n[c];s.addColorStop(h[0],h[1])}return s}}}}},l=function(){function t(t,e,n,i,r,o,a,s){var c,l=e.coords,h=e.colors,u=t.data,d=4*t.width;l[n+1]>l[i+1]&&(c=n,n=i,i=c,c=o,o=a,a=c),l[i+1]>l[r+1]&&(c=i,i=r,r=c,c=a,a=s,s=c),l[n+1]>l[i+1]&&(c=n,n=i,i=c,c=o,o=a,a=c);var p=(l[n]+e.offsetX)*e.scaleX,f=(l[n+1]+e.offsetY)*e.scaleY,m=(l[i]+e.offsetX)*e.scaleX,g=(l[i+1]+e.offsetY)*e.scaleY,v=(l[r]+e.offsetX)*e.scaleX,y=(l[r+1]+e.offsetY)*e.scaleY;if(!(f>=y))for(var b,x,w,_,S,E,A,T,M,C=h[o],P=h[o+1],R=h[o+2],L=h[a],k=h[a+1],I=h[a+2],D=h[s],O=h[s+1],F=h[s+2],N=Math.round(f),U=Math.round(y),j=N;j<=U;j++){j<g?(b=p-(p-m)*(M=j<f?0:f===g?1:(f-j)/(f-g)),x=C-(C-L)*M,w=P-(P-k)*M,_=R-(R-I)*M):(b=m-(m-v)*(M=j>y?1:g===y?0:(g-j)/(g-y)),x=L-(L-D)*M,w=k-(k-O)*M,_=I-(I-F)*M),S=p-(p-v)*(M=j<f?0:j>y?1:(f-j)/(f-y)),E=C-(C-D)*M,A=P-(P-O)*M,T=R-(R-F)*M;for(var B=Math.round(Math.min(b,S)),z=Math.round(Math.max(b,S)),H=d*j+4*B,G=B;G<=z;G++)M=(M=(b-G)/(b-S))<0?0:M>1?1:M,u[H++]=x-(x-E)*M|0,u[H++]=w-(w-A)*M|0,u[H++]=_-(_-T)*M|0,u[H++]=255}}function e(e,n,i){var r,o,s=n.coords,c=n.colors;switch(n.type){case"lattice":var l=n.verticesPerRow,h=Math.floor(s.length/l)-1,u=l-1;for(r=0;r<h;r++)for(var d=r*l,p=0;p<u;p++,d++)t(e,i,s[d],s[d+1],s[d+l],c[d],c[d+1],c[d+l]),t(e,i,s[d+l+1],s[d+1],s[d+l],c[d+l+1],c[d+1],c[d+l]);break;case"triangles":for(r=0,o=s.length;r<o;r+=3)t(e,i,s[r],s[r+1],s[r+2],c[r],c[r+1],c[r+2]);break;default:a("illigal figure")}}return function(t,n,i,r,o,a,c){var l,h,u,d,p=Math.floor(t[0]),f=Math.floor(t[1]),m=Math.ceil(t[2])-p,g=Math.ceil(t[3])-f,v=Math.min(Math.ceil(Math.abs(m*n[0]*1.1)),3e3),y=Math.min(Math.ceil(Math.abs(g*n[1]*1.1)),3e3),b=m/v,x=g/y,w={coords:i,colors:r,offsetX:-p,offsetY:-f,scaleX:1/b,scaleY:1/x},_=v+4,S=y+4;if(s.isEnabled)l=s.drawFigures(v,y,a,o,w),(h=c.getCanvas("mesh",_,S,!1)).context.drawImage(l,2,2),l=h.canvas;else{var E=(h=c.getCanvas("mesh",_,S,!1)).context,A=E.createImageData(v,y);if(a){var T=A.data;for(u=0,d=T.length;u<d;u+=4)T[u]=a[0],T[u+1]=a[1],T[u+2]=a[2],T[u+3]=255}for(u=0;u<o.length;u++)e(A,o[u],w);E.putImageData(A,2,2),l=h.canvas}return{canvas:l,offsetX:p-2*b,offsetY:f-2*x,scaleX:b,scaleY:x}}}();c.Mesh={fromIR:function(t){var e=t[2],n=t[3],r=t[4],o=t[5],a=t[6],s=t[8];return{type:"Pattern",getPattern:function(t,c,h){var u;if(h)u=i.singularValueDecompose2dScale(t.mozCurrentTransform);else if(u=i.singularValueDecompose2dScale(c.baseTransform),a){var d=i.singularValueDecompose2dScale(a);u=[u[0]*d[0],u[1]*d[1]]}var p=l(o,u,e,n,r,h?null:s,c.cachedCanvases);return h||(t.setTransform.apply(t,c.baseTransform),a&&t.transform.apply(t,a)),t.translate(p.offsetX,p.offsetY),t.scale(p.scaleX,p.scaleY),t.createPattern(p.canvas,"no-repeat")}}}},c.Dummy={fromIR:function(){return{type:"Pattern",getPattern:function(){return"hotpink"}}}};var h=function(){var t=1,e=2;function n(t,e,n,i,r){this.operatorList=t[2],this.matrix=t[3]||[1,0,0,1,0,0],this.bbox=t[4],this.xstep=t[5],this.ystep=t[6],this.paintType=t[7],this.tilingType=t[8],this.color=e,this.canvasGraphicsFactory=i,this.baseTransform=r,this.type="Pattern",this.ctx=n}return n.prototype={createPatternCanvas:function(t){var e=this.operatorList,n=this.bbox,o=this.xstep,a=this.ystep,s=this.paintType,c=this.tilingType,l=this.color,h=this.canvasGraphicsFactory;r("TilingType: "+c);var u=n[0],d=n[1],p=n[2],f=n[3],m=[u,d],g=[u+o,d+a],v=g[0]-m[0],y=g[1]-m[1],b=i.singularValueDecompose2dScale(this.matrix),x=i.singularValueDecompose2dScale(this.baseTransform),w=[b[0]*x[0],b[1]*x[1]];v=Math.min(Math.ceil(Math.abs(v*w[0])),3e3),y=Math.min(Math.ceil(Math.abs(y*w[1])),3e3);var _=t.cachedCanvases.getCanvas("pattern",v,y,!0),S=_.context,E=h.createCanvasGraphics(S);E.groupLevel=t.groupLevel,this.setFillAndStrokeStyleToContext(S,s,l),this.setScale(v,y,o,a),this.transformToScale(E);var A=[1,0,0,1,-m[0],-m[1]];return E.transform.apply(E,A),this.clipBbox(E,n,u,d,p,f),E.executeOperatorList(e),_.canvas},setScale:function(t,e,n,i){this.scale=[t/n,e/i]},transformToScale:function(t){var e=this.scale,n=[e[0],0,0,e[1],0,0];t.transform.apply(t,n)},scaleToContext:function(){var t=this.scale;this.ctx.scale(1/t[0],1/t[1])},clipBbox:function(t,e,n,i,r,a){if(e&&o(e)&&4===e.length){var s=r-n,c=a-i;t.ctx.rect(n,i,s,c),t.clip(),t.endPath()}},setFillAndStrokeStyleToContext:function(n,r,o){switch(r){case t:var s=this.ctx;n.fillStyle=s.fillStyle,n.strokeStyle=s.strokeStyle;break;case e:var c=i.makeCssRgb(o[0],o[1],o[2]);n.fillStyle=c,n.strokeStyle=c;break;default:a("Unsupported paint type: "+r)}},getPattern:function(t,e){var n=this.createPatternCanvas(e);return(t=this.ctx).setTransform.apply(t,this.baseTransform),t.transform.apply(t,this.matrix),this.scaleToContext(),t.createPattern(n,"repeat")}},n}();t.getShadingPatternFromIR=function(t){var e=c[t[0]];return e||a("Unknown IR type: "+t[0]),e.fromIR(t)},t.TilingPattern=h}(t.pdfjsDisplayPatternHelper={},t.pdfjsSharedUtil,t.pdfjsDisplayWebGL)}(this),function(t,e){!function(t,e,n,i,r){var o=e.FONT_IDENTITY_MATRIX,a=e.IDENTITY_MATRIX,s=e.ImageKind,c=e.OPS,l=e.TextRenderingMode,h=e.Uint32ArrayView,u=e.Util,d=e.assert,p=e.info,f=e.isNum,m=e.isArray,g=e.isLittleEndian,v=e.error,y=e.shadow,b=e.warn,x=i.TilingPattern,w=i.getShadingPatternFromIR,_=r.WebGLUtils,S=n.hasCanvasTypedArrays,E={get value(){return y(E,"value",S())}},A={get value(){return y(A,"value",g())}};function T(t,e){var n=document.createElement("canvas");return n.width=t,n.height=e,n}function M(t){t.mozCurrentTransform||(t._originalSave=t.save,t._originalRestore=t.restore,t._originalRotate=t.rotate,t._originalScale=t.scale,t._originalTranslate=t.translate,t._originalTransform=t.transform,t._originalSetTransform=t.setTransform,t._transformMatrix=t._transformMatrix||[1,0,0,1,0,0],t._transformStack=[],Object.defineProperty(t,"mozCurrentTransform",{get:function(){return this._transformMatrix}}),Object.defineProperty(t,"mozCurrentTransformInverse",{get:function(){var t=this._transformMatrix,e=t[0],n=t[1],i=t[2],r=t[3],o=t[4],a=t[5],s=e*r-n*i,c=n*i-e*r;return[r/s,n/c,i/c,e/s,(r*o-i*a)/c,(n*o-e*a)/s]}}),t.save=function(){var t=this._transformMatrix;this._transformStack.push(t),this._transformMatrix=t.slice(0,6),this._originalSave()},t.restore=function(){var t=this._transformStack.pop();t&&(this._transformMatrix=t,this._originalRestore())},t.translate=function(t,e){var n=this._transformMatrix;n[4]=n[0]*t+n[2]*e+n[4],n[5]=n[1]*t+n[3]*e+n[5],this._originalTranslate(t,e)},t.scale=function(t,e){var n=this._transformMatrix;n[0]=n[0]*t,n[1]=n[1]*t,n[2]=n[2]*e,n[3]=n[3]*e,this._originalScale(t,e)},t.transform=function(e,n,i,r,o,a){var s=this._transformMatrix;this._transformMatrix=[s[0]*e+s[2]*n,s[1]*e+s[3]*n,s[0]*i+s[2]*r,s[1]*i+s[3]*r,s[0]*o+s[2]*a+s[4],s[1]*o+s[3]*a+s[5]],t._originalTransform(e,n,i,r,o,a)},t.setTransform=function(e,n,i,r,o,a){this._transformMatrix=[e,n,i,r,o,a],t._originalSetTransform(e,n,i,r,o,a)},t.rotate=function(t){var e=Math.cos(t),n=Math.sin(t),i=this._transformMatrix;this._transformMatrix=[i[0]*e+i[2]*n,i[1]*e+i[3]*n,i[0]*-n+i[2]*e,i[1]*-n+i[3]*e,i[4],i[5]],this._originalRotate(t)})}var C=function(){function t(){this.cache=Object.create(null)}return t.prototype={getCanvas:function(t,e,n,i){var r;if(void 0!==this.cache[t])(r=this.cache[t]).canvas.width=e,r.canvas.height=n,r.context.setTransform(1,0,0,1,0,0);else{var o=T(e,n),a=o.getContext("2d");i&&M(a),this.cache[t]=r={canvas:o,context:a}}return r},clear:function(){for(var t in this.cache){var e=this.cache[t];e.canvas.width=0,e.canvas.height=0,delete this.cache[t]}}},t}();var P=function(){function t(t){this.alphaIsShape=!1,this.fontSize=0,this.fontSizeScale=1,this.textMatrix=a,this.textMatrixScale=1,this.fontMatrix=o,this.leading=0,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRenderingMode=l.FILL,this.textRise=0,this.fillColor="#000000",this.strokeColor="#000000",this.patternFill=!1,this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.activeSMask=null,this.resumeSMaskCtx=null,this.old=t}return t.prototype={clone:function(){return Object.create(this)},setCurrentPoint:function(t,e){this.x=t,this.y=e}},t}(),R=function(){function t(t,e,n,i){this.ctx=t,this.current=new P,this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=e,this.objs=n,this.imageLayer=i,this.groupStack=[],this.processingType3=null,this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.cachedCanvases=new C,t&&M(t),this.cachedGetSinglePixelWidth=null}function e(t,e){if("undefined"!=typeof ImageData&&e instanceof ImageData)t.putImageData(e,0,0);else{var n,i,r,o,a,c=e.height,l=e.width,u=c%16,d=(c-u)/16,p=0===u?d:d+1,f=t.createImageData(l,16),m=0,g=e.data,y=f.data;if(e.kind===s.GRAYSCALE_1BPP){var b=g.byteLength,x=E.value?new Uint32Array(y.buffer):new h(y),w=x.length,_=l+7>>3,S=4294967295,T=A.value||!E.value?4278190080:255;for(i=0;i<p;i++){for(o=i<d?16:u,n=0,r=0;r<o;r++){for(var M=b-m,C=0,P=M>_?l:8*M-7,R=-8&P,L=0,k=0;C<R;C+=8)k=g[m++],x[n++]=128&k?S:T,x[n++]=64&k?S:T,x[n++]=32&k?S:T,x[n++]=16&k?S:T,x[n++]=8&k?S:T,x[n++]=4&k?S:T,x[n++]=2&k?S:T,x[n++]=1&k?S:T;for(;C<P;C++)0===L&&(k=g[m++],L=128),x[n++]=k&L?S:T,L>>=1}for(;n<w;)x[n++]=0;t.putImageData(f,0,16*i)}}else if(e.kind===s.RGBA_32BPP){for(r=0,a=16*l*4,i=0;i<d;i++)y.set(g.subarray(m,m+a)),m+=a,t.putImageData(f,0,r),r+=16;i<p&&(a=l*u*4,y.set(g.subarray(m,m+a)),t.putImageData(f,0,r))}else if(e.kind===s.RGB_24BPP)for(a=l*(o=16),i=0;i<p;i++){for(i>=d&&(a=l*(o=u)),n=0,r=a;r--;)y[n++]=g[m++],y[n++]=g[m++],y[n++]=g[m++],y[n++]=255;t.putImageData(f,0,16*i)}else v("bad image kind: "+e.kind)}}function n(t,e){for(var n=e.height,i=e.width,r=n%16,o=(n-r)/16,a=0===r?o:o+1,s=t.createImageData(i,16),c=0,l=e.data,h=s.data,u=0;u<a;u++){for(var d=u<o?16:r,p=3,f=0;f<d;f++)for(var m=0,g=0;g<i;g++){if(!m){var v=l[c++];m=128}h[p]=v&m?0:255,p+=4,m>>=1}t.putImageData(s,0,16*u)}}function i(t,e){for(var n=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font"],i=0,r=n.length;i<r;i++){var o=n[i];void 0!==t[o]&&(e[o]=t[o])}void 0!==t.setLineDash&&(e.setLineDash(t.getLineDash()),e.lineDashOffset=t.lineDashOffset)}function r(t,e,n,i){for(var r=t.length,o=3;o<r;o+=4){var a=t[o];if(0===a)t[o-3]=e,t[o-2]=n,t[o-1]=i;else if(a<255){var s=255-a;t[o-3]=t[o-3]*a+e*s>>8,t[o-2]=t[o-2]*a+n*s>>8,t[o-1]=t[o-1]*a+i*s>>8}}}function g(t,e,n){for(var i=t.length,r=3;r<i;r+=4){var o=n?n[t[r]]:t[r];e[r]=e[r]*o*(1/255)|0}}function S(t,e,n){for(var i=t.length,r=3;r<i;r+=4){var o=77*t[r-3]+152*t[r-2]+28*t[r-1];e[r]=n?e[r]*n[o>>8]>>8:e[r]*o>>16}}function T(t,e,n){var i=e.canvas,o=e.context;t.setTransform(e.scaleX,0,0,e.scaleY,e.offsetX,e.offsetY);var a=e.backdrop||null;if(!e.transferMap&&_.isEnabled){var s=_.composeSMask(n.canvas,i,{subtype:e.subtype,backdrop:a});return t.setTransform(1,0,0,1,0,0),void t.drawImage(s,e.offsetX,e.offsetY)}!function(t,e,n,i,o,a,s){var c,l=!!a,h=l?a[0]:0,u=l?a[1]:0,d=l?a[2]:0;c="Luminosity"===o?S:g;for(var p=Math.min(i,Math.ceil(1048576/n)),f=0;f<i;f+=p){var m=Math.min(p,i-f),v=t.getImageData(0,f,n,m),y=e.getImageData(0,f,n,m);l&&r(v.data,h,u,d),c(v.data,y.data,s),t.putImageData(y,0,f)}}(o,n,i.width,i.height,e.subtype,a,e.transferMap),t.drawImage(i,0,0)}var R=["butt","round","square"],L=["miter","round","bevel"],k={},I={};for(var D in t.prototype={beginDrawing:function(t,e,n){var i=this.ctx.canvas.width,r=this.ctx.canvas.height;if(this.ctx.save(),this.ctx.fillStyle="rgb(255, 255, 255)",this.ctx.fillRect(0,0,i,r),this.ctx.restore(),n){var o=this.cachedCanvases.getCanvas("transparent",i,r,!0);this.compositeCtx=this.ctx,this.transparentCanvas=o.canvas,this.ctx=o.context,this.ctx.save(),this.ctx.transform.apply(this.ctx,this.compositeCtx.mozCurrentTransform)}this.ctx.save(),t&&this.ctx.transform.apply(this.ctx,t),this.ctx.transform.apply(this.ctx,e.transform),this.baseTransform=this.ctx.mozCurrentTransform.slice(),this.imageLayer&&this.imageLayer.beginLayout()},executeOperatorList:function(t,e,n,i){var r=t.argsArray,o=t.fnArray,a=e||0,s=r.length;if(s===a)return a;for(var l,h=s-a>10&&"function"==typeof n,u=h?Date.now()+15:0,d=0,p=this.commonObjs,f=this.objs;;){if(void 0!==i&&a===i.nextBreakPoint)return i.breakIt(a,n),a;if((l=o[a])!==c.dependency)this[l].apply(this,r[a]);else for(var m=r[a],g=0,v=m.length;g<v;g++){var y=m[g],b="g"===y[0]&&"_"===y[1]?p:f;if(!b.isResolved(y))return b.get(y,n),a}if(++a===s)return a;if(h&&++d>10){if(Date.now()>u)return n(),a;d=0}}},endDrawing:function(){null!==this.current.activeSMask&&this.endSMaskGroup(),this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null),this.cachedCanvases.clear(),_.clear(),this.imageLayer&&this.imageLayer.endLayout()},setLineWidth:function(t){this.current.lineWidth=t,this.ctx.lineWidth=t},setLineCap:function(t){this.ctx.lineCap=R[t]},setLineJoin:function(t){this.ctx.lineJoin=L[t]},setMiterLimit:function(t){this.ctx.miterLimit=t},setDash:function(t,e){var n=this.ctx;void 0!==n.setLineDash&&(n.setLineDash(t),n.lineDashOffset=e)},setRenderingIntent:function(t){},setFlatness:function(t){},setGState:function(t){for(var e=0,n=t.length;e<n;e++){var i=t[e],r=i[0],o=i[1];switch(r){case"LW":this.setLineWidth(o);break;case"LC":this.setLineCap(o);break;case"LJ":this.setLineJoin(o);break;case"ML":this.setMiterLimit(o);break;case"D":this.setDash(o[0],o[1]);break;case"RI":this.setRenderingIntent(o);break;case"FL":this.setFlatness(o);break;case"Font":this.setFont(o[0],o[1]);break;case"CA":this.current.strokeAlpha=i[1];break;case"ca":this.current.fillAlpha=i[1],this.ctx.globalAlpha=i[1];break;case"BM":if(o&&o.name&&"Normal"!==o.name){var a=o.name.replace(/([A-Z])/g,(function(t){return"-"+t.toLowerCase()})).substring(1);this.ctx.globalCompositeOperation=a,this.ctx.globalCompositeOperation!==a&&b('globalCompositeOperation "'+a+'" is not supported')}else this.ctx.globalCompositeOperation="source-over";break;case"SMask":this.current.activeSMask&&(this.stateStack.length>0&&this.stateStack[this.stateStack.length-1].activeSMask===this.current.activeSMask?this.suspendSMaskGroup():this.endSMaskGroup()),this.current.activeSMask=o?this.tempSMask:null,this.current.activeSMask&&this.beginSMaskGroup(),this.tempSMask=null}}},beginSMaskGroup:function(){var t=this.current.activeSMask,e=t.canvas.width,n=t.canvas.height,r="smaskGroupAt"+this.groupLevel,o=this.cachedCanvases.getCanvas(r,e,n,!0),a=this.ctx,s=a.mozCurrentTransform;this.ctx.save();var c=o.context;c.scale(1/t.scaleX,1/t.scaleY),c.translate(-t.offsetX,-t.offsetY),c.transform.apply(c,s),t.startTransformInverse=c.mozCurrentTransformInverse,i(a,c),this.ctx=c,this.setGState([["BM","Normal"],["ca",1],["CA",1]]),this.groupStack.push(a),this.groupLevel++},suspendSMaskGroup:function(){var t=this.ctx;this.groupLevel--,this.ctx=this.groupStack.pop(),T(this.ctx,this.current.activeSMask,t),this.ctx.restore(),this.ctx.save(),i(t,this.ctx),this.current.resumeSMaskCtx=t;var e=u.transform(this.current.activeSMask.startTransformInverse,t.mozCurrentTransform);this.ctx.transform.apply(this.ctx,e),t.save(),t.setTransform(1,0,0,1,0,0),t.clearRect(0,0,t.canvas.width,t.canvas.height),t.restore()},resumeSMaskGroup:function(){var t=this.current.resumeSMaskCtx,e=this.ctx;this.ctx=t,this.groupStack.push(e),this.groupLevel++},endSMaskGroup:function(){var t=this.ctx;this.groupLevel--,this.ctx=this.groupStack.pop(),T(this.ctx,this.current.activeSMask,t),this.ctx.restore(),i(t,this.ctx);var e=u.transform(this.current.activeSMask.startTransformInverse,t.mozCurrentTransform);this.ctx.transform.apply(this.ctx,e)},save:function(){this.ctx.save();var t=this.current;this.stateStack.push(t),this.current=t.clone(),this.current.resumeSMaskCtx=null},restore:function(){this.current.resumeSMaskCtx&&this.resumeSMaskGroup(),null===this.current.activeSMask||0!==this.stateStack.length&&this.stateStack[this.stateStack.length-1].activeSMask===this.current.activeSMask||this.endSMaskGroup(),0!==this.stateStack.length&&(this.current=this.stateStack.pop(),this.ctx.restore(),this.pendingClip=null,this.cachedGetSinglePixelWidth=null)},transform:function(t,e,n,i,r,o){this.ctx.transform(t,e,n,i,r,o),this.cachedGetSinglePixelWidth=null},constructPath:function(t,e){for(var n=this.ctx,i=this.current,r=i.x,o=i.y,a=0,s=0,l=t.length;a<l;a++)switch(0|t[a]){case c.rectangle:r=e[s++],o=e[s++];var h=e[s++],u=e[s++];0===h&&(h=this.getSinglePixelWidth()),0===u&&(u=this.getSinglePixelWidth());var d=r+h,p=o+u;this.ctx.moveTo(r,o),this.ctx.lineTo(d,o),this.ctx.lineTo(d,p),this.ctx.lineTo(r,p),this.ctx.lineTo(r,o),this.ctx.closePath();break;case c.moveTo:r=e[s++],o=e[s++],n.moveTo(r,o);break;case c.lineTo:r=e[s++],o=e[s++],n.lineTo(r,o);break;case c.curveTo:r=e[s+4],o=e[s+5],n.bezierCurveTo(e[s],e[s+1],e[s+2],e[s+3],r,o),s+=6;break;case c.curveTo2:n.bezierCurveTo(r,o,e[s],e[s+1],e[s+2],e[s+3]),r=e[s+2],o=e[s+3],s+=4;break;case c.curveTo3:r=e[s+2],o=e[s+3],n.bezierCurveTo(e[s],e[s+1],r,o,r,o),s+=4;break;case c.closePath:n.closePath()}i.setCurrentPoint(r,o)},closePath:function(){this.ctx.closePath()},stroke:function(t){t=void 0===t||t;var e=this.ctx,n=this.current.strokeColor;e.lineWidth=Math.max(.65*this.getSinglePixelWidth(),this.current.lineWidth),e.globalAlpha=this.current.strokeAlpha,n&&n.hasOwnProperty("type")&&"Pattern"===n.type?(e.save(),e.strokeStyle=n.getPattern(e,this),e.stroke(),e.restore()):e.stroke(),t&&this.consumePath(),e.globalAlpha=this.current.fillAlpha},closeStroke:function(){this.closePath(),this.stroke()},fill:function(t){t=void 0===t||t;var e=this.ctx,n=this.current.fillColor,i=!1;this.current.patternFill&&(e.save(),this.baseTransform&&e.setTransform.apply(e,this.baseTransform),e.fillStyle=n.getPattern(e,this),i=!0),this.pendingEOFill?(void 0!==e.mozFillRule?(e.mozFillRule="evenodd",e.fill(),e.mozFillRule="nonzero"):e.fill("evenodd"),this.pendingEOFill=!1):e.fill(),i&&e.restore(),t&&this.consumePath()},eoFill:function(){this.pendingEOFill=!0,this.fill()},fillStroke:function(){this.fill(!1),this.stroke(!1),this.consumePath()},eoFillStroke:function(){this.pendingEOFill=!0,this.fillStroke()},closeFillStroke:function(){this.closePath(),this.fillStroke()},closeEOFillStroke:function(){this.pendingEOFill=!0,this.closePath(),this.fillStroke()},endPath:function(){this.consumePath()},clip:function(){this.pendingClip=k},eoClip:function(){this.pendingClip=I},beginText:function(){this.current.textMatrix=a,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0},endText:function(){var t=this.pendingTextPaths,e=this.ctx;if(void 0!==t){e.save(),e.beginPath();for(var n=0;n<t.length;n++){var i=t[n];e.setTransform.apply(e,i.transform),e.translate(i.x,i.y),i.addToPath(e,i.fontSize)}e.restore(),e.clip(),e.beginPath(),delete this.pendingTextPaths}else e.beginPath()},setCharSpacing:function(t){this.current.charSpacing=t},setWordSpacing:function(t){this.current.wordSpacing=t},setHScale:function(t){this.current.textHScale=t/100},setLeading:function(t){this.current.leading=-t},setFont:function(t,e){var n=this.commonObjs.get(t),i=this.current;if(n||v("Can't find font for "+t),i.fontMatrix=n.fontMatrix?n.fontMatrix:o,0!==i.fontMatrix[0]&&0!==i.fontMatrix[3]||b("Invalid font matrix for font "+t),e<0?(e=-e,i.fontDirection=-1):i.fontDirection=1,this.current.font=n,this.current.fontSize=e,!n.isType3Font){var r=n.loadedName||"sans-serif",a=n.black?"900":n.bold?"bold":"normal",s=n.italic?"italic":"normal",c='"'+r+'", '+n.fallbackName,l=e<16?16:e>100?100:e;this.current.fontSizeScale=e/l;var h=s+" "+a+" "+l+"px "+c;this.ctx.font=h}},setTextRenderingMode:function(t){this.current.textRenderingMode=t},setTextRise:function(t){this.current.textRise=t},moveText:function(t,e){this.current.x=this.current.lineX+=t,this.current.y=this.current.lineY+=e},setLeadingMoveText:function(t,e){this.setLeading(-e),this.moveText(t,e)},setTextMatrix:function(t,e,n,i,r,o){this.current.textMatrix=[t,e,n,i,r,o],this.current.textMatrixScale=Math.sqrt(t*t+e*e),this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0},nextLine:function(){this.moveText(0,this.current.leading)},paintChar:function(t,e,n){var i,r=this.ctx,o=this.current,a=o.font,s=o.textRenderingMode,c=o.fontSize/o.fontSizeScale,h=s&l.FILL_STROKE_MASK,u=!!(s&l.ADD_TO_PATH_FLAG);((a.disableFontFace||u)&&(i=a.getPathGenerator(this.commonObjs,t)),a.disableFontFace?(r.save(),r.translate(e,n),r.beginPath(),i(r,c),h!==l.FILL&&h!==l.FILL_STROKE||r.fill(),h!==l.STROKE&&h!==l.FILL_STROKE||r.stroke(),r.restore()):(h!==l.FILL&&h!==l.FILL_STROKE||r.fillText(t,e,n),h!==l.STROKE&&h!==l.FILL_STROKE||r.strokeText(t,e,n)),u)&&(this.pendingTextPaths||(this.pendingTextPaths=[])).push({transform:r.mozCurrentTransform,x:e,y:n,fontSize:c,addToPath:i})},get isFontSubpixelAAEnabled(){var t=document.createElement("canvas").getContext("2d");t.scale(1.5,1),t.fillText("I",0,10);for(var e=t.getImageData(0,0,10,10).data,n=!1,i=3;i<e.length;i+=4)if(e[i]>0&&e[i]<255){n=!0;break}return y(this,"isFontSubpixelAAEnabled",n)},showText:function(t){var e=this.current,n=e.font;if(n.isType3Font)return this.showType3Text(t);var i=e.fontSize;if(0!==i){var r=this.ctx,o=e.fontSizeScale,a=e.charSpacing,s=e.wordSpacing,c=e.fontDirection,h=e.textHScale*c,u=t.length,d=n.vertical,p=d?1:-1,m=n.defaultVMetrics,g=i*e.fontMatrix[0],v=e.textRenderingMode===l.FILL&&!n.disableFontFace;r.save(),r.transform.apply(r,e.textMatrix),r.translate(e.x,e.y+e.textRise),e.patternFill&&(r.fillStyle=e.fillColor.getPattern(r,this)),c>0?r.scale(h,-1):r.scale(h,1);var y=e.lineWidth,b=e.textMatrixScale;if(0===b||0===y){var x=e.textRenderingMode&l.FILL_STROKE_MASK;x!==l.STROKE&&x!==l.FILL_STROKE||(this.cachedGetSinglePixelWidth=null,y=.65*this.getSinglePixelWidth())}else y/=b;1!==o&&(r.scale(o,o),y/=o),r.lineWidth=y;var w,_=0;for(w=0;w<u;++w){var S=t[w];if(f(S))_+=p*S*i/1e3;else{var E,A,T,M,C,P,R,L=!1,k=(S.isSpace?s:0)+a,I=S.fontChar,D=S.accent,O=S.width;if(d)C=S.vmetric||m,P=-(P=S.vmetric?C[1]:.5*O)*g,R=C[2]*g,O=C?-C[0]:O,E=P/o,A=(_+R)/o;else E=_/o,A=0;if(n.remeasure&&O>0){var F=1e3*r.measureText(I).width/i*o;if(O<F&&this.isFontSubpixelAAEnabled){var N=O/F;L=!0,r.save(),r.scale(N,1),E/=N}else O!==F&&(E+=(O-F)/2e3*i/o)}(S.isInFont||n.missingFile)&&(v&&!D?r.fillText(I,E,A):(this.paintChar(I,E,A),D&&(T=E+D.offset.x/o,M=A-D.offset.y/o,this.paintChar(D.fontChar,T,M)))),_+=O*g+k*c,L&&r.restore()}}d?e.y-=_*h:e.x+=_*h,r.restore()}},showType3Text:function(t){var e,n,i,r,a=this.ctx,s=this.current,c=s.font,h=s.fontSize,d=s.fontDirection,p=c.vertical?1:-1,m=s.charSpacing,g=s.wordSpacing,v=s.textHScale*d,y=s.fontMatrix||o,x=t.length;if(!(s.textRenderingMode===l.INVISIBLE)&&0!==h){for(this.cachedGetSinglePixelWidth=null,a.save(),a.transform.apply(a,s.textMatrix),a.translate(s.x,s.y),a.scale(v,d),e=0;e<x;++e)if(n=t[e],f(n))r=p*n*h/1e3,this.ctx.translate(r,0),s.x+=r*v;else{var w=(n.isSpace?g:0)+m,_=c.charProcOperatorList[n.operatorListId];if(_)this.processingType3=n,this.save(),a.scale(h,h),a.transform.apply(a,y),this.executeOperatorList(_),this.restore(),i=u.applyTransform([n.width,0],y)[0]*h+w,a.translate(i,0),s.x+=i*v;else b('Type3 character "'+n.operatorListId+'" is not available')}a.restore(),this.processingType3=null}},setCharWidth:function(t,e){},setCharWidthAndBounds:function(t,e,n,i,r,o){this.ctx.rect(n,i,r-n,o-i),this.clip(),this.endPath()},getColorN_Pattern:function(e){var n;if("TilingPattern"===e[0]){var i=e[1],r=this.baseTransform||this.ctx.mozCurrentTransform.slice(),o=this,a={createCanvasGraphics:function(e){return new t(e,o.commonObjs,o.objs)}};n=new x(e,i,this.ctx,a,r)}else n=w(e);return n},setStrokeColorN:function(){this.current.strokeColor=this.getColorN_Pattern(arguments)},setFillColorN:function(){this.current.fillColor=this.getColorN_Pattern(arguments),this.current.patternFill=!0},setStrokeRGBColor:function(t,e,n){var i=u.makeCssRgb(t,e,n);this.ctx.strokeStyle=i,this.current.strokeColor=i},setFillRGBColor:function(t,e,n){var i=u.makeCssRgb(t,e,n);this.ctx.fillStyle=i,this.current.fillColor=i,this.current.patternFill=!1},shadingFill:function(t){var e=this.ctx;this.save();var n=w(t);e.fillStyle=n.getPattern(e,this,!0);var i=e.mozCurrentTransformInverse;if(i){var r=e.canvas,o=r.width,a=r.height,s=u.applyTransform([0,0],i),c=u.applyTransform([0,a],i),l=u.applyTransform([o,0],i),h=u.applyTransform([o,a],i),d=Math.min(s[0],c[0],l[0],h[0]),p=Math.min(s[1],c[1],l[1],h[1]),f=Math.max(s[0],c[0],l[0],h[0]),m=Math.max(s[1],c[1],l[1],h[1]);this.ctx.fillRect(d,p,f-d,m-p)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.restore()},beginInlineImage:function(){v("Should not call beginInlineImage")},beginImageData:function(){v("Should not call beginImageData")},paintFormXObjectBegin:function(t,e){if(this.save(),this.baseTransformStack.push(this.baseTransform),m(t)&&6===t.length&&this.transform.apply(this,t),this.baseTransform=this.ctx.mozCurrentTransform,m(e)&&4===e.length){var n=e[2]-e[0],i=e[3]-e[1];this.ctx.rect(e[0],e[1],n,i),this.clip(),this.endPath()}},paintFormXObjectEnd:function(){this.restore(),this.baseTransform=this.baseTransformStack.pop()},beginGroup:function(t){this.save();var e=this.ctx;t.isolated||p("TODO: Support non-isolated groups."),t.knockout&&b("Knockout groups not supported.");var n=e.mozCurrentTransform;t.matrix&&e.transform.apply(e,t.matrix),d(t.bbox,"Bounding box is required.");var r=u.getAxialAlignedBoundingBox(t.bbox,e.mozCurrentTransform),o=[0,0,e.canvas.width,e.canvas.height];r=u.intersect(r,o)||[0,0,0,0];var a=Math.floor(r[0]),s=Math.floor(r[1]),c=Math.max(Math.ceil(r[2])-a,1),l=Math.max(Math.ceil(r[3])-s,1),h=1,f=1;c>4096&&(h=c/4096,c=4096),l>4096&&(f=l/4096,l=4096);var m="groupAt"+this.groupLevel;t.smask&&(m+="_smask_"+this.smaskCounter++%2);var g=this.cachedCanvases.getCanvas(m,c,l,!0),v=g.context;v.scale(1/h,1/f),v.translate(-a,-s),v.transform.apply(v,n),t.smask?this.smaskStack.push({canvas:g.canvas,context:v,offsetX:a,offsetY:s,scaleX:h,scaleY:f,subtype:t.smask.subtype,backdrop:t.smask.backdrop,transferMap:t.smask.transferMap||null,startTransformInverse:null}):(e.setTransform(1,0,0,1,0,0),e.translate(a,s),e.scale(h,f)),i(e,v),this.ctx=v,this.setGState([["BM","Normal"],["ca",1],["CA",1]]),this.groupStack.push(e),this.groupLevel++,this.current.activeSMask=null},endGroup:function(t){this.groupLevel--;var e=this.ctx;this.ctx=this.groupStack.pop(),void 0!==this.ctx.imageSmoothingEnabled?this.ctx.imageSmoothingEnabled=!1:this.ctx.mozImageSmoothingEnabled=!1,t.smask?this.tempSMask=this.smaskStack.pop():this.ctx.drawImage(e.canvas,0,0),this.restore()},beginAnnotations:function(){this.save(),this.current=new P,this.baseTransform&&this.ctx.setTransform.apply(this.ctx,this.baseTransform)},endAnnotations:function(){this.restore()},beginAnnotation:function(t,e,n){if(this.save(),m(t)&&4===t.length){var i=t[2]-t[0],r=t[3]-t[1];this.ctx.rect(t[0],t[1],i,r),this.clip(),this.endPath()}this.transform.apply(this,e),this.transform.apply(this,n)},endAnnotation:function(){this.restore()},paintJpegXObject:function(t,e,n){var i=this.objs.get(t);if(i){this.save();var r=this.ctx;if(r.scale(1/e,-1/n),r.drawImage(i,0,0,i.width,i.height,0,-n,e,n),this.imageLayer){var o=r.mozCurrentTransformInverse,a=this.getCanvasPosition(0,0);this.imageLayer.appendImage({objId:t,left:a[0],top:a[1],width:e/o[0],height:n/o[3]})}this.restore()}else b("Dependent image isn't ready yet")},paintImageMaskXObject:function(t){var e=this.ctx,i=t.width,r=t.height,o=this.current.fillColor,a=this.current.patternFill,s=this.processingType3;if(s&&void 0===s.compiled&&(s.compiled=i<=1e3&&r<=1e3?function(t){var e,n,i,r,o=t.width,a=t.height,s=o+1,c=new Uint8Array(s*(a+1)),l=new Uint8Array([0,2,4,0,1,0,5,4,8,10,0,8,0,2,1,0]),h=o+7&-8,u=t.data,d=new Uint8Array(h*a),p=0;for(e=0,r=u.length;e<r;e++)for(var f=128,m=u[e];f>0;)d[p++]=m&f?0:255,f>>=1;var g=0;for(0!==d[p=0]&&(c[0]=1,++g),n=1;n<o;n++)d[p]!==d[p+1]&&(c[n]=d[p]?2:1,++g),p++;for(0!==d[p]&&(c[n]=2,++g),e=1;e<a;e++){i=e*s,d[(p=e*h)-h]!==d[p]&&(c[i]=d[p]?1:8,++g);var v=(d[p]?4:0)+(d[p-h]?8:0);for(n=1;n<o;n++)l[v=(v>>2)+(d[p+1]?4:0)+(d[p-h+1]?8:0)]&&(c[i+n]=l[v],++g),p++;if(d[p-h]!==d[p]&&(c[i+n]=d[p]?2:4,++g),g>1e3)return null}for(i=e*s,0!==d[p=h*(a-1)]&&(c[i]=8,++g),n=1;n<o;n++)d[p]!==d[p+1]&&(c[i+n]=d[p]?4:8,++g),p++;if(0!==d[p]&&(c[i+n]=4,++g),g>1e3)return null;var y=new Int32Array([0,s,-1,0,-s,0,0,0,1]),b=[];for(e=0;g&&e<=a;e++){for(var x=e*s,w=x+o;x<w&&!c[x];)x++;if(x!==w){var _,S=[x%s,e],E=c[x],A=x;do{var T=y[E];do{x+=T}while(!c[x]);5!==(_=c[x])&&10!==_?(E=_,c[x]=0):(E=_&51*E>>4,c[x]&=E>>2|E<<2),S.push(x%s),S.push(x/s|0),--g}while(A!==x);b.push(S),--e}}return function(t){t.save(),t.scale(1/o,-1/a),t.translate(0,-a),t.beginPath();for(var e=0,n=b.length;e<n;e++){var i=b[e];t.moveTo(i[0],i[1]);for(var r=2,s=i.length;r<s;r+=2)t.lineTo(i[r],i[r+1])}t.fill(),t.beginPath(),t.restore()}}({data:t.data,width:i,height:r}):null),s&&s.compiled)s.compiled(e);else{var c=this.cachedCanvases.getCanvas("maskCanvas",i,r),l=c.context;l.save(),n(l,t),l.globalCompositeOperation="source-in",l.fillStyle=a?o.getPattern(l,this):o,l.fillRect(0,0,i,r),l.restore(),this.paintInlineImageXObject(c.canvas)}},paintImageMaskXObjectRepeat:function(t,e,i,r){var o=t.width,a=t.height,s=this.current.fillColor,c=this.current.patternFill,l=this.cachedCanvases.getCanvas("maskCanvas",o,a),h=l.context;h.save(),n(h,t),h.globalCompositeOperation="source-in",h.fillStyle=c?s.getPattern(h,this):s,h.fillRect(0,0,o,a),h.restore();for(var u=this.ctx,d=0,p=r.length;d<p;d+=2)u.save(),u.transform(e,0,0,i,r[d],r[d+1]),u.scale(1,-1),u.drawImage(l.canvas,0,0,o,a,0,-1,1,1),u.restore()},paintImageMaskXObjectGroup:function(t){for(var e=this.ctx,i=this.current.fillColor,r=this.current.patternFill,o=0,a=t.length;o<a;o++){var s=t[o],c=s.width,l=s.height,h=this.cachedCanvases.getCanvas("maskCanvas",c,l),u=h.context;u.save(),n(u,s),u.globalCompositeOperation="source-in",u.fillStyle=r?i.getPattern(u,this):i,u.fillRect(0,0,c,l),u.restore(),e.save(),e.transform.apply(e,s.transform),e.scale(1,-1),e.drawImage(h.canvas,0,0,c,l,0,-1,1,1),e.restore()}},paintImageXObject:function(t){var e=this.objs.get(t);e?this.paintInlineImageXObject(e):b("Dependent image isn't ready yet")},paintImageXObjectRepeat:function(t,e,n,i){var r=this.objs.get(t);if(r){for(var o=r.width,a=r.height,s=[],c=0,l=i.length;c<l;c+=2)s.push({transform:[e,0,0,n,i[c],i[c+1]],x:0,y:0,w:o,h:a});this.paintInlineImageXObjectGroup(r,s)}else b("Dependent image isn't ready yet")},paintInlineImageXObject:function(t){var n=t.width,i=t.height,r=this.ctx;this.save(),r.scale(1/n,-1/i);var o,a,s=r.mozCurrentTransformInverse,c=s[0],l=s[1],h=Math.max(Math.sqrt(c*c+l*l),1),u=s[2],d=s[3],p=Math.max(Math.sqrt(u*u+d*d),1);if(t instanceof HTMLElement||!t.data)o=t;else{var f=(a=this.cachedCanvases.getCanvas("inlineImage",n,i)).context;e(f,t),o=a.canvas}for(var m=n,g=i,v="prescale1";h>2&&m>1||p>2&&g>1;){var y=m,b=g;h>2&&m>1&&(h/=m/(y=Math.ceil(m/2))),p>2&&g>1&&(p/=g/(b=Math.ceil(g/2))),(f=(a=this.cachedCanvases.getCanvas(v,y,b)).context).clearRect(0,0,y,b),f.drawImage(o,0,0,m,g,0,0,y,b),o=a.canvas,m=y,g=b,v="prescale1"===v?"prescale2":"prescale1"}if(r.drawImage(o,0,0,m,g,0,-i,n,i),this.imageLayer){var x=this.getCanvasPosition(0,-i);this.imageLayer.appendImage({imgData:t,left:x[0],top:x[1],width:n/s[0],height:i/s[3]})}this.restore()},paintInlineImageXObjectGroup:function(t,n){var i=this.ctx,r=t.width,o=t.height,a=this.cachedCanvases.getCanvas("inlineImage",r,o);e(a.context,t);for(var s=0,c=n.length;s<c;s++){var l=n[s];if(i.save(),i.transform.apply(i,l.transform),i.scale(1,-1),i.drawImage(a.canvas,l.x,l.y,l.w,l.h,0,-1,1,1),this.imageLayer){var h=this.getCanvasPosition(l.x,l.y);this.imageLayer.appendImage({imgData:t,left:h[0],top:h[1],width:r,height:o})}i.restore()}},paintSolidColorImageMask:function(){this.ctx.fillRect(0,0,1,1)},paintXObject:function(){b("Unsupported 'paintXObject' command.")},markPoint:function(t){},markPointProps:function(t,e){},beginMarkedContent:function(t){},beginMarkedContentProps:function(t,e){},endMarkedContent:function(){},beginCompat:function(){},endCompat:function(){},consumePath:function(){var t=this.ctx;this.pendingClip&&(this.pendingClip===I?void 0!==t.mozFillRule?(t.mozFillRule="evenodd",t.clip(),t.mozFillRule="nonzero"):t.clip("evenodd"):t.clip(),this.pendingClip=null),t.beginPath()},getSinglePixelWidth:function(t){if(null===this.cachedGetSinglePixelWidth){this.ctx.save();var e=this.ctx.mozCurrentTransformInverse;this.ctx.restore(),this.cachedGetSinglePixelWidth=Math.sqrt(Math.max(e[0]*e[0]+e[1]*e[1],e[2]*e[2]+e[3]*e[3]))}return this.cachedGetSinglePixelWidth},getCanvasPosition:function(t,e){var n=this.ctx.mozCurrentTransform;return[n[0]*t+n[2]*e+n[4],n[1]*t+n[3]*e+n[5]]}},c)t.prototype[c[D]]=t.prototype[D];return t}();t.CanvasGraphics=R,t.createScratchCanvas=T}(t.pdfjsDisplayCanvas={},t.pdfjsSharedUtil,t.pdfjsDisplayDOMUtils,t.pdfjsDisplayPatternHelper,t.pdfjsDisplayWebGL)}(this),function(t,i){!function(t,i,r,o,a,s,c){var l,h,u=i.InvalidPDFException,d=i.MessageHandler,p=i.MissingPDFException,f=i.PageViewport,m=(i.PasswordResponses,i.PasswordException),g=i.StatTimer,v=i.UnexpectedResponseException,y=i.UnknownErrorException,b=i.Util,x=i.createPromiseCapability,w=i.error,_=i.deprecated,S=i.getVerbosityLevel,E=i.info,A=i.isInt,T=i.isArray,M=i.isArrayBuffer,C=i.isSameOrigin,P=i.loadJpegStream,R=i.stringToBytes,L=i.globalScope,k=i.warn,I=r.FontFaceObject,D=r.FontLoader,O=o.CanvasGraphics,F=o.createScratchCanvas,N=a.Metadata,U=s.getDefaultSetting,j=!1,B=!1,z=!1;"undefined"==typeof window&&(j=!0,z=!0);z=!0;"undefined"!=typeof requirejs&&requirejs.toUrl&&(l=requirejs.toUrl("pdfjs-dist/build/pdf.worker.js"));var H="undefined"!=typeof requirejs&&requirejs.load;function G(t,e,n,i){return t.destroyed?Promise.reject(new Error("Worker was destroyed")):(e.disableAutoFetch=U("disableAutoFetch"),e.disableStream=U("disableStream"),e.chunkedViewerLoading=!!n,n&&(e.length=n.length,e.initialData=n.initialData),t.messageHandler.sendWithPromise("GetDocRequest",{docId:i,source:e,disableRange:U("disableRange"),maxImageSize:U("maxImageSize"),cMapUrl:U("cMapUrl"),cMapPacked:U("cMapPacked"),disableFontFace:U("disableFontFace"),disableCreateObjectURL:U("disableCreateObjectURL"),postMessageTransfers:U("postMessageTransfers")&&!B,docBaseUrl:e.docBaseUrl}).then((function(e){if(t.destroyed)throw new Error("Worker was destroyed");return e})))}h=z?function(t){n.e(0).then(function(){var e=n(5);t(e.WorkerMessageHandler)}.bind(null,n)).catch(n.oe)}:H?function(t){requirejs(["pdfjs-dist/build/pdf.worker"],(function(e){t(e.WorkerMessageHandler)}))}:null;var V=function(){var t=0;function e(){this._capability=x(),this._transport=null,this._worker=null,this.docId="d"+t++,this.destroyed=!1,this.onPassword=null,this.onProgress=null,this.onUnsupportedFeature=null}return e.prototype={get promise(){return this._capability.promise},destroy:function(){return this.destroyed=!0,(this._transport?this._transport.destroy():Promise.resolve()).then(function(){this._transport=null,this._worker&&(this._worker.destroy(),this._worker=null)}.bind(this))},then:function(t,e){return this.promise.then.apply(this.promise,arguments)}},e}(),W=function(){function t(t,e){this.length=t,this.initialData=e,this._rangeListeners=[],this._progressListeners=[],this._progressiveReadListeners=[],this._readyCapability=x()}return t.prototype={addRangeListener:function(t){this._rangeListeners.push(t)},addProgressListener:function(t){this._progressListeners.push(t)},addProgressiveReadListener:function(t){this._progressiveReadListeners.push(t)},onDataRange:function(t,e){for(var n=this._rangeListeners,i=0,r=n.length;i<r;++i)n[i](t,e)},onDataProgress:function(t){this._readyCapability.promise.then(function(){for(var e=this._progressListeners,n=0,i=e.length;n<i;++n)e[n](t)}.bind(this))},onDataProgressiveRead:function(t){this._readyCapability.promise.then(function(){for(var e=this._progressiveReadListeners,n=0,i=e.length;n<i;++n)e[n](t)}.bind(this))},transportReady:function(){this._readyCapability.resolve()},requestDataRange:function(t,e){throw new Error("Abstract method PDFDataRangeTransport.requestDataRange")},abort:function(){}},t}(),X=function(){function t(t,e,n){this.pdfInfo=t,this.transport=e,this.loadingTask=n}return t.prototype={get numPages(){return this.pdfInfo.numPages},get fingerprint(){return this.pdfInfo.fingerprint},getPage:function(t){return this.transport.getPage(t)},getPageIndex:function(t){return this.transport.getPageIndex(t)},getDestinations:function(){return this.transport.getDestinations()},getDestination:function(t){return this.transport.getDestination(t)},getPageLabels:function(){return this.transport.getPageLabels()},getAttachments:function(){return this.transport.getAttachments()},getJavaScript:function(){return this.transport.getJavaScript()},getOutline:function(){return this.transport.getOutline()},getMetadata:function(){return this.transport.getMetadata()},getData:function(){return this.transport.getData()},getDownloadInfo:function(){return this.transport.downloadInfoCapability.promise},getStats:function(){return this.transport.getStats()},cleanup:function(){this.transport.startCleanup()},destroy:function(){return this.loadingTask.destroy()}},t}(),q=function(){function t(t,e,n){this.pageIndex=t,this.pageInfo=e,this.transport=n,this.stats=new g,this.stats.enabled=U("enableStats"),this.commonObjs=n.commonObjs,this.objs=new $,this.cleanupAfterRender=!1,this.pendingCleanup=!1,this.intentStates=Object.create(null),this.destroyed=!1}return t.prototype={get pageNumber(){return this.pageIndex+1},get rotate(){return this.pageInfo.rotate},get ref(){return this.pageInfo.ref},get userUnit(){return this.pageInfo.userUnit},get view(){return this.pageInfo.view},getViewport:function(t,e){return arguments.length<2&&(e=this.rotate),new f(this.view,t,e,0,0)},getAnnotations:function(t){var e=t&&t.intent||null;return this.annotationsPromise&&this.annotationsIntent===e||(this.annotationsPromise=this.transport.getAnnotations(this.pageIndex,e),this.annotationsIntent=e),this.annotationsPromise},render:function(t){var e=this.stats;e.time("Overall"),this.pendingCleanup=!1;var n="print"===t.intent?"print":"display",i=!0===t.renderInteractiveForms;this.intentStates[n]||(this.intentStates[n]=Object.create(null));var r=this.intentStates[n];r.displayReadyCapability||(r.receivingOperatorList=!0,r.displayReadyCapability=x(),r.operatorList={fnArray:[],argsArray:[],lastChunk:!1},this.stats.time("Page Request"),this.transport.messageHandler.send("RenderPageRequest",{pageIndex:this.pageNumber-1,intent:n,renderInteractiveForms:i}));var o=new J(c,t,this.objs,this.commonObjs,r.operatorList,this.pageNumber);o.useRequestAnimationFrame="print"!==n,r.renderTasks||(r.renderTasks=[]),r.renderTasks.push(o);var a=o.task;t.continueCallback&&(_("render is used with continueCallback parameter"),a.onContinue=t.continueCallback);var s=this;function c(t){var n=r.renderTasks.indexOf(o);n>=0&&r.renderTasks.splice(n,1),s.cleanupAfterRender&&(s.pendingCleanup=!0),s._tryCleanup(),t?o.capability.reject(t):o.capability.resolve(),e.timeEnd("Rendering"),e.timeEnd("Overall")}return r.displayReadyCapability.promise.then((function(t){s.pendingCleanup?c():(e.time("Rendering"),o.initializeGraphics(t),o.operatorListChanged())}),(function(t){c(t)})),a},getOperatorList:function(){this.intentStates.oplist||(this.intentStates.oplist=Object.create(null));var t,e=this.intentStates.oplist;return e.opListReadCapability||((t={}).operatorListChanged=function(){if(e.operatorList.lastChunk){e.opListReadCapability.resolve(e.operatorList);var n=e.renderTasks.indexOf(t);n>=0&&e.renderTasks.splice(n,1)}},e.receivingOperatorList=!0,e.opListReadCapability=x(),e.renderTasks=[],e.renderTasks.push(t),e.operatorList={fnArray:[],argsArray:[],lastChunk:!1},this.transport.messageHandler.send("RenderPageRequest",{pageIndex:this.pageIndex,intent:"oplist"})),e.opListReadCapability.promise},getTextContent:function(t){return this.transport.messageHandler.sendWithPromise("GetTextContent",{pageIndex:this.pageNumber-1,normalizeWhitespace:!(!t||!0!==t.normalizeWhitespace),combineTextItems:!t||!0!==t.disableCombineTextItems})},_destroy:function(){this.destroyed=!0,this.transport.pageCache[this.pageIndex]=null;var t=[];return Object.keys(this.intentStates).forEach((function(e){"oplist"!==e&&this.intentStates[e].renderTasks.forEach((function(e){var n=e.capability.promise.catch((function(){}));t.push(n),e.cancel()}))}),this),this.objs.clear(),this.annotationsPromise=null,this.pendingCleanup=!1,Promise.all(t)},destroy:function(){_("page destroy method, use cleanup() instead"),this.cleanup()},cleanup:function(){this.pendingCleanup=!0,this._tryCleanup()},_tryCleanup:function(){this.pendingCleanup&&!Object.keys(this.intentStates).some((function(t){var e=this.intentStates[t];return 0!==e.renderTasks.length||e.receivingOperatorList}),this)&&(Object.keys(this.intentStates).forEach((function(t){delete this.intentStates[t]}),this),this.objs.clear(),this.annotationsPromise=null,this.pendingCleanup=!1)},_startRenderPage:function(t,e){var n=this.intentStates[e];n.displayReadyCapability&&n.displayReadyCapability.resolve(t)},_renderPageChunk:function(t,e){var n,i,r=this.intentStates[e];for(n=0,i=t.length;n<i;n++)r.operatorList.fnArray.push(t.fnArray[n]),r.operatorList.argsArray.push(t.argsArray[n]);for(r.operatorList.lastChunk=t.lastChunk,n=0;n<r.renderTasks.length;n++)r.renderTasks[n].operatorListChanged();t.lastChunk&&(r.receivingOperatorList=!1,this._tryCleanup())}},t}(),Y=function(){var t,n=0;function i(){return void 0!==l?l:U("workerSrc")?U("workerSrc"):e?e.replace(/\.js$/i,".worker.js"):void w("No PDFJS.workerSrc specified")}function r(t){this._listeners=[],this._defer=t,this._deferred=Promise.resolve(void 0)}function o(t){this.name=t,this.destroyed=!1,this._readyCapability=x(),this._port=null,this._webWorker=null,this._messageHandler=null,this._initialize()}return r.prototype={postMessage:function(t,e){if(this._defer){var n=new WeakMap,i={data:function t(i){if("object"!=typeof i||null===i)return i;if(n.has(i))return n.get(i);var r,o;if((o=i.buffer)&&M(o)){var a=e&&e.indexOf(o)>=0;return r=i===o?i:a?new i.constructor(o,i.byteOffset,i.byteLength):new i.constructor(i),n.set(i,r),r}for(var s in r=T(i)?[]:{},n.set(i,r),i){for(var c,l=i;!(c=Object.getOwnPropertyDescriptor(l,s));)l=Object.getPrototypeOf(l);void 0!==c.value&&"function"!=typeof c.value&&(r[s]=t(c.value))}return r}(t)};this._deferred.then(function(){this._listeners.forEach((function(t){t.call(this,i)}),this)}.bind(this))}else this._listeners.forEach((function(e){e.call(this,{data:t})}),this)},addEventListener:function(t,e){this._listeners.push(e)},removeEventListener:function(t,e){var n=this._listeners.indexOf(e);this._listeners.splice(n,1)},terminate:function(){this._listeners=[]}},o.prototype={get promise(){return this._readyCapability.promise},get port(){return this._port},get messageHandler(){return this._messageHandler},_initialize:function(){if(!j&&!U("disableWorker")&&"undefined"!=typeof Worker){var t=i();try{C(window.location.href,t)||(s=new URL(t,window.location).href,c="importScripts('"+s+"');",t=URL.createObjectURL(new Blob([c])));var e=new Worker(t),n=new d("main","worker",e),r=function(){e.removeEventListener("error",o),n.destroy(),e.terminate(),this.destroyed?this._readyCapability.reject(new Error("Worker was destroyed")):this._setupFakeWorker()}.bind(this),o=function(t){this._webWorker||r()}.bind(this);e.addEventListener("error",o),n.on("test",function(t){(e.removeEventListener("error",o),this.destroyed)?r():t&&t.supportTypedArray?(this._messageHandler=n,this._port=e,this._webWorker=e,t.supportTransfers||(B=!0),this._readyCapability.resolve(),n.send("configure",{verbosity:S()})):(this._setupFakeWorker(),n.destroy(),e.terminate())}.bind(this)),n.on("console_log",(function(t){console.log.apply(console,t)})),n.on("console_error",(function(t){console.error.apply(console,t)})),n.on("ready",function(t){if(e.removeEventListener("error",o),this.destroyed)r();else try{a()}catch(t){this._setupFakeWorker()}}.bind(this));var a=function(){var t=U("postMessageTransfers")&&!B,e=new Uint8Array([t?255:0]);try{n.send("test",e,[e.buffer])}catch(t){E("Cannot use postMessage transfers"),e[0]=0,n.send("test",e)}};return void a()}catch(t){E("The worker has been disabled.")}}var s,c;this._setupFakeWorker()},_setupFakeWorker:function(){j||U("disableWorker")||(k("Setting up fake worker."),j=!0),(t||(t=x(),(h||function(t){b.loadScript(i(),(function(){t(window.pdfjsDistBuildPdfWorker.WorkerMessageHandler)}))})(t.resolve)),t.promise).then(function(t){if(this.destroyed)this._readyCapability.reject(new Error("Worker was destroyed"));else{var e=new r(Uint8Array!==Float32Array);this._port=e;var i="fake"+n++,o=new d(i+"_worker",i,e);t.setup(o,e);var a=new d(i,i+"_worker",e);this._messageHandler=a,this._readyCapability.resolve()}}.bind(this))},destroy:function(){this.destroyed=!0,this._webWorker&&(this._webWorker.terminate(),this._webWorker=null),this._port=null,this._messageHandler&&(this._messageHandler.destroy(),this._messageHandler=null)}},o}(),Z=function(){function t(t,e,n){this.messageHandler=t,this.loadingTask=e,this.pdfDataRangeTransport=n,this.commonObjs=new $,this.fontLoader=new D(e.docId),this.destroyed=!1,this.destroyCapability=null,this._passwordCapability=null,this.pageCache=[],this.pagePromises=[],this.downloadInfoCapability=x(),this.setupMessageHandler()}return t.prototype={destroy:function(){if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=x(),this._passwordCapability&&this._passwordCapability.reject(new Error("Worker was destroyed during onPassword callback"));var t=[];this.pageCache.forEach((function(e){e&&t.push(e._destroy())})),this.pageCache=[],this.pagePromises=[];var e=this,n=this.messageHandler.sendWithPromise("Terminate",null);return t.push(n),Promise.all(t).then((function(){e.fontLoader.clear(),e.pdfDataRangeTransport&&(e.pdfDataRangeTransport.abort(),e.pdfDataRangeTransport=null),e.messageHandler&&(e.messageHandler.destroy(),e.messageHandler=null),e.destroyCapability.resolve()}),this.destroyCapability.reject),this.destroyCapability.promise},setupMessageHandler:function(){var t=this.messageHandler,e=this.loadingTask,n=this.pdfDataRangeTransport;n&&(n.addRangeListener((function(e,n){t.send("OnDataRange",{begin:e,chunk:n})})),n.addProgressListener((function(e){t.send("OnDataProgress",{loaded:e})})),n.addProgressiveReadListener((function(e){t.send("OnDataRange",{chunk:e})})),t.on("RequestDataRange",(function(t){n.requestDataRange(t.begin,t.end)}),this)),t.on("GetDoc",(function(t){var e=t.pdfInfo;this.numPages=t.pdfInfo.numPages;var n=this.loadingTask,i=new X(e,this,n);this.pdfDocument=i,n._capability.resolve(i)}),this),t.on("PasswordRequest",(function(t){if(this._passwordCapability=x(),e.onPassword){var n=function(t){this._passwordCapability.resolve({password:t})}.bind(this);e.onPassword(n,t.code)}else this._passwordCapability.reject(new m(t.message,t.code));return this._passwordCapability.promise}),this),t.on("PasswordException",(function(t){e._capability.reject(new m(t.message,t.code))}),this),t.on("InvalidPDF",(function(t){this.loadingTask._capability.reject(new u(t.message))}),this),t.on("MissingPDF",(function(t){this.loadingTask._capability.reject(new p(t.message))}),this),t.on("UnexpectedResponse",(function(t){this.loadingTask._capability.reject(new v(t.message,t.status))}),this),t.on("UnknownError",(function(t){this.loadingTask._capability.reject(new y(t.message,t.details))}),this),t.on("DataLoaded",(function(t){this.downloadInfoCapability.resolve(t)}),this),t.on("PDFManagerReady",(function(t){this.pdfDataRangeTransport&&this.pdfDataRangeTransport.transportReady()}),this),t.on("StartRenderPage",(function(t){if(!this.destroyed){var e=this.pageCache[t.pageIndex];e.stats.timeEnd("Page Request"),e._startRenderPage(t.transparency,t.intent)}}),this),t.on("RenderPageChunk",(function(t){this.destroyed||this.pageCache[t.pageIndex]._renderPageChunk(t.operatorList,t.intent)}),this),t.on("commonobj",(function(t){if(!this.destroyed){var e=t[0],n=t[1];if(!this.commonObjs.hasData(e))switch(n){case"Font":var i=t[2];if("error"in i){var r=i.error;k("Error during font loading: "+r),this.commonObjs.resolve(e,r);break}var o=null;U("pdfBug")&&L.FontInspector&&L.FontInspector.enabled&&(o={registerFont:function(t,e){L.FontInspector.fontAdded(t,e)}});var a=new I(i,{isEvalSuported:U("isEvalSupported"),disableFontFace:U("disableFontFace"),fontRegistry:o});this.fontLoader.bind([a],function(t){this.commonObjs.resolve(e,a)}.bind(this));break;case"FontPath":this.commonObjs.resolve(e,t[2]);break;default:w("Got unknown common object type "+n)}}}),this),t.on("obj",(function(t){if(!this.destroyed){var e,n=t[0],i=t[1],r=t[2],o=this.pageCache[i];if(!o.objs.hasData(n))switch(r){case"JpegStream":e=t[3],P(n,e,o.objs);break;case"Image":e=t[3],o.objs.resolve(n,e);e&&"data"in e&&e.data.length>8e6&&(o.cleanupAfterRender=!0);break;default:w("Got unknown object type "+r)}}}),this),t.on("DocProgress",(function(t){if(!this.destroyed){var e=this.loadingTask;e.onProgress&&e.onProgress({loaded:t.loaded,total:t.total})}}),this),t.on("PageError",(function(t){if(!this.destroyed){var e=this.pageCache[t.pageNum-1].intentStates[t.intent];if(e.displayReadyCapability?e.displayReadyCapability.reject(t.error):w(t.error),e.operatorList){e.operatorList.lastChunk=!0;for(var n=0;n<e.renderTasks.length;n++)e.renderTasks[n].operatorListChanged()}}}),this),t.on("UnsupportedFeature",(function(t){if(!this.destroyed){var e=t.featureId,n=this.loadingTask;n.onUnsupportedFeature&&n.onUnsupportedFeature(e),K.notify(e)}}),this),t.on("JpegDecode",(function(t){if(this.destroyed)return Promise.reject(new Error("Worker was destroyed"));var e=t[0],n=t[1];return 3!==n&&1!==n?Promise.reject(new Error("Only 3 components or 1 component can be returned")):new Promise((function(t,i){var r=new Image;r.onload=function(){var e=r.width,i=r.height,o=e*i,a=4*o,s=new Uint8Array(o*n),c=F(e,i).getContext("2d");c.drawImage(r,0,0);var l,h,u=c.getImageData(0,0,e,i).data;if(3===n)for(l=0,h=0;l<a;l+=4,h+=3)s[h]=u[l],s[h+1]=u[l+1],s[h+2]=u[l+2];else if(1===n)for(l=0,h=0;l<a;l+=4,h++)s[h]=u[l];t({data:s,width:e,height:i})},r.onerror=function(){i(new Error("JpegDecode failed to load image"))},r.src=e}))}),this)},getData:function(){return this.messageHandler.sendWithPromise("GetData",null)},getPage:function(t,e){if(!A(t)||t<=0||t>this.numPages)return Promise.reject(new Error("Invalid page request"));var n=t-1;if(n in this.pagePromises)return this.pagePromises[n];var i=this.messageHandler.sendWithPromise("GetPage",{pageIndex:n}).then(function(t){if(this.destroyed)throw new Error("Transport destroyed");var e=new q(n,t,this);return this.pageCache[n]=e,e}.bind(this));return this.pagePromises[n]=i,i},getPageIndex:function(t){return this.messageHandler.sendWithPromise("GetPageIndex",{ref:t}).catch((function(t){return Promise.reject(new Error(t))}))},getAnnotations:function(t,e){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:t,intent:e})},getDestinations:function(){return this.messageHandler.sendWithPromise("GetDestinations",null)},getDestination:function(t){return this.messageHandler.sendWithPromise("GetDestination",{id:t})},getPageLabels:function(){return this.messageHandler.sendWithPromise("GetPageLabels",null)},getAttachments:function(){return this.messageHandler.sendWithPromise("GetAttachments",null)},getJavaScript:function(){return this.messageHandler.sendWithPromise("GetJavaScript",null)},getOutline:function(){return this.messageHandler.sendWithPromise("GetOutline",null)},getMetadata:function(){return this.messageHandler.sendWithPromise("GetMetadata",null).then((function(t){return{info:t[0],metadata:t[1]?new N(t[1]):null}}))},getStats:function(){return this.messageHandler.sendWithPromise("GetStats",null)},startCleanup:function(){this.messageHandler.sendWithPromise("Cleanup",null).then(function(){for(var t=0,e=this.pageCache.length;t<e;t++){var n=this.pageCache[t];n&&n.cleanup()}this.commonObjs.clear(),this.fontLoader.clear()}.bind(this))}},t}(),$=function(){function t(){this.objs=Object.create(null)}return t.prototype={ensureObj:function(t){if(this.objs[t])return this.objs[t];var e={capability:x(),data:null,resolved:!1};return this.objs[t]=e,e},get:function(t,e){if(e)return this.ensureObj(t).capability.promise.then(e),null;var n=this.objs[t];return n&&n.resolved||w("Requesting object that isn't resolved yet "+t),n.data},resolve:function(t,e){var n=this.ensureObj(t);n.resolved=!0,n.data=e,n.capability.resolve(e)},isResolved:function(t){var e=this.objs;return!!e[t]&&e[t].resolved},hasData:function(t){return this.isResolved(t)},getData:function(t){var e=this.objs;return e[t]&&e[t].resolved?e[t].data:null},clear:function(){this.objs=Object.create(null)}},t}(),Q=function(){function t(t){this._internalRenderTask=t,this.onContinue=null}return t.prototype={get promise(){return this._internalRenderTask.capability.promise},cancel:function(){this._internalRenderTask.cancel()},then:function(t,e){return this.promise.then.apply(this.promise,arguments)}},t}(),J=function(){function t(t,e,n,i,r,o){this.callback=t,this.params=e,this.objs=n,this.commonObjs=i,this.operatorListIdx=null,this.operatorList=r,this.pageNumber=o,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this.useRequestAnimationFrame=!1,this.cancelled=!1,this.capability=x(),this.task=new Q(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this)}return t.prototype={initializeGraphics:function(t){if(!this.cancelled){U("pdfBug")&&L.StepperManager&&L.StepperManager.enabled&&(this.stepper=L.StepperManager.create(this.pageNumber-1),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());var e=this.params;this.gfx=new O(e.canvasContext,this.commonObjs,this.objs,e.imageLayer),this.gfx.beginDrawing(e.transform,e.viewport,t),this.operatorListIdx=0,this.graphicsReady=!0,this.graphicsReadyCallback&&this.graphicsReadyCallback()}},cancel:function(){this.running=!1,this.cancelled=!0,this.callback("cancelled")},operatorListChanged:function(){this.graphicsReady?(this.stepper&&this.stepper.updateOperatorList(this.operatorList),this.running||this._continue()):this.graphicsReadyCallback||(this.graphicsReadyCallback=this._continueBound)},_continue:function(){this.running=!0,this.cancelled||(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())},_scheduleNext:function(){this.useRequestAnimationFrame&&"undefined"!=typeof window?window.requestAnimationFrame(this._nextBound):Promise.resolve(void 0).then(this._nextBound)},_next:function(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),this.callback())))}},t}(),K=(tt=[],{listen:function(t){_("Global UnsupportedManager.listen is used:  use PDFDocumentLoadingTask.onUnsupportedFeature instead"),tt.push(t)},notify:function(t){for(var e=0,n=tt.length;e<n;e++)tt[e](t)}});var tt;t.version="1.7.225";t.build="17d135f";t.getDocument=function(t,e,n,i){var r,o=new V;arguments.length>1&&_("getDocument is called with pdfDataRangeTransport, passwordCallback or progressCallback argument"),e&&(e instanceof W||((e=Object.create(e)).length=t.length,e.initialData=t.initialData,e.abort||(e.abort=function(){})),(t=Object.create(t)).range=e),o.onPassword=n||null,o.onProgress=i||null,"string"==typeof t?r={url:t}:M(t)?r={data:t}:t instanceof W?r={range:t}:("object"!=typeof t&&w("Invalid parameter in getDocument, need either Uint8Array, string or a parameter object"),t.url||t.data||t.range||w("Invalid parameter object: need either .data, .range or .url"),r=t);var a={},s=null,c=null;for(var l in r)if("url"!==l||"undefined"==typeof window)if("range"!==l)if("worker"!==l)if("data"!==l||r[l]instanceof Uint8Array)a[l]=r[l];else{var h=r[l];"string"==typeof h?a[l]=R(h):"object"!=typeof h||null===h||isNaN(h.length)?M(h)?a[l]=new Uint8Array(h):w("Invalid PDF binary data: either typed array, string or array-like object is expected in the data property."):a[l]=new Uint8Array(h)}else c=r[l];else s=r[l];else a[l]=new URL(r[l],window.location).href;a.rangeChunkSize=a.rangeChunkSize||65536,c||(c=new Y,o._worker=c);var u=o.docId;return c.promise.then((function(){if(o.destroyed)throw new Error("Loading aborted");return G(c,a,s,u).then((function(t){if(o.destroyed)throw new Error("Loading aborted");var e=new d(u,t,c.port),n=new Z(e,o,s);o._transport=n,e.send("Ready",null)}))})).catch(o._capability.reject),o},t.PDFDataRangeTransport=W,t.PDFWorker=Y,t.PDFDocumentProxy=X,t.PDFPageProxy=q,t._UnsupportedManager=K}(t.pdfjsDisplayAPI={},t.pdfjsSharedUtil,t.pdfjsDisplayFontLoader,t.pdfjsDisplayCanvas,t.pdfjsDisplayMetadata,t.pdfjsDisplayDOMUtils)}(this),function(t,e){!function(t,e,n,i,r,o,a,s){var c=e.globalScope,l=e.deprecated,h=e.warn,u=n.LinkTarget,d=n.DEFAULT_LINK_REL,p="undefined"==typeof window;c.PDFJS||(c.PDFJS={});var f=c.PDFJS;f.version="1.7.225";f.build="17d135f";f.pdfBug=!1,void 0!==f.verbosity&&e.setVerbosityLevel(f.verbosity);delete f.verbosity,Object.defineProperty(f,"verbosity",{get:function(){return e.getVerbosityLevel()},set:function(t){e.setVerbosityLevel(t)},enumerable:!0,configurable:!0}),f.VERBOSITY_LEVELS=e.VERBOSITY_LEVELS,f.OPS=e.OPS,f.UNSUPPORTED_FEATURES=e.UNSUPPORTED_FEATURES,f.isValidUrl=n.isValidUrl,f.shadow=e.shadow,f.createBlob=e.createBlob,f.createObjectURL=function(t,n){return e.createObjectURL(t,n,f.disableCreateObjectURL)},Object.defineProperty(f,"isLittleEndian",{configurable:!0,get:function(){var t=e.isLittleEndian();return e.shadow(f,"isLittleEndian",t)}}),f.removeNullCharacters=e.removeNullCharacters,f.PasswordResponses=e.PasswordResponses,f.PasswordException=e.PasswordException,f.UnknownErrorException=e.UnknownErrorException,f.InvalidPDFException=e.InvalidPDFException,f.MissingPDFException=e.MissingPDFException,f.UnexpectedResponseException=e.UnexpectedResponseException,f.Util=e.Util,f.PageViewport=e.PageViewport,f.createPromiseCapability=e.createPromiseCapability,f.maxImageSize=void 0===f.maxImageSize?-1:f.maxImageSize,f.cMapUrl=void 0===f.cMapUrl?null:f.cMapUrl,f.cMapPacked=void 0!==f.cMapPacked&&f.cMapPacked,f.disableFontFace=void 0!==f.disableFontFace&&f.disableFontFace,f.imageResourcesPath=void 0===f.imageResourcesPath?"":f.imageResourcesPath,f.disableWorker=void 0!==f.disableWorker&&f.disableWorker,f.workerSrc=void 0===f.workerSrc?null:f.workerSrc,f.disableRange=void 0!==f.disableRange&&f.disableRange,f.disableStream=void 0!==f.disableStream&&f.disableStream,f.disableAutoFetch=void 0!==f.disableAutoFetch&&f.disableAutoFetch,f.pdfBug=void 0!==f.pdfBug&&f.pdfBug,f.postMessageTransfers=void 0===f.postMessageTransfers||f.postMessageTransfers,f.disableCreateObjectURL=void 0!==f.disableCreateObjectURL&&f.disableCreateObjectURL,f.disableWebGL=void 0===f.disableWebGL||f.disableWebGL,f.externalLinkTarget=void 0===f.externalLinkTarget?u.NONE:f.externalLinkTarget,f.externalLinkRel=void 0===f.externalLinkRel?d:f.externalLinkRel,f.isEvalSupported=void 0===f.isEvalSupported||f.isEvalSupported;var m=f.openExternalLinksInNewWindow;delete f.openExternalLinksInNewWindow,Object.defineProperty(f,"openExternalLinksInNewWindow",{get:function(){return f.externalLinkTarget===u.BLANK},set:function(t){t&&l('PDFJS.openExternalLinksInNewWindow, please use "PDFJS.externalLinkTarget = PDFJS.LinkTarget.BLANK" instead.'),f.externalLinkTarget===u.NONE?f.externalLinkTarget=t?u.BLANK:u.NONE:h("PDFJS.externalLinkTarget is already initialized")},enumerable:!0,configurable:!0}),m&&(f.openExternalLinksInNewWindow=m);f.getDocument=i.getDocument,f.PDFDataRangeTransport=i.PDFDataRangeTransport,f.PDFWorker=i.PDFWorker,Object.defineProperty(f,"hasCanvasTypedArrays",{configurable:!0,get:function(){var t=n.hasCanvasTypedArrays();return e.shadow(f,"hasCanvasTypedArrays",t)}}),f.CustomStyle=n.CustomStyle,f.LinkTarget=u,f.addLinkAttributes=n.addLinkAttributes,f.getFilenameFromUrl=n.getFilenameFromUrl,f.isExternalLinkTargetSet=n.isExternalLinkTargetSet,f.AnnotationLayer=r.AnnotationLayer,f.renderTextLayer=o.renderTextLayer,f.Metadata=a.Metadata,f.SVGGraphics=s.SVGGraphics,f.UnsupportedManager=i._UnsupportedManager,t.globalScope=c,t.isWorker=p,t.PDFJS=c.PDFJS}(t.pdfjsDisplayGlobal={},t.pdfjsSharedUtil,t.pdfjsDisplayDOMUtils,t.pdfjsDisplayAPI,t.pdfjsDisplayAnnotationLayer,t.pdfjsDisplayTextLayer,t.pdfjsDisplayMetadata,t.pdfjsDisplaySVG)}(this)}).call(r),t.PDFJS=r.pdfjsDisplayGlobal.PDFJS,t.build=r.pdfjsDisplayAPI.build,t.version=r.pdfjsDisplayAPI.version,t.getDocument=r.pdfjsDisplayAPI.getDocument,t.PDFDataRangeTransport=r.pdfjsDisplayAPI.PDFDataRangeTransport,t.PDFWorker=r.pdfjsDisplayAPI.PDFWorker,t.renderTextLayer=r.pdfjsDisplayTextLayer.renderTextLayer,t.AnnotationLayer=r.pdfjsDisplayAnnotationLayer.AnnotationLayer,t.CustomStyle=r.pdfjsDisplayDOMUtils.CustomStyle,t.PasswordResponses=r.pdfjsSharedUtil.PasswordResponses,t.InvalidPDFException=r.pdfjsSharedUtil.InvalidPDFException,t.MissingPDFException=r.pdfjsSharedUtil.MissingPDFException,t.SVGGraphics=r.pdfjsDisplaySVG.SVGGraphics,t.UnexpectedResponseException=r.pdfjsSharedUtil.UnexpectedResponseException,t.OPS=r.pdfjsSharedUtil.OPS,t.UNSUPPORTED_FEATURES=r.pdfjsSharedUtil.UNSUPPORTED_FEATURES,t.isValidUrl=r.pdfjsDisplayDOMUtils.isValidUrl,t.createValidAbsoluteUrl=r.pdfjsSharedUtil.createValidAbsoluteUrl,t.createObjectURL=r.pdfjsSharedUtil.createObjectURL,t.removeNullCharacters=r.pdfjsSharedUtil.removeNullCharacters,t.shadow=r.pdfjsSharedUtil.shadow,t.createBlob=r.pdfjsSharedUtil.createBlob,t.getFilenameFromUrl=r.pdfjsDisplayDOMUtils.getFilenameFromUrl,t.addLinkAttributes=r.pdfjsDisplayDOMUtils.addLinkAttributes})?r.apply(e,o):r)||(t.exports=a)}()}).call(this,n(0))},,function(t,e,n){"use strict";n.r(e),function(t){var e=n(4);n(9);e.a,n(10),Object(e.a)("#container").FlipBook({pageCallback:function(t){return t>10&&(t=10*Math.random(),0==(t=Math.floor(t))&&(t=1),console.log("n",t)),{type:"image",src:"books/images/theKingIsBlack/"+(t+1)+".jpg",interactive:!1}},pages:100,controlsProps:{downloadURL:"books/pdf/FoxitPdfSdk.pdf",actions:{cmdBackward:{code:37},cmdForward:{code:39},cmdSave:{code:68,flags:1},mouseCmdRotate:{enabled:!0}}},propertiesCallback:function(t){return t.cover.color=0,t.page.depth*=2,t},template:{html:"./flip-book/templates/default-book-view.html",styles:["./flip-book/css/short-white-book-view.css"],links:[{rel:"stylesheet",href:"./flip-book/css/font-awesome.min.css"}],script:"./flip-book/js/default-book-view.js",sounds:{startFlip:"./flip-book/sounds/start-flip.mp3",endFlip:"./flip-book/sounds/end-flip.mp3"}}})}.call(this,n(1))},function(t,e,n){},function(module,exports,__webpack_require__){(function(__webpack_provided_window_dot_jQuery,__webpack_provided_window_dot_html2canvas,__webpack_provided_window_dot_THREE,__webpack_provided_window_dot_PDFJS,THREE){!function(t){var e={};function n(i){if(e[i])return e[i].exports;var r=e[i]={i:i,l:!1,exports:{}};return t[i].call(r.exports,r,r.exports,n),r.l=!0,r.exports}n.m=t,n.c=e,n.i=function(t){return t},n.d=function(t,e,i){n.o(t,e)||Object.defineProperty(t,e,{configurable:!1,enumerable:!0,get:i})},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=3)}([function(t,e,n){"use strict";e.__esModule=!0;var i=n(2);n(1),e.default=i.$},function(module,exports,__webpack_require__){"use strict";var _typeof2="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};!function(t){var e={};function n(i){if(e[i])return e[i].exports;var r=e[i]={i:i,l:!1,exports:{}};return t[i].call(r.exports,r,r.exports,n),r.l=!0,r.exports}n.m=t,n.c=e,n.i=function(t){return t},n.d=function(t,e,i){n.o(t,e)||Object.defineProperty(t,e,{configurable:!1,enumerable:!0,get:i})},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=72)}([function(t,e,n){e.__esModule=!0;var i=__webpack_provided_window_dot_jQuery,r=__webpack_provided_window_dot_html2canvas,o=__webpack_provided_window_dot_THREE,a=window.React,s=window.ReactDOM,c=__webpack_provided_window_dot_PDFJS;e.$=i,e.html2canvas=r,e.THREE=o,e.React=a,e.ReactDOM=s,e.PDFJS=c,e.tr=function(t){return(window.iberezansky||{}).tr&&window.iberezansky.tr(t)||t}},function(t,e,n){e.__esModule=!0;var i=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},r=__webpack_provided_window_dot_jQuery,o=__webpack_provided_window_dot_html2canvas,a=__webpack_provided_window_dot_THREE,s=__webpack_provided_window_dot_PDFJS;window.FB3D_LOCALE&&(window.iberezansky=i({},window.iberezansky,{tr:function(t){return(FB3D_LOCALE.dictionary||{})[t]||t}})),e.$=r,e.html2canvas=o,e.THREE=a,e.PDFJS=s,e.tr=function(t){return(window.iberezansky||{}).tr&&window.iberezansky.tr(t)||t}},function(t,e){e.__esModule=!0;var n=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}return t.sum1=function(t,e,n,i){return[t*e[0]+n*i[0]]},t.sum2=function(t,e,n,i){return[t*e[0]+n*i[0],t*e[1]+n*i[1]]},t.sum3=function(t,e,n,i){return[t*e[0]+n*i[0],t*e[1]+n*i[1],t*e[2]+n*i[2]]},t.sum4=function(t,e,n,i){return[t*e[0]+n*i[0],t*e[1]+n*i[1],t*e[2]+n*i[2],t*e[3]+n*i[3]]},t.rk4=function(e,n,i,r){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:t.sum[r.length-1],a=e(n,r),s=e(n+i/2,o(1,r,i/2,a)),c=e(n+i/2,o(1,r,i/2,s)),l=e(n+i,o(1,r,i,c));return o(1,r,i/6,o(1,o(1,a,2,s),1,o(2,c,1,l)))},t.extrapolateLinear=function(t,e,n){return e[0]+(e[1]-e[0])/(t[1]-t[0])*(n-t[0])},t.interpolateLinear=function(e,n,i){return e[0]>e[1]&&(e=e.reverse(),n=n.reverse()),i<e[0]?n[0]:i>e[1]?n[1]:t.extrapolateLinear(e,n,i)},t.calcScale=function(t,e,n,i){return Math.min(n/t,i/e)},t.mulM=function(t,e){for(var n=[],i=0;i<t.length;++i){n.push([]);for(var r=0;r<e[0].length;++r){n[i][r]=0;for(var o=0;o<e.length;++o)n[i][r]+=t[i][o]*e[o][r]}}return n},t.transM=function(t){for(var e=[],n=0;n<t.length;++n)for(var i=0;i<t[0].length;++i)e[i]||(e[i]=[]),e[i][n]=t[n][i];return e},t.mat=function(t){var e=0,n=t,i=Array.isArray(n),r=0;for(n=i?n:n[Symbol.iterator]();;){var o;if(i){if(r>=n.length)break;o=n[r++]}else{if((r=n.next()).done)break;o=r.value}e+=o}return e/t.length},t.disp=function(e){var n=t.mat(e),i=0,r=e,o=Array.isArray(r),a=0;for(r=o?r:r[Symbol.iterator]();;){var s;if(o){if(a>=r.length)break;s=r[a++]}else{if((a=r.next()).done)break;s=a.value}i+=(s-n)*(s-n)}return i/e.length},t.predict=function(e,n){var i=[],r=e.length;if(t.disp(e)<r&&r>1){for(var o=[],a=[],s=0;s<r;++s)o.push([s,1]),a.push([e[s]]);for(var c=t.transM(o),l=t.mulM(c,o),h=t.mulM(c,a),u=l[0][0]*l[1][1]-l[1][0]*l[0][1],d=[-(l[0][1]*h[1][0]-h[0][0]*l[1][1])/u,(l[0][0]*h[1][0]-l[1][0]*h[0][0])/u],p=0;p<n;++p){var f=Math.round(d[0]*(p+r)+d[1]);-1===i.indexOf(f)&&i.push(f)}}return i},t.getUnique=function(){return Math.ceil(1e9*Math.random())},t.setSplinePoints=function(t,e){t.points.length!==e.x.length&&console.warn("setSplinePoints: bad points");for(var n=0;n<t.points.length;++n)t.points[n].set(e.x[n],e.y[n],e.z?e.z[n]:0)},t.mapl2L=function(t,e,n,i){for(var r=e/(n-1),o=0,a=0,s=t[0];a<t.length-1&&o<e+.1*r;s+=t[++a])Math.abs(o-s)<Math.abs(o-s-t[a+1])&&(i(a,o),o+=r);o<e+.1*r&&console.warn("mapl2L: ls is not enought")},t.det2=function(t,e,n,i){return t*i-e*n},t.solve2Lin=function(e,n,i,r){var o=void 0,a=t.det2(e[0],e[1],i[0],i[1]);Math.abs(a)>t.eps&&(o={x:t.det2(n,e[1],r,i[1])/a,y:t.det2(e[0],n,i[0],r)/a});return o},t.isInsidePoly=function(e,n){for(var i=!1,r=void 0,o=0;o<e.length;++o)if(t.v2dist(n,e[o])<t.eps){r=1,i=!0;break}for(;!i;){i=!0,r=0;for(var a={x:n.x+Math.random()-.5,y:n.y+Math.random()-.5},s={x:a.x-n.x,y:a.y-n.y},c=[s.y,-s.x],l=n.x*s.y-n.y*s.x,h=0;h<e.length;++h){var u=e[h],d=e[(h+1)%e.length],p={x:d.x-u.x,y:d.y-u.y},f=[p.y,-p.x],m=u.x*p.y-u.y*p.x,g=t.solve2Lin(c,l,f,m);if(g){if(t.v2dist(g,u)<t.eps||t.v2dist(g,d)<t.eps){i=!1;break}if(g.x>Math.min(u.x,d.x)-t.eps&&g.x<Math.max(u.x,d.x)+t.eps&&g.y>Math.min(u.y,d.y)-t.eps&&g.y<Math.max(u.y,d.y)+t.eps){if(t.v2dist(g,n)<t.eps){r=1;break}var v={x:g.x-n.x,y:g.y-n.y};r+=v.x*s.x+v.y*s.y>0}}}}return r%2},t.isInsideConvPoly=function(t,e){for(var n=[0,0],i=0;i<t.length;++i){var r=t[i],o=t[(i+1)%t.length],a={x:r.x-e.x,y:r.y-e.y},s={x:o.x-e.x,y:o.y-e.y};++n[(a.x*s.y-a.y*s.x<0)+0]}return~n.indexOf(t.length)},t.v2len=function(t){return Math.sqrt(t.x*t.x+t.y*t.y)},t.v2dist=function(e,n){return t.v2len({x:n.x-e.x,y:n.y-e.y})},t.computeSquare=function(e){for(var n=[],i=0,r=0;r<e.length;++r)n.push(t.v2dist(e[r],e[(r+1)%e.length])),i+=.5*n[r];return Math.sqrt(i*(i-n[0])*(i-n[1])*(i-n[2]))},t.computeInterpCoefs=function(e,n){for(var i=t.computeSquare(e),r=[],o=e.length,a=0;a<o;++a)r[a]=t.computeSquare([n,e[(a+1)%o],e[(a+2)%o]])/i;return r},t}();n.sum=[n.sum1,n.sum2,n.sum3,n.sum4],n.eps=1e-4,e.default=n},function(t,e,n){e.__esModule=!0;var i,r=n(0),o=n(2),a=(i=o)&&i.__esModule?i:{default:i};function s(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function c(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==(void 0===e?"undefined":_typeof2(e))&&"function"!=typeof e?t:e}var l=function(t){function e(){return s(this,e),c(this,t.apply(this,arguments))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+(void 0===e?"undefined":_typeof2(e)));t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.splitSpline=function(t,n){for(var i={len:0,ls:[0]},r=1/n,o=0;o<=n;++o){var a=t.getPoint(o*r);if(o){var s=e.v1.distanceTo(a);i.len+=s,i.ls.push(s)}e.v1.copy(a)}return i},e.getLinearIndeces=function(t,n){for(var i=[0],r=0,o=0;o<=5e3;++o){var a=t.getPoint(2e-4*o);if(o){var s=e.v1.distanceTo(a);r+=s,i.push(s)}e.v1.copy(a)}i.push(1e7);for(var c=[],l=r/(n-1),h=0,u=0,d=i[0];h<i.length-1;d+=i[++h])Math.abs(u-d)<Math.abs(u-d-i[h+1])&&(c.push(2e-4*h),u+=l);return c},e.refinePoly=function(t,e){for(var n=[],i=0;i<t.length;++i){var o=t[i],s=t[(i+1)%t.length],c=a.default.v2dist(o,s),l=Math.ceil(c/e),h=c/l;n.push(o);for(var u=1;u<l;++u)n.push(new r.THREE.Vector2(o.x+u*h*(s.x-o.x)/c,o.y+u*h*(s.y-o.y)/c))}return n},e}(a.default);l.v1=new r.THREE.Vector3,e.default=l},function(t,e){e.__esModule=!0;var n=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}return t.normalizeUrl=function(t){function e(t){return t.replace(/\\/g,"/").split("/")}var n=e(window.location.href);return t=e(t),n[2]===t[2]&&(t[0]=n[0]),t.join("/")},t.extends=function(t,e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])},t.defaultCmp=function(t,e){return t-e},t.lowerBound=function(e,n,i){i=i||t.defaultCmp;for(var r=0,o=e.length-1;o-r>1;){var a=Math.floor((r+o)/2);i(n,e[a])<0?o=a:r=a}return i(n,e[o])>=0?o:r},t}();e.default=n},function(t,e,n){e.__esModule=!0;var i,r=n(0),o=n(7),a=(i=o)&&i.__esModule?i:{default:i};var s=function(){function t(e,n,i,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.context=e,this.wnd=e.wnd,this.doc=e.doc,this.element=e.element||e.doc.body,this.c=e.renderCanvas||t.renderCanvas,this.ctx=e.renderCanvasCtx||t.renderCanvasCtx,this.resW=this.width=n,this.resH=this.height=i,this.color=r}return t.prototype.setResolution=function(t){this.resW=t.width,this.resH=t.height},t.prototype.dispose=function(){},t.prototype.renderBlankPage=function(){this.ctx.beginPath(),this.ctx.fillStyle=a.default.color2Rgba(this.color,1),this.ctx.rect(0,0,this.c.width,this.c.height),this.ctx.fill()},t.prototype.renderImage=function(t){this.pushCtx(),this.ctx.drawImage(t,0,0),this.popCtx()},t.prototype.normToConv=function(t){return{x:t.x*this.c.width,y:(1-t.y)*this.c.height}},t.prototype.renderHit=function(t){var e=this.ctx;e.fillStyle="rgba(255,255,0,0.4)",e.beginPath();var n=this.normToConv(t[0]);e.moveTo(n.x,n.y);for(var i=1;i<t.length;++i)n=this.normToConv(t[i]),e.lineTo(n.x,n.y);e.closePath(),e.fill()},t.prototype.pushCtx=function(){return this.resW!=this.c.width&&(this.c.width=this.resW),this.resH!=this.c.height&&(this.c.height=this.resH),this.ctx.save(),this.ctx.scale(this.c.width/this.width,this.c.height/this.height),this.ctx},t.prototype.popCtx=function(){this.ctx.restore()},t.prototype.renderNotFoundPage=function(){this.renderBlankPage()},t.prototype.finishRender=function(){this.onChange&&this.onChange(this.c)},t.prototype.finishLoad=function(){this.onLoad?this.onLoad():this.startRender()},t.prototype.getSimulatedDoc=function(){},t}();s.renderCanvas=(0,r.$)("<canvas>")[0],s.renderCanvasCtx=s.renderCanvas.getContext("2d"),e.default=s},function(t,e,n){e.__esModule=!0;var i=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},r=n(0);var o=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.wnd=e,this.doc=n,this.enabled=!0}return t.prototype.setEnable=function(t){t||(this.mCapObject&&(this.notify(this.mCapObject,r.$.Event("mouseup"),"mouseup"),this.mCapObject=void 0),this.mHovObject&&(this.notify(this.mHovObject,r.$.Event("mouseout"),"mouseout"),this.mHovObject=void 0)),this.enabled=t},t.prototype.getCallback=function(t){},t.prototype.notify=function(t,e,n){var o=this.getCallback(t);if(o){var a=i({},e,{type:n,view:this.wnd});o(r.$.Event(n,a),t)}},t.prototype.convert=function(t,e){if(this.enabled){this.filter&&(t=this.filter(this.element,t));var n=this.getObject(t,e);(~t.type.indexOf("touch")?this.convertTouch(t,e,n):this.convertMouse(t,e,n))&&n&&this.notify(n,t,t.type)}},t.prototype.convertTouch=function(t,e,n){var i=!0;switch(t.type){case"touchstart":this.tCapObject&&this.notify(this.tCapObject,t,"touchend"),this.tCapObject=n;break;case"touchend":this.tCapObject&&!this.test(this.tCapObject,n)?(this.notify(this.tCapObject,t,"touchend"),i=!1):n&&this.test(this.tCapObject,n)&&this.notify(n,t,"touchtap"),this.tCapObject=void 0;break;case"touchtap":i=!1}return i},t.prototype.convertMouse=function(t,e,n){var i=!0;switch(t.type){case"mousedown":this.mCapObject&&this.notify(this.mCapObject,t,"mouseup"),this.mCapObject=n;break;case"mouseup":this.mCapObject&&!this.test(this.mCapObject,n)&&(this.notify(this.mCapObject,t,"mouseup"),i=!1);break;case"click":i=this.test(this.mCapObject,n),this.mCapObject=void 0;break;case"mouseenter":case"mouseover":case"mousemove":!this.test(this.mHovObject,n)&&this.mHovObject&&(this.notify(this.mHovObject,t,"mouseout"),this.mHovObject=void 0),!this.mHovObject&&n&&(this.notify(n,t,"mouseover"),this.mHovObject=n),i="mousemove"===t.type;break;case"mouseleave":case"mouseout":this.mHovObject&&(this.notify(this.mHovObject,t,"mouseout"),this.mHovObject=void 0),i=!1}return i},t}();e.default=o},function(t,e){e.__esModule=!0;var n=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}return t.extrapolateLinear=function(t,e,n){return e[0]+(e[1]-e[0])/(t[1]-t[0])*(n-t[0])},t.interpolate01=function(e,n,i){return t.extrapolateLinear([0,1],[e,n],i)},t.getColorBytes=function(t){return[t>>16&255,t>>8&255,255&t]},t.inverseColor=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,i=t.getColorBytes(e),r=[255-i[0],255-i[1],255-i[2]],o=[Math.round(t.interpolate01(i[0],r[0],n)),Math.round(t.interpolate01(i[1],r[1],n)),Math.round(t.interpolate01(i[2],r[2],n))];return t.bytes2Color(o)},t.color2Rgba=function(e,n){return t.bytes2Rgba(t.getColorBytes(e),n)},t.bytes2Rgba=function(t,e){return"rgba("+t.join(",")+","+e+")"},t.bytes2Color=function(t){return t[2]|t[1]<<8|t[0]<<16},t}();e.default=n},function(t,e,n){e.__esModule=!0;var i=c(n(14)),r=c(n(43)),o=c(n(59)),a=c(n(57)),s=c(n(51));function c(t){return t&&t.__esModule?t:{default:t}}var l=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.context=e,this.cache=n||new i.default}return t.prototype.build=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:210,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:297,c=arguments.length>4&&void 0!==arguments[4]?arguments[4]:16777215,l=arguments.length>5&&void 0!==arguments[5]?arguments[5]:void 0,h=void 0;switch(t.type){case"html":h=new s.default(this.context,n,i,c,t.src,this.cache,l);break;case"image":h=new o.default(this.context,n,i,c,t.src);break;case"pdf":h=new a.default(this.context,n,i,c,t.src,e);break;case"blank":default:h=new r.default(this.context,n,i,c)}return h},t}();e.default=l},function(t,e,n){e.__esModule=!0;var i,r=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},o=n(11),a=n(2),s=(i=a)&&i.__esModule?i:{default:i};var c=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.onReady=e,this.defaults=(0,o.props)()}return t.prototype.dispose=function(){},t.prototype.calcSize=function(t,e){var n=s.default.calcScale(t,e,this.defaults.width,this.defaults.height);return{width:n*t,height:n*e}},t.prototype.calcTexels=function(t,e){var n=this.defaults.sheet,i=s.default.calcScale(t,e,n.widthTexels,n.heightTexels);return{widthTexels:i*t,heightTexels:i*e}},t.prototype.calcProps=function(t,e){this.props=r({},this.defaults,this.calcSize(t,e),{sheet:r({},this.defaults.sheet,this.calcTexels(t,e)),cover:r({},this.defaults.cover),page:r({},this.defaults.page)})},t.prototype.calcSheets=function(t){return this.sheets=Math.ceil(Math.max(0,t-4)/2)},t.prototype.getSheets=function(){return this.sheets},t.prototype.getProps=function(){return this.props},t.prototype.getPageCallback=function(){return this.binds.pageCallback},t.prototype.ready=function(){this.onReady&&this.onReady(this.getProps(),this.getSheets(),this.getPageCallback())},t}();e.default=c},function(t,e,n){e.__esModule=!0;var i="function"==typeof Symbol&&"symbol"===_typeof2(Symbol.iterator)?function(t){return void 0===t?"undefined":_typeof2(t)}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":void 0===t?"undefined":_typeof2(t)},r=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},o=n(1),a=l(n(41)),s=l(n(3)),c=l(n(20));function l(t){return t&&t.__esModule?t:{default:t}}function h(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var u=function(){function t(e,n,i,s){var l=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,u=this,d=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"closed",p=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0;h(this,t),this.visual=e,this.p=r({},n,{first:i,last:s});var f=this.getProps(),m=this.loadPoints();Object.keys(m).map((function(t){u[t]=m[t][f.shape]||m[t][0]})),this.pSpline=new o.THREE.Spline([]);for(var g=0;g<this.interpolationPoints.x[0].length;++g)this.pSpline.points.push(new o.THREE.Vector3);this.iSpline=new o.THREE.Spline([]);for(var v=0;v<a.default.resX;++v)this.iSpline.points.push(new o.THREE.Vector3);if(this.aSplines=[],this.geometry=a.default.geometry.clone(),this.p.sideFaces=[{first:0,last:a.default.faces[0]},{first:a.default.faces[0],last:a.default.faces[1]}],this.sideTexture=new o.THREE.Texture,this.sideTexture.wrapT=o.THREE.RepeatWrapping,this.sideTexture.repeat.set(0,s-i),this.sideTexture.image=f.sideTexture,this.sideTexture.needsUpdate=!0,this.materials=[new o.THREE.MeshPhongMaterial,new o.THREE.MeshPhongMaterial,new o.THREE.MeshPhongMaterial({map:this.sideTexture}),new o.THREE.MeshPhongMaterial({map:this.sideTexture}),new o.THREE.MeshPhongMaterial({map:this.sideTexture}),new o.THREE.MeshPhongMaterial({map:this.sideTexture})],this.p.setTexture(this.materials[0],2*i),this.p.setTexture(this.materials[1],2*s-1),this.mesh=new o.THREE.Mesh(this.geometry,new o.THREE.MeshFaceMaterial(this.materials)),this.mesh.castShadow=!1,this.mesh.receiveShadow=!1,this.three=this.mesh,this.three.userData.self=this,this.markers=[],this.p.marker.use){var y=this.geometry.vertices.length,b=Array.apply(0,Array(y)).map((function(t,e){return e})),x=Array.isArray(b),w=0;for(b=x?b:b[Symbol.iterator]();;){var _;if(x){if(w>=b.length)break;_=b[w++]}else{if((w=b.next()).done)break;_=w.value}var S=_,E=c.default.createMarker(this.geometry.vertices[S],S<y/2?16711680:65280,this.p.marker.size);this.markers.push({marker:E,vertex:S}),this.three.add(E)}}this.corner={use:!0,height:0,maxDistance:0,points:[],OZ:new o.THREE.Vector3(0,0,1),axis:new o.THREE.Vector3},this.set(0,"closed",p,i,s),this.set(l,d,p,i,s)}return t.prototype.dispose=function(){var t=this.materials,e=Array.isArray(t),n=0;for(t=e?t:t[Symbol.iterator]();;){var i;if(e){if(n>=t.length)break;i=t[n++]}else{if((n=t.next()).done)break;i=n.value}var r=i;r.map&&(r.map=null,r.needsUpdate=!0),r.dispose()}delete this.materials,this.geometry.dispose()},t.prototype.getSize=function(){return this.p.last-this.p.first},t.prototype.getProps=function(){return r({},this.p.page,{sheets:this.p.sheets})},t.prototype.getTopCerners=function(){var t=this.angle>Math.PI/2?this.geometry.vertices.length/2:0;return[this.geometry.vertices[t],this.geometry.vertices[a.default.resX-1+t],this.geometry.vertices[(a.default.resZ-1)*a.default.resX+t],this.geometry.vertices[a.default.resZ*a.default.resX-1+t]]},t.prototype.getTopSize=function(){var t=this.getTopCerners();return{width:t[0].distanceTo(t[1]),height:t[0].distanceTo(t[2])}},t.prototype.getTopWorldRotation=function(t){return t.x=-Math.PI/2,t},t.prototype.getTopWorldPosition=function(t){var e=this.geometry.vertices.length,n=this.angle>Math.PI/2?e/2:0,i=[this.geometry.vertices[n],this.geometry.vertices[a.default.resX-1+n],this.geometry.vertices[(a.default.resZ-1)*a.default.resX+n],this.geometry.vertices[a.default.resZ*a.default.resX-1+n]];t.set(0,0,0);var r=i,o=Array.isArray(r),s=0;for(r=o?r:r[Symbol.iterator]();;){var c;if(o){if(s>=r.length)break;c=r[s++]}else{if((s=r.next()).done)break;c=s.value}var l=c;t.x+=.25*l.x,t.y+=.25*l.y,t.z+=.25*l.z}return this.three.localToWorld(t),t},t.prototype.getInterpolationPoints=function(t,e){var n={x:[],y:[]},i=this.getProps().wave,r=t,o=Array.isArray(r),a=0;for(r=o?r:r[Symbol.iterator]();;){var s;if(o){if(a>=r.length)break;s=r[a++]}else{if((a=r.next()).done)break;s=a.value}var c=s;n.x.push([].concat(this.interpolationPoints.x[c])),n.y.push(~e.indexOf(c)?this.interpolationPoints.y[c].map((function(t){return i*t})):[].concat(this.interpolationPoints.y[c]))}return n},t.prototype.set=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.state,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.corner.height,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:this.p.first,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:this.p.last,a=Math.PI;this.state=e;var s=void 0,c=void 0;"object"===(void 0===t?"undefined":i(t))?(this.angle=t.openedAngle,s=t.closedAngle,c=t.binderTurn>a/2?a-t.binderTurn:t.binderTurn):this.angle=t,this.corner.height=n,this.p.first===r&&this.p.last===o||(this.sideTexture.repeat.set(0,o-r),this.sideTexture.needsUpdate=!0,this.p.first!==r&&this.p.setTexture(this.materials[0],2*r),this.p.last!==o&&this.p.setTexture(this.materials[1],2*o-1)),this.p.first=r,this.p.last=o;var l=void 0,h=this.getProps();if("closed"===this.state)l=this.getInterpolationPoints(this.closedInterpolationIndeces,this.closedInterpolationIndeces);else if("opened"===this.state)if(void 0!==s&&Math.abs(s-a/2)>.01){l=this.getInterpolationPoints(this.flatInterpolationIndeces,[]);var u=this.getPointsAtAngle(this.getInterpolationPoints(this.closedInterpolationIndeces,this.closedInterpolationIndeces),s>a/2?a-s:s);l.x=[u.x].concat(l.x),l.y=[u.y].concat(l.y)}else l=this.getInterpolationPoints(this.openedInterpolationIndeces,this.closedInterpolationIndeces);var d=void 0,p=void 0,f=.5*h.sheets*h.depth;"closed"===this.state&&(f-=7e-6*this.p.scale),this.angle<=a/2?(d=(h.sheets-r)*h.depth,p=(h.sheets-o)*h.depth):(d=r*h.depth,p=o*h.depth);var m=this.angle>a/2?a-this.angle:this.angle,g="closed"===this.state?m:void 0===c?a/2:c,v=this.getPointsAtAngleAndHs(l,m,g,[d/h.width,p/h.width]),y=v[0],b=v[1];this.angle>a/2&&(this.inverse(y),this.inverse(b),f=-f),this.setPoints(y,b,f)},t.prototype.setPoints=function(t,e,n){for(var i=this,r=this.getProps(),s=0,c=[e,t],l=0;l<a.default.resY;++l)for(var h=0;h<a.default.resZ;++h)for(var u=0;u<a.default.resX;++u)this.geometry.vertices[s++].set(c[l].x[u]*r.width+n,c[l].y[u]*r.width,h*r.height/(a.default.resZ-1)-.5*r.height);if(s!==this.geometry.vertices.length&&console.warn("setPoints: bad mapping!"),this.corner.use&&!this.corner.points.length){var d=new o.THREE.Plane,p=d.normal,f=(1-this.getProps().flexibleCorner)*Math.min(r.width,r.height),m=new o.THREE.Vector3;d.setFromNormalAndCoplanarPoint(new o.THREE.Vector3(-1,0,-1).normalize(),new o.THREE.Vector3(f+n,0,.5*r.height));for(var g=0,v=this.geometry.vertices.length;g<v;++g)if(d.projectPoint(this.geometry.vertices[g],m),m.sub(this.geometry.vertices[g]),m.x*p.x+m.y*p.y+m.z*p.z>0){var y=m.length()/f;this.corner.maxDistance=Math.max(this.corner.maxDistance,y),this.corner.points.push({vertex:g,distance:y})}}if(this.corner.use&&Math.abs(this.corner.height)>.001){var b=function(t){return r.cornerDeviation*i.corner.height/(1+Math.exp(-r.bending*(t-.5*i.corner.maxDistance)))};this.corner.axis.set(-1,0,1).normalize(),this.corner.axis.applyAxisAngle(this.corner.OZ,this.angle);var x=this.corner.points,w=Array.isArray(x),_=0;for(x=w?x:x[Symbol.iterator]();;){var S;if(w){if(_>=x.length)break;S=x[_++]}else{if((_=x.next()).done)break;S=_.value}var E=S;this.geometry.vertices[E.vertex].applyAxisAngle(this.corner.axis,b(E.distance))}}var A=this.markers,T=Array.isArray(A),M=0;for(A=T?A:A[Symbol.iterator]();;){var C;if(T){if(M>=A.length)break;C=A[M++]}else{if((M=A.next()).done)break;C=M.value}var P=C;P.marker.position.copy(this.geometry.vertices[P.vertex])}this.geometry.computeVertexNormals(),this.geometry.computeBoundingSphere(),this.geometry.verticesNeedUpdate=!0,this.markup&&this.markup.computeVertices()},t.prototype.inverse=function(t){for(var e=0;e<t.x.length;++e)t.x[e]=-t.x[e];return t},t.prototype.getPointsAtHs=function(t,e,n){var i=this,o=1e3;s.default.setSplinePoints(this.pSpline,t);var c=s.default.splitSpline(this.pSpline,o),l=[],h=r({},this.pSpline.getPoint(.999)),u=r({},this.pSpline.getPoint(1)),d={x:u.x-h.x,y:u.y-h.y},p=Math.sqrt(d.x*d.x+d.y*d.y),f=this.pSpline.points[this.pSpline.points.length-1];f.set(f.x+.1*d.x/p,f.y+.1*d.y/p,0),(c=s.default.splitSpline(this.pSpline,o)).ls.push(1e7),s.default.mapl2L(c.ls,c.len,a.default.resX,(function(t){for(var a=0;a<n.length;++a)if(t){var s=r({},i.pSpline.getPoint((t-1)/o)),c=i.pSpline.getPoint(t/o),h=-(c.y-s.y),u=c.x-s.x,d=Math.sqrt(h*h+u*u);l[a].x.push(c.x+h/d*n[a]),l[a].y.push(c.y+u/d*n[a])}else l[a]={x:[-n[a]*Math.sin(e)],y:[n[a]*Math.cos(e)]}}));for(var m=[],g=function(t){m[t]={x:[],y:[]},s.default.setSplinePoints(i.iSpline,l[t]);var e=s.default.splitSpline(i.iSpline,o);e.ls.push(1e7),s.default.mapl2L(e.ls,1,a.default.resX,(function(e){var n=i.iSpline.getPoint(e/o);m[t].x.push(n.x),m[t].y.push(n.y)}))},v=0;v<n.length;++v)g(v);return m},t.prototype.getPointsAtAngleAndHs=function(t,e,n,i){var r=this.getPointsAtAngle(t,e);return this.getPointsAtHs(r,n,i)},t.prototype.getPointsAtAngle=function(t,e){var n={x:[],y:[]},i=[];e/=Math.PI/2;for(var r=0;r<t.x.length;++r)i.push(r/(t.x.length-1));for(var o=0;o<t.x[0].length;++o){for(var a=[],s=[],c=0;c<t.x.length;++c)a.push(t.x[c][o]),s.push(t.y[c][o]);n.x.push(this.interpolate(i,a,e)),n.y.push(this.interpolate(i,s,e))}return n},t.prototype.interpolate=function(t,e,n){if(!this.aSplines[t.length]){this.aSplines[t.length]=new o.THREE.Spline([]);for(var i=this.aSplines[t.length].points,r=0;r<t.length;++r)i.push(new o.THREE.Vector3)}for(var a=this.aSplines[t.length],s=0;s<t.length;++s)a.points[s].set(t[s],e[s],0);return a.getPoint(Math.min(1,Math.max(n,0))).y},t.prototype.loadPoints=function(){for(var t=[],e=[],n=[0,.2877,.6347,.8174,1],i=0;i<n.length;i++){var r=n[i];t.push(r*Math.cos(.9*Math.PI/4)),e.push(r*Math.sin(.9*Math.PI/4))}return{interpolationPoints:[{x:[[0,.2877,.6347,.8174,1],[0,.286,.632,.815,.997],[0,.279,.623,.806,.988],[0,.126,.411,.593,.774],[0,0,0,0,0],t],y:[[0,0,0,0,0],[0,.03,.01,.002,0],[0,.06,.017,.004,0],[0,.259,.44,.446,.429],[0,.2877,.6347,.8174,1],e]},{x:[[0,.2877,.6347,.8174,1],[0,.286,.632,.815,.997],[0,.279,.623,.806,.988],[0,.233,.563,.746,.927],[0,.144,.433,.613,.796],[0,.07,.288,.455,.626],[0,0,0,0,0],t],y:[[0,0,0,0,0],[0,.03,.01,.002,0],[0,.06,.017,.004,0],[0,.168,.269,.27,.255],[0,.245,.435,.458,.46],[0,.278,.544,.614,.673],[0,.2877,.6347,.8174,1],e]}],openedInterpolationIndeces:[[2,3,4],[2,3,4,5,6]],closedInterpolationIndeces:[[0,1,2],[0,1,2]],flatInterpolationIndeces:[[5,4],[7,6]]}},t}();e.default=u},function(t,e){e.__esModule=!0,e.props=function(){return{height:.297,width:.21,gravity:1,cachedPages:50,renderInactivePages:!0,renderInactivePagesOnMobile:!1,renderWhileFlipping:!1,pagesForPredicting:5,preloadPages:5,rtl:!1,sheet:{startVelocity:.9,cornerDeviation:.25,flexibility:10,flexibleCorner:.5,bending:11,wave:.5,shape:0,widthTexels:1050,heightTexels:1485,color:16777215},cover:{binderTexture:"",depth:3e-4,padding:0,mass:.003},page:{depth:1e-4,mass:.001},cssLayerProps:{width:1024}}}},function(t,e,n){e.__esModule=!0,e.CSS3DSprite=e.CSS3DObject=void 0;var i=n(0);function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==(void 0===e?"undefined":_typeof2(e))&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+(void 0===e?"undefined":_typeof2(e)));t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}i.THREE.CSS3DObject=function(t){function e(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0;r(this,e);var i=o(this,t.call(this));return n&&i.set(n),i}return a(e,t),e.prototype.set=function(t){this.element=t,this.element.style.position="absolute",this.addEventListener("removed",(function(){null!==this.element.parentNode&&this.element.parentNode.removeChild(this.element)}))},e}(i.THREE.Object3D),i.THREE.CSS3DSprite=function(t){function e(n){return r(this,e),o(this,t.call(this,n))}return a(e,t),e}(i.THREE.CSS3DObject),i.THREE.CSS3DRenderer=function t(){var e,n,o,a;r(this,t);var s=new i.THREE.Matrix4,c={camera:{fov:0,style:""},objects:{}},l=document.createElement("div");l.style.overflow="hidden",this.domElement=l;var h=document.createElement("div");h.style.WebkitTransformStyle="preserve-3d",h.style.MozTransformStyle="preserve-3d",h.style.transformStyle="preserve-3d",l.appendChild(h);var u=/Trident/i.test(navigator.userAgent);function d(t){return Math.abs(t)<1e-10?0:t}function p(t,e){var n=t.elements,i="matrix3d("+d(n[0])+","+d(n[1])+","+d(n[2])+","+d(n[3])+","+d(-n[4])+","+d(-n[5])+","+d(-n[6])+","+d(-n[7])+","+d(n[8])+","+d(n[9])+","+d(n[10])+","+d(n[11])+","+d(n[12])+","+d(n[13])+","+d(n[14])+","+d(n[15])+")";return u?"translate(-50%,-50%)translate("+o+"px,"+a+"px)"+e+i:"translate(-50%,-50%)"+i}this.setClearColor=function(){},this.getSize=function(){return{width:e,height:n}},this.setSize=function(t,i){o=(e=t)/2,a=(n=i)/2,l.style.width=t+"px",l.style.height=i+"px",h.style.width=t+"px",h.style.height=i+"px"};var f,m,g=(f=new i.THREE.Vector3,m=new i.THREE.Vector3,function(t,e){return f.setFromMatrixPosition(t.matrixWorld),m.setFromMatrixPosition(e.matrixWorld),f.distanceToSquared(m)});this.render=function(t,e){var n=e.projectionMatrix.elements[5]*a;c.camera.fov!==n&&(l.style.WebkitPerspective=n+"px",l.style.MozPerspective=n+"px",l.style.perspective=n+"px",c.camera.fov=n),t.updateMatrixWorld(),null===e.parent&&e.updateMatrixWorld();var r="translateZ("+n+"px)"+function(t){var e=t.elements;return"matrix3d("+d(e[0])+","+d(-e[1])+","+d(e[2])+","+d(e[3])+","+d(e[4])+","+d(-e[5])+","+d(e[6])+","+d(e[7])+","+d(e[8])+","+d(-e[9])+","+d(e[10])+","+d(e[11])+","+d(e[12])+","+d(-e[13])+","+d(e[14])+","+d(e[15])+")"}(e.matrixWorldInverse),f=r+"translate("+o+"px,"+a+"px)";c.camera.style===f||u||(h.style.WebkitTransform=f,h.style.MozTransform=f,h.style.transform=f,c.camera.style=f),function t(e,n,r){if(e instanceof i.THREE.CSS3DObject){var o;e instanceof i.THREE.CSS3DSprite?(s.copy(n.matrixWorldInverse),s.transpose(),s.copyPosition(e.matrixWorld),s.scale(e.scale),s.elements[3]=0,s.elements[7]=0,s.elements[11]=0,s.elements[15]=1,o=p(s,r)):o=p(e.matrixWorld,r);var a=e.element,l=c.objects[e.id]&&c.objects[e.id].style;void 0!==l&&l===o||(a.style.WebkitTransform=o,a.style.MozTransform=o,a.style.transform=o,c.objects[e.id]={style:o},u&&(c.objects[e.id].distanceToCameraSquared=g(n,e))),a.parentNode!==h&&h.appendChild(a)}for(var d=0,f=e.children.length;d<f;d++)t(e.children[d],n,r)}(t,e,r),u&&function(t){var e=Object.keys(c.objects).sort((function(t,e){return c.objects[t].distanceToCameraSquared-c.objects[e].distanceToCameraSquared})),n=e.length;t.traverse((function(t){var i=e.indexOf(t.id+"");-1!==i&&(t.element.style.zIndex=n-i)}))}(t)}},e.default=i.THREE.CSS3DRenderer;var s=i.THREE.CSS3DObject,c=i.THREE.CSS3DSprite;e.CSS3DObject=s,e.CSS3DSprite=c},function(module,exports,__webpack_require__){exports.__esModule=!0;var _libs=__webpack_require__(0),_CSS3DRenderer=__webpack_require__(12);function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==(void 0===e?"undefined":_typeof2(e))&&"function"!=typeof e?t:e}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+(void 0===e?"undefined":_typeof2(e)));t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var CSSLayer=function(_CSS3DObject){function CSSLayer(t,e,n){_classCallCheck(this,CSSLayer);var i=_possibleConstructorReturn(this,_CSS3DObject.call(this));i.props=n,i.jContainer=(0,_libs.$)('<div class="hidden css-layer"></div>');var r=n.width,o=e/t*r;return i.jContainer.width(r).height(o),i.scale.x/=r/t,i.scale.y/=r/t,i.setData(),i.set(i.jContainer[0]),i}return _inherits(CSSLayer,_CSS3DObject),CSSLayer.init=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:150;CSSLayer.delay=e,CSSLayer.style=(0,_libs.$)("<style type=text/css>\n      .css-layer {\n    \t\topacity: 1;\n    \t\ttransition: opacity "+e+"ms ease-out;\n        visibility: visible;\n        overflow: hidden;\n    \t}\n    \t.css-layer.hidden {\n    \t\ttransition: opacity "+e+"ms ease-in, visibility "+e+"ms step-end;\n    \t\topacity: 0;\n        visibility: hidden;\n      }\n    </style>").appendTo(t.head)},CSSLayer.dispose=function(){CSSLayer.style.remove()},CSSLayer.prototype.callInternal=function(t){if(this.object&&this.object[t])try{this.object[t]()}catch(t){console.error(t)}},CSSLayer.prototype.dispose=function(){this.clearInternals()},CSSLayer.prototype.clearInternals=function(){this.callInternal("dispose"),!this.css||this.css.remove(),!this.html||this.html.remove()},CSSLayer.prototype.setData=function setData(){var css=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",html=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",js=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";this.clearInternals(),this.css=(0,_libs.$)('<style type="text/css">'+css+"</style>").appendTo(this.jContainer),this.html=(0,_libs.$)(html).appendTo(this.jContainer);var init=eval(js);init&&(this.object=init(this.jContainer,this.props)||{})},CSSLayer.prototype.pendedCall=function(t){var e=this,n=this.timestamp=Date.now();setTimeout((function(){n===e.timestamp&&t()}),CSSLayer.delay)},CSSLayer.prototype.isHidden=function(){return this.jContainer.hasClass("hidden")},CSSLayer.prototype.hide=function(){var t=this,e=void 0;return this.isHidden()?e=Promise.resolve():(this.jContainer.addClass("hidden"),this.callInternal("hide"),e=new Promise((function(e){t.pendedCall((function(){t.callInternal("hidden"),e()}))}))),e},CSSLayer.prototype.show=function(){var t=this,e=void 0;return this.isHidden()?(this.jContainer.removeClass("hidden"),this.callInternal("show"),e=new Promise((function(e){t.pendedCall((function(){t.callInternal("shown"),e()}))}))):e=Promise.resolve(),e},CSSLayer}(_CSS3DRenderer.CSS3DObject);exports.default=CSSLayer},function(t,e){function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}e.__esModule=!0;var i=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1/0,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t.countSizeof;n(this,t),this.os=new Map,this.sizeof=i,this.maxSize=e,this.size=0}return t.prototype.forEach=function(t){this.os.forEach((function(e,n){return t([n,e])}))},t.countSizeof=function(t){return 1},t.prototype.remove=function(t){var e=!1,n=this.os.get(t);return n.locked&&n.locked(t)||(this.size-=this.sizeof(n),n.dispose&&n.dispose(),this.os.delete(t),e=!0),e},t.prototype.freeSpace=function(){var t=[],e=this.os,n=Array.isArray(e),i=0;for(e=n?e:e[Symbol.iterator]();;){var r;if(n){if(i>=e.length)break;r=e[i++]}else{if((i=e.next()).done)break;r=i.value}var o=r;t.push({timestamp:o[1].timestamp,key:o[0]})}t.sort((function(t,e){return t.timestamp-e.timestamp}));for(var a=0;a<t.length&&this.size>3*this.maxSize/4;++a)this.remove(t[a].key)},t.prototype.dispose=function(){var t=[],e=this.os,n=Array.isArray(e),i=0;for(e=n?e:e[Symbol.iterator]();;){var r;if(n){if(i>=e.length)break;r=e[i++]}else{if((i=e.next()).done)break;r=i.value}var o=r;t.push({v:o[1],k:o[0]})}var a=t,s=Array.isArray(a),c=0;for(a=s?a:a[Symbol.iterator]();;){var l;if(s){if(c>=a.length)break;l=a[c++]}else{if((c=a.next()).done)break;l=c.value}var h=l;h.v.dispose&&h.v.dispose(),this.os.delete(h.k)}},t.recursionSizeof=function(e){var n=0;if(e){++n;var i=e.length;if(void 0===i)for(var r in e)e.hasOwnProperty(r)&&(n+=t.recursionSizeof(e[r]));else n+=i}return n},t.prototype.getTimestamp=function(){return Date.now()},t.prototype.get=function(t){var e=this.os.get(t);return e&&(e.timestamp=this.getTimestamp()),e},t.prototype.put=function(t,e){return e.timestamp=this.getTimestamp(),this.os.set(t,e),this.size+=this.sizeof(e),this.size>this.maxSize&&this.freeSpace(),e},t}();e.default=i},function(t,e,n){function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==(void 0===e?"undefined":_typeof2(e))&&"function"!=typeof e?t:e}e.__esModule=!0;var o=function(t){function e(){return i(this,e),r(this,t.apply(this,arguments))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+(void 0===e?"undefined":_typeof2(e)));t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.handleDefault=function(t,e,n){},e.prototype.dispatchAsync=function(t){var e=this;Promise.resolve().then((function(){return e.dispatchEvent(t)}))},e.prototype.dispose=function(){},e}(n(0).THREE.EventDispatcher);e.default=o},function(t,e,n){e.__esModule=!0;var i,r=n(6);function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==(void 0===e?"undefined":_typeof2(e))&&"function"!=typeof e?t:e}var s=function(t){function e(n,i){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){return!1},s=arguments[3];o(this,e);var c=a(this,t.call(this,n,i));return c.eDoc=s,c.customTest=r,c.customs=[],c}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+(void 0===e?"undefined":_typeof2(e)));t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.test=function(t,e){return!(!t||!e)&&this.customTest(t,e)},e.prototype.getCallback=function(t){return t.target.callback},e.prototype.addCustom=function(t){this.customs.push(t)},e.prototype.getObject=function(t,e){var n=void 0;if(e.doc===this.eDoc){var i=this.customs,r=Array.isArray(i),o=0;for(i=r?i:i[Symbol.iterator]();;){var a;if(r){if(o>=i.length)break;a=i[o++]}else{if((o=i.next()).done)break;a=o.value}if(n=a.testIntersection(t,e))break}}return n},e}(((i=r)&&i.__esModule?i:{default:i}).default);e.default=s},function(t,e,n){e.__esModule=!0;var i,r=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},o=n(4),a=(i=o)&&i.__esModule?i:{default:i};var s=function(){function t(e,n,i){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.props=r({},t.defaults,i),this.strs=e;this.merge(e);this.hits=[],this.contexts=[],this.pattern=n.toLowerCase(),this.lstr=this.str.toLowerCase();for(var o=0;-1!==(o=this.lstr.indexOf(this.pattern,o));)this.addHits(o),this.addContext(o),o+=this.pattern.length}return t.isDelimetr=function(e){return e===t.DELIMITER},t.prototype.merge=function(){for(var e=[],n=[],i=this.strs,r=0,o=0;o<i.length;++o)i[o].length&&(n.push({base:o,offset:r}),e.push(i[o]),r+=i[o].length,o<i.length-1&&!t.isDelimetr(i[o].charAt(i[o].length-1))&&!t.isDelimetr(i[o+1].charAt(0))&&(e.push(t.DELIMITER),++r));this.map=n,this.str=e.join("")},t.prototype.addHits=function(e){var n=this.map[a.default.lowerBound(this.map,{offset:e},(function(t,e){return t.offset-e.offset}))],i=this.pattern.length,r=n.base;for(e-=n.offset;i;)if(this.strs[r].length){var o=r<this.strs.length-1&&!t.isDelimetr(this.strs[r].charAt(this.strs[r].length-1))&&!t.isDelimetr(this.strs[r+1].charAt(0)),s=Math.min(this.strs[r].length+(o?1:0)-e,i);e<this.strs[r].length&&this.hits.push({index:r,offset:e,length:Math.min(s,this.strs[r].length-e)}),i-=s,++r,e=0}},t.prototype.addContext=function(e){for(var n=e,i=e+this.pattern.length-1,r=this.props.contextLength,o=r+1;r&&o-r;)if(o=r,r%2){for(var a=n-2;a>=0;--a)if(t.isDelimetr(this.str[a])||0===a){n=0===a?0:a+1,--r;break}}else for(var s=i+2;s<this.str.length;++s)if(t.isDelimetr(this.str[s])||s===this.str.length-1){i=s===this.str.length-1?s===this.str.length-1:s-1,--r;break}this.contexts.push(this.str.substr(n,i-n+1))},t.prototype.getHits=function(){return this.hits},t.prototype.getContexts=function(){return this.contexts},t}();s.DELIMITER=" ",s.defaults={contextLength:7,hits:!0,contexts:!0},e.default=s},function(t,e,n){e.__esModule=!0;var i,r=n(0),o=n(4),a=(i=o)&&i.__esModule?i:{default:i};r.PDFJS.workerSrc=(window.PDFJS_LOCALE?PDFJS_LOCALE:{pdfJsWorker:"js/pdf.worker.js",pdfJsCMapUrl:"cmaps/"}).pdfJsWorker,r.PDFJS.cMapUrl=(window.PDFJS_LOCALE?PDFJS_LOCALE:{pdfJsWorker:"js/pdf.worker.js",pdfJsCMapUrl:"cmaps/"}).pdfJsCMapUrl,r.PDFJS.cMapPacked=!0;var s=function(){function t(e,n){var i=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.src=a.default.normalizeUrl(e),this.handlerQueue=[],this.progresData={loaded:-1,total:1},this.loadingProgress=n,r.PDFJS.getDocument({url:this.src,rangeChunkSize:524288},null,null,(function(t){if(i.loadingProgress){var e=Math.floor(100*t.loaded/t.total);e!==Math.floor(100*i.progresData.loaded/i.progresData.total)&&(e=(e=isNaN(e)?0:e)>100?100:e,i.loadingProgress(e))}i.progresData=t})).then((function(t){t.numPages>1?Promise.all([t.getPage(1),t.getPage(2)]).then((function(e){i.init(t,e)})):i.init(t)}))}return t.prototype.init=function(e,n){this.handler=e,this.doubledPages=!!n&&Math.abs(2*t.getPageSize(n[0]).width-t.getPageSize(n[1]).width)/t.getPageSize(n[0]).width<1e-4;var i=Promise.resolve(e),r=function(){if(a){if(s>=o.length)return"break";c=o[s++]}else{if((s=o.next()).done)return"break";c=s.value}var t=c;i=i.then((function(e){return t(e),e}))},o=this.handlerQueue.reverse(),a=Array.isArray(o),s=0;for(o=a?o:o[Symbol.iterator]();;){var c;if("break"===r())break}},t.prototype.getPageType=function(t){return this.doubledPages&&0!==t&&t!==this.getPagesNum()-1?1&t?"left":"right":"full"},t.prototype.getPage=function(t){return this.handler.getPage(this.doubledPages?Math.ceil(t/2)+1:t+1)},t.prototype.dispose=function(){this.handlerQueue.splice(0,this.handlerQueue.length),delete this.handler},t.prototype.setLoadingProgressClb=function(t){this.loadingProgress=t},t.prototype.getPagesNum=function(){return this.handler?this.doubledPages?2*(this.handler.numPages-1):this.handler.numPages:void 0},t.getPageSize=function(t){return{width:t.view[2]-t.view[0],height:t.view[3]-t.view[1]}},t.prototype.getHandler=function(t){this.handler?t(this.handler):this.handlerQueue.push(t)},t}();e.default=s},function(t,e,n){e.__esModule=!0;var i=n(0);function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var o=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t.objectsAndFacesTest;r(this,t),this.visual=e,this.coords=new i.THREE.Vector2,this.raycaster=this.visual.raycaster,this.camera=this.visual.camera,this.threes=[],this.test=n}return t.objectsTest=function(t,e){return!(!t||!e)&&t.object===e.object},t.objectsAndFacesTest=function(t,e){return!(!t||!e)&&(t.object===e.object&&t.face.materialIndex===e.face.materialIndex)},t.prototype.addThree=function(t){this.threes.push(t)},t.prototype.removeThree=function(t){var e=this.threes.indexOf(t);~e&&this.threes.splice(e,1)},t.prototype.getObject=function(t){return this.setCoordsFromEvent(t),this.raycaster.setFromCamera(this.coords,this.camera),this.raycaster.intersectObjects(this.threes)[0]},t}();e.default=o},function(t,e,n){e.__esModule=!0;var i,r=n(2),o=(i=r)&&i.__esModule?i:{default:i};var a=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}return t.vertices2UVs=function(t,e,n,i,r){for(var o=[],a=n;a<i;++a)for(var s=[e[a].a,e[a].b,e[a].c],c=0;c<s.length;++c)o[s[c]]||(o[s[c]]=r(t[s[c]]));return o},t.computeFaceVertexUvs=function(e,n){for(var i=[t.vertices2UVs(e.vertices,e.faces,0,n[0],(function(t){return new THREE.Vector2(t.x,1-t.z)})),t.vertices2UVs(e.vertices,e.faces,n[0],n[1],(function(t){return new THREE.Vector2(1-t.x,1-t.z)})),t.vertices2UVs(e.vertices,e.faces,n[1],n[2],(function(t){return new THREE.Vector2(t.x,t.y)})),t.vertices2UVs(e.vertices,e.faces,n[2],n[3],(function(t){return new THREE.Vector2(1-t.x,t.y)})),t.vertices2UVs(e.vertices,e.faces,n[3],n[4],(function(t){return new THREE.Vector2(t.z,t.y)})),t.vertices2UVs(e.vertices,e.faces,n[4],e.faces.length,(function(t){return new THREE.Vector2(1-t.z,t.y)}))],r=0,o=0;o<e.faces.length;++o){r+=n[r]===o;var a=e.faces[o];a.materialIndex=r,e.faceVertexUvs[0][o]=[i[r][a.a],i[r][a.b],i[r][a.c]]}},t.createMarker=function(t,e,n){var i=new THREE.Mesh(new THREE.SphereGeometry(n),new THREE.MeshPhongMaterial({color:e}));return i.position.set(t.x,t.y,t.z),i},t.findUvTris=function(t,e,n,i){var r=[],a=e,s=Array.isArray(a),c=0;for(a=s?a:a[Symbol.iterator]();;){var l;if(s){if(c>=a.length)break;l=a[c++]}else{if((c=a.next()).done)break;l=c.value}for(var h=l,u=!1,d=n;d<i&&!u;++d){var p=t.faceVertexUvs[0][d];o.default.isInsideConvPoly(p,h)&&(r.push({coefs:o.default.computeInterpCoefs(p,h),i:d}),u=!0)}u||(console.error("Bad point"),r.push(void 0))}return r},t.findInternalVertices=function(t,e,n,i){for(var r={},a=n;a<i;++a)for(var s=t.faceVertexUvs[0][a],c=t.faces[a],l=[c.a,c.b,c.c],h=0;h<s.length;++h)void 0===r[l[h]]&&o.default.isInsidePoly(e,s[h])&&(r[l[h]]={p:s[h],i:l[h],n:c.vertexNormals[h]});return Object.values(r)},t}();e.default=a},function(t,e){e.__esModule=!0;var n=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}return t.test=function(t,e){return t.target===e.target},t}();e.default=n},function(t,e,n){var i=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},r=n(1),o=w(n(45)),a=w(n(66)),s=w(n(35)),c=w(n(26)),l=w(n(29)),h=w(n(27)),u=w(n(34)),d=w(n(30)),p=w(n(53)),f=w(n(58)),m=w(n(44)),g=w(n(63)),v=w(n(40)),y=w(n(28)),b=w(n(24)),x=w(n(39));function w(t){return t&&t.__esModule?t:{default:t}}r.$.fn.FlipBook=function(t){var e={dispose:function(){this.ready?(!e.pdfLinksHandler||e.pdfLinksHandler.dispose(),delete e.pdfLinksHandler,e.sounds.dispose(),delete e.sounds,e.tocCtrl.dispose(),delete e.tocCtrl,e.thumbnails.dispose(),delete e.thumbnails,!e.bookmarks||e.bookmarks.dispose(),delete e.bookmarks,e.ctrl.dispose(),delete e.ctrl,e.bookPrinter.dispose(),delete e.bookPrinter,e.book.dispose(),delete e.book,e.propsBuilder.dispose(),delete e.propsBuilder,delete e.bookBuilder,e.visual.dispose(),delete e.visual,e.view.dispose(),delete e.view,delete e.dispose):this.pendingDispose=!0}};return t=i({},t),e.view=new l.default(this.length?this[0]:(0,r.$)("<div>").appendTo("body"),(function(){o.default.webgl?(e.loadingCtrl=new p.default(e.view,!0,(function(t){return 0===t?(0,r.tr)("Please wait... the Application is Loading"):(0,r.tr)("PDF is Loading:")+" "+t+"%"})),e.visual=new a.default(e.view.getContainer().ownerDocument.defaultView,e.view.getContainer().ownerDocument,e.view.getView()),e.bookBuilder=function(n,o,a){n.cssLayerProps=i({},n.cssLayerProps,{scene:e}),t.propertiesCallback&&(n=t.propertiesCallback(n)),e.book=new c.default(e.visual,o,a,n),e.bookPrinter=new y.default(e.visual,e.book,(t.template||{}).printStyle),e.loadingCtrl.dispose(),delete e.loadingCtrl,e.ctrl=new h.default(e.book,e.view,t.controlsProps),e.book.setInjector((function(t){t.jQuery=t.$=r.$,t.book=e.book,t.bookCtrl=e.ctrl,n.injector&&n.injector(t)})),e.view.addHandler(e.ctrl),e.ctrl.setPrinter(e.bookPrinter);var l=a(0);e.search=new f.default(e.view.getSearchView(),e.book.getPages()),e.search.onQuery=e.book.setQuery.bind(e.book),e.book.addEventListener("searchResults",(function(t){e.search.setResults(t.results,t.lastPage)})),e.thumbnails=new g.default(e.visual,e.view.getThumbnailsView(),a,2*(o+2),{kWtoH:n.width/n.height}),e.tocCtrl=new v.default(e.view,e.ctrl),e.tocCtrl.setThumbnails(e.thumbnails),e.tocCtrl.setSearch(e.search),e.ctrl.setTocCtrl(e.tocCtrl),e.view.addHandler(e.tocCtrl),"pdf"===l.type&&(e.pdfLinksHandler=new s.default(l.src,e.ctrl,e.visual.element),e.book.addEventListener("pdfAnnotation",e.pdfLinksHandler.handleEvent.bind(e.pdfLinksHandler)),l.src.getHandler((function(t){t.getOutline().then((function(t){e.bookmarks=new m.default(e.view.getBookmarksView(),t),e.tocCtrl.setBookmarks(e.bookmarks,l.src)}))})),t.pdfLinks&&t.pdfLinks.handler&&e.pdfLinksHandler.setHandler(t.pdfLinks.handler)),e.sounds=new x.default(t.template),e.ctrl.setSounds(e.sounds),e.sounds.subscribeFlips(e.ctrl),e.ready=!0,new b.default(e.visual,e.ctrl,t.autoNavigation).dispose(),t.ready&&t.ready(e),e.pendingDispose&&e.dispose()},t.pdf?(e.propsBuilder=new u.default(t.pdf,e.bookBuilder),e.propsBuilder.pdf.setLoadingProgressClb(e.loadingCtrl.setProgress.bind(e.loadingCtrl))):t.pageCallback?e.propsBuilder=new d.default(e.visual,t.pageCallback,t.pages,e.bookBuilder):e.propsBuilder=new d.default(e.visual,c.default.pageCallback,6,e.bookBuilder)):o.default.addGetWebGLMessage({parent:e.view.getView()})}),t.template),e},(0,r.$)((function(){for(var t=(0,r.$)(".flip-book-container"),e=0;e<t.length;++e){var n=(0,r.$)(t[e]),i=n.attr("src");i&&n.FlipBook({pdf:i})}})),__webpack_provided_window_dot_jQuery=window.$=r.$},function(t,e){Array.prototype.fill||(Array.prototype.fill=function(t){if(null==this)throw new TypeError("this is null or not defined");for(var e=Object(this),n=e.length>>>0,i=arguments[1],r=i>>0,o=r<0?Math.max(n+r,0):Math.min(r,n),a=arguments[2],s=void 0===a?n:a>>0,c=s<0?Math.max(n+s,0):Math.min(s,n);o<c;)e[o]=t,o++;return e}),Array.prototype.find||Object.defineProperty(Array.prototype,"find",{value:function(t){if(null==this)throw new TypeError("Array.prototype.find called on null or undefined");if("function"!=typeof t)throw new TypeError("predicate must be a function");for(var e,n=Object(this),i=n.length>>>0,r=arguments[1],o=0;o<i;o++)if(e=n[o],t.call(r,e,o,n))return e}}),Array.prototype.findIndex||(Array.prototype.findIndex=function(t){if(null==this)throw new TypeError("Array.prototype.findIndex called on null or undefined");if("function"!=typeof t)throw new TypeError("predicate must be a function");for(var e,n=Object(this),i=n.length>>>0,r=arguments[1],o=0;o<i;o++)if(e=n[o],t.call(r,e,o,n))return o;return-1}),Object.values||(Object.values=function(t){return Object.keys(t).map((function(e){return t[e]}))||[]})},function(t,e){e.__esModule=!0;var n=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t};function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var r=function(){function t(e,r){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};i(this,t),o=n({},o,{urlParam:o.urlParam||"fb3d-page",navigates:void 0===o.navigates?1:o.navigates}),this.props=o,this.context=e,this.bookCtrl=r,this.urlParam=o.urlParam,this.wnd=e.wnd,this.wnd.fb3d=n({},this.wnd.fb3d),this.wnd.fb3d.navigator=n({},this.wnd.fb3d.navigator),this.navigator=this.wnd.fb3d.navigator[this.urlParam]=n({},this.wnd.fb3d.navigator[this.urlParam]),this.navigator.instances=(this.navigator.instances||0)+1,this.navigator.instances<=this.props.navigates&&this.bookCtrl.goToPage(this.getPageNumber())}return t.prototype.dispose=function(){},t.prototype.getParameterByName=function(t,e){e||(e=window.location.href),t=t.replace(/[\[\]]/g,"\\$&");var n=new RegExp("[?&]"+t+"(=([^]*)|&|#|$)").exec(e);return n?n[2]?decodeURIComponent(n[2].replace(/\+/g," ")):"":null},t.prototype.getPageNumber=function(){var t=this.getParameterByName(this.urlParam);return t=parseInt(t),isNaN(t)&&(t=1),t-1},t}();e.default=r},function(t,e,n){e.__esModule=!0;var i,r=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},o=n(1),a=n(3),s=(i=a)&&i.__esModule?i:{default:i};var c=function(){function t(e,n){var i=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.visual=e,this.p=r({},n,{backSize:2*n.cover.depth+n.sheets*n.page.depth}),this.OZ=new o.THREE.Vector3(0,0,1),this.backG=new o.THREE.BoxGeometry(n.cover.depth,this.p.backSize,n.cover.height),this.materials=[new o.THREE.MeshPhongMaterial({color:n.cover.color}),new o.THREE.MeshPhongMaterial({color:n.cover.color}),new o.THREE.MeshPhongMaterial({color:n.cover.color}),new o.THREE.MeshPhongMaterial({color:n.cover.color}),new o.THREE.MeshPhongMaterial({color:n.cover.color}),new o.THREE.MeshPhongMaterial({color:n.cover.color})];var a=new o.THREE.Mesh(this.backG,new o.THREE.MeshFaceMaterial(this.materials));""!==n.cover.binderTexture&&this.visual.textureLoader.load(n.cover.binderTexture,(function(t){i.materials[1].color.setHex(16777215),i.materials[1].map=t,t.minFilter=o.THREE.LinearFilter,t.needsUpdate=!0,i.materials[1].needsUpdate=!0})),this.three=new o.THREE.Object3D,this.back=new o.THREE.Object3D,this.backRT=new o.THREE.Object3D,this.backRR=new o.THREE.Object3D,this.backLT=new o.THREE.Object3D,this.backLR=new o.THREE.Object3D,this.leftPivot=new o.THREE.Object3D,this.rightPivot=new o.THREE.Object3D,this.back.add(a),this.back.add(this.leftPivot),this.back.add(this.rightPivot),this.backRT.add(this.back),this.backRR.add(this.backRT),this.backLT.add(this.backRR),this.backLR.add(this.backLT),this.three.add(this.backLR)}return t.prototype.dispose=function(){var t=this.materials,e=Array.isArray(t),n=0;for(t=e?t:t[Symbol.iterator]();;){var i;if(e){if(n>=t.length)break;i=t[n++]}else{if((n=t.next()).done)break;i=n.value}var r=i;r.map&&(r.map=null,r.needsUpdate=!0),r.dispose()}delete this.materials,this.backG.dispose()},t.prototype.set=function(t){var e=void 0,n=void 0;t>Math.PI/2?(e=Math.PI/2,n=t-Math.PI/2):(e=t,n=0);var i=this.p,r={x:-.5*i.cover.depth,y:.5*i.backSize-i.cover.depth};this.backRT.position.set(r.x,r.y,0),this.backRR.position.set(-r.x,-r.y,0),this.backRR.quaternion.setFromAxisAngle(this.OZ,e);var o={x:i.backSize-2*i.cover.depth-.5*i.cover.depth,y:.5*i.backSize-i.cover.depth};this.backLT.position.set(o.x,o.y,0),this.backLR.position.set(-o.x,-o.y,0),this.backLR.quaternion.setFromAxisAngle(this.OZ,n)},t.prototype.setLeft=function(t){var e=Math.PI;this.leftPivot.position.set(s.default.interpolateLinear([-e,-e/2],[0,this.p.cover.depth],t),.5*this.p.backSize-.5*this.p.cover.depth,0),this.leftPivot.quaternion.setFromAxisAngle(this.OZ,t)},t.prototype.setRight=function(t){var e=Math.PI;this.rightPivot.position.set(s.default.interpolateLinear([-e/2,0],[this.p.cover.depth,0],t),-.5*this.p.backSize+.5*this.p.cover.depth,0),this.rightPivot.quaternion.setFromAxisAngle(this.OZ,t)},t.prototype.joinLeftCover=function(t){t.three.position.set(0,-.5*this.p.cover.depth,0),this.leftPivot.add(t.three)},t.prototype.disconnectLeftCover=function(t){this.leftPivot.remove(t.three)},t.prototype.joinRightCover=function(t){t.three.position.set(0,-.5*this.p.cover.depth,0),this.rightPivot.add(t.three)},t.prototype.disconnectRightCover=function(t){this.rightPivot.remove(t.three)},t}();e.default=c},function(t,e,n){e.__esModule=!0;var i=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},r=n(1),o=n(11),a=v(n(7)),s=v(n(25)),c=v(n(31)),l=v(n(10)),h=v(n(38)),u=v(n(33)),d=v(n(13)),p=v(n(32)),f=v(n(36)),m=v(n(16)),g=v(n(68));function v(t){return t&&t.__esModule?t:{default:t}}var y=function(t){function e(n,o,a,m){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var g=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==(void 0===e?"undefined":_typeof2(e))&&"function"!=typeof e?t:e}(this,t.call(this));return n.jContainer.append('\n      <style type="text/css">\n        .demo-msg {\n          position: absolute;\n          top: 10px;\n          right: 10px;\n          padding: 10px;\n          background-color: #ffe4e1;\n          border-radius: 3px;\n        }\n      </style>\n      <div class="demo-msg">\n        This is the demo version, only 10 pages are available. Use the <a href="https://goo.gl/bt3Zhh" target="_blank">full version</a>.\n      </div>\n    '),g.visual=n,g.mouseController=!0,g.p=i({},e.prepareProps(m),{sheets:o,pageCallback:a,zoom:1,singlePage:!1,autoResolution:{enable:!1,k:1.5}}),g.pageManager=new u.default(n,g,g.p),d.default.init(n.doc),g.layerManager=new p.default(g),g.searchEngine=new f.default(a,2*(o+2)),g.searchEngine.onPageHitsChanged=function(t,e){g.pageManager.refreshPageQuery(t,e),g.dispatchEvent({type:"searchResults",results:g.searchEngine.results,lastPage:t,query:e})},g.three=new r.THREE.Object3D,g.binder=new s.default(n,g.p),g.three.add(g.binder.three),g.leftCover=new c.default(n,i({},g.p,{setTexture:g.setLeftCoverTexture.bind(g)}),Math.PI/2,"opened"),g.binder.joinLeftCover(g.leftCover),g.subscribeSheetBlock(g.leftCover,0),g.rightCover=new c.default(n,i({},g.p,{setTexture:g.setRightCoverTexture.bind(g)}),0,"closed"),g.binder.joinRightCover(g.rightCover),g.subscribeSheetBlock(g.rightCover,2*(g.p.sheets+1)),g.threeSheetBlocks=new r.THREE.Object3D,g.three.add(g.threeSheetBlocks),g.threeSheetBlocks.position.set(.5*g.p.cover.depth-.5*o*g.p.page.depth,-.5*o*g.p.page.depth,0),g.sheetBlocks=[],o>0&&g.addSheetBlock(0,new l.default(n,i({},g.p,{setTexture:g.setPageTexture.bind(g)}),0,o,0,"closed")),g.angle=g.p.rtl?Math.PI:0,g.closedAngle=0,g.set(g.angle,0),g.lastMousePos={t:0},g.three.position.set(-.5*g.p.cover.depth+.5*o*g.p.page.depth,0,0),g.sheetPhysics=new h.default(g.p.page.width/g.p.scale,g.p.gravity,g.p.page.cornerDeviation),g.binds={update:g.update.bind(g),lastMousePos:function(t){g.lastMousePos=i({},g.lastMousePos,{pageX:t.pageX,pageY:t.pageY})}},g.visual.addRenderCallback(g.binds.update),(0,r.$)(g.visual.element).on("mousemove",g.binds.lastMousePos),g.binds.onPickCallback=g.onPickCallback.bind(g),g.visual.drag.onPickCallback=g.binds.onPickCallback,g.binds.onDragCallback=g.onDragCallback.bind(g),g.visual.drag.onDragCallback=g.binds.onDragCallback,g.binds.onReleaseCallback=g.onReleaseCallback.bind(g),g.visual.drag.onReleaseCallback=g.binds.onReleaseCallback,g.dragAngle=.05,g.tmp={boxs:[new r.THREE.Box3,new r.THREE.Box3]},g.visual.addObject(g.three),g.visual.addEventListener("resize",g.pageManager.refreshZoom.bind(g.pageManager)),setTimeout((function(){g.notifyBeforeAnimation(),g.notifyAfterAnimation()}),100),g}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+(void 0===e?"undefined":_typeof2(e)));t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.dispose=function(){this.visual.removeObject(this.three),this.sheetPhysics.dispose(),delete this.visual.drag.onPickCallback,delete this.visual.drag.onDragCallback,delete this.visual.drag.onReleaseCallback,(0,r.$)(this.visual.element).off("mousemove",this.binds.lastMousePos),this.visual.removeRenderCallback(this.binds.update),this.removeSheetBlocks(0,this.sheetBlocks.length),this.binder.disconnectLeftCover(this.leftCover),this.removeSheetBlock(this.leftCover),this.binder.disconnectRightCover(this.rightCover),this.removeSheetBlock(this.rightCover),this.binder.dispose(),this.layerManager.dispose(),d.default.dispose(),this.pageManager.dispose()},e.prototype.setAutoResolution=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1.5;this.p.autoResolution=i({},this.p.autoResolution,{enable:t,k:e})},e.prototype.setZoom=function(t,e){(Math.abs(this.p.zoom-t)>.001||e!==this.p.singlePage)&&(this.p.zoom=t,this.p.singlePage=e,this.pageManager.refreshZoom())},e.prototype.getPageCallback=function(){return this.p.pageCallback},e.prototype.setQuery=function(t){this.searchEngine.setQuery(t)},e.prototype.isProcessing=function(){return 0!==this.sheetPhysics.getSize()},e.prototype.getPages=function(){return 4+2*this.p.sheets},e.prototype.setFlipProgressClb=function(t){this.p.flipProgressClb=t},e.prototype.setInjector=function(t){this.p.injector=t},e.prototype.isActivePage=function(t){var e=!0;if(t>1&&t<this.getPages()-2){var n=this.sheetBlocks,i=Array.isArray(n),r=0;for(n=i?n:n[Symbol.iterator]();;){var o;if(i){if(r>=n.length)break;o=n[r++]}else{if((r=n.next()).done)break;o=r.value}var a=o;if(t-2>2*a.p.first&&t-2<2*a.p.last-1){e=!1;break}}}return e},e.prototype.getBlockByPage=function(t){var e=void 0;if(t<2)e=this.leftCover;else if(t<2*(this.p.sheets+1)){var n=this.sheetBlocks,i=Array.isArray(n),r=0;for(n=i?n:n[Symbol.iterator]();;){var o;if(i){if(r>=n.length)break;o=n[r++]}else{if((r=n.next()).done)break;o=r.value}var a=o;if(t-2>=2*a.p.first&&t-2<2*a.p.last){e=a;break}}}else e=this.rightCover;return e},e.prototype.getBlockPages=function(t){var e=void 0;switch(t){case this.leftCover:e=[0,1];break;case this.rightCover:e=[2*(this.p.sheets+1),2*(this.p.sheets+1)+1];break;default:e=t?[2*(t.p.first+1),2*(t.p.last+1)-1]:void 0}return e},e.prototype.getPage=function(){var t=Math.PI,e=void 0;if(this.angle===t/2||this.angle===3*t/2){var n=this.sheetBlocks,i=Array.isArray(n),r=0;for(n=i?n:n[Symbol.iterator]();;){var o;if(i){if(r>=n.length)break;o=n[r++]}else{if((r=n.next()).done)break;o=r.value}var a=o;if(a.angle<=t/2){e=this.getBlockPages(a)[0]-1;break}}e||(e=this.getPages()-3)}else this.angle<t/2?e=0:this.angle>3*t/2?e=1:this.angle<t?e=this.getPages()-3:this.angle>=t&&(e=this.getPages()-1);return e},e.prototype.getTopPages=function(){var t=this.getPage();return 0===t||t===this.getPages()-1?[t]:[t,t+1]},e.prototype.getPageState=function(t){return this.pageManager.getPageState(t)},e.prototype.enableLoadingAnimation=function(t){this.pageManager.enableLoadingAnimation(t)},e.prototype.getLeftFlipping=function(){var t=void 0,e=this.sheetBlocks[0],n=Math.PI;return this.angle===n?t=this.rightCover:e&&"closed"===e.state&&e.angle>n/2?t=e:this.angle!==n/2&&this.angle!==3*n/2||(t=this.leftCover),t},e.prototype.getRightFlipping=function(){var t=void 0,e=this.sheetBlocks[this.sheetBlocks.length-1],n=Math.PI;return 0===this.angle?t=this.leftCover:e&&"closed"===e.state&&e.angle<=n/2?t=e:this.angle!==n/2&&this.angle!==3*n/2||(t=this.rightCover),t},e.prototype.getClosedBlockAngle=function(t){var e=void 0,n=Math.PI;if(this.leftCover.physicId){var i=void 0;try{i=Math.abs(this.sheetPhysics.getParametr(this.leftCover.physicId,"angle")-t)}catch(t){i=0}e=t>n/2||i>n/6?n/2:this.closedAngle}else if(this.rightCover.physicId){var r=void 0;try{r=Math.abs(this.sheetPhysics.getParametr(this.rightCover.physicId,"angle")-t)}catch(t){r=0}e=t<n/2||r>n/6?n/2+1e-7:this.closedAngle}else e=n/2+1e-7*(0!==t);return{openedAngle:t,closedAngle:e,binderTurn:this.closedAngle}},e.prototype.flipLeft=function(){var t,n,i=this,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.p.flipProgressClb,a=void 0,s=void 0;return this.sheetPhysics.getSize()<25&&(t=i.sheetBlocks[0],n=Math.PI,i.angle===n?s=i.connectPhysics(a=i.rightCover,i.p.cover.mass,n,-i.p.cover.startVelocity,i.p.cover.flexibility,0,(function(t,e){return i.set(3*n/2-t/2,e)}),(function(t,e){i.set(3*n/2-t/2,0),i.setSheetBlocks(t?n:n/2+1e-7,"closed")}),o):t&&"closed"===t.state&&t.angle>n/2?(a=r<t.getSize()?i.splitSheetBlock(0,t.getSize()-r)[1]:t,s=i.connectPhysics(a,i.p.page.mass*a.getSize(),n,-i.p.page.startVelocity,i.p.page.flexibility,0,(function(t,e){return a.set(i.getClosedBlockAngle(t),"opened",e)}),e.finishAnimationClb.bind({book:i,block:a}),o)):i.angle!==n/2&&i.angle!==3*n/2||(s=i.connectPhysics(a=i.leftCover,i.p.cover.mass,n,-i.p.cover.startVelocity,i.p.cover.flexibility,0,(function(t,e){i.set(2*n-t/2,e),t>n/2&&i.setSheetBlocks(t?n/2:0,"closed")}),(function(t,e){return i.set(0===t?0:2*n-t/2,0)}),o))),s},e.prototype.flipRight=function(){var t,n,i=this,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.p.flipProgressClb,a=void 0,s=void 0;return this.sheetPhysics.getSize()<25&&(t=i.sheetBlocks[i.sheetBlocks.length-1],n=Math.PI,0===i.angle?s=i.connectPhysics(a=i.leftCover,i.p.cover.mass,0,i.p.cover.startVelocity,i.p.cover.flexibility,0,(function(t,e){return i.set(t/2,e)}),(function(t,e){i.set(t/2,0),i.setSheetBlocks(t?n/2:0,"closed")}),o):t&&"closed"===t.state&&t.angle<=n/2?(a=r<t.getSize()?i.splitSheetBlock(i.sheetBlocks.length-1,r)[0]:t,s=i.connectPhysics(a,i.p.page.mass*a.getSize(),0,i.p.page.startVelocity,i.p.page.flexibility,0,(function(t,e){return a.set(i.getClosedBlockAngle(t),"opened",e)}),e.finishAnimationClb.bind({book:i,block:a}),o)):i.angle!==n/2&&i.angle!==3*n/2||(s=i.connectPhysics(a=i.rightCover,i.p.cover.mass,0,i.p.cover.startVelocity,i.p.cover.flexibility,0,(function(t,e){i.set(n/2+t/2,e),t<n/2&&i.setSheetBlocks(n/2+1e-7,"closed")}),(function(t,e){return i.set(n/2+t/2,0)}),o))),s},e.prototype.clearHoverInfo=function(){this.pageManager.turnOnEvents(),delete this.hoverInfo.block.force,delete this.hoverInfo.block.cornerForce,delete this.hoverInfo},e.prototype.xSegment=function(){var t=this.tmp.boxs,e={};return this.leftCover.physicId?(t[0].setFromObject(this.rightCover.three),e.min=-(e.max=t[0].max.x)):this.rightCover.physicId?(t[0].setFromObject(this.leftCover.three),e.max=-(e.min=t[0].min.x)):(t[0].setFromObject(this.leftCover.three),t[1].setFromObject(this.rightCover.three),t[0].union(t[1]),e.min=t[0].min.x,e.max=t[0].max.x),e},e.prototype.computeTarget=function(t){var e,n=t.x,i=(t.y,this.xSegment());return e=(i.max-n)/(i.max-i.min)*Math.PI,Math.max(this.dragAngle,Math.min(Math.PI-this.dragAngle,e))},e.prototype.onPickCallback=function(t){var e=!1,n=t.object.userData.self,r=i({},t.uv),o=t.face.materialIndex;return o<2&&(r.x=0===o?r.x:1-r.x,n.cornerTarget.testIntersection(null,r)&&n.physicId&&(this.hoverInfo&&this.clearHoverInfo(),n.force=h.default.dragForceClb,n.cornerForce=h.default.getDragCornerForceClb(this.computeTarget(t.point)),this.dragInfo={object:t,block:n},e=!0,this.pageManager.turnOffEvents())),e},e.prototype.onDragCallback=function(t){var e=this.dragInfo.block;e.getProps();return e.force=h.default.dragForceClb,e.cornerForce=h.default.getDragCornerForceClb(this.computeTarget(t)),!0},e.prototype.onReleaseCallback=function(){delete this.dragInfo.block.force,delete this.dragInfo.block.cornerForce,delete this.dragInfo,this.pageManager.turnOnEvents()},e.prototype.getFlipping=function(t){return t?this.getLeftFlipping():this.getRightFlipping()},e.prototype.flip=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return t?this.flipLeft(e):this.flipRight(e)},e.prototype.enableMouse=function(t){this.mouseController=t},e.prototype.cornerCallback=function(t,e){var n=this;this.mouseController&&function(){var i=e.data,r=i.i,o=i.n;if("mouseover"===t.type)n.hoverInfo&&void 0!==n.hoverInfo.pendings?++n.hoverInfo.pendings:(n.hoverInfo&&(console.warn("Wrong state: element is already hover"),n.hoverInfo.n!==o&&n.clearHoverInfo()),n.hoverInfo||n.dragInfo||function(){var t=Promise.resolve(void 0),e=n.getBlockByPage(o),i=n.getFlipping(r);if(o>1&&o<2*(n.p.sheets+1)&&e.physicId&&(e.angle<.02||e.angle>Math.PI-.02))t=Promise.resolve(e);else if(e===i){var a=[n.leftCover].concat(n.sheetBlocks,[n.rightCover]),s=a.indexOf(e),c=~s?a[s+2*r-1]:void 0;(!c||!c.physicId||c.angle>.02&&c.angle<Math.PI-.02)&&(t=n.flip(r,1).then((function(t){return t?n.sheetPhysics.setParametr(t.physicId,"velocity",0):delete n.hoverInfo,t})),n.hoverInfo={pendings:1})}t.then((function(t){if(n.hoverInfo&&n.hoverInfo.pendings<1&&(t=void 0,delete n.hoverInfo),t){n.pageManager.turnOffEvents();var e=t.getProps();t.force=n.sheetPhysics.getTargetForceClb(e.mass*t.getSize(),r?Math.PI-.02:.02),t.cornerForce=function(){return(r?-1:1)*h.default.hoverCornerForceClb()},n.sheetPhysics.setParametr(t.physicId,"angle",r?Math.PI-.01:.01),n.hoverInfo={n:o,block:t},n.update(1/30)}}))}());else if(n.hoverInfo&&"mouseout"===t.type)void 0!==n.hoverInfo.pendings?--n.hoverInfo.pendings:o===n.hoverInfo.n&&n.clearHoverInfo();else if("mousedown"===t.type)n.cornerClickData={x:t.pageX,y:t.pageY};else if("click"===t.type){if(Math.sqrt(Math.pow(n.cornerClickData.x-t.pageX,2)+Math.pow(n.cornerClickData.y-t.pageY,2))<5){var a=n.getBlockByPage(o);if(a.physicId){var s=a.physicId,c=a.getProps();n.sheetPhysics.setParametr(s,"velocity",(r?-1:1)*c.startVelocity)}}delete n.cornerClickData}}()},e.prototype.addSheetBlock=function(t,e){this.sheetBlocks.splice(t,0,e),this.subscribeSheetBlock(e,2),this.threeSheetBlocks.add(e.three)},e.prototype.subscribeSheetBlock=function(t,e){var n=this,i=new m.default(this.visual.wnd,this.visual.doc,g.default.test),r=.15,o=new g.default(.925,.075,r);o.block=t,o.callback=this.cornerCallback.bind(this),i.addCustom(o),t.cornerTarget=o,t.three.userData.mouseCallback=function(r,o){var a=o.face.materialIndex;if(a<2){var s=0===a?e+2*t.p.first:e+2*t.p.last-1;i.convert(r,{x:0===a?o.uv.x:1-o.uv.x,y:o.uv.y,i:a,n:s}),n.pageManager.transferEventToTexture(s,r,o)}},t.three.userData.touchCallback=function(i,r){var o=r.face.materialIndex;if(o<2){var a=0===o?e+2*t.p.first:e+2*t.p.last-1;n.pageManager.transferEventToTexture(a,i,r)}},this.visual.drag.addThree(t.three),this.visual.mouseEvents.addThree(t.three),this.visual.touchEvents.addThree(t.three)},e.prototype.removeSheetBlock=function(t){this.visual.mouseEvents.removeThree(t.three),this.visual.touchEvents.removeThree(t.three),this.visual.drag.removeThree(t.three),this.threeSheetBlocks.remove(t.three),t.dispose()},e.prototype.removeSheetBlocks=function(t,e){var n=this.sheetBlocks.splice(t,e),i=Array.isArray(n),r=0;for(n=i?n:n[Symbol.iterator]();;){var o;if(i){if(r>=n.length)break;o=n[r++]}else{if((r=n.next()).done)break;o=r.value}var a=o;this.removeSheetBlock(a)}},e.prototype.setTexture=function(t,e){this.pageManager.setTexture(t,e)},e.prototype.setPageTexture=function(t,e){this.setTexture(t,e+2)},e.prototype.setLeftCoverTexture=function(t,e){this.setTexture(t,e)},e.prototype.setRightCoverTexture=function(t,e){this.setTexture(t,e+2*(this.p.sheets+1))},e.finishAnimationClb=function(t){this.block.set(this.book.getClosedBlockAngle(t).closedAngle,"closed",0);var e=this.book.sheetBlocks.indexOf(this.block);~e&&(0===t?this.book.mergeSheetBlocks(e,this.book.sheetBlocks.length-e):this.book.mergeSheetBlocks(0,e+1))},e.prototype.calcBlockForce=function(t,e,n,i,r){return t.force?t.force(e,n,i,r):0},e.prototype.calcBlockCornerForce=function(t,e,n,i,r){return t.cornerForce?t.cornerForce(e,n,i,r):0},e.prototype.notifyBeforeAnimation=function(){var t=void 0;return this.animationNotification?t=Promise.reject():(this.animationNotification=!0,this.dispatchEvent({type:"beforeAnimation"}),t=this.layerManager.hide()),t},e.prototype.notifyAfterAnimation=function(){this.animationNotification&&(delete this.animationNotification,this.layerManager.show(),this.dispatchEvent({type:"afterAnimation"}))},e.prototype.connectPhysics=function(t,e,n,i,r,o,a,s,c){var l=this,h=function(){return l.hoverInfo?"hover":l.dragInfo?"drag":"free"};return(this.sheetPhysics.getSize()?Promise.resolve():this.notifyBeforeAnimation()).then((function(){return t.physicId=l.sheetPhysics.addObject(e,n,i,r,o,(function(e,i){a(e,i),c(t,Math.abs(n-e)/Math.PI,"process",h())}),(function(e,i){s(e,i),delete t.physicId,c(t,Math.abs(n-e)/Math.PI,"finish",h()),Promise.resolve().then((function(){l.sheetPhysics.getSize()||l.notifyAfterAnimation()}))}),(function(e,n,i,r){return l.calcBlockForce(t,e,n,i,r)}),(function(e,n,i,r){return l.calcBlockCornerForce(t,e,n,i,r)})),c(t,0,"init",h()),t})).catch((function(){}))},e.prototype.update=function(t){var e=this;this.lastMousePos.t+=t,this.isProcessing()&&void 0!==this.lastMousePos.pageX&&this.lastMousePos.t-(this.lastMousePos.lastT||0)>.25&&!this.hoverInfo&&!this.dragInfo&&(this.lastMousePos.lastT=this.lastMousePos.t,Promise.resolve().then((function(){(0,r.$)(e.visual.element).trigger(r.$.Event("mousemove",e.lastMousePos))}))),this.sheetPhysics.simulate(t)},e.prototype.splitSheetBlock=function(t,e){var n=this.sheetBlocks[t];if(n&&e<n.getSize()){var r=new l.default(this.visual,i({},this.p,{setTexture:this.setPageTexture.bind(this)}),n.p.first,n.p.first+e,n.angle,n.state);return n.set(n.angle,n.state,n.corner.height,n.p.first+e,n.p.last),this.addSheetBlock(t,r),[r,n]}},e.prototype.mergeSheetBlocks=function(t,e){if(t<this.sheetBlocks.length){e=Math.min(this.sheetBlocks.length-t,e);var n=this.sheetBlocks[t],i=this.sheetBlocks[t+e-1];n.set(n.angle,n.state,n.corner.height,n.p.first,i.p.last),this.removeSheetBlocks(t+1,e-1)}},e.prototype.setSheetBlocks=function(t,e){"closed"===e&&(this.closedAngle=t),this.sheetBlocks.forEach((function(n){n.physicId||n.set(t,e)}))},e.prototype.set=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this.angle=t;var n=Math.PI;if(t<n/4)this.binder.set(0),this.binder.setLeft(-n/2+2*t),this.leftCover.set(n/2,"opened",e),this.setSheetBlocks(0,"closed"),this.binder.setRight(0),this.rightCover.set(0,"closed",0);else if(t<2*n/4){var i=2*(t-n/4);this.binder.set(i),this.binder.setLeft(-i),this.leftCover.set(n/2+i,"opened",e),this.setSheetBlocks(i,"closed"),this.binder.setRight(-i),this.rightCover.set(i,"closed",0)}else if(t<3*n/4){var r=2*(t-n/2);this.binder.set(n/2),this.binder.setLeft(-n/2),this.leftCover.set(n,"opened",0),this.binder.setRight(-n/2),this.rightCover.set(r,"opened",e)}else if(t<4*n/4){var o=2*(t-3*n/4)+n/2;this.binder.set(o),this.binder.setLeft(-o),this.leftCover.set(o,"closed",0),this.setSheetBlocks(o,"closed"),this.binder.setRight(-n/2),this.rightCover.set(n/2,"opened",e)}else if(t<5*n/4)this.binder.set(n),this.binder.setLeft(-n),this.leftCover.set(n,"closed",0),this.setSheetBlocks(n,"closed"),this.binder.setRight(-n/2-2*(t-n)),this.rightCover.set(n/2,"opened",e);else if(t<6*n/4){var a=2*(t-5*n/4);this.binder.set(n-a),this.binder.setLeft(-n+a),this.leftCover.set(n-a,"closed",0),this.setSheetBlocks(n-a,"closed"),this.binder.setRight(-n+a),this.rightCover.set(n/2-a,"opened",e)}else if(t<7*n/4){var s=2*(t-6*n/4);this.binder.set(n/2),this.binder.setLeft(-n/2),this.leftCover.set(n-s,"opened",e),this.binder.setRight(-n/2),this.rightCover.set(0,"opened",0)}else if(t<8*n/4){var c=2*(t-7*n/4);this.binder.set(n/2-c),this.binder.setLeft(-n/2),this.leftCover.set(n/2,"opened",e),this.setSheetBlocks(n/2-c,"closed"),this.binder.setRight(-n/2+c),this.rightCover.set(n/2-c,"closed",0)}},e.createSideTexture=function(t){var e=(0,r.$)('<canvas width="8" height="8"></canvas>'),n=e[0].getContext("2d");return n.beginPath(),n.fillStyle=a.default.color2Rgba(t,1),n.rect(0,0,8,7),n.fill(),n.beginPath(),n.fillStyle=a.default.color2Rgba(a.default.inverseColor(t,.5),1),n.rect(0,7,8,1),n.fill(),e[0]},e.prepareProps=function(t){return e.calcProps(e.mergeProps((0,o.props)(),t))},e.mergeProps=function(t,e){return i({},t,e=e||{},{sheet:i({},t.sheet,e.sheet),cover:i({},t.cover,e.cover),page:i({},t.page,e.page),cssLayerProps:i({},t.cssLayerProps,e.cssLayerProps)})},e.calcProps=function(t){var n=i({},t,{sheet:i({},t.sheet),cover:i({},t.sheet,t.cover),page:i({},t.sheet,t.page),cssLayerProps:i({},t.cssLayerProps,{$:r.$})}),o=10*n.height,a=10*n.width,s={sideTexture:n.sheet.sideTexture||e.createSideTexture(n.sheet.color)},c=i({},s,n.cover,{depth:10*n.cover.depth,width:a,height:o,padding:10*n.cover.padding}),l=i({},s,n.page,{depth:10*n.page.depth,width:c.width-c.padding,height:c.height-2*c.padding}),h={use:!1,color:16711680,size:.01};return c.color===s.color||n.cover.sideTexture||(c.sideTexture=e.createSideTexture(c.color)),l.color===s.color||n.page.sideTexture||(l.sideTexture=e.createSideTexture(l.color)),i({},n,{scale:10,height:o,width:a,flipProgressClb:function(){},cover:c,page:l,marker:h})},e}(r.THREE.EventDispatcher);e.default=y},function(t,e,n){e.__esModule=!0;var i="function"==typeof Symbol&&"symbol"===_typeof2(Symbol.iterator)?function(t){return void 0===t?"undefined":_typeof2(t)}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":void 0===t?"undefined":_typeof2(t)},r=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},o=n(1),a=d(n(15)),s=n(42),c=d(n(49)),l=d(n(70)),h=d(n(55)),u=d(n(50));function d(t){return t&&t.__esModule?t:{default:t}}var p=function(t){function e(n,i,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var a=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==(void 0===e?"undefined":_typeof2(e))&&"function"!=typeof e?t:e}(this,t.call(this));return a.navigationControls=!0,a.book=n,a.visual=n.visual,a.p=e.prepareProps(r),a.p.rtl=n.p.rtl,a.devicePixelRatio=a.visual.wnd.devicePixelRatio||1,a.orbit=n.visual.getOrbit(),n.setFlipProgressClb(a.updateViewIfState.bind(a)),a.view=i,a.bindActions(),a.state={smartPan:!a.actions.cmdSmartPan.active,singlePage:a.actions.cmdSinglePage.active||a.actions.cmdSinglePage.activeForMobile&&a.devicePixelRatio>1,stats:a.actions.cmdStats.active,lighting:a.p.lighting.default,activeSide:1},a.boxs=[new o.THREE.Box3,new o.THREE.Box3],a.bookWatcher=new h.default(a.visual,(function(){return a.state.singlePage?a.state.activeSide?a.boxs[0].setFromObject(n.rightCover.three):a.boxs[0].setFromObject(n.leftCover.three):(a.boxs[0].setFromObject(n.leftCover.three),a.boxs[1].setFromObject(n.rightCover.three),a.boxs[0].union(a.boxs[1])),a.boxs[0]})),a.bookWatcher.scale=a.p.scale.default,a.book.setZoom(a.bookWatcher.scale,a.state.singlePage),a.Stats=new l.default,a.Stats.domElement.style.position="absolute",a.Stats.domElement.style.top="0px",a.visual.setExtraLighting(a.state.lighting),a.binds={onScreenModeChanged:a.onScreenModeChanged.bind(a),stats:a.Stats.update.bind(a.Stats),onUpdateView:a.updateView.bind(a)},u.default.addEventListener(a.view.getParentContainer().ownerDocument,a.binds.onScreenModeChanged),a.cmdSmartPan(),a.view.templateObject.appLoaded&&Promise.resolve().then(a.view.templateObject.appLoaded),a.book.enableLoadingAnimation(a.p.loadingAnimation.book),a.p.loadingAnimation.skin&&a.initLoadingAnimation(),a.book.enableLoadingAnimation(a.p.loadingAnimation.book),a.book.setAutoResolution(a.p.autoResolution.enabled,a.p.autoResolution.coefficient),a}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+(void 0===e?"undefined":_typeof2(e)));t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.dispose=function(){u.default.removeEventListener(this.view.getParentContainer().ownerDocument,this.binds.onScreenModeChanged),delete this.book,delete this.view,delete this.visual},e.prototype.initLoadingAnimation=function(){var t=this,e=function(){var e=!1,n=t.book.getTopPages(),i=Array.isArray(n),r=0;for(n=i?n:n[Symbol.iterator]();;){var o;if(i){if(r>=n.length)break;o=n[r++]}else{if((r=n.next()).done)break;o=r.value}var a=o,s=t.book.getPageState(a);if(e=void 0===s||"loading"===s)break}t.view.setState("widLoading",{visible:e})};this.book.addEventListener("beforeAnimation",e),this.book.addEventListener("afterAnimation",e),this.book.addEventListener("loadPage",e),this.book.addEventListener("loadedPage",e)},e.prototype.enableNavigation=function(t){this.navigationControls=t},e.prototype.setTocCtrl=function(t){this.tocCtrl=t,this.tocCtrl.onChange=this.updateView.bind(this),this.updateView()},e.prototype.setPrinter=function(t){this.printer=t,this.updateView()},e.prototype.setSounds=function(t){this.sounds=t,t.setEnabled(this.actions.cmdSounds.active),this.updateView()},e.prototype.onScreenModeChanged=function(t){this.updateView()},e.prototype.canZoomIn=function(){return!this.state.smartPan||Math.abs(this.bookWatcher.scale-this.p.scale.max)>this.p.eps},e.prototype.canZoomOut=function(){return!this.state.smartPan||Math.abs(this.bookWatcher.scale-this.p.scale.min)>this.p.eps},e.prototype.canDefaultZoom=function(){return this.state.smartPan},e.prototype.setBookZoom=function(t){var e=this;setTimeout((function(){e.bookWatcher.scale===t&&e.book.setZoom(t,e.state.singlePage)}),1e3)},e.prototype.cmdZoomIn=function(){this.state.smartPan?(this.bookWatcher.scale=Math.min(this.p.scale.max,this.bookWatcher.scale+this.p.scale.delta),this.setBookZoom(this.bookWatcher.scale)):this.orbit.zoomIn(6.6*this.p.scale.delta/.32),this.updateView()},e.prototype.cmdZoomOut=function(){this.state.smartPan?(this.bookWatcher.scale=Math.max(this.p.scale.min,this.bookWatcher.scale-this.p.scale.delta),this.setBookZoom(this.bookWatcher.scale)):this.orbit.zoomOut(6.6*this.p.scale.delta/.32),this.updateView()},e.prototype.cmdDefaultZoom=function(){this.state.smartPan&&(this.bookWatcher.scale=this.p.scale.default,this.setBookZoom(this.bookWatcher.scale),this.updateView())},e.prototype.cmdToc=function(){this.tocCtrl&&this.tocCtrl.togle()},e.prototype.cmdFastBackward=function(){this.startFlip(this.book.flipLeft(5))},e.prototype.cmdBackward=function(){var t=this;this.state.singlePage?(this.state.activeSide=(this.getPage()+1)%2,this.state.activeSide?(this.state.activeSide=0,this.updateView()):this.startFlip(this.book.flipLeft(1)).then((function(e){e&&(t.state.activeSide=1)}))):this.startFlip(this.book.flipLeft(1))},e.prototype.cmdForward=function(){var t=this;this.state.singlePage?(this.state.activeSide=(this.getPage()+1)%2,this.state.activeSide?this.startFlip(this.book.flipRight(1)).then((function(e){e&&(t.state.activeSide=0)})):(this.state.activeSide=1,this.updateView())):this.startFlip(this.book.flipRight(1))},e.prototype.cmdFastForward=function(){this.startFlip(this.book.flipRight(5))},e.prototype.cmdSave=function(){window.open(this.p.downloadURL,"_blank")},e.prototype.cmdPrint=function(){this.printer.print()},e.prototype.cmdFullScreen=function(){u.default.activated()?u.default.cancel():u.default.request(this.view.getParentContainer())},e.prototype.cmdSmartPan=function(){this.state.smartPan=!this.state.smartPan,this.state.smartPan?(this.orbit.minAzimuthAngle=0,this.orbit.maxAzimuthAngle=0,this.orbit.minPolarAngle=0,this.orbit.maxPolarAngle=Math.PI/4,this.bookWatcher.enabled=!0):(this.orbit.minAzimuthAngle=-1/0,this.orbit.maxAzimuthAngle=1/0,this.orbit.minPolarAngle=0,this.orbit.maxPolarAngle=Math.PI,this.bookWatcher.enabled=!1),this.updateView()},e.prototype.cmdSinglePage=function(){this.state.singlePage=!this.state.singlePage,this.setBookZoom(this.bookWatcher.scale),this.updateView()},e.prototype.cmdSounds=function(){this.sounds&&this.sounds.togle(),this.updateView()},e.prototype.cmdStats=function(){this.state.stats=!this.state.stats,this.state.stats?((0,o.$)(this.view.getContainer()).append(this.Stats.domElement),this.visual.addRenderCallback(this.binds.stats)):((0,o.$)(this.view.getContainer()).find(this.Stats.domElement).remove(),this.visual.removeRenderCallback(this.binds.stats)),this.updateView()},e.prototype.cmdLightingUp=function(){this.state.lighting=Math.min(this.state.lighting+this.p.lighting.delta,this.p.lighting.max),this.visual.setExtraLighting(this.state.lighting),this.updateView()},e.prototype.cmdLightingDown=function(){this.state.lighting=Math.max(this.state.lighting-this.p.lighting.delta,this.p.lighting.min),this.visual.setExtraLighting(this.state.lighting),this.updateView()},e.prototype.goToPage=function(t){var e=this;this.p.rtl&&(t=this.book.getPages()-1-t);var n=Math.max(Math.min(t,this.book.getPages()-1),0);this.state.activeSide=(n+1)%2;var i=Math.max(Math.min(t-1+t%2,this.book.getPages()-1),0),r=this.book.getPage(),o=[],a=0;if(i!=r){0===r?(o.push(1),r+=1,++a):r===this.book.getPages()-1&&(o.push(-1),r-=2,++a);var s=0;0===i?(s=-1,i+=1,++a):i===this.book.getPages()-1&&(s=1,i-=2,++a),i-r&&o.push(Math.ceil((i-r)/2)),s&&o.push(s)}var c=function(t,n,i){setTimeout((function(){t<0?e.startFlip(e.book.flipLeft(-t,i)):e.startFlip(e.book.flipRight(t,i))}),n)};if(2===a)c(o[0],0,(function(t,e,n){"finish"==n&&1==e&&c(o[o.length-1],0)})),c(o[1],500);else{var l=0,h=o,u=Array.isArray(h),d=0;for(h=u?h:h[Symbol.iterator]();;){var p;if(u){if(d>=h.length)break;p=h[d++]}else{if((d=h.next()).done)break;p=d.value}c(p,l),l+=250}}},e.prototype.startFlip=function(t){var e=this;return t?t.then((function(t){return t&&e.dispatchAsync({type:"startFlip"}),t})):Promise.resolve(void 0)},e.prototype.endFlip=function(t){return this.dispatchAsync({type:"endFlip"}),t},e.prototype.getPage=function(){return this.book.getPage()?Math.min(this.book.getPage()+this.state.activeSide,this.book.getPages()-1):0},e.prototype.getPageForGUI=function(){var t=(this.state.singlePage?this.getPage():this.book.getPage())+1;return this.p.rtl&&(t=this.book.getPages()-t+1),t},e.prototype.inpPage=function(t,e){this.goToPage(e-1)},e.prototype.updateViewIfState=function(t,e,n,i){"init"!==n&&"finish"!==n||setTimeout(this.updateView.bind(this),100),"finish"===n&&this.endFlip(t)},e.prototype.updateViewState=function(){this.viewState={cmdZoomIn:{enable:this.canZoomIn(),visible:this.actions.cmdZoomIn.enabled,active:!1},cmdZoomOut:{enable:this.canZoomOut(),visible:this.actions.cmdZoomOut.enabled,active:!1},cmdDefaultZoom:{enable:this.canDefaultZoom(),visible:this.actions.cmdDefaultZoom.enabled,active:this.canDefaultZoom()&&Math.abs(this.bookWatcher.scale-this.p.scale.default)<this.p.eps},cmdToc:{enable:!!this.tocCtrl,visible:this.actions.cmdToc.enabled&&this.tocCtrl,active:this.tocCtrl&&this.tocCtrl.visible},inpPages:{visible:!0,value:this.book.getPages()},inpPage:{visible:!0,enable:!this.book.isProcessing()&&this.navigationControls,value:this.getPageForGUI()},cmdSave:{enable:!0,visible:this.actions.cmdSave.enabled&&!!this.p.downloadURL,active:!1},cmdPrint:{enable:!0,visible:this.actions.cmdPrint.enabled&&!!this.printer,active:!1},cmdFullScreen:{enable:u.default.available(),visible:this.actions.cmdFullScreen.enabled,active:u.default.available()&&u.default.activated()},widSettings:{enable:!0,visible:this.actions.widSettings.enabled,active:!1},cmdSmartPan:{enable:!0,visible:this.actions.cmdSmartPan.enabled,active:this.state.smartPan},cmdSinglePage:{enable:!0,visible:this.actions.cmdSinglePage.enabled,active:this.state.singlePage},cmdSounds:{enable:!0,visible:this.actions.cmdSounds.enabled&&!!this.sounds,active:!!this.sounds&&this.sounds.enabled},cmdStats:{enable:!0,visible:this.actions.cmdStats.enabled,active:this.state.stats},cmdLightingUp:{enable:Math.abs(this.state.lighting-this.p.lighting.max)>this.p.eps,visible:this.actions.cmdLightingUp.enabled,active:!1},cmdLightingDown:{enable:Math.abs(this.state.lighting-this.p.lighting.min)>this.p.eps,visible:this.actions.cmdLightingDown.enabled,active:!1}};var t=this.book.getLeftFlipping(),e=this.book.getRightFlipping(),n={cmdFastBackward:!!t&&this.navigationControls,cmdBackward:!!t&&this.navigationControls,cmdForward:!!e&&this.navigationControls,cmdFastForward:!!e&&this.navigationControls},i=Object.keys(n),r=Array.isArray(i),o=0;for(i=r?i:i[Symbol.iterator]();;){var a;if(r){if(o>=i.length)break;a=i[o++]}else{if((o=i.next()).done)break;a=o.value}var s=a;this.viewState[s]={enable:n[s],visible:this.actions[s].enabled,active:!1}}},e.prototype.updateView=function(){if(this.view){this.updateViewState();var t=Object.keys(this.viewState),e=Array.isArray(t),n=0;for(t=e?t:t[Symbol.iterator]();;){var i;if(e){if(n>=t.length)break;i=t[n++]}else{if((n=t.next()).done)break;i=n.value}var r=i;this.view.setState(r,this.viewState[r])}}},e.prototype.getActions=function(){var t=this,e=function(e){return t.actions.touchCmdSwipe.enabled&&t.actions.touchCmdSwipe.code===t.actions[e].code&&t.state.smartPan&&t.bookWatcher.scale<=1},n={},i=function(e){0===e.indexOf("cmd")&&(n[e]={activate:function(){t.viewState&&t.viewState[e].enable&&t[e].apply(t,arguments)}})};for(var o in this)i(o);return r({},n,{cmdPanLeft:{activate:function(e){return t.orbit.actions.pan(e,{state:"move",dx:-t.p.pan.speed,dy:0})}},cmdPanRight:{activate:function(e){return t.orbit.actions.pan(e,{state:"move",dx:t.p.pan.speed,dy:0})}},cmdPanUp:{activate:function(e){return t.orbit.actions.pan(e,{state:"move",dx:0,dy:-t.p.pan.speed})}},cmdPanDown:{activate:function(e){return t.orbit.actions.pan(e,{state:"move",dx:0,dy:t.p.pan.speed})}},mouseCmdRotate:{activate:this.orbit.actions.rotate},mouseCmdDragZoom:{activate:function(e,n){n.dy>0?t.cmdZoomOut():n.dy<0&&t.cmdZoomIn()}},mouseCmdPan:{activate:this.orbit.actions.pan},mouseCmdWheelZoom:{activate:function(e){e.preventDefault(),e.deltaY<0?t.cmdZoomOut():e.deltaY>0&&t.cmdZoomIn()}},touchCmdRotate:{activate:function(n,i){e("touchCmdRotate")||(n.preventDefault(),t.orbit.actions.rotate(n,i))}},touchCmdZoom:{activate:function(n,i){e("touchCmdZoom")||(n.preventDefault(),i.dy>0?t.cmdZoomOut():i.dy<0&&t.cmdZoomIn())}},touchCmdPan:{activate:function(n,i){e("touchCmdPan")||(n.preventDefault(),t.orbit.actions.pan(n,i))}},touchCmdSwipe:{activate:function(n,i){if(e("touchCmdSwipe"))if(n.preventDefault(),"start"===i.state){var o=(n.touches||n.originalEvent.touches)[t.actions.touchCmdSwipe.code-1];t.swipeData={handled:!1,x0:o.pageX,y0:o.pageY,x:o.pageX,y:o.pageY}}else"move"===i.state?t.swipeData.handled||(t.swipeData=r({},t.swipeData,{x:t.swipeData.x+i.dx,y:t.swipeData.y+i.dy}),Math.abs(t.swipeData.x0-t.swipeData.x)>100&&(t.swipeData.x0>t.swipeData.x?t.cmdForward():t.cmdBackward(),t.swipeData.handled=!0)):delete t.swipeData}},widSettings:{activate:function(){}}})},e.prototype.bindActions=function(){this.eToA=new c.default((0,o.$)(this.visual.element)),this.eToA.addAction((function(t){return t.preventDefault()}),"contextmenu",c.default.mouseButtons.Right,0),this.actions=this.getActions();var t=Object.keys(this.actions),e=Array.isArray(t),n=0;for(t=e?t:t[Symbol.iterator]();;){var i;if(e){if(n>=t.length)break;i=t[n++]}else{if((n=t.next()).done)break;i=n.value}var a=i,s=r({},this.actions[a],this.p.actions[a]);if(this.actions[a]=s,s.enabled){var l=s.flags||0;s.type?this.eToA.addAction(s.activate,s.type,s.code,l):void 0!==s.code&&this.eToA.addAction(s.activate,"keydown",s.code,l)}}},e.prepareProps=function(t){return e.calcProps(e.mergeProps((0,s.props)(),t))},e.setActions=function(t,e){var n=Object.keys(e||{}),i=Array.isArray(n),o=0;for(n=i?n:n[Symbol.iterator]();;){var a;if(i){if(o>=n.length)break;a=n[o++]}else{if((o=n.next()).done)break;a=o.value}var s=a;t.actions[s]=r({},t.actions[s],e[s])}},e.mergeProps=function(t,n){var o=function t(e,n){var o=r({},e,n=n||{}),a=Object.keys(e),s=Array.isArray(a),c=0;for(a=s?a:a[Symbol.iterator]();;){var l;if(s){if(c>=a.length)break;l=a[c++]}else{if((c=a.next()).done)break;l=c.value}var h=l;"object"===i(e[h])&&(o[h]=t(e[h],n[h]))}return o}(t,n=n||{});return e.setActions(o,t.actions),e.setActions(o,n.actions),o},e.calcProps=function(t){return t.scale.delta=(t.scale.max-t.scale.min)/t.scale.levels,t.lighting.delta=(t.lighting.max-t.lighting.min)/t.lighting.levels,t},e}(a.default);e.default=p},function(t,e,n){e.__esModule=!0;var i=n(1);var r=function(){function t(e,n,i){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.book=n,this.styleSheet=i,this.wnd=e.wnd,this.doc=e.doc,this.pageCallback=n.getPageCallback();var r=this.pageCallback(0);this.type=r.type,"pdf"===this.type&&(this.pdfSrc=r.src.src)}return t.prototype.cancel=function(){this.canceled=!0},t.prototype.dispose=function(){this.frame&&(this.frame.remove(),delete this.frame)},t.prototype.print=function(){var t,e,n=this;delete this.canceled,"pdf"===this.type?(t=void 0,e=!1,n.useIFrame()?(e=!!n.frame,n.frame||(n.frame=(0,i.$)('<iframe src="'+n.pdfSrc+'" style="display: none;"></iframe>').appendTo(n.doc.body)),t=n.frame[0].contentWindow):t=n.wnd.open(n.pdfSrc),e?t.print():(0,i.$)(t).on("load",(function(){try{t.print()}catch(t){console.error(t)}}))):this.renderContent().then((function(t){var e=n.wnd.open().document,i='\n            <!DOCTYPE html>\n            <html>\n              <head>\n                <meta charset="utf-8">\n                <title>3D FlipBook - Printing</title>\n                '+t.head+'\n                <script type="text/javascript">\n                  function printDocument() {\n                    window.print();\n                    window.close();\n                  }\n                  function init() {\n                    setTimeout(printDocument, 100);\n                  }\n                <\/script>\n              </head>\n              <body onload="init()">\n                '+t.body+"\n              </body>\n            </html>\n          ";e.open(),e.write(i),e.close()})).catch((function(t){return console.warn("3D FlipBook - Printing was canceled")}))},t.prototype.progress=function(t){if(this.canceled)throw"Cancel Printing";this.onProgress&&this.onProgress(Math.floor(100*t))},t.prototype.renderContent=function(){for(var t=this,e=this.book.getPages(),n=new Set,i=[],r=Promise.resolve(),o=function(o){var a=t.pageCallback(o);"image"===a.type?r=r.then((function(){return t.progress(o/e),t.renderImage(n,i,a.src)})):"html"===a.type&&(r=r.then((function(){return t.progress(o/e),t.renderHtml(n,i,a.src)})))},a=0;a<e;++a)o(a);return r.then((function(){return t.progress(1),{head:t.renderHead(n),body:i.join("\n")}}))},t.wrap=function(t){return'<div class="fb3d-printer-page">'+t+"</div>"},t.prototype.renderImage=function(e,n,i){n.push(t.wrap('<img src="'+i+'" />'))},t.prototype.renderHtml=function(e,n,r){return new Promise((function(o,a){i.$.get(r,(function(i){var r=i.match(/<link.*?>/gi)||[],a=Array.isArray(r),s=0;for(r=a?r:r[Symbol.iterator]();;){var c;if(a){if(s>=r.length)break;c=r[s++]}else{if((s=r.next()).done)break;c=s.value}var l=c;if(l.match(/stylesheet/i)){var h=l.match(/href\s*=\s*['"](.*)['"]/i);h&&e.add(h[1])}}var u=i.match(/<body.*?>([\S\s]*)<\/body>/i);u&&n.push(t.wrap(u[1])),o()})).fail((function(t){console.error(t.responseText),a()}))}))},t.prototype.renderHead=function(e){var n=[];return e.forEach((function(t){return n.push('<link rel="stylesheet" href="'+t+'">')})),n.push(this.styleSheet?'<link rel="stylesheet" href="'+this.styleSheet+'">':t.defaultStyleSheet()),n.join("\n")},t.prototype.useIFrame=function(){var t=this.wnd.chrome,e=this.wnd.navigator,n=e.vendor,i=e.userAgent.indexOf("Edge")>-1;return!!e.userAgent.match("CriOS")||!(!t||"Google Inc."!==n||i)},t.defaultStyleSheet=function(){return'\n      <style type="text/css">\n        body {\n          margin: 0;\n          padding: 0;\n        }\n        .fb3d-printer-page {\n          page-break-after: always;\n        }\n      </style>\n    '},t}();e.default=r},function(t,e,n){e.__esModule=!0;n(1);var i,r=n(65);var o=function(t){function e(n,i,r,o){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==(void 0===e?"undefined":_typeof2(e))&&"function"!=typeof e?t:e}(this,t.call(this,n,i,r,o))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+(void 0===e?"undefined":_typeof2(e)));t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.initView=function(){this.view=this.container.find(".view"),this.bookmarksView=this.container.find(".widBookmarks"),this.thumbnailsView=this.container.find(".widThumbnails"),this.searchView=this.container.find(".widSearch")},e.prototype.getHandlers=function(n){var i=this;return"inpPage"===n?[{inpPage:function(r,o){return i.callLater(t.prototype.getHandlers.call(i,n),n,r,o,e.PAGE_HANDLER_DELAY)}}]:t.prototype.getHandlers.call(this,n)},e.prototype.onItemStateChanged=function(t,e){"cmdFullScreen"===t&&(e.active?this.parentContainer.addClass("fullscreen"):this.parentContainer.removeClass("fullscreen"))},e.prototype.getView=function(){return this.view},e.prototype.getBookmarksView=function(){return this.bookmarksView},e.prototype.getThumbnailsView=function(){return this.thumbnailsView},e.prototype.getSearchView=function(){return this.searchView},e.prototype.getForms=function(){return[]},e.prototype.getLinks=function(){return["cmdZoomIn","cmdZoomOut","cmdDefaultZoom","cmdToc","cmdFastBackward","cmdBackward","cmdForward","cmdFastForward","cmdSave","cmdPrint","cmdFullScreen","cmdSmartPan","cmdSinglePage","cmdSounds","cmdStats","cmdLightingUp","cmdLightingDown","cmdCloseToc","cmdBookmarks","cmdSearch","cmdThumbnails"]},e.prototype.getWidgets=function(){return["widLoadingProgress","widFloatWnd","widTocMenu","widBookmarks","widThumbnails","widSearch","widSettings","widLoading"]},e.prototype.getInputs=function(){return["inpPage","inpPages"]},e.prototype.getTexts=function(){return["txtLoadingProgress"]},e.prototype.getTemplate=function(){return{html:"templates/default-book-view.html",styles:["css/black-book-view.css"],links:[{rel:"stylesheet",href:"css/font-awesome.min.css"}],script:"js/default-book-view.js"}},e}(((i=r)&&i.__esModule?i:{default:i}).default);o.PAGE_HANDLER_DELAY=1e3,e.default=o},function(t,e,n){e.__esModule=!0;var i=o(n(9)),r=o(n(8));function o(t){return t&&t.__esModule?t:{default:t}}var a=function(t){function e(n,i,o,a){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var s,c=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==(void 0===e?"undefined":_typeof2(e))&&"function"!=typeof e?t:e}(this,t.call(this,a));return c.calcSheets(o),c.pageCallback=i,c.binds={pageCallback:i.bind(c)},c.imageFactory=new r.default(n),o>0?(s=c.imageFactory.build(i(0),0,c.defaults.sheet.widthTexels,c.defaults.sheet.heightTexels,c.defaults.sheet.color)).onLoad=function(){c.calcProps(s.width,s.height),s.dispose(),c.ready()}:(c.props=c.defaults,c.ready()),c}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+(void 0===e?"undefined":_typeof2(e)));t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e}(i.default);e.default=a},function(t,e,n){e.__esModule=!0;var i,r=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},o=n(10);var a=function(t){function e(n,i,r,o){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==(void 0===e?"undefined":_typeof2(e))&&"function"!=typeof e?t:e}(this,t.call(this,n,i,0,1,r,o))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+(void 0===e?"undefined":_typeof2(e)));t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.getProps=function(){return r({},this.p.cover,{sheets:1})},e.prototype.loadPoints=function(){return{interpolationPoints:[{x:[[0,.2877,.6347,.8174,1],[0,.2831,.6256,.8082,.9909],[0,.2603,.5936,.7763,.9589],[0,.137,.3881,.5342,.6758],[0,0,0,0,0]],y:[[0,0,0,0,0],[0,.02,.005,-.001,-.0025],[0,.04,.01,-.002,-.005],[0,.2466,.4795,.5708,.6758],[0,.2877,.6347,.8174,1]]},{x:[[0,.2877,.6347,.8174,1],[0,.2831,.6256,.8082,.9909],[0,.2603,.5936,.7763,.9589],[0,.233,.563,.746,.927],[0,.144,.433,.613,.796],[0,.07,.288,.455,.626],[0,0,0,0,0]],y:[[0,0,0,0,0],[0,.02,.005,-.001,-.0025],[0,.04,.01,-.002,-.005],[0,.168,.269,.27,.255],[0,.245,.435,.458,.46],[0,.278,.544,.614,.673],[0,.2877,.6347,.8174,1]]}],openedInterpolationIndeces:[[2,3,4],[2,3,4,5,6]],closedInterpolationIndeces:[[0,1,2],[0,1,2]]}},e}(((i=o)&&i.__esModule?i:{default:i}).default);e.default=a},function(t,e,n){e.__esModule=!0;var i,r=n(37),o=(i=r)&&i.__esModule?i:{default:i};var a=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.book=e,this.props=e.p.cssLayerProps,this.visual=e.visual,this.pageManager=e.pageManager,this.wrappers={}}return t.prototype.getActives=function(){var t=this.book.getPage(),e=this.book.getPages();return 0===t||t===e-1?[t]:[t,t+1]},t.prototype.dispose=function(){var t=Object.values(this.wrappers),e=Array.isArray(t),n=0;for(t=e?t:t[Symbol.iterator]();;){var i;if(e){if(n>=t.length)break;i=t[n++]}else{if((n=t.next()).done)break;i=n.value}i.layers.forEach((function(t){return t.dispose()}))}delete this.wrappers},t.prototype.show=function(){var t=this;this.hidden=!1;var e=function(){if(i){if(r>=n.length)return"break";a=n[r++]}else{if((r=n.next()).done)return"break";a=r.value}var e,s=a,c=t.wrappers[s];c?"ready"===c.state&&c.layers.length&&(e=t.book.getBlockByPage(s),c.layers.forEach((function(t){t.isHidden()&&(t.update(e),t.show())}))):function(){var e=t.wrappers[s]={state:"loading",layers:[]};Promise.resolve().then((function(){t.pageManager.getLayers(s,(function(n){if(n.length&&t.wrappers){var i=t.book.getBlockByPage(s),r=n,a=Array.isArray(r),c=0;for(r=a?r:r[Symbol.iterator]();;){var l;if(a){if(c>=r.length)break;l=r[c++]}else{if((c=r.next()).done)break;l=c.value}var h=l,u=new o.default(t.visual,i,t.props);e.layers.push(u),u.set(h.css,h.html,h.js)}setTimeout((function(){!t.hidden&&~t.getActives().indexOf(s)&&e.layers.forEach((function(t){return t.show()}))}),10)}e.state="ready"}))}))}()},n=this.getActives(),i=Array.isArray(n),r=0;for(n=i?n:n[Symbol.iterator]();;){var a;if("break"===e())break}},t.prototype.hide=function(){this.hidden=!0;var t=[],e=Object.values(this.wrappers),n=Array.isArray(e),i=0;for(e=n?e:e[Symbol.iterator]();;){var r;if(n){if(i>=e.length)break;r=e[i++]}else{if((i=e.next()).done)break;r=i.value}r.layers.forEach((function(e){return t.push(e.hide())}))}return Promise.all(t)},t}();e.default=a},function(t,e,n){e.__esModule=!0;var i=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},r=n(1),o=h(n(14)),a=h(n(52)),s=h(n(8)),c=h(n(2)),l=h(n(60));function h(t){return t&&t.__esModule?t:{default:t}}var u=function(){function t(e,n,a){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.visual=e,this.book=n,this.pageQuery="",this.p=a,this.pageCache=new o.default(a.cachedPages),this.resourcesCache=new o.default,this.canvas=(0,r.$)("<canvas>")[0],this.imageFactory=new s.default(i({},e,{dispatchEvent:n.dispatchEvent.bind(n),renderCanvas:this.canvas,renderCanvasCtx:this.canvas.getContext("2d")}),this.resourcesCache),this.loadings=[],this.renderQueue=[],this.pageRequests=[],this.predictedRequests=[],this.tmpMaterial=new r.THREE.MeshBasicMaterial,e.addObject(new r.THREE.Mesh(new r.THREE.PlaneGeometry(0,0),this.tmpMaterial)),this.loadingAnimation=!0,this.loading={},this.loading[a.cover.color]=this.createLoadingTexture(a.cover),a.page.color!==a.cover.color&&(this.loading[a.page.color]=this.createLoadingTexture(a.page)),this.turnOnEvents(),e.addRenderCallback(this.update.bind(this)),setTimeout(this.updateRenderQueue.bind(this),250)}return t.prototype.createLoadingTexture=function(t){var e=Math.sqrt(1262992.5/(t.widthTexels*t.heightTexels)),n=new a.default(e*t.widthTexels,e*t.heightTexels,t.color),i=new l.default(n.createSprite(6),6,1,6,.2);return n.dispose(),i},t.prototype.dispose=function(){this.turnOffEvents();var t=Object.keys(this.loading),e=Array.isArray(t),n=0;for(t=e?t:t[Symbol.iterator]();;){var i;if(e){if(n>=t.length)break;i=t[n++]}else{if((n=t.next()).done)break;i=n.value}var r=i;this.loading[r].dispose()}delete this.loading,this.resourcesCache.dispose(),this.pageCache.dispose(),this.canvas.height=this.canvas.width=0,delete this.canvas},t.prototype.isCover=function(t){return t<2||t>=2*(this.p.sheets+1)},t.prototype.isMobile=function(){return(this.visual.wnd.devicePixelRatio||1)>1},t.prototype.getPageState=function(t){var e=this.pageCache.get(t);return e?e.state:void 0},t.prototype.enableLoadingAnimation=function(t){this.loadingAnimation=t;var e=this.loadings,n=Array.isArray(e),i=0;for(e=n?e:e[Symbol.iterator]();;){var r;if(n){if(i>=e.length)break;r=e[i++]}else{if((i=e.next()).done)break;r=i.value}var o=r;this.setupMaterial(o)}},t.prototype.update=function(t){if(this.loadingAnimation){var e={},n=this.loadings,i=Array.isArray(n),r=0;for(n=i?n:n[Symbol.iterator]();;){var o;if(i){if(r>=n.length)break;o=n[r++]}else{if((r=n.next()).done)break;o=r.value}var a=o;a.isActive()&&(e[a.color]=!0)}var s=Object.keys(e),c=Array.isArray(s),l=0;for(s=c?s:s[Symbol.iterator]();;){var h;if(c){if(l>=s.length)break;h=s[l++]}else{if((l=s.next()).done)break;h=l.value}var u=h;this.loading[u].update(t)}}},t.prototype.removeFromLoadings=function(t){var e=this.loadings.indexOf(t);~e&&this.loadings.splice(e,1)},t.prototype.removeFromRenderQueue=function(t){var e=this.renderQueue.indexOf(t);~e&&this.renderQueue.splice(e,1)},t.prototype.refreshPageQuery=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";this.pageQuery=e;var n=this.pageCache.get(t);n&&n.wrapper&&n.wrapper.setQuery&&(this.pageCache.remove(t)||(n.wrapper.setQuery(e),this.pushInRenderQueue(n)))},t.prototype.refreshZoom=function(){var t,e=this;this.p.autoResolution.enable&&(t=[],e.pageCache.forEach((function(e){t.push(e)})),t.forEach((function(t){var n=t[1];n&&n.wrapper&&(e.pageCache.remove(t[0])||e.pushInRenderQueue(n))})))},t.prototype.getLayers=function(t,e){var n=this;this.p.cssLayersLoader?this.p.cssLayersLoader(t,(function(){for(var i=arguments.length,r=Array(i),o=0;o<i;o++)r[o]=arguments[o];var a=n.pageCache.get(t);a&&("active"!==a.state?a.pendings.push({clb:e,args:r}):e.apply(void 0,r))})):e([])},t.prototype.resolvePendings=function(t){var e=t,n=Array.isArray(e),i=0;for(e=n?e:e[Symbol.iterator]();;){var r;if(n){if(i>=e.length)break;r=e[i++]}else{if((i=e.next()).done)break;r=i.value}var o=r;try{o.clb.apply(o,o.args)}catch(t){console.error(t)}}t.splice(0,t.length)},t.prototype.rtlPageN=function(t){return this.p.rtl?2*(this.p.sheets+2)-1-t:t},t.prototype.load=function(t,e){var n=this,i=this.p.pageCallback(this.rtlPageN(e)),o=this.isCover(e)?this.p.cover:this.p.page,a={n:e,texture:new r.THREE.Texture,wrapper:null,state:"loading",locked:function(t){return"loading"===a.state||"rendering"===a.state||n.book.isActivePage(t)},color:o.color,isActive:function(){return n.book.isActivePage(e)},isTop:function(){return~n.book.getTopPages().indexOf(e)},dispose:function(){n.removeFromLoadings(a),n.removeFromRenderQueue(a),a.wrapper&&a.wrapper.dispose&&a.wrapper.dispose(),a.texture.dispose(),delete a.texture,delete a.wrapper},pendings:[]};return a.texture.minFilter=r.THREE.LinearFilter,this.loadings.push(a),this.setMaterial(a,t),Promise.resolve().then((function(){if(a.texture){a.widthTexels=i.widthTexels||o.widthTexels,a.heightTexels=i.heightTexels||o.heightTexels;var t=n.calcResolution(a);a.wrapper=n.imageFactory.build(i,void 0===i.number?e:i.number,t.width,t.height,o.color,n.p.injector),a.wrapper.setQuery&&a.wrapper.setQuery(n.pageQuery),a.simulate=i.interactive?(a.wrapper.simulate||function(){}).bind(a.wrapper):void 0,a.wrapper.onLoad=function(){n.pushInRenderQueue(a),n.book.dispatchEvent({type:"loadedPage",page:e})},a.wrapper.onChange=function(t){a.texture&&(n.removeFromLoadings(a),a.material&&(a.material.map=a.texture,a.material.color=new r.THREE.Color(16777215),a.material.needsUpdate=!0),a.texture.image=t,a.texture.needsUpdate=!0,a.texture.onUpdate=function(){"queuedForRender"!==a.state&&(a.state="active",n.resolvePendings(a.pendings)),delete n.rendering},n.tmpMaterial.map=a.texture,n.tmpMaterial.needsUpdate=!0)}}})),this.book.dispatchEvent({type:"loadPage",page:e}),this.pageCache.put(e,a)},t.prototype.isSinglePage=function(t){return this.p.singlePage||!t.n||t.n===this.book.getPages()-1},t.prototype.calcResolution=function(t){var e=void 0;if(this.p.autoResolution.enable){var n=Math.min((this.isSinglePage(t)?1:.5)*this.visual.width()/t.widthTexels,this.visual.height()/t.heightTexels);e={width:this.p.autoResolution.k*this.p.zoom*n*t.widthTexels,height:this.p.autoResolution.k*this.p.zoom*n*t.heightTexels}}else e={width:t.widthTexels,height:t.heightTexels};return e},t.prototype.pushInRenderQueue=function(t){"queuedForRender"!==t.state&&(t.state="queuedForRender",this.renderQueue.push(t))},t.prototype.updateRenderQueue=function(){if(this.canvas){var t=this.p;if(!this.rendering&&(t.renderWhileFlipping||!this.book.isProcessing())){var e=void 0,n=void 0,i=this.renderQueue,r=Array.isArray(i),o=0;for(i=r?i:i[Symbol.iterator]();;){var a;if(r){if(o>=i.length)break;a=i[o++]}else{if((o=i.next()).done)break;a=o.value}var s=a;if(!e&&s.isActive()&&(e=s),s.isTop()){n=s;break}}this.rendering=n||e,(this.isMobile()&&t.renderInactivePagesOnMobile||!this.isMobile()&&t.renderInactivePages)&&(this.rendering=this.rendering||this.renderQueue[0]),this.rendering&&(this.rendering.wrapper.startRender?(this.removeFromRenderQueue(this.rendering),this.rendering.state="rendering",this.rendering.wrapper.setResolution(this.calcResolution(this.rendering)),this.rendering.wrapper.startRender()):delete this.rendering)}setTimeout(this.updateRenderQueue.bind(this),250)}},t.prototype.turnOnEvents=function(){this.transferEvents=!0},t.prototype.turnOffEvents=function(){var t=r.$.Event("mouseup"),e=r.$.Event("mouseout");this.pageCache.forEach((function(n){var i=n[1];i.simulate&&(i.simulate(t,void 0,0,0),i.simulate(e,void 0,0,0))})),this.transferEvents=!1},t.prototype.transferEventToTexture=function(t,e,n){var i,r,o=this;if(this.transferEvents){var a=this.getOrLoadTextureObject(void 0,t);a.wrapper&&(i=n.uv,r=a.wrapper.getSimulatedDoc(),o.pageCache.forEach((function(t){var n=t[1];n.simulate&&n.simulate(e,r,i.x,i.y)})))}},t.prototype.loadPredictedPages=function(){this.predictedRequests=c.default.predict(this.pageRequests,this.p.preloadPages);var t=this.predictedRequests,e=Array.isArray(t),n=0;for(t=e?t:t[Symbol.iterator]();;){var i;if(e){if(n>=t.length)break;i=t[n++]}else{if((n=t.next()).done)break;i=n.value}var r=i;r<this.book.getPages()&&!this.pageCache.get(r)&&this.load(void 0,r)}},t.prototype.addPageRequest=function(t){this.pageRequests.push(t),this.pageRequests.length>this.p.pagesForPredicting&&this.pageRequests.shift(),Promise.resolve().then(this.loadPredictedPages.bind(this))},t.prototype.setMaterial=function(t,e){this.pageCache.forEach((function(n){var i=n[1];t!==i&&i.material===e&&delete i.material})),e&&e!==t.material&&(t.material=e,this.setupMaterial(t))},t.prototype.setupMaterial=function(t){t.material.map=t.texture.image?t.texture:this.loadingAnimation?this.loading[t.color].texture:null,t.material.map||(t.material.color=new r.THREE.Color(t.color)),t.material.needsUpdate=!0},t.prototype.getOrLoadTextureObject=function(t,e){var n=this.pageCache.get(e);return n?this.setMaterial(n,t):(n=this.load(t,e),this.addPageRequest(e)),n},t.prototype.setTexture=function(t,e){~this.predictedRequests.indexOf(e)&&this.addPageRequest(e),this.getOrLoadTextureObject(t,e)},t}();e.default=u},function(t,e,n){e.__esModule=!0;var i=o(n(9)),r=o(n(18));function o(t){return t&&t.__esModule?t:{default:t}}var a=function(t){function e(n,i){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var o=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==(void 0===e?"undefined":_typeof2(e))&&"function"!=typeof e?t:e}(this,t.call(this,i));return o.pdf=new r.default(n),o.pageDescription={type:"pdf",src:o.pdf,interactive:!0},o.binds={pageCallback:o.pageCallback.bind(o)},o.pdf.getHandler(o.init.bind(o)),o}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+(void 0===e?"undefined":_typeof2(e)));t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.dispose=function(){this.pdf.dispose(),t.prototype.dispose.call(this)},e.prototype.init=function(t){var e=this,n=this.pdf.getPagesNum();this.calcSheets(n),n>0?t.getPage(1).then((function(t){var n=r.default.getPageSize(t);e.calcProps(n.width,n.height),e.ready()})).catch((function(t){console.error(t)})):(this.props=this.defaults,this.ready())},e.prototype.pageCallback=function(t){return this.pageDescription},e}(i.default);e.default=a},function(t,e,n){e.__esModule=!0;var i=n(1);var r=function(){function t(e,n,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.pdf=e,this.ctrl=n,this.element=(0,i.$)(r),this.cursors=[]}return t.prototype.dispose=function(){},t.prototype.setHandler=function(t){this.handler=t},t.prototype.defaultHandler=function(t,e){"internal"===t?this.ctrl.goToPage(e):"external"===t&&window.open(e,"_blank")},t.prototype.callHandlers=function(t,e){this.handler&&this.handler(t,e)||this.defaultHandler(t,e)},t.prototype.handleEvent=function(t){var e=this,n=t.event,i=t.annotation;switch(n.type){case"mouseover":this.cursors.push(this.element.css("cursor")),this.element.css("cursor","pointer");break;case"mouseout":this.element.css("cursor",this.cursors.pop()||"");break;case"touchtap":case"click":if(i.url)this.callHandlers("external",i.url);else if(i.dest){("string"==typeof i.dest?this.pdf.handler.getDestination(i.dest):Promise.resolve(i.dest)).then((function(t){return"number"==typeof t[0]?t[0]:e.pdf.handler.getPageIndex(t[0])})).then((function(t){return e.callHandlers("internal",t)})).catch((function(){return console.error("Bad link")}))}}},t}();e.default=r},function(t,e,n){e.__esModule=!0;var i,r=n(17),o=(i=r)&&i.__esModule?i:{default:i};var a=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.pageCallback=e,this.pages=n,this.results=[]}return t.prototype.setQuery=function(t){this.query=t,this.update=!0,this.process()},t.prototype.process=function(){var t,e=this;if(this.update){var n=this.results;if(this.results=[],this.onPageHitsChanged){var i=n,r=Array.isArray(i),o=0;for(i=r?i:i[Symbol.iterator]();;){if(r){if(o>=i.length)break;i[o++]}else{if((o=i.next()).done)break;o.value}this.onPageHitsChanged(void 0,"")}}this.update=!1,this.page=0,this.stamp=Date.now(),this.query.length>1&&this.process()}else this.page<this.pages&&(t=e.stamp,e.find(e.pageCallback(e.page)).then((function(n){t===e.stamp&&(n.length&&e.results.push({page:e.page,contexts:n}),++e.page,e.onPageHitsChanged&&e.onPageHitsChanged(e.page,e.query),e.process())})))},t.prototype.find=function(t){var e=this;return"pdf"===t.type?new Promise((function(n){t.src.getHandler((function(){var i=void 0===t.number?e.page:t.number;"right"===t.src.getPageType(i)?n([]):t.src.getPage(i).then((function(t){t.getTextContent().then((function(t){n(new o.default(t.items.map((function(t){return t.str})),e.query,{hits:!1}).getContexts())}))})).catch((function(){return n([])}))}))})):Promise.resolve([])},t}();e.default=a},function(t,e,n){e.__esModule=!0;var i,r=n(13),o=(i=r)&&i.__esModule?i:{default:i};var a=function(){function t(e,n,i){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.visual=e;var r=n.getTopSize();this.layer=new o.default(r.width,r.height,i),this.update(n),this.visual.addCssObject(this.layer)}return t.prototype.dispose=function(){this.layer.dispose(),this.visual.removeCssObject(this.layer)},t.prototype.isHidden=function(){return this.layer.isHidden()},t.prototype.hide=function(){return this.layer.hide()},t.prototype.show=function(){return this.layer.show()},t.prototype.set=function(t,e,n){this.layer.setData(t,e,n)},t.prototype.update=function(t){this.block=t,this.block.getTopWorldRotation(this.layer.rotation),this.block.getTopWorldPosition(this.layer.position)},t}();e.default=a},function(t,e,n){e.__esModule=!0;var i,r=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},o=n(3),a=(i=o)&&i.__esModule?i:{default:i};function s(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var c=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.15,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:240;s(this,t),this.p={r:e,cornerDeviation:i,l:Math.PI*e,startDt:1/r,gravity:n,margin:.002*e,infM:1e4,attempts:16,maxIterations:100},this.os=[]}return t.targetForceClb=function(t,e,n,i){var r=e*this.r;return 100*this.m*this.g*(2/(1+Math.exp(10*(r-this.tl)))-1)-40*this.m*n},t.hoverCornerForceClb=function(t,e,n,i){return 5},t.prototype.getTargetForceClb=function(e,n){return t.targetForceClb.bind({g:this.p.gravity,m:e,tl:n*this.p.r,r:this.p.r})},t.dragForceClb=function(t,e,n,i){return t.flbt*t.m*(10*t.g*i-50*n/(1+Math.exp(3.5*Math.abs(i))))},t.dragCornerForceClb=function(t,e,n,i){return 15*(2/(1+Math.exp(10*(e-this.ta)*t.r))-1)},t.getDragCornerForceClb=function(e){return t.dragCornerForceClb.bind({ta:e})},t.prototype.dispose=function(){this.os=[]},t.prototype.getSize=function(){return this.os.length},t.prototype.addObject=function(t,e,n,i,r,o,s){var c=arguments.length>7&&void 0!==arguments[7]?arguments[7]:function(){return 0},l=arguments.length>8&&void 0!==arguments[8]?arguments[8]:function(){return 0},h={id:a.default.getUnique(),m:t,v:n,l:e*this.p.r,f:c,cf:l,ch:r,flbt:i,simulateClb:o,removeClb:s},u=this.os.findIndex((function(t){return h.l<=t.l}));return u=~u?u:this.os.length,this.os.splice(u,0,h),h.id},t.prototype.getParametrMap=function(t){return{mass:"m",velocity:"v",flexibility:"flbt",cornerHeight:"ch",simulateClb:"simulateClb",removeClb:"removeClb",forceClb:"f",cornerForceClb:"cf"}[t]},t.prototype.setParametr=function(t,e,n){var i=this.os.find((function(e){return e.id===t}));"angle"===e?i.l=n*this.p.r:i[this.getParametrMap(e)]=n},t.prototype.getParametr=function(t,e){var n=this.os.find((function(e){return e.id===t}));return"angle"===e?n.l/this.p.r:n[this.getParametrMap(e)]},t.prototype.simulate=function(t){for(var e=0,n=this.p.startDt,i=0,r=0;e<t&&r<this.p.maxIterations;){n>t-e&&(n=t-e);var o=this.integrate(this.os,n),a=this.findCollisions(o);if(a.num>1&&i<this.p.attempts)n/=2,++i;else{if(1===a.num){var s=this.solveCollision(o[a.last-1],o[a.last]);o[a.last-1]=s[0],o[a.last]=s[1]}else if(a.num>1){var c=[],l=-2,h=a.all,u=Array.isArray(h),d=0;for(h=u?h:h[Symbol.iterator]();;){var p;if(u){if(d>=h.length)break;p=h[d++]}else{if((d=h.next()).done)break;p=d.value}var f=p;f-l>1&&c.push([]),c[c.length-1].push(f),l=f}var m=c,g=Array.isArray(m),v=0;for(m=g?m:m[Symbol.iterator]();;){var y;if(g){if(v>=m.length)break;y=m[v++]}else{if((v=m.next()).done)break;y=v.value}var b=y,x=void 0,w=void 0;o[b[0]].l>Math.PI/2*this.p.r?(x=-1,w=b[b.length-1]):(x=1,w=b[0]);for(var _=w;_<o.length&&_>-1;_+=x){var S=o[_+x];if(!(S&&x*(S.l-o[_].l)<=this.p.margin))break;S.l=o[_].l+2*x*this.p.margin,(S.l>this.p.l||S.l<0)&&(S.l=S.l>this.p.l?this.p.l:0,S.ch=0,S.v=0,console.error("Bad collision"))}}}this.os=o,this.findAndSolveCornerCollisions(),e+=n,n=this.p.startDt,i=0}++r}this.removeStatics()},t.prototype.removeStatics=function(){var t=[],e=[[],[]],n=this.os,i=Array.isArray(n),r=0;for(n=i?n:n[Symbol.iterator]();;){var o;if(i){if(r>=n.length)break;o=n[r++]}else{if((r=n.next()).done)break;o=r.value}var a=o;a.simulateClb&&a.simulateClb(a.l/this.p.r,a.ch),a.l!==this.p.l&&0!==a.l||0!==a.v?t.push(a):void 0!==a.removeClb&&e[(a.l!==this.p.l)+0].push(a)}this.os=t;var s=e[0].reverse(),c=Array.isArray(s),l=0;for(s=c?s:s[Symbol.iterator]();;){var h;if(c){if(l>=s.length)break;h=s[l++]}else{if((l=s.next()).done)break;h=l.value}var u=h;u.removeClb(Math.PI,u.ch)}var d=e[1],p=Array.isArray(d),f=0;for(d=p?d:d[Symbol.iterator]();;){var m;if(p){if(f>=d.length)break;m=d[f++]}else{if((f=d.next()).done)break;m=f.value}var g=m;g.removeClb(0,g.ch)}},t.prototype.findAndSolveCornerCollisions=function(){if(this.os.length)for(var t=[r({},this.os[0],{l:0,m:this.p.infM,ch:0})].concat(this.os,[r({},this.os[0],{l:1.05*this.p.l,m:this.p.infM,ch:0})]),e=1;e<t.length;++e){var n=t[e-1],i=t[e];if(1.05*(n.l+this.p.cornerDeviation*n.ch*this.p.r)>i.l+this.p.cornerDeviation*i.ch*this.p.r&&n.ch>i.ch){var o=n.ch-i.ch,a=n.m/n.flbt+i.m/i.flbt,s=n.m/n.flbt/a,c=i.m/i.flbt/a;n.ch=n.ch-c*o,i.ch=i.ch+s*o}}},t.prototype.solveCollision=function(t,e){var n=e.m+t.m,i=(-t.v*e.m+t.m*t.v+2*e.m*e.v)/n,o=(e.m*e.v-e.v*t.m+2*t.m*t.v)/n;return[r({},t,{v:i}),r({},e,{v:o})]},t.prototype.findCollisions=function(t){for(var e={num:0,last:0,all:[]},n=1;n<t.length&&e.num<2;++n)(t[n-1].l>t[n].l||this.isCollision(t[n-1],t[n]))&&(t[n-1].l>t[n].l&&++e.num,++e.num,e.last=n,-1===e.all.indexOf(n-1)&&e.all.push(n-1),-1===e.all.indexOf(n)&&e.all.push(n));return e},t.prototype.isCollision=function(t,e){return Math.abs(t.l-e.l)<this.p.margin&&t.v>e.v},t.prototype.integrate=function(t,e){var n=[],i=t,o=Array.isArray(i),s=0;for(i=o?i:i[Symbol.iterator]();;){var c;if(o){if(s>=i.length)break;c=i[s++]}else{if((s=i.next()).done)break;c=s.value}var l=c,h=a.default.rk4(this.dy.bind({g:this.p.gravity,r:this.p.r,m:l.m,f:l.f,cf:l.cf,ch:l.ch,flbt:l.flbt}),0,e,[l.v,l.l,l.ch]),u=r({},l,{v:h[0],l:h[1],ch:h[2]});(u.l<=0||u.l>=this.p.l)&&(u.l=u.l<=0?0:this.p.l,u.v=0,u.ch=0),n.push(u)}return n},t.prototype.dy=function(t,e){var n=e[0],i=e[1],r=e[2],o=this.f(this,i/this.r,n,r),a=this.cf(this,i/this.r,n,r);return[(-this.g*Math.cos(i/this.r)*this.m+o)/this.m,n+.01*(Math.random()-.5),this.flbt*((2/(1+Math.exp(-.2*a))-1)*(1-2/(1+Math.exp(-5*(Math.abs(r)-2))))-r)]},t}();e.default=c},function(t,e){function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}e.__esModule=!0;var i=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};n(this,t),this.sounds=e.sounds||{},this.audio={},this.sounds.startFlip&&(this.audio.startFlip=new Audio(this.sounds.startFlip)),this.sounds.endFlip&&(this.audio.endFlip=new Audio(this.sounds.endFlip))}return t.prototype.setEnabled=function(t){this.enabled=t},t.prototype.togle=function(){this.enabled=!this.enabled},t.prototype.dispose=function(){delete this.audio.startFlip,delete this.audio.endFlip},t.prototype.startFlip=function(){this.enabled&&this.audio.startFlip&&this.audio.startFlip.play()},t.prototype.endFlip=function(){this.enabled&&this.audio.startFlip&&(this.audio.startFlip.pause(),this.audio.startFlip.currentTime=0),this.enabled&&this.audio.endFlip&&this.audio.endFlip.play()},t.prototype.subscribeFlips=function(t){t.addEventListener("startFlip",this.startFlip.bind(this)),t.addEventListener("endFlip",this.endFlip.bind(this))},t}();e.default=i},function(t,e,n){e.__esModule=!0;var i,r=n(67);var o=function(t){function e(n,i){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var r=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==(void 0===e?"undefined":_typeof2(e))&&"function"!=typeof e?t:e}(this,t.call(this,n));return r.bookCtrl=i,r.tab="none",r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+(void 0===e?"undefined":_typeof2(e)));t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.setThumbnails=function(t){this.thumbnails=t,t.onNavigate=this.navigateThumbnails.bind(this),"none"===this.tab&&(this.tab="thumbnails"),this.fireChange()},e.prototype.setSearch=function(t){this.search=t,t.onNavigate=this.navigateSearch.bind(this),this.fireChange()},e.prototype.setBookmarks=function(t,e){this.bookmarks=t,this.pdf=e,t.onNavigate=this.navigateBookmarks.bind(this),t.getSize()&&(this.tab="bookmarks",this.isBookmarks=!0),this.fireChange()},e.prototype.cmdBookmarks=function(){this.tab="bookmarks",this.fireChange()},e.prototype.cmdThumbnails=function(){this.tab="thumbnails",this.fireChange()},e.prototype.cmdSearch=function(){this.tab="search",this.fireChange()},e.prototype.cmdCloseToc=function(){this.hide()},e.prototype.navigateThumbnails=function(t){this.bookCtrl.goToPage(t)},e.prototype.navigateSearch=function(t){this.bookCtrl.goToPage(t)},e.prototype.navigateBookmarks=function(t){var e=this;if(t.url)window.open(t.url,"_blank");else if(t.dest){("string"==typeof t.dest?this.pdf.handler.getDestination(t.dest):Promise.resolve(t.dest)).then((function(t){return e.pdf.handler.getPageIndex(t[0])})).then((function(t){return e.bookCtrl.goToPage(t)})).catch((function(){return console.error("Bad bookmark")}))}},e.prototype.updateView=function(){var e=this;this.view&&(this.view.setState("widTocMenu",{enable:!0,visible:!0,active:!1}),this.view.setState("widThumbnails",{enable:!0,visible:"thumbnails"===this.tab,active:!1}),this.view.setState("widSearch",{enable:!0,visible:"search"===this.tab,active:!1}),this.view.setState("widBookmarks",{enable:!0,visible:"bookmarks"===this.tab,active:!1}),this.view.setState("cmdBookmarks",{enable:!0,visible:!0,active:"bookmarks"===this.tab}),this.view.setState("cmdCloseToc",{enable:!0,visible:!0,active:!1}),this.view.setState("cmdThumbnails",{enable:!0,visible:!0,active:"thumbnails"===this.tab}),this.view.setState("cmdSearch",{enable:!0,visible:!0,active:"search"===this.tab}),Promise.resolve().then((function(){return e.thumbnails.setEnable(e.visible&&"thumbnails"===e.tab)})),t.prototype.updateView.call(this))},e}(((i=r)&&i.__esModule?i:{default:i}).default);e.default=o},function(t,e,n){e.__esModule=!0;var i,r=n(1),o=n(20),a=(i=o)&&i.__esModule?i:{default:i};var s=[],c=new r.THREE.PlaneGeometry(1,1,10,1);c.translate(.5,.5,1);var l=new r.THREE.PlaneGeometry(1,1,10,1);l.rotateY(Math.PI),l.translate(.5,.5,0);var h=new r.THREE.PlaneGeometry(1,1,14,1);h.rotateY(-Math.PI/2),h.translate(0,.5,.5);var u=new r.THREE.PlaneGeometry(1,1,14,1);u.rotateY(Math.PI/2),u.translate(1,.5,.5);var d=new r.THREE.PlaneGeometry(1,1,10,14);d.rotateX(-Math.PI/2),d.translate(.5,1,.5);var p=d.clone();p.translate(0,-1,0);var f=p.faces,m=Array.isArray(f),g=0;for(f=m?f:f[Symbol.iterator]();;){var v;if(m){if(g>=f.length)break;v=f[g++]}else{if((g=f.next()).done)break;v=g.value}var y=v,b=[y.b,y.a];y.a=b[0],y.b=b[1]}var x=new r.THREE.Geometry;x.vertices=[].concat(p.vertices,d.vertices);var w=function(t,e){var n=t,i=Array.isArray(n),o=0;for(n=i?n:n[Symbol.iterator]();;){var a;if(i){if(o>=n.length)break;a=n[o++]}else{if((o=n.next()).done)break;a=o.value}var c=a;x.faces.push(new r.THREE.Face3(e(c.a),e(c.b),e(c.c)))}s.push(x.faces.length)},_=function(t,e){for(var n,i,r=[],o=0;o<t.length;++o)for(var a=0;a<e.length;++a)if(n=t[o],i=e[a],Math.abs(n.x-i.x)+Math.abs(n.y-i.y)+Math.abs(n.z-i.z)<1e-4){r[o]=a;break}return r},S=_(c.vertices,x.vertices),E=_(l.vertices,x.vertices),A=_(h.vertices,x.vertices),T=_(u.vertices,x.vertices);w(d.faces,(function(t){return t+p.vertices.length})),w(p.faces,(function(t){return t})),w(c.faces,(function(t){return S[t]})),w(l.faces,(function(t){return E[t]})),w(h.faces,(function(t){return A[t]})),w(u.faces,(function(t){return T[t]})),s.pop(),a.default.computeFaceVertexUvs(x,s),x.computeVertexNormals(),x.computeBoundingSphere(),x.verticesNeedUpdate=!0,e.default={resX:11,resY:2,resZ:15,faces:s,geometry:x}},function(t,e){e.__esModule=!0,e.props=function(){return{eps:1e-4,skin:{default:"short-white-book-view"},scale:{default:.9,min:.9,max:2.5,levels:7},lighting:{default:.7,min:0,max:1,levels:7},pan:{speed:50},loadingAnimation:{skin:!1,book:!0},autoResolution:{enabled:!0,coefficient:1.5},actions:{cmdZoomIn:{enabled:!0},cmdZoomOut:{enabled:!0},cmdDefaultZoom:{enabled:!0,type:"dblclick",code:0},cmdToc:{enabled:!0},cmdFastBackward:{enabled:!1},cmdBackward:{enabled:!0},cmdForward:{enabled:!0},cmdFastForward:{enabled:!1},cmdSave:{enabled:!0},cmdPrint:{enabled:!0},cmdFullScreen:{enabled:!0},widSettings:{enabled:!0},cmdSmartPan:{enabled:!0,active:!0},cmdSinglePage:{enabled:!0,active:!1,activeForMobile:!1},cmdSounds:{enabled:!0,active:!0},cmdStats:{enabled:!0,active:!1},cmdLightingUp:{enabled:!0},cmdLightingDown:{enabled:!0},cmdPanLeft:{enabled:!1},cmdPanRight:{enabled:!1},cmdPanUp:{enabled:!1},cmdPanDown:{enabled:!1},mouseCmdRotate:{enabled:!0,type:"mousedrag",code:r},mouseCmdDragZoom:{enabled:!0,type:"mousedrag",code:i},mouseCmdPan:{enabled:!0,type:"mousedrag",code:n},mouseCmdWheelZoom:{enabled:!0,type:"mousewheel",code:0},touchCmdRotate:{enabled:!0,type:"touchdrag",code:3},touchCmdZoom:{enabled:!0,type:"touchdrag",code:2},touchCmdPan:{enabled:!0,type:"touchdrag",code:1},touchCmdSwipe:{enabled:!0,type:"touchdrag",code:1}}}};var n=0,i=1,r=2},function(t,e,n){e.__esModule=!0;n(0);var i,r=n(5);var o=function(t){function e(n,i,r,o){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var a=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==(void 0===e?"undefined":_typeof2(e))&&"function"!=typeof e?t:e}(this,t.call(this,n,i,r,o));return Promise.resolve().then((function(){a.startRender=function(){a.renderBlankPage(),a.finishRender()},a.finishLoad()})),a}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+(void 0===e?"undefined":_typeof2(e)));t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e}(((i=r)&&i.__esModule?i:{default:i}).default);e.default=o},function(t,e,n){e.__esModule=!0;var i=n(0);function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var o=function(){function t(e,n){var o=this,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(t){return t.title},s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:function(t){return t.items};r(this,t),this.container=e,this.map=[],this.getTitle=a,this.getItems=s,this.nodes=this.mapNodes(n,this.map),this.binds={togle:function(t){t.preventDefault();for(var n=(0,i.$)(t.target);n[0]&&n[0]!==e[0]&&!n.hasClass("item");)n=(0,i.$)(n[0].parentNode);if(n.hasClass("item")){for(var r=(0,i.$)(t.target);r[0]&&r[0]!==n[0]&&!r.hasClass("cmd");)r=(0,i.$)(r[0].parentNode);if(r.hasClass("cmd")){var a=o.map[n.attr("data-id")];r.hasClass("togle")?(a.minimized=!a.minimized,a.minimized?(n.find("ul").remove(),n.find(".togle").addClass("minimized")):(n.find(".togle").removeClass("minimized"),n.append((o.renderNode(a).match(/<ul.*<\/ul>/)||[""])[0]))):o.onNavigate&&o.onNavigate(a.item)}}}},e.on("click",this.binds.togle),this.update()}return t.prototype.getSize=function(){return this.map.length},t.prototype.dispose=function(){this.container.off("click",this.binds.togle),this.container.html("")},t.prototype.update=function(){this.container.html(this.renderNodes(this.nodes))},t.prototype.forEach=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.nodes,n=e||[],i=Array.isArray(n),r=0;for(n=i?n:n[Symbol.iterator]();;){var o;if(i){if(r>=n.length)break;o=n[r++]}else{if((r=n.next()).done)break;o=r.value}var a=o;t(a),this.forEach(t,a.children)}},t.prototype.expand=function(){this.forEach((function(t){return t.minimized=!1})),this.update()},t.prototype.minimize=function(){this.forEach((function(t){return t.minimized=!0})),this.update()},t.prototype.renderNode=function(t){return['<div class="area">',t.children?'<a href="#" class="cmd togle'+(t.minimized?" minimized":"")+'"><i class="fa fa-angle-right"></i></a> ':'<i class="white-space"></i> ','<a class="cmd" title="',t.title,'" href="#">',t.title,"</a></div>",t.minimized?"":this.renderNodes(t.children)].join("")},t.prototype.renderNodes=function(t){var e=['<div class="bookmarks">'];if(t&&t.length){e.push('<ul class="level-',t[0].level,'">');var n=t,i=Array.isArray(n),r=0;for(n=i?n:n[Symbol.iterator]();;){var o;if(i){if(r>=n.length)break;o=n[r++]}else{if((r=n.next()).done)break;o=r.value}var a=o;e.push(['<li class="item" data-id="',a.id,'">',this.renderNode(a),"</li>"].join(""))}e.push("</ul>")}return e.push("</div>"),e.join("")},t.prototype.mapNodes=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=null;if(t&&t.length){i=[];var r=t,o=Array.isArray(r),a=0;for(r=o?r:r[Symbol.iterator]();;){var s;if(o){if(a>=r.length)break;s=r[a++]}else{if((a=r.next()).done)break;s=a.value}var c=s,l=e.length;e.push(void 0);var h={id:l,title:this.getTitle(c),level:n,item:c,minimized:!0,children:this.mapNodes(this.getItems(c),e,n+1)};i.push(h),e[l]=h}}return i},t}();e.default=o},function(t,e,n){e.__esModule=!0;var i=n(0);var r=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}return t.getWebGLErrorMessage=function(){var e=document.createElement("div");return e.id="webgl-error-message",e.style.fontFamily="monospace",e.style.fontSize="13px",e.style.fontWeight="normal",e.style.textAlign="center",e.style.background="#fff",e.style.color="#000",e.style.padding="1.5em",e.style.width="400px",e.style.margin="5em auto 0",t.webgl||(e.innerHTML=window.WebGLRenderingContext?['Your graphics card does not seem to support <a href="http://khronos.org/webgl/wiki/Getting_a_WebGL_Implementation" style="color:#000">WebGL</a>.<br />','Find out how to get it <a href="http://get.webgl.org/" style="color:#000">here</a>.'].join("\n"):['Your browser does not seem to support <a href="http://khronos.org/webgl/wiki/Getting_a_WebGL_Implementation" style="color:#000">WebGL</a>.<br/>','Find out how to get it <a href="http://get.webgl.org/" style="color:#000">here</a>.'].join("\n")),e},t.addGetWebGLMessage=function(e){var n,r=void 0;r=(e=e||{}).parent||(0,i.$)(document.body),e.id,n=t.getWebGLErrorMessage(),r.append(n)},t}();r.canvas=!!window.CanvasRenderingContext2D,r.webgl=function(){try{var t=document.createElement("canvas");return!(!window.WebGLRenderingContext||!t.getContext("webgl")&&!t.getContext("experimental-webgl"))}catch(t){return!1}}(),r.workers=!!window.Worker,r.fileapi=window.File&&window.FileReader&&window.FileList&&window.Blob,e.default=r},function(t,e,n){e.__esModule=!0;var i=n(0);function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var o=function(){function t(e,n){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:document.body;r(this,t),this.jFrame=e,this.wnd=e[0].contentWindow,this.doc=e[0].contentDocument,this.element=n||doc.body,this.bElement=o,this.resendProperties=this.getDefaultResendProperties(),this.undefinedProperties=this.getDefaultUndefinedProperties(),this.cursors=[],this.onDocChangeClbs=[];for(var a=[{find:":hover",replace:"."+t.HOVER},{find:":active",replace:"."+t.ACTIVE}],s=['<style type="text/css">'],c=0;c<this.doc.styleSheets.length;++c)for(var l=this.doc.styleSheets[c],h=0;h<l.cssRules.length;++h){var u=l.cssRules[h],d=void 0,p=a,f=Array.isArray(p),m=0;for(p=f?p:p[Symbol.iterator]();;){var g;if(f){if(m>=p.length)break;g=p[m++]}else{if((m=p.next()).done)break;g=m.value}var v=g;~u.selectorText.indexOf(v.find)&&(d=(d||u.cssText).replace(new RegExp(v.find,"g"),v.replace))}d&&s.push(d)}s.push("</style>"),(0,i.$)(this.doc.head).append((0,i.$)(s.join("")))}return t.prototype.convertCoords=function(t,e){var n=(0,i.$)(this.element),r=n.offset();return{x:r.left+n.width()*t,y:r.top+n.height()*(1-e)}},t.prototype.triggerEvent=function(t,e,n,r,o){var a={},s=this.resendProperties,c=Array.isArray(s),l=0;for(s=c?s:s[Symbol.iterator]();;){var h;if(c){if(l>=s.length)break;h=s[l++]}else{if((l=s.next()).done)break;h=l.value}var u=h;a[u]=e[u]}var d=this.undefinedProperties,p=Array.isArray(d),f=0;for(d=p?d:d[Symbol.iterator]();;){var m;if(p){if(f>=d.length)break;m=d[f++]}else{if((f=d.next()).done)break;m=f.value}a[m]=void 0}for(var g in o)o.hasOwnProperty(g)&&(a[g]=o[g]);a.view=this.wnd,a.pageX=n.x,a.pageY=n.y;var v=i.$.Event(r,a);v.timeStamp=e.timeStamp,(0,i.$)(t).trigger(v)},t.prototype.addClass=function(t,e){(0,i.$)(t).addClass(e);var n=this.wnd.getComputedStyle(t);this.cursors.push((0,i.$)(this.bElement).css("cursor")),(0,i.$)(this.bElement).css("cursor",n.getPropertyValue("cursor"))},t.prototype.removeClass=function(t,e){(0,i.$)(t).removeClass(e),(0,i.$)(this.bElement).css("cursor",this.cursors.pop())},t.prototype.enterElement=function(e){this.addClass(e,t.HOVER)},t.prototype.leaveElement=function(e){this.removeClass(e,t.HOVER)},t.prototype.activateElement=function(e){this.addClass(e,t.ACTIVE)},t.prototype.deactivateElement=function(e){this.removeClass(e,t.ACTIVE)},t.prototype.addDocChangeClb=function(t){this.onDocChangeClbs.push(t)},t.prototype.notify=function(){var t=this.onDocChangeClbs,e=Array.isArray(t),n=0;for(t=e?t:t[Symbol.iterator]();;){var i;if(e){if(n>=t.length)break;i=t[n++]}else{if((n=t.next()).done)break;i=n.value}i(this.wnd,this.doc)}},t.prototype.elementFromPoint=function(t){for(var e=this.doc.body,n=!0;n;){n=!1;for(var r=0;r<e.childNodes.length;++r){var o=e.childNodes[r];if(o instanceof this.wnd.Element){var a=(0,i.$)(o),s=a.offset(),c=a.height(),l=a.width();if(t.x>s.left&&t.x<s.left+l&&t.y>s.top&&t.y<s.top+c){e=o,n=!0;break}}}}return e},t.prototype.getElement=function(t){var e=this.jFrame.offset();this.jFrame.offset({left:.5*window.innerWidth-t.x,top:.5*window.innerHeight-t.y});var n=this.doc.elementFromPoint(t.x,t.y);return n||(n=this.doc.elementFromPoint(t.x,t.y)),this.jFrame.offset(e),n||this.elementFromPoint(t)},t.prototype.simulate=function(t,e,n,i){var r=this.convertCoords(n,i),o=e===this.doc?this.getElement(r):void 0,a=void 0!==o,s=!1;switch(t.type){case"mousedown":this.capElement&&(this.deactivateElement(this.capElement),s=!0),this.capElement=o,this.capElement&&(this.activateElement(this.capElement),s=!0);break;case"mouseup":this.capElement&&(this.deactivateElement(this.capElement),s=!0),this.timeStamp=t.timeStamp;break;case"click":a=o&&this.capElement===o&&t.timeStamp===this.timeStamp,this.capElement=void 0;break;case"mouseenter":case"mouseover":case"mousemove":var c=null;this.hovElement!==o&&this.hovElement&&(this.triggerEvent(this.hovElement,t,r,"mouseout",{relatedTarget:o||null}),this.leaveElement(this.hovElement),c=this.hovElement,this.hovElement=void 0,s=!0),!this.hovElement&&o&&(this.triggerEvent(o,t,r,"mouseover",{relatedTarget:c}),this.enterElement(o),this.hovElement=o,s=!0),a=o&&"mousemove"===t.type;break;case"mouseleave":case"mouseout":this.hovElement&&(this.triggerEvent(this.hovElement,t,r,"mouseout",{relatedTarget:t.relatedTarget}),this.leaveElement(this.hovElement),this.hovElement=void 0,s=!0),a=!1}a&&this.triggerEvent(o,t,r,t.type),s&&this.notify()},t.prototype.getDefaultUndefinedProperties=function(){return["clientX","clientY","offsetX","offsetY","screenX","screenY"]},t.prototype.getDefaultResendProperties=function(){return["altKey","bubbles","button","buttons","cancelable","changedTouches","char","charCode","ctrlKey","data","detail","eventPhase","isDefaultPrevented","key","keyCode","metaKey","pointerId","pointerType","shiftKey","targetTouches","touches","which"]},t}();o.HOVER="SIMULATED-HOVER",o.ACTIVE="SIMULATED-ACTIVE",e.default=o},function(t,e){e.__esModule=!0;e.default=function t(e,n,i){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t);var r=this;this.window=e,this.document=n,this.cache=i;var o=function(){return{escape:function(t){return t.replace(/([.*+?^${}()|\[\]\/\\])/g,"\\$1")},parseExtension:e,mimeType:function(t){var n=e(t).toLowerCase();return(i="application/font-woff",{woff:i,woff2:i,ttf:"application/font-truetype",eot:"application/vnd.ms-fontobject",png:"image/png",jpg:"image/jpeg",jpeg:"image/jpeg",gif:"image/gif",tiff:"image/tiff",svg:"image/svg+xml"})[n]||"";var i},dataAsUrl:function(t,e){return["data:",e,";base64,",t].join("")},isDataUrl:function(t){return-1!==t.search(/^(data:)/)},canvasToBlob:function(t){return t.toBlob?new Promise((function(e){t.toBlob(e)})):function(t){return new Promise((function(e){for(var n=r.window.atob(t.toDataURL().split(",")[1]),i=n.length,o=new r.window.Uint8Array(i),a=0;a<i;a++)o[a]=n.charCodeAt(a);e(new r.window.Blob([o],{type:"image/png"}))}))}(t)},resolveUrl:function(t,e){var n=r.document.implementation.createHTMLDocument(),i=n.createElement("base");n.head.appendChild(i);var o=n.createElement("a");return n.body.appendChild(o),i.href=e,o.href=t,o.href},getAndEncode:function(t){var e=r.cache.get(t);if(e)return e.content?e.content:new Promise((function(t){e.content?t(e.content):e.pendings.push(t)}));e=r.cache.put(t,{pendings:[]});return new Promise((function(n){var i=new r.window.XMLHttpRequest;function o(t){console.error(t),n("")}i.onreadystatechange=function(){if(4!==i.readyState)return;if(200!==i.status)return void o("cannot fetch resource: "+t+", status: "+i.status);var a=new r.window.FileReader;a.onloadend=function(){e.content=a.result.split(/,/)[1];var t=e.pendings,i=Array.isArray(t),r=0;for(t=i?t:t[Symbol.iterator]();;){var o;if(i){if(r>=t.length)break;o=t[r++]}else{if((r=t.next()).done)break;o=r.value}o(e.content)}e.pendings=[],n(e.content)},a.readAsDataURL(i.response)},i.ontimeout=function(){o("timeout of 30000ms occured while fetching resource: "+t)},i.responseType="blob",i.timeout=3e4,i.open("GET",t,!0),i.send()}))},uid:(t=0,function(){return"u"+("0000"+(r.window.Math.random()*r.window.Math.pow(36,4)<<0).toString(36)).slice(-4)+t++}),delay:function(t){return function(e){return new Promise((function(n){setTimeout((function(){n(e)}),t)}))}},asArray:function(t){for(var e=[],n=t.length,i=0;i<n;i++)e.push(t[i]);return e},escapeXhtml:function(t){return t.replace(/(#|\n)/g,(function(t){return"#"===t?"%23":"%0A"}))},makeImage:function(t){return new Promise((function(e,n){var i=new r.window.Image;i.onload=function(){e(i)},i.onerror=n,i.src=t}))},width:function(t){var e=n(t,"border-left-width"),i=n(t,"border-right-width");return t.scrollWidth+e+i},height:function(t){var e=n(t,"border-top-width"),i=n(t,"border-bottom-width");return t.scrollHeight+e+i},isElement:function(t){return t instanceof r.window.Element},isCanvas:function(t){return t instanceof r.window.HTMLCanvasElement},isTextArea:function(t){return t instanceof r.window.HTMLTextAreaElement},isInput:function(t){return t instanceof r.window.HTMLInputElement},isSVG:function(t){return t instanceof r.window.SVGElement},isSVGRect:function(t){return t instanceof r.window.SVGRectElement},isImage:function(t){return t instanceof r.window.HTMLImageElement}};var t;function e(t){var e=/\.([^\.\/]*?)$/g.exec(t);return e?e[1]:""}function n(t,e){var n=r.window.getComputedStyle(t).getPropertyValue(e);return parseFloat(n.replace("px",""))}}(),a=function(){var t=/url\(['"]?([^'"]+?)['"]?\)/g;return{inlineAll:function(t,r,o){return function(){return!e(t)}()?Promise.resolve(t):Promise.resolve(t).then(n).then((function(e){var n=Promise.resolve(t);return e.forEach((function(t){n=n.then((function(e){return i(e,t,r,o)}))})),n}))},shouldProcess:e,impl:{readUrls:n,inline:i}};function e(e){return-1!==e.search(t)}function n(e){for(var n=[],i=void 0;null!==(i=t.exec(e));)n.push(i[1]);return n.filter((function(t){return!o.isDataUrl(t)}))}function i(t,e,n,i){return Promise.resolve(e).then((function(t){return n?o.resolveUrl(t,n):t})).then(i||o.getAndEncode).then((function(t){return o.dataAsUrl(t,o.mimeType(e))})).then((function(n){return t.replace(function(t){return new r.window.RegExp(["(url\\(['\"]?)(",o.escape(t),")(['\"]?\\))"].join(""),"g")}(e),["$1",n,"$3"].join(""))}))}}(),s=function(){return{resolveAll:function(){return t(r.document).then((function(t){return Promise.all(t.map((function(t){return t.resolve()})))})).then((function(t){return t.join("\n")}))},impl:{readAll:t}};function t(){return Promise.resolve(o.asArray(r.document.styleSheets)).then((function(t){var e=[];return t.forEach((function(t){try{o.asArray(t.cssRules||[]).forEach(e.push.bind(e))}catch(e){console.log("Error while reading CSS rules from "+t.href,e.toString())}})),e})).then((function(t){return t.filter((function(t){return t.type===CSSRule.FONT_FACE_RULE})).filter((function(t){return a.shouldProcess(t.style.getPropertyValue("src"))}))})).then((function(e){return e.map(t)}));function t(t){return{resolve:function(){var e=(t.parentStyleSheet||{}).href;return a.inlineAll(t.cssText,e)},src:function(){return t.style.getPropertyValue("src")}}}}}(),c=function(){return{inlineAll:function e(n){return o.isElement(n)?function(t){var e=t.style.getPropertyValue("background");return e?a.inlineAll(e).then((function(e){t.style.setProperty("background",e,t.style.getPropertyPriority("background"))})).then((function(){return t})):Promise.resolve(t)}(n).then((function(){return o.isImage(n)?t(n).inline():Promise.all(o.asArray(n.childNodes).map((function(t){return e(t)})))})):Promise.resolve(n)},impl:{newImage:t}};function t(t){return{inline:function(e){return o.isDataUrl(t.src)?Promise.resolve():Promise.resolve(t.src).then(e||o.getAndEncode).then((function(e){return o.dataAsUrl(e,o.mimeType(t.src))})).then((function(e){return new Promise((function(n,i){t.onload=n,t.onerror=i,t.src=e}))}))}}}}();function l(t,e){return e=e||{},Promise.resolve(t).then((function(t){return function t(e,n,i){return i||!n||n(e)?Promise.resolve(e).then((function(t){return o.isCanvas(t)?o.makeImage(t.toDataURL()):t.cloneNode(!1)})).then((function(t){return a(e,t,n)})).then((function(t){return function(t,e){return o.isElement(e)?Promise.resolve().then(n).then(i).then(a).then(s).then((function(){return e})):e;function n(){var n,i;n=r.window.getComputedStyle(t),i=e.style,n.cssText?i.cssText=n.cssText:function(t,e){o.asArray(t).forEach((function(n){e.setProperty(n,t.getPropertyValue(n),t.getPropertyPriority(n))}))}(n,i)}function i(){[":before",":after"].forEach((function(n){!function(n){var i=r.window.getComputedStyle(t,n),a=i.getPropertyValue("content");if(""===a||"none"===a)return;var s=o.uid();e.className=e.className+" "+s;var c=r.document.createElement("style");c.appendChild(function(t,e,n){var i="."+t+":"+e,a=n.cssText?function(t){var e=t.getPropertyValue("content");return t.cssText+" content: "+e+";"}(n):function(t){return o.asArray(t).map((function(e){return e+": "+t.getPropertyValue(e)+(t.getPropertyPriority(e)?" !important":"")})).join("; ")+";"}(n);return r.document.createTextNode(i+"{"+a+"}")}(s,n,i)),e.appendChild(c)}(n)}))}function a(){o.isTextArea(t)&&(e.innerHTML=t.value),o.isInput(t)&&e.setAttribute("value",t.value)}function s(){o.isSVG(e)&&(e.setAttribute("xmlns","http://www.w3.org/2000/svg"),o.isSVGRect(e)&&["width","height"].forEach((function(t){var n=e.getAttribute(t);n&&e.style.setProperty(t,n)})))}}(e,t)})):Promise.resolve();function a(e,n,i){var r=e.childNodes;return 0===r.length?Promise.resolve(n):a(n,o.asArray(r),i).then((function(){return n}));function a(e,n,i){var r=Promise.resolve();return n.forEach((function(n){r=r.then((function(){return t(n,i)})).then((function(t){t&&e.appendChild(t)}))})),r}}}(t,e.filter,!0)})).then(u).then(d).then((function(t){e.bgcolor&&(t.style.backgroundColor=e.bgcolor);e.width&&(t.style.width=e.width+"px");e.height&&(t.style.height=e.height+"px");e.style&&r.window.Object.keys(e.style).forEach((function(n){t.style[n]=e.style[n]}));return t})).then((function(n){return function(t,e,n){return Promise.resolve(t).then((function(t){return t.setAttribute("xmlns","http://www.w3.org/1999/xhtml"),(new r.window.XMLSerializer).serializeToString(t)})).then(o.escapeXhtml).then((function(t){return["data:image/svg+xml;charset=utf-8,",'<svg xmlns="http://www.w3.org/2000/svg" width="',e,'" height="',n,'">','<foreignObject x="0" y="0" width="100%" height="100%">',t,"</foreignObject>","</svg>"].join("")}))}(n,e.width||o.width(t),e.height||o.height(t))}))}function h(t,e){return l(t,e).then(o.makeImage).then(o.delay(100)).then((function(n){var i=function(t){var n=r.document.createElement("canvas");if(n.width=e.width||o.width(t),n.height=e.height||o.height(t),e.bgcolor){var i=n.getContext("2d");i.fillStyle=e.bgcolor,i.fillRect(0,0,n.width,n.height)}return n}(t);return i.getContext("2d").drawImage(n,0,0),i}))}function u(t){return s.resolveAll().then((function(e){var n=r.document.createElement("style");return t.appendChild(n),n.appendChild(r.document.createTextNode(e)),t}))}function d(t){return c.inlineAll(t).then((function(){return t}))}this.toSvg=l,this.toPng=function(t,e){return h(t,e||{}).then((function(t){return t.toDataURL()}))},this.toJpeg=function(t,e){return h(t,e=e||{}).then((function(t){return t.toDataURL("image/jpeg",e.quality||1)}))},this.toBlob=function(t,e){return h(t,e||{}).then(o.canvasToBlob)},this.toPixelData=function(t,e){return h(t,e||{}).then((function(e){return e.getContext("2d").getImageData(0,0,o.width(t),o.height(t)).data}))},this.impl={fontFaces:s,images:c,util:o,inliner:a}}},function(t,e,n){e.__esModule=!0;var i=n(0);var r=function(){function t(e,n,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.wnd=e,this.doc=n,this.visual=r,this.coords=new i.THREE.Vector2,this.intersection=new i.THREE.Vector3,this.raycaster=this.visual.raycaster,this.camera=this.visual.camera,this.plane=new i.THREE.Plane,this.threes=[],this.selected=null,this.enabled=!0,this.controlsState=this.visual.getControlsState(),this.element=this.visual.element,this.binds={onMouseMove:this.onMouseMove.bind(this),onMouseDown:this.onMouseDown.bind(this),onMouseUp:this.onMouseUp.bind(this)},(0,i.$)(this.element).on("mousemove",this.binds.onMouseMove),(0,i.$)(this.element).on("mousedown",this.binds.onMouseDown),(0,i.$)(this.doc).on("mouseup",this.binds.onMouseUp)}return t.prototype.addThree=function(t){this.threes.push(t)},t.prototype.removeThree=function(t){var e=this.threes.indexOf(t);~e&&this.threes.splice(e,1)},t.prototype.onPickCallback=function(){return!0},t.prototype.onDragCallback=function(){return!0},t.prototype.onReleaseCallback=function(){},t.prototype.dispose=function(){(0,i.$)(this.element).off("mousemove",this.binds.onMouseMove),(0,i.$)(this.element).off("mousedown",this.binds.onMouseDown),(0,i.$)(this.doc).off("mouseup",this.binds.onMouseUp)},t.prototype.setCoordsFromEvent=function(t){var e=(0,i.$)(this.element),n=e.offset();return this.coords.x=(t.pageX-n.left)/e.width()*2-1,this.coords.y=-(t.pageY-n.top)/e.height()*2+1,this.coords},t.prototype.onMouseDown=function(t){if(this.enabled){this.selected&&this.onMouseUp(t),this.setCoordsFromEvent(t),this.raycaster.setFromCamera(this.coords,this.camera);var e=this.raycaster.intersectObjects(this.threes);if(e.length>0){var n=e[0].object;if(!this.onPickCallback(e[0]))return;var i=e[0].point.clone();this.distance=i.sub(this.raycaster.ray.origin).length(),this.controlsState=this.visual.getControlsState(),this.visual.setControlsState(!1),this.plane.setFromNormalAndCoplanarPoint(this.visual.camera.getWorldDirection(this.plane.normal),e[0].point),this.selected=n}}},t.prototype.onMouseMove=function(t){this.enabled&&(t.preventDefault(),this.selected&&(this.setCoordsFromEvent(t),this.raycaster.setFromCamera(this.coords,this.camera),this.raycaster.ray.intersectPlane(this.plane,this.intersection)&&(this.onDragCallback(this.intersection)||this.onMouseUp(t))))},t.prototype.onMouseUp=function(t){this.selected&&(this.onReleaseCallback(),this.selected=null,this.visual.setControlsState(this.controlsState)),this.enabled&&t.preventDefault()},t}();e.default=r},function(t,e,n){e.__esModule=!0;var i=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},r=n(0);n(71)(r.$);var o=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.actions=n||{},this.element=e,this.doc=e[0].ownerDocument,this.wnd=this.doc.defaultView,this.enabled=!0,this.binds={contextMenu:this.contextMenu.bind(this),mouseDown:this.mouseDown.bind(this),mouseMove:this.mouseMove.bind(this),mouseUp:this.mouseUp.bind(this),mouseWheel:this.mouseWheel.bind(this),mouseMoveDoc:this.mouseMoveDoc.bind(this),mouseUpDoc:this.mouseUpDoc.bind(this),click:this.click.bind(this),dblclick:this.dblclick.bind(this),touchStart:this.touchStart.bind(this),touchMove:this.touchMove.bind(this),touchEnd:this.touchEnd.bind(this),keyDown:this.keyDown.bind(this),keyPress:this.keyPress.bind(this),keyUp:this.keyUp.bind(this)},this.element.on("contextmenu",this.binds.contextMenu),this.element.on("mousedown",this.binds.mouseDown),this.element.on("mousemove",this.binds.mouseMove),this.element.on("mouseup",this.binds.mouseUp),this.element.on("mousewheel",this.binds.mouseWheel),(0,r.$)(this.doc).on("mousemove",this.binds.mouseMoveDoc),(0,r.$)(this.doc).on("mouseup",this.binds.mouseUpDoc),this.element.on("click",this.binds.click),this.element.on("dblclick",this.binds.dblclick),this.element.on("touchstart",this.binds.touchStart),this.element.on("touchmove",this.binds.touchMove),this.element.on("touchend",this.binds.touchEnd),(0,r.$)(this.wnd).on("keydown",this.binds.keyDown),(0,r.$)(this.wnd).on("keypress",this.binds.keyPress),(0,r.$)(this.wnd).on("keyup",this.binds.keyUp)}return t.getEventFlags=function(t){return t.ctrlKey<<0|t.shiftKey<<1|t.altKey<<2},t.getPosition=function(t){var e=void 0,n=void 0;return 2===t.length?(e=t[1].pageX-t[0].pageX,n=t[1].pageY-t[0].pageY,n=-Math.sqrt(e*e+n*n),e=0):(e=t[0].pageX,n=t[0].pageY),{x:e,y:n}},t.prototype.addAction=function(t,e,n,i){e=e.toLowerCase(),this.actions[e]||(this.actions[e]={}),this.actions[e][n]||(this.actions[e][n]={}),this.actions[e][n][i]||(this.actions[e][n][i]=[]),this.actions[e][n][i].push(t)},t.prototype.getActions=function(t,e,n){return((this.actions[t]||{})[e]||{})[n]||[]},t.prototype.fireActions=function(t,e,n){var i=t,r=Array.isArray(i),o=0;for(i=r?i:i[Symbol.iterator]();;){var a;if(r){if(o>=i.length)break;a=i[o++]}else{if((o=i.next()).done)break;a=o.value}a(e,n)}},t.prototype.contextMenu=function(e){if(this.enabled){var n=t.getEventFlags(e);this.fireActions(this.getActions("contextmenu",e.button,n),e)}},t.prototype.mouseDown=function(e){if(this.picked&&this.mouseUpDoc(),this.enabled){var n=t.getEventFlags(e);this.fireActions(this.getActions("mousedown",e.button,n),e),this.picked={x:e.pageX,y:e.pageY,actions:this.getActions("mousedrag",e.button,n)},this.fireActions(this.picked.actions,e,{state:"start"})}},t.prototype.mouseMove=function(e){if(this.enabled){var n=t.getEventFlags(e);this.fireActions(this.getActions("mousemove",e.button,n),e)}},t.prototype.mouseMoveDoc=function(t){this.enabled&&this.picked&&(this.fireActions(this.picked.actions,t,{state:"move",dx:t.pageX-this.picked.x,dy:t.pageY-this.picked.y}),this.picked={x:t.pageX,y:t.pageY,actions:this.picked.actions})},t.prototype.mouseUp=function(e){if(this.enabled){var n=t.getEventFlags(e);this.fireActions(this.getActions("mouseup",e.button,n),e)}},t.prototype.mouseUpDoc=function(t){this.picked&&(this.fireActions(this.picked.actions,t,{state:"end"}),delete this.picked)},t.prototype.mouseWheel=function(e){if(this.enabled){var n=t.getEventFlags(e);this.fireActions(this.getActions("mousewheel",0,n),e)}},t.prototype.clicks=function(e,n){if(this.enabled){var i=t.getEventFlags(e);this.fireActions(this.getActions(n,e.button,i),e)}},t.prototype.click=function(t){this.clicks(t,"click")},t.prototype.dblclick=function(t){this.clicks(t,"dblclick")},t.prototype.touchPick=function(e,n,r){this.touchPicked=i({},t.getPosition(r),{actions:this.getActions("touchdrag",r.length,n),code:r.length,flags:n}),this.fireActions(this.touchPicked.actions,e,{state:"start"})},t.prototype.touchStart=function(e){if(this.touchPicked&&this.touchEnd(e),this.enabled){var n=t.getEventFlags(e),i=e.touches||e.originalEvent.touches;this.fireActions(this.getActions("touchstart",i.length,n),e),this.touchPick(e,n,i)}},t.prototype.touchMove=function(e){if(this.enabled){var n=t.getEventFlags(e),r=e.touches||e.originalEvent.touches;if(this.fireActions(this.getActions("touchmove",r.length,n),e),this.touchPicked)if(this.touchPicked.code===r.length&&this.touchPicked.flags===n){var o=t.getPosition(r);this.fireActions(this.touchPicked.actions,e,{state:"move",dx:o.x-this.touchPicked.x,dy:o.y-this.touchPicked.y}),this.touchPicked=i({},this.touchPicked,o)}else this.touchEnd(e),this.touchPick(e,n,r)}},t.prototype.touchEnd=function(t){this.touchPicked&&(this.fireActions(this.touchPicked.actions,t,{state:"end"}),delete this.touchPicked)},t.prototype.key=function(e,n){if(this.enabled){var i=t.getEventFlags(e);this.fireActions(this.getActions(n,e.keyCode,i),e)}},t.prototype.keyDown=function(t){this.key(t,"keydown")},t.prototype.keyPress=function(t){this.key(t,"keypress")},t.prototype.keyUp=function(t){this.key(t,"keyup")},t.prototype.dispose=function(){this.element.off("contextmenu",this.binds.contextMenu),this.element.off("mousedown",this.binds.mouseDown),this.element.off("mousemove",this.binds.mouseMove),this.element.off("mouseup",this.binds.mouseUp),this.element.off("mousewheel",this.binds.mouseWheel),(0,r.$)(this.doc).off("mousemove",this.binds.mouseMoveDoc),(0,r.$)(this.doc).off("mouseup",this.binds.mouseUpDoc),this.element.off("click",this.binds.click),this.element.off("dblclick",this.binds.dblclick),this.element.off("touchstart",this.binds.touchStart),this.element.off("touchmove",this.binds.touchMove),this.element.off("touchend",this.binds.touchEnd),(0,r.$)(this.wnd).off("keydown",this.binds.keyDown),(0,r.$)(this.wnd).off("keypress",this.binds.keyPress),(0,r.$)(this.wnd).off("keyup",this.binds.keyUp)},t}();o.modKeys={Ctrl:1,Shift:2,Alt:4},o.mouseButtons={Left:0,Middle:1,Right:2},e.default=o},function(t,e){e.__esModule=!0;var n=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}return t.available=function(){return t._hasWebkitFullScreen||t._hasMozFullScreen||t._hasMsFullscreen},t.activated=function(){return t._hasWebkitFullScreen?document.webkitIsFullScreen:t._hasMozFullScreen?document.mozFullScreen:t._hasMsFullscreen?!!document.msFullscreenElement:void console.assert(!1)},t.addEventListener=function(t,e){t.addEventListener&&(t.addEventListener("webkitfullscreenchange",e,!1),t.addEventListener("mozfullscreenchange",e,!1),t.addEventListener("fullscreenchange",e,!1),t.addEventListener("MSFullscreenChange",e,!1))},t.removeEventListener=function(t,e){t.removeEventListener&&(t.removeEventListener("webkitfullscreenchange",e,!1),t.removeEventListener("mozfullscreenchange",e,!1),t.removeEventListener("fullscreenchange",e,!1),t.removeEventListener("MSFullscreenChange",e,!1))},t.request=function(e){e=e||document.body,t._hasWebkitFullScreen?e.webkitRequestFullScreen():t._hasMozFullScreen?e.mozRequestFullScreen():t._hasMsFullscreen?e.msRequestFullscreen():console.assert(!1)},t.cancel=function(){t._hasWebkitFullScreen?document.webkitCancelFullScreen():t._hasMozFullScreen?document.mozCancelFullScreen():t._hasMsFullscreen?document.msExitFullscreen():console.assert(!1)},t}();n._hasWebkitFullScreen=!!document.webkitCancelFullScreen,n._hasMozFullScreen=!!document.mozCancelFullScreen,n._hasMsFullscreen=!!document.documentElement.msRequestFullscreen,e.default=n},function(t,e,n){e.__esModule=!0;var i=n(0),r=c(n(5)),o=c(n(2)),a=c(n(47)),s=c(n(46));function c(t){return t&&t.__esModule?t:{default:t}}var l=function(t){function e(n,r,c,l,h,u,d){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var p=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==(void 0===e?"undefined":_typeof2(e))&&"function"!=typeof e?t:e}(this,t.call(this,n,r,c,l));p.iId="i"+o.default.getUnique();var f=(0,i.$)('<iframe id="'+p.iId+'" src="'+h+'" style="position: fixed; left: -1000px;"></iframe>');return(0,i.$)(p.doc.body).append(f),p.frame=f[0],p.binds={},d&&d(p.frame.contentWindow),p.doc.implementation.hasFeature("www.http://w3.org/TR/SVG11/feature#Extensibility","1.1")&&(p.image=new Image,p.binds.imageLoad=function(){p.renderImage(p.image),p.finishRender()},(0,i.$)(p.image).on("load",p.binds.imageLoad),p.svgRender=new a.default(p.frame.contentWindow,p.frame.contentDocument,u)),p.binds.frameLoad=function(){~p.frame.contentDocument.title.indexOf("404")?(p.startRender=function(){p.renderNotFoundPage(),p.finishRender()},p.finishLoad()):setTimeout((function(){p.frame&&(p.width=(0,i.$)(p.frame.contentDocument.body).width(),p.height=(0,i.$)(p.frame.contentDocument.body).height(),f.css("width",p.width+"px").css("height",p.height+"px"),f.offset({left:-p.width-100,top:0}),p.svgRender&&(p.simulator=new s.default(f,p.frame.contentDocument.body,p.element),p.simulator.addDocChangeClb(p.finishLoad.bind(p))),p.startRender=function(){p.render()},p.finishLoad())}),500)},(0,i.$)(p.frame.contentWindow).on("load",p.binds.frameLoad),p}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+(void 0===e?"undefined":_typeof2(e)));t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.getSimulatedDoc=function(){return this.frame.contentDocument},e.prototype.render=function(){var t=this;this.svgRender?this.svgRender.toSvg(this.simulator.element,{height:this.height+"px",width:this.width+"px"}).then((function(e){t.image.src=e})).catch((function(e){console.error("Dom2Image: ",e),t.renderBlankPage(),t.finishRender()})):(0,i.html2canvas)(this.frame.contentDocument.body,{timeout:3e4}).then((function(e){t.renderImage(e),t.finishRender()}))},e.prototype.dispose=function(){(0,i.$)(this.image).off("load",this.binds.imageLoad),(0,i.$)(this.frame.contentWindow).off("load",this.binds.frameLoad),(0,i.$)(this.doc.body).find("#"+this.iId).remove(),this.image&&(this.image.src="",delete this.image),this.frame.src="",delete this.frame,t.prototype.dispose.call(this)},e.prototype.simulate=function(t,e,n,i){this.simulator&&this.simulator.simulate(t,e,n,i)},e}(r.default);e.default=l},function(t,e,n){e.__esModule=!0;var i=n(0),r=a(n(7)),o=a(n(3));function a(t){return t&&t.__esModule?t:{default:t}}var s=function(){function t(e,n,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t);var o=(0,i.$)('<canvas width="'+e+'" height="'+n+'"></canvas>');this.c=o[0],this.p={g:9.8,dt:1/60,color:r,updateInterval:.25},this.ctx=this.c.getContext("2d"),this.os=[-2,Math.PI/2],this.t=this.p.updateInterval}return t.prototype.dy=function(t,e){var n=e[0],i=e[1];return[-this.g*Math.cos(i),n]},t.prototype.integrate=function(t){for(var e=0,n=this.p.dt,i=this.os;e<t;)e+n>t&&(n=t-e),i=o.default.rk4(this.dy.bind({g:this.p.g}),0,n,i),e+=n;return i},t.prototype.calcTimeTo=function(t){for(var e=0,n=this.p.dt,i=this.os;Math.abs(i[1]-t)>1e-4;){var r=o.default.rk4(this.dy.bind({g:this.p.g}),0,n,i);r[0]<0&&r[1]<t||r[0]>0&&r[1]>t?n/=2:(i=r,e+=n)}return e},t.prototype.update=function(t){if(this.os=this.integrate(t),this.t+=t,this.t>=this.p.updateInterval){this.t=0;var e=.06*Math.min(this.c.width,this.c.height),n=this.os[1],o=.5*this.c.width,a=.5*this.c.height,s=this.ctx;s.clearRect(0,0,this.c.width,this.c.height),s.beginPath(),s.fillStyle=r.default.color2Rgba(this.p.color,1),s.rect(0,0,this.c.width,this.c.height),s.fill(),s.beginPath(),s.shadowBlur=50,s.fillStyle=r.default.color2Rgba(r.default.inverseColor(this.p.color,.9),Math.abs(this.os[0]/6.36)),s.shadowColor=r.default.color2Rgba(r.default.inverseColor(this.p.color,1),.9),s.shadowOffsetX=0,s.shadowOffsetY=0,s.font="bold "+Math.round(.25*e)+"px Arial",s.textAlign="center",s.textBaseline="middle",s.fillText((0,i.tr)("Loading..."),o,a);var c=2*Math.PI/10;s.shadowColor=r.default.color2Rgba(r.default.inverseColor(this.p.color,1),.7);for(var l=0,h=n,u=.2*e;l<10;++l,u*=.9,h+=c){s.beginPath(),s.fillStyle=r.default.color2Rgba(r.default.inverseColor(this.p.color,(10-l)/10),.7*(10-l)/10);var d=o+e*Math.cos(h),p=a-e*Math.sin(h),f=o+e*Math.cos(h+c),m=a-e*Math.sin(h+c);s.shadowOffsetX=.2*(f-d),s.shadowOffsetY=.2*(m-p),s.arc(d,p,u,0,2*Math.PI,1),s.fill()}this.onChange&&this.onChange(this.c,this.p.color)}},t.prototype.getImage=function(){return this.c},t.prototype.dispose=function(){this.c.width=0,this.c.height=0,delete this.ctx,delete this.c},t.prototype.createSprite=function(t){var e=(0,i.$)('<canvas width="'+this.c.width*t+'" height="'+this.c.height+'"></canvas>')[0],n=e.getContext("2d"),r=this.calcTimeTo(this.os[1]+2*Math.sign(this.os[0])*Math.PI)/(t+1),o=this.p.updateInterval;this.p.updateInterval=0;for(var a=0;a<t;++a)this.update(r),n.drawImage(this.c,a*this.c.width,0);return this.p.updateInterval=o,e},t}();e.default=s},function(t,e,n){e.__esModule=!0;n(0);function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var r=function(){function t(e){var n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0;i(this,t),this.view=e,this.progress=0,this.showProgress=n,this.getLoadingMsg=r||t.defaultLoadingMsg,this.updateView()}return t.defaultLoadingMsg=function(t){return["Please wait... the Application is Loading: ",t,"%"].join("")},t.prototype.dispose=function(){this.showProgress=!1,this.updateView(),delete this.view},t.prototype.setProgress=function(t){this.progress=t,this.updateView()},t.prototype.updateView=function(){if(this.view){this.view.setState("widLoadingProgress",{enable:!0,visible:this.showProgress,active:!1}),this.view.setState("txtLoadingProgress",{value:this.getLoadingMsg(this.progress),visible:!0});var t=this.view.getLinks(),e=Array.isArray(t),n=0;for(t=e?t:t[Symbol.iterator]();;){var i;if(e){if(n>=t.length)break;i=t[n++]}else{if((n=t.next()).done)break;i=n.value}var r=i;this.view.setState(r,{enable:!1,visible:!0,active:!1})}this.view.setState("inpPages",{visible:!0,value:""}),this.view.setState("inpPage",{visible:!0,enable:!1,value:""})}},t}();e.default=r},function(t,e,n){e.__esModule=!0;var i,r=n(0),o=n(6);var a=function(t){function e(n,i,o){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var a=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==(void 0===e?"undefined":_typeof2(e))&&"function"!=typeof e?t:e}(this,t.call(this,n,i));return a.element=o,a.binds={convert:a.convert.bind(a)},(0,r.$)(a.element).on("mousemove mousedown mouseover mouseout click",a.binds.convert),(0,r.$)(a.doc).on("mouseup",a.binds.convert),a}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+(void 0===e?"undefined":_typeof2(e)));t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.dispose=function(){(0,r.$)(this.element).off("mousemove mousedown mouseover mouseout click",this.binds.convert),(0,r.$)(this.doc).off("mouseup",this.binds.convert)},e}(((i=o)&&i.__esModule?i:{default:i}).default);e.default=a},function(t,e,n){e.__esModule=!0;var i,r=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},o=n(0),a=n(3),s=(i=a)&&i.__esModule?i:{default:i};function c(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var l=function(){function t(e,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.testScale;c(this,t),this.visual=e,this.boundBoxClb=n,this.testScale=i,this.camera=e.camera,this.element=this.visual.element,this.elementSize={w:1,h:1},this.devicePixelRatio=this.visual.wnd.devicePixelRatio||1,this.orbit=e.getOrbit(),this.scale=1,this.eps=1e-4,this.v=new o.THREE.Vector3,this.dv=new o.THREE.Vector2,this.enabled=!1,e.addRenderCallback(this.update.bind(this)),this.os={vx:0,vy:0,x:0,y:0},this.orbit.update(),this.camera.updateMatrixWorld();var r=this.computeClientBoundBox(),a=1.11;this.movePan({x:-a*r.mid.x,y:-a*r.mid.y})}return t.prototype.movePan=function(t){this.orbit.pan(t.x*this.visual.width(),-t.y*this.visual.height())},t.prototype.vToCamera=function(t){return t.project(this.camera),{x:.5*t.x,y:.5*t.y}},t.prototype.computeClientBoundBox=function(){var t=this.boundBoxClb(),e=[t.min.x,t.max.x],n=[0,0],i=[t.min.z,t.max.z],r=[],o={max:{},min:{}},a=e,s=Array.isArray(a),c=0;for(a=s?a:a[Symbol.iterator]();;){var l;if(s){if(c>=a.length)break;l=a[c++]}else{if((c=a.next()).done)break;l=c.value}var h=l,u=n,d=Array.isArray(u),p=0;for(u=d?u:u[Symbol.iterator]();;){var f;if(d){if(p>=u.length)break;f=u[p++]}else{if((p=u.next()).done)break;f=p.value}var m=f,g=i,v=Array.isArray(g),y=0;for(g=v?g:g[Symbol.iterator]();;){var b;if(v){if(y>=g.length)break;b=g[y++]}else{if((y=g.next()).done)break;b=y.value}var x=b;r.push(this.vToCamera(this.v.set(h,m,x)))}}}return r.sort((function(t,e){return t.x-e.x})),o.min.x=r[0].x,o.max.x=r[r.length-1].x,r.sort((function(t,e){return t.y-e.y})),o.min.y=r[0].y,o.max.y=r[r.length-1].y,o.width=o.max.x-o.min.x,o.height=o.max.y-o.min.y,o.mid={x:.5*(o.max.x+o.min.x),y:.5*(o.max.y+o.min.y)},o},t.prototype.setObject=function(t){this.boundBoxClb=t},t.prototype.testScale=function(){return!0},t.prototype.computeCorr=function(t,e,n){var i=0;return t<1?e>-.5?i=-.5-e:n<.5&&(i=.5-n):e<-.5?i=-.5-e:n>.5&&(i=.5-n),i},t.prototype.getScale=function(){var t=this.computeClientBoundBox(),e=this.elementSize.w/t.width,n=this.elementSize.h/t.height;return 1/Math.min(e,n)},t.prototype.centerView=function(t){var e=this,n=this.computeClientBoundBox(),i=this.elementSize.w/n.width,o=this.elementSize.h/n.height,a=Math.min(i,o);if(this.testScale()&&Math.abs(1/a-this.scale)>this.eps){var s=1/a+.2*(this.scale-1/a);this.orbit.setScale(this.orbit.getScale()/(a*s)),this.orbit.update(),this.camera.updateMatrixWorld(),n=this.computeClientBoundBox(),i=this.elementSize.w/n.width,o=this.elementSize.h/n.height,a=Math.min(i,o)}var c=this.dv;if(a>1-this.eps?c.set(-n.mid.x,-n.mid.y):c.set(this.computeCorr(i,n.min.x,n.max.x),this.computeCorr(o,n.min.y,n.max.y)),Math.sqrt(this.os.vx*this.os.vx+this.os.vy*this.os.vy)>.003||c.length()>.003){var l=1/60,h=0,u=r({},this.os,{x:0,y:0});for(u.tf=function(t,n,i,r){return{x:75*(c.x-i)/Math.pow(e.devicePixelRatio,1),y:75*(c.y-r)/Math.pow(e.devicePixelRatio,1)}};h<t;)h+l>t&&(l=t-h),u=this.integrate(u,l),h+=l;this.movePan(u),this.os=u}},t.prototype.integrate=function(t,e){var n=s.default.rk4(this.dy.bind(t),0,e,[t.vx,t.vy,t.x,t.y]),i=n[0],o=n[1],a=n[2],c=n[3];return r({},t,{vx:i,vy:o,x:a,y:c})},t.prototype.dy=function(t,e){var n=e[0],i=e[1],r=e[2],o=e[3],a=this.tf(n,i,r,o);return[a.x-15*n,a.y-15*i,n,i]},t.prototype.update=function(t){this.enabled&&this.boundBoxClb&&this.centerView(t)},t}();e.default=l},function(t,e,n){e.__esModule=!0;var i=n(0);var r=function(t){function e(n,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var o,a,s,c,l,h=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==(void 0===e?"undefined":_typeof2(e))&&"function"!=typeof e?t:e}(this,t.call(this));h.object=n,h.domElement=r||document.body,h.enabled=!0,h.target=new i.THREE.Vector3,h.minDistance=0,h.maxDistance=1/0,h.minZoom=0,h.maxZoom=1/0,h.minPolarAngle=0,h.maxPolarAngle=Math.PI,h.minAzimuthAngle=-1/0,h.maxAzimuthAngle=1/0,h.enableDamping=!1,h.dampingFactor=.25,h.enableZoom=!0,h.zoomSpeed=1,h.enableRotate=!0,h.rotateSpeed=1,h.enablePan=!0,h.autoRotate=!1,h.autoRotateSpeed=2,h.target0=h.target.clone(),h.position0=h.object.position.clone(),h.zoom0=h.object.zoom,h.getPolarAngle=function(){return f.phi},h.getAzimuthalAngle=function(){return f.theta},h.reset=function(){u.target.copy(u.target0),u.object.position.copy(u.position0),u.object.zoom=u.zoom0,u.object.updateProjectionMatrix(),u.dispatchEvent(d),u.update()},h.zoomOut=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.zoomSpeed,e=this.zoomSpeed;this.zoomSpeed=t,E(b()),this.zoomSpeed=e},h.zoomIn=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.zoomSpeed,e=this.zoomSpeed;this.zoomSpeed=t,A(b()),this.zoomSpeed=e},h.getScale=function(){return g},h.setScale=function(t){g=t},h.update=(o=new i.THREE.Vector3,a=(new i.THREE.Quaternion).setFromUnitVectors(n.up,new i.THREE.Vector3(0,1,0)),s=a.clone().inverse(),c=new i.THREE.Vector3,l=new i.THREE.Quaternion,function(){var t=u.object.position;return o.copy(t).sub(u.target),o.applyQuaternion(a),f.setFromVector3(o),u.autoRotate&&x(2*Math.PI/60/60*u.autoRotateSpeed),f.theta+=m.theta,f.phi+=m.phi,f.theta=Math.max(u.minAzimuthAngle,Math.min(u.maxAzimuthAngle,f.theta)),f.phi=Math.max(u.minPolarAngle,Math.min(u.maxPolarAngle,f.phi)),f.makeSafe(),f.radius*=g,f.radius=Math.max(u.minDistance,Math.min(u.maxDistance,f.radius)),u.target.add(v),o.setFromSpherical(f),o.applyQuaternion(s),t.copy(u.target).add(o),u.object.lookAt(u.target),!0===u.enableDamping?(m.theta*=1-u.dampingFactor,m.phi*=1-u.dampingFactor):m.set(0,0,0),g=1,v.set(0,0,0),!!(y||c.distanceToSquared(u.object.position)>p||8*(1-l.dot(u.object.quaternion))>p)&&(u.dispatchEvent(d),c.copy(u.object.position),l.copy(u.object.quaternion),y=!1,!0)}),h.dispose=function(){};var u=h,d={type:"change"},p=1e-6,f=new i.THREE.Spherical,m=new i.THREE.Spherical,g=1,v=new i.THREE.Vector3,y=!1;function b(){return Math.pow(.95,u.zoomSpeed)}function x(t){m.theta-=t}var w,_=(w=new i.THREE.Vector3,function(t,e){w.setFromMatrixColumn(e,0),w.multiplyScalar(-t),v.add(w)}),S=function(){var t=new i.THREE.Vector3;return function(e,n){t.setFromMatrixColumn(n,1),t.multiplyScalar(e),v.add(t)}}();function E(t){u.object instanceof i.THREE.PerspectiveCamera?g/=t:u.object instanceof i.THREE.OrthographicCamera?(u.object.zoom=Math.max(u.minZoom,Math.min(u.maxZoom,u.object.zoom*t)),u.object.updateProjectionMatrix(),y=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type-dolly/zoom disabled."),u.enableZoom=!1)}function A(t){u.object instanceof i.THREE.PerspectiveCamera?g*=t:u.object instanceof i.THREE.OrthographicCamera?(u.object.zoom=Math.max(u.minZoom,Math.min(u.maxZoom,u.object.zoom/t)),u.object.updateProjectionMatrix(),y=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type-dolly/zoom disabled."),u.enableZoom=!1)}return u.pan=function(){var t=new i.THREE.Vector3;return function(e,n){var r=u.domElement;if(u.object instanceof i.THREE.PerspectiveCamera){var o=u.object.position;t.copy(o).sub(u.target);var a=t.length();a*=Math.tan(u.object.fov/2*Math.PI/180),_(2*e*a/r.clientHeight,u.object.matrix),S(2*n*a/r.clientHeight,u.object.matrix)}else u.object instanceof i.THREE.OrthographicCamera?(_(e*(u.object.right-u.object.left)/u.object.zoom/r.clientWidth,u.object.matrix),S(n*(u.object.top-u.object.bottom)/u.object.zoom/r.clientHeight,u.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type-pan disabled."),u.enablePan=!1)}}(),h.actions={rotate:function(t,e){if(u.enabled&&u.enableRotate&&"move"===e.state){var n=u.domElement;x(2*Math.PI*e.dx/n.clientWidth*u.rotateSpeed),i=2*Math.PI*e.dy/n.clientHeight*u.rotateSpeed,m.phi-=i,u.update()}var i},pan:function(t,e){u.enabled&&u.enablePan&&"move"===e.state&&(u.pan(e.dx,e.dy),u.update())},offsetDolly:function(t,e){u.enabled&&u.enableZoom&&"move"===e.state&&(e.dy>0?E(b()):e.dy<0&&A(b()),u.update())},wheelDolly:function(t){u.enabled&&u.enableZoom&&(t.deltaY>0?A(b()):t.deltaY<0&&E(b()),u.update())}},h.update(),h}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+(void 0===e?"undefined":_typeof2(e)));t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e}(i.THREE.EventDispatcher);e.default=r},function(t,e,n){e.__esModule=!0;var i=n(0),r=h(n(5)),o=h(n(18)),a=h(n(2)),s=h(n(16)),c=h(n(69)),l=h(n(17));function h(t){return t&&t.__esModule?t:{default:t}}var u=function(t){function e(n,i,r,o,a,s){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var c=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==(void 0===e?"undefined":_typeof2(e))&&"function"!=typeof e?t:e}(this,t.call(this,n,i,r,o));return c.query="",c.n=s,c.pdf=a,c.v={x:0,y:0,z:0,set:function(t,e,n){return this.x=t,this.y=e,this.z=n,this},transform:function(t){var e=t.m[0][0]*this.x+t.m[1][0]*this.y+t.m[2][0]*this.z,n=t.m[0][1]*this.x+t.m[1][1]*this.y+t.m[2][1]*this.z,i=t.m[0][2]*this.x+t.m[0][2]*this.y+t.m[2][0]*this.z;return this.x=e,this.y=n,this.z=i,this}},c.m={m:[[1,0,0],[0,1,0],[0,0,1]],set:function(t,e,n,i,r,o,a,s,c){return this.m=[[t,e,n],[i,r,o],[a,s,c]],this}},c.startRender=function(){c.pdf.getHandler(c.render.bind(c))},Promise.resolve().then((function(){return c.pdf.getHandler(c.init.bind(c))})),c}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+(void 0===e?"undefined":_typeof2(e)));t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.setQuery=function(t){this.query=t.trim(),this.textContent&&this.setHits(this.textContent)},e.prototype.rectSize=function(t){return{width:t[2]-t[0],height:t[3]-t[1]}},e.prototype.createPoly=function(t,e,n){var i=[],r=this.v;return r.set(e.x,e.y,1).transform(t),i.push({x:r.x,y:r.y}),r.set(e.x,e.y+n.height,1).transform(t),i.push({x:r.x,y:r.y}),r.set(e.x+n.width,e.y+n.height,1).transform(t),i.push({x:r.x,y:r.y}),r.set(e.x+n.width,e.y,1).transform(t),i.push({x:r.x,y:r.y}),i},e.prototype.getSimulatedDoc=function(){return this.page},e.prototype.simulate=function(t,e,n,i){this.eventConverter&&this.eventConverter.convert(t,{doc:e,x:n,y:i})},e.prototype.setAnnotations=function(t){var e=this,n=this.viewport.transform,i=[];this.m.set(n[0],n[1],0,n[2],n[3],0,n[4],n[5],1);var r=t,o=Array.isArray(r),a=0;for(r=o?r:r[Symbol.iterator]();;){var l;if(o){if(a>=r.length)break;l=r[a++]}else{if((a=r.next()).done)break;l=a.value}var h=l;if("Link"===h.subtype){var u=h.rect,d={x:u[0],y:u[1]},p=this.rectSize(u),f=new c.default(this.createPoly(this.m,d,p).map((function(t){return{x:t.x/e.viewport.width,y:1-t.y/e.viewport.height}})));f.anno=h,f.callback=this.annoClb.bind(this),i.push(f)}}if(i.length){this.eventConverter=new s.default(this.wnd,this.doc,c.default.test,this.page);var m=i,g=Array.isArray(m),v=0;for(m=g?m:m[Symbol.iterator]();;){var y;if(g){if(v>=m.length)break;y=m[v++]}else{if((v=m.next()).done)break;y=v.value}var b=y;this.eventConverter.addCustom(b)}}},e.prototype.setHits=function(t){this.textContent=t,""!==this.query&&(this.finder=new l.default(t.items.map((function(t){return t.str})),this.query,{contexts:!1}))},e.prototype.renderHits=function(){var t=this;if(this.finder){this.page.view;var e=(0,i.$)('<div style="position: absolute; visibility: hidden;"></div>').appendTo("body"),n=e[0],r=e.offset().left,o=this.finder.getHits(),a=Array.isArray(o),s=0;for(o=a?o:o[Symbol.iterator]();;){var c;if(a){if(s>=o.length)break;c=o[s++]}else{if((s=o.next()).done)break;c=s.value}var l=c,h=this.textContent.items[l.index],u=PDFJS.Util.transform(this.viewport.transform,h.transform),d=this.textContent.styles[h.fontName],p=Math.atan2(u[1],u[0])+(d.vertical?Math.PI/2:0),f=Math.sqrt(u[2]*u[2]+u[3]*u[3]),m=d.ascent?d.ascent*f:d.descent?(1+d.descent)*f:f;e.html(h.str.substr(0,l.offset)+"<span>"+h.str.substr(l.offset,l.length)+"</span>"+h.str.substr(l.offset+l.length)),n.style.fontSize=f+"px",n.style.fontFamily=d.fontFamily;var g=e.find("span"),v=d.vertical?h.height*this.viewport.scale:h.width*this.viewport.scale,y=e.width(),b=(g.offset().left-r)/y;this.m.set(1,0,0,0,1,0,u[4]+m*Math.sin(p),u[5]-m*Math.cos(p),1);var x=this.createPoly(this.m,{x:b*v,y:0},{width:v*g.width()/y,height:g.height()});x=x.map((function(e){return{x:e.x/t.viewport.width,y:1-e.y/t.viewport.height}})),this.renderHit(x)}e.remove()}},e.prototype.annoClb=function(t,e){this.context.dispatchEvent&&this.context.dispatchEvent({type:"pdfAnnotation",event:t,annotation:e.target.anno})},e.prototype.calcViewport=function(){var t=a.default.calcScale(this.size.width,this.size.height,this.resW,this.resH);(!this.viewport||Math.abs(this.viewport.scale-t)>1e-4)&&(this.viewport=this.page.getViewport(t),"full"!==this.type&&("right"===this.type&&(this.viewport.offsetX+=.5*this.viewport.width,this.viewport.transform[4]-=.5*this.viewport.width),this.viewport.width/=2),this.resW=this.width=this.viewport.width,this.resH=this.height=this.viewport.height)},e.prototype.init=function(){var t=this;this.type=this.pdf.getPageType(this.n),this.pdf.getPage(this.n).then((function(e){t.page=e,t.size=o.default.getPageSize(e),"full"!==t.type&&(t.size.width/=2),e.getAnnotations().then(t.setAnnotations.bind(t)),e.getTextContent().then(t.setHits.bind(t)),t.calcViewport(),t.finishLoad()})).catch((function(e){console.error("Cannot load PDF page: "+(t.n+1)),t.finishLoad()}))},e.prototype.setResolution=function(e){t.prototype.setResolution.call(this,e),this.page&&this.calcViewport()},e.prototype.render=function(t){var e=this;this.page?this.page.render({canvasContext:this.pushCtx(),viewport:this.viewport}).then((function(){e.renderHits(),e.popCtx(),e.finishRender()})):(this.renderBlankPage(),this.finishRender())},e}(r.default);e.default=u},function(t,e,n){e.__esModule=!0;var i=n(0);var r=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.container=e,this.pages=n,this.prevResults=[],e.html('\n      <div class="search">\n        <div class="query">\n          <input class="inpQuery" type="text" maxlength="30" value="" />\n        </div>\n        <div class="results">\n        </div>\n        <div class="status">\n\n        </div>\n      </div>\n    '),this.query=e.find(".query input"),this.results=e.find(".results"),this.status=e.find(".status"),this.binds={navigate:this.navigate.bind(this),doQuery:this.doQuery.bind(this)},this.query.on("keydown",this.binds.doQuery),this.results.on("click",this.binds.navigate)}return t.prototype.dispose=function(){this.results.off("click",this.binds.navigate),this.query.off("keydown",this.binds.doQuery)},t.prototype.navigate=function(t){if(t.preventDefault(),void 0!==this.onNavigate){var e=(0,i.$)(t.target);if(!e.hasClass("result")){var n=e.find(".result");if(n.length)e=n;else for(;e.length&&!e.hasClass("result");)e=(0,i.$)(e[0].parentNode)}var r=e.attr("data");void 0!==r&&this.onNavigate(parseInt(r))}},t.prototype.doQuery=function(){var t=this;if(this.onQuery){var e=this.queryStamp=Date.now();setTimeout((function(){e===t.queryStamp&&t.onQuery(t.query[0].value.trim())}),1e3)}},t.prototype.setResults=function(t,e){this.prevResults.length&&t[0]!==this.prevResults[0]&&(this.prevResults=[],this.results.html(""));for(var n=[],r=this.prevResults.length;r<t.length;++r){var o=t[r];n.push('<div class="result" data="'+o.page+'">'),n.push('<a href="#">'),n.push("<div>"+o.contexts.join("</div><div>")+"</div>"),n.push("</a>"),n.push("</div>")}(0,i.$)(n.join("")).appendTo(this.results),this.prevResults=[].concat(t),void 0===e?this.status.html(""):this.status.html(e+" of "+this.pages)},t}();e.default=r},function(t,e,n){e.__esModule=!0;var i=n(0),r=a(n(5)),o=a(n(4));function a(t){return t&&t.__esModule?t:{default:t}}var s=function(t){function e(n,r,a,s,c){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var l=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==(void 0===e?"undefined":_typeof2(e))&&"function"!=typeof e?t:e}(this,t.call(this,n,r,a,s));return l.binds={},l.image=new Image,l.image.crossOrigin="Anonymous",l.binds.imageLoad=function(){l.width=l.image.width,l.height=l.image.height,l.startRender=function(){l.renderImage(l.image),l.finishRender()},l.finishLoad()},l.binds.imageError=function(){l.startRender=function(){l.renderNotFoundPage(),l.finishRender()},l.finishLoad()},(0,i.$)(l.image).on("load",l.binds.imageLoad).on("error",l.binds.imageError),l.image.src=o.default.normalizeUrl(c),l}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+(void 0===e?"undefined":_typeof2(e)));t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.dispose=function(){(0,i.$)(this.image).off("load",this.binds.imageLoad).off("error",this.binds.imageError),this.image.src="",delete this.image,t.prototype.dispose.call(this)},e}(r.default);e.default=s},function(t,e,n){e.__esModule=!0;var i=n(0);var r=function(){function t(e,n,r,o,a){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t);var s=new i.THREE.Texture;s.minFilter=i.THREE.LinearFilter,s.image=e,s.needsUpdate=!0,this.texture=s,this.tilesHorizontal=n,this.tilesVertical=r,this.numberOfTiles=o,s.repeat.set(1/this.tilesHorizontal,1/this.tilesVertical),this.tileDisplayDuration=a,this.currentDisplayTime=0,this.currentTile=0}return t.prototype.update=function(t){for(this.currentDisplayTime+=t;this.currentDisplayTime>this.tileDisplayDuration;){this.currentDisplayTime-=this.tileDisplayDuration,++this.currentTile,this.currentTile==this.numberOfTiles&&(this.currentTile=0);var e=this.currentTile%this.tilesHorizontal;this.texture.offset.x=e/this.tilesHorizontal;var n=Math.floor(this.currentTile/this.tilesHorizontal);this.texture.offset.y=n/this.tilesVertical}},t.prototype.dispose=function(){var t=this.texture.image;t.height=t.width=0,this.texture.dispose()},t}();e.default=r},function(t,e,n){e.__esModule=!0;var i=n(0),r=s(n(4)),o=s(n(54)),a=s(n(19));function s(t){return t&&t.__esModule?t:{default:t}}var c=function(t){function e(n,i,o,s){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var c=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==(void 0===e?"undefined":_typeof2(e))&&"function"!=typeof e?t:e}(this,t.call(this,n,i,o.element));return r.default.extends(c,new a.default(o,s)),c}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+(void 0===e?"undefined":_typeof2(e)));t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.getCallback=function(t){return t.object.userData.mouseCallback},e.prototype.setCoordsFromEvent=function(t){var e=(0,i.$)(this.element),n=e.offset();return this.coords.x=(t.pageX-n.left)/e.width()*2-1,this.coords.y=-(t.pageY-n.top)/e.height()*2+1,this.coords},e}(o.default);e.default=c},function(t,e,n){e.__esModule=!0;var i=n(0),r=s(n(4)),o=s(n(64)),a=s(n(19));function s(t){return t&&t.__esModule?t:{default:t}}var c=function(t){function e(n,i,o,s){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var c=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==(void 0===e?"undefined":_typeof2(e))&&"function"!=typeof e?t:e}(this,t.call(this,n,i,o.element));return r.default.extends(c,new a.default(o,s)),c}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+(void 0===e?"undefined":_typeof2(e)));t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.getCallback=function(t){return t.object.userData.touchCallback},e.prototype.setCoordsFromEvent=function(t){var e=(0,i.$)(this.element),n=e.offset(),r=t.touches||t.originalEvent.touches,o=r.length?r[0]:(this.lastTouches||[{pageX:0,pageY:0}])[0],a=o.pageX,s=o.pageY;return this.lastTouches=r.length?r:this.lastTouches,this.coords.x=(a-n.left)/e.width()*2-1,this.coords.y=-(s-n.top)/e.height()*2+1,this.coords},e}(o.default);e.default=c},function(t,e,n){e.__esModule=!0;var i,r=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},o=n(0),a=n(8),s=(i=a)&&i.__esModule?i:{default:i};function c(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var l=function(){function t(e,n,i,a){var l=this,h=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{kWtoH:210/297};c(this,t),this.container=n,this.p=h,this.thumbnailsClb=i,this.size=a,this.canvas=(0,o.$)("<canvas>")[0],this.imageFactory=new s.default(r({},e,{renderCanvas:this.canvas,renderCanvasCtx:this.canvas.getContext("2d")})),this.thumbnails=[];for(var u=0;u<a;++u){var d=this.thumbnailsClb(u);this.thumbnails.push(r({},d,{index:u,loaded:"thumbnail-image"===d.type,heading:null,thumbnail:null,title:d.title||u}))}this.binds={update:this.update.bind(this),navigate:function(t){if(t.preventDefault(),l.onNavigate){for(var e=t.target;e&&!e.dataThumbnail;)e=e.parentNode;l.onNavigate(e.dataThumbnail.index)}}},this.container.on("scroll",this.binds.update)}return t.prototype.getSize=function(){return this.size},t.prototype.setEnable=function(t){this.enable=t,this.update()},t.prototype.dispose=function(){this.container.find("a").off("click",this.binds.navigate),this.container.off("scroll",this.binds.update),this.container.html(""),this.canvas.height=this.canvas.width=0,delete this.canvas},t.prototype.load=function(t){var e=this;this.loading=!0;var n=this.imageFactory.build(t,void 0===t.number?t.index:t.number,300*this.p.kWtoH,300);n.onChange=function(i){e.setImage(t,i.toDataURL("image/png")),t.loaded=!0,n.dispose(),e.loading=!1,Promise.resolve().then((function(){return e.update()}))}},t.prototype.getActive=function(){var t=this.container.scrollTop(),e=t+this.container.height(),n=[],i=this.thumbnails,r=Array.isArray(i),o=0;for(i=r?i:i[Symbol.iterator]();;){var a;if(r){if(o>=i.length)break;a=i[o++]}else{if((o=i.next()).done)break;a=o.value}var s=a;Math.max(s.first,t)<Math.min(s.last,e)&&n.push(s)}return n},t.prototype.update=function(){if(!this.loading&&this.canvas&&this.enable){this.built||this.render();var t=this.getActive(),e=Array.isArray(t),n=0;for(t=e?t:t[Symbol.iterator]();;){var i;if(e){if(n>=t.length)break;i=t[n++]}else{if((n=t.next()).done)break;i=n.value}var r=i;if(!r.loaded){this.load(r);break}}}},t.prototype.setImage=function(t,e){t.img=e,t.thumbnail.css("background-image",["url('",e,"')"].join("")),t.thumbnail.removeClass("loading")},t.prototype.render=function(){for(var t=['<div class="thumbnails">'],e=0;e<this.size;++e)t.push(['<div class="item"><a href="#"><div class="thumbnail loading"></div></a><div class="heading"><a href="#" title="',e+1,'">',e+1,"</a></div></div>"].join(""));t.push("</div>"),this.container.append(t.join(""));for(var n=this.container.find(".item"),i=this.container.find(".thumbnails").offset().top,r=0;r<n.length;++r){var a=(0,o.$)(n[r]);this.thumbnails[r].heading=a.find(".heading"),this.thumbnails[r].thumbnail=a.find(".thumbnail"),this.thumbnails[r].first=a.offset().top-i,this.thumbnails[r].last=this.thumbnails[r].first+a.height(),this.thumbnails[r].loaded&&this.setImage(this.thumbnails[r],this.thumbnails[r].src);for(var s=a.find("a"),c=0;c<s.length;++c){s[c].dataThumbnail=this.thumbnails[r]}}this.container.find("a").on("click",this.binds.navigate),this.built=!0},t}();e.default=l},function(t,e,n){e.__esModule=!0;var i,r=n(0),o=n(6);var a=function(t){function e(n,i,o){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var a=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==(void 0===e?"undefined":_typeof2(e))&&"function"!=typeof e?t:e}(this,t.call(this,n,i));return a.element=o,a.binds={convert:a.convert.bind(a)},(0,r.$)(a.element).on("touchstart touchmove",a.binds.convert),(0,r.$)(a.doc).on("touchend",a.binds.convert),a}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+(void 0===e?"undefined":_typeof2(e)));t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.dispose=function(){(0,r.$)(this.element).off("touchstart touchmove",this.binds.convert),(0,r.$)(this.doc).off("touchend",this.binds.convert)},e}(((i=o)&&i.__esModule?i:{default:i}).default);e.default=a},function(module,exports,__webpack_require__){exports.__esModule=!0;var _extends=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},_libs=__webpack_require__(0);function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var View=function(){function View(parentContainer,onLoad){var _this3=this,template=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};_classCallCheck(this,View),this.pendings={},this.binds={onResize:this.onResize.bind(this)},this.parentContainer=(0,_libs.$)(parentContainer),this.isIOS=/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream,this.parentContainer.html('<iframe style="border: 0;'+(this.isIOS?"":" width: 100%; height: 100%")+'" scrolling="no"></iframe>'),this.frame=this.parentContainer.find("iframe")[0],this.frame.contentWindow.stop&&this.frame.contentWindow.stop(),this.isIOS&&((0,_libs.$)(this.parentContainer[0].ownerDocument.defaultView).on("resize",this.binds.onResize),this.onResize(),setTimeout(this.checkIframeSize.bind(this),250)),this.container=(0,_libs.$)(this.frame.contentDocument.body),this.container.css("margin","0"),this.head=(0,_libs.$)(this.frame.contentDocument.head),this.onLoad=onLoad,this.handlers=[];var script=template.html?template.script:this.getTemplate().script,urls={styles:template.styles||this.getTemplate().styles,html:[template.html||this.getTemplate().html],script:script?[script]:[]},files={},links=template.links||this.getTemplate().links;this.loadFiles(urls,files).then((function(){for(var _loop4=function(){if(_isArray7){if(_i7>=_iterator7.length)return"break";_ref7=_iterator7[_i7++]}else{if((_i7=_iterator7.next()).done)return"break";_ref7=_i7.value}var t=_ref7,e=t.data,n=t.url;e=e.replace(/url\(['"](.*?)["']\)/g,(function(t,e){return["url(",_this3.urlResolver(n,e),")"].join("")})),(0,_libs.$)('<style type="text/css">'+e+"</style>").appendTo(_this3.head)},_iterator7=files.styles,_isArray7=Array.isArray(_iterator7),_i7=0,_iterator7=_isArray7?_iterator7:_iterator7[Symbol.iterator]();;){var _ref7,_ret4=_loop4();if("break"===_ret4)break}_this3.container.html(_this3.translate(files.html[0].data)),_this3.jLinks=[];for(var _iterator8=links,_isArray8=Array.isArray(_iterator8),_i8=0,_iterator8=_isArray8?_iterator8:_iterator8[Symbol.iterator]();;){var _ref8;if(_isArray8){if(_i8>=_iterator8.length)break;_ref8=_iterator8[_i8++]}else{if(_i8=_iterator8.next(),_i8.done)break;_ref8=_i8.value}var _link=_ref8;_this3.jLinks.push((0,_libs.$)(["<link ",_this3.objToAttrsStr(_link),">"].join("")).appendTo(_this3.head))}if(files.script[0]){var init=eval(files.script[0].data);_this3.templateObject=init(_this3.container)}else _this3.templateObject={};_this3.linkControls={};for(var _iterator9=_this3.getLinks(),_isArray9=Array.isArray(_iterator9),_i9=0,_iterator9=_isArray9?_iterator9:_iterator9[Symbol.iterator]();;){var _ref9;if(_isArray9){if(_i9>=_iterator9.length)break;_ref9=_iterator9[_i9++]}else{if(_i9=_iterator9.next(),_i9.done)break;_ref9=_i9.value}var id=_ref9;_this3.linkControls[id]=_this3.container.find("."+id),_this3.binds[id]=View.handleLinkEvent.bind({getHandlers:_this3.getHandlers.bind(_this3),id:id,ctrl:_this3.linkControls[id]}),_this3.linkControls[id].on("click",_this3.binds[id])}_this3.widgetControls={};for(var _iterator10=_this3.getWidgets(),_isArray10=Array.isArray(_iterator10),_i10=0,_iterator10=_isArray10?_iterator10:_iterator10[Symbol.iterator]();;){var _ref10;if(_isArray10){if(_i10>=_iterator10.length)break;_ref10=_iterator10[_i10++]}else{if(_i10=_iterator10.next(),_i10.done)break;_ref10=_i10.value}var _id=_ref10;_this3.widgetControls[_id]=_this3.container.find("."+_id)}_this3.inputControls={};for(var _iterator11=_this3.getInputs(),_isArray11=Array.isArray(_iterator11),_i11=0,_iterator11=_isArray11?_iterator11:_iterator11[Symbol.iterator]();;){var _ref11;if(_isArray11){if(_i11>=_iterator11.length)break;_ref11=_iterator11[_i11++]}else{if(_i11=_iterator11.next(),_i11.done)break;_ref11=_i11.value}var _id2=_ref11;_this3.inputControls[_id2]=_this3.container.find("."+_id2),_this3.binds[_id2]=View.handleInputEvent.bind({getHandlers:_this3.getHandlers.bind(_this3),id:_id2,ctrl:_this3.inputControls[_id2]}),_this3.inputControls[_id2].on("keyup",_this3.binds[_id2])}_this3.formControls={};for(var _iterator12=_this3.getForms(),_isArray12=Array.isArray(_iterator12),_i12=0,_iterator12=_isArray12?_iterator12:_iterator12[Symbol.iterator]();;){var _ref12;if(_isArray12){if(_i12>=_iterator12.length)break;_ref12=_iterator12[_i12++]}else{if(_i12=_iterator12.next(),_i12.done)break;_ref12=_i12.value}var _id3=_ref12;_this3.formControls[_id3]=_this3.container.find("."+_id3),_this3.binds[_id3]=View.handleFormEvent.bind({getHandlers:_this3.getHandlers.bind(_this3),id:_id3,ctrl:_this3.formControls[_id3]}),_this3.formControls[_id3].on("submit",_this3.binds[_id3])}_this3.textControls={};for(var _iterator13=_this3.getTexts(),_isArray13=Array.isArray(_iterator13),_i13=0,_iterator13=_isArray13?_iterator13:_iterator13[Symbol.iterator]();;){var _ref13;if(_isArray13){if(_i13>=_iterator13.length)break;_ref13=_iterator13[_i13++]}else{if(_i13=_iterator13.next(),_i13.done)break;_ref13=_i13.value}var _id4=_ref13;_this3.textControls[_id4]=_this3.container.find("."+_id4)}_this3.stateSetters=[{map:_this3.linkControls,setter:_this3.setLinkControlState.bind(_this3)},{map:_this3.widgetControls,setter:_this3.setWidgetControlState.bind(_this3)},{map:_this3.inputControls,setter:_this3.setInputControlState.bind(_this3)},{map:_this3.textControls,setter:_this3.setTextControlState.bind(_this3)}],_this3.initView(),_this3.onLoad&&_this3.onLoad(),_this3.fireLinksOnLoadEvent()})).catch((function(t){return console.error(t)}))}return View.classProperty=function(t,e,n){n?t.addClass(e):t.removeClass(e)},View.attributeProperty=function(t,e,n){n?t.attr(e,n):t.removeAttr(e)},View.callHandlers=function(t,e,n,i){var r=t,o=Array.isArray(r),a=0;for(r=o?r:r[Symbol.iterator]();;){var s;if(o){if(a>=r.length)break;s=r[a++]}else{if((a=r.next()).done)break;s=a.value}var c=s;c[e]?c[e](n,i):c.handleDefault&&c.handleDefault(e,n,i)}},View.handleEvent=function(t,e,n,i){View.callHandlers(e(t),t,n,i)},View.handleLinkEvent=function(t){t.preventDefault(),this.ctrl.hasClass("disabled")||View.handleEvent(this.id,this.getHandlers,t)},View.handleInputEvent=function(t){View.handleEvent(this.id,this.getHandlers,t,t.target.value)},View.handleFormEvent=function(t){t.preventDefault(),View.handleEvent(this.id,this.getHandlers,t)},View.prototype.getLinks=function(){return null},View.prototype.getWidgets=function(){return null},View.prototype.getInputs=function(){return null},View.prototype.getTexts=function(){return null},View.prototype.getTemplate=function(){return{}},View.prototype.getHandlers=function(t){return this.handlers},View.prototype.callLater=function(t,e,n,i,r){var o=this;this.pendings[e]={timestamp:(new Date).getTime()},setTimeout((function(){var a=(new Date).getTime(),s=o.pendings[e];s&&a-s.timestamp>=r&&(View.callHandlers(t,e,n,i),delete o.pendings[e])}),r)},View.prototype.loadFiles=function(t,e){var n=[],i=function(){if(o){if(a>=r.length)return"break";s=r[a++]}else{if((a=r.next()).done)return"break";s=a.value}var i=s;e[i]=[];var c=function(){if(h){if(u>=l.length)return"break";d=l[u++]}else{if((u=l.next()).done)return"break";d=u.value}var t=d;n.push(new Promise((function(n,r){_libs.$.get(t,(function(r){e[i].push({url:t,data:r}),n()})).fail((function(t){r(t)}))})))},l=t[i],h=Array.isArray(l),u=0;for(l=h?l:l[Symbol.iterator]();;){var d;if("break"===c())break}},r=Object.keys(t),o=Array.isArray(r),a=0;for(r=o?r:r[Symbol.iterator]();;){var s;if("break"===i())break}return Promise.all(n)},View.prototype.urlResolver=function(t,e){if("/"!==(e=e.replace(/\\/g,"/")).charAt(0)){var n=(t=t.replace(/\\/g,"/")).lastIndexOf("/"),i=(e=(~n?t.substr(0,n+1):"")+e).split("/");e=[];var r=i,o=Array.isArray(r),a=0;for(r=o?r:r[Symbol.iterator]();;){var s;if(o){if(a>=r.length)break;s=r[a++]}else{if((a=r.next()).done)break;s=a.value}var c=s;"."===c||(".."===c?!e.length||1===e.length&&""===e[0]||e.pop():e.push(c))}e=e.join("/")}return e},View.prototype.objToAttrsStr=function(t){var e=[],n=Object.keys(t),i=Array.isArray(n),r=0;for(n=i?n:n[Symbol.iterator]();;){var o;if(i){if(r>=n.length)break;o=n[r++]}else{if((r=n.next()).done)break;o=r.value}var a=o;e.push([a,'="',t[a],'"'].join(""))}return e.join(" ")},View.prototype.checkIframeSize=function(){this.frame&&((Math.abs(this.frame.width-this.parentContainer.width())>1||Math.abs(this.frame.height-this.parentContainer.height())>1)&&this.onResize(),setTimeout(this.checkIframeSize.bind(this),250))},View.prototype.onResize=function(){this.frame.width=this.parentContainer.width(),this.frame.height=this.parentContainer.height()},View.prototype.translate=function(t){return t.replace(/<\$tr>(.*)<\/\$tr>/gi,(function(t,e){return(0,_libs.tr)(e)}))},View.prototype.fireLinksOnLoadEvent=function(){var t=this;if(this.templateObject&&this.templateObject.linkLoaded){var e=function(){if(i){if(r>=n.length)return"break";o=n[r++]}else{if((r=n.next()).done)return"break";o=r.value}var e=o[0],a=new Image;a.onerror=function(){return t.templateObject.linkLoaded(e)},a.src=e.href},n=this.jLinks,i=Array.isArray(n),r=0;for(n=i?n:n[Symbol.iterator]();;){var o;if("break"===e())break}}},View.prototype.dispose=function(){delete this.textControls;var t=this.getLinks(),e=Array.isArray(t),n=0;for(t=e?t:t[Symbol.iterator]();;){var i;if(e){if(n>=t.length)break;i=t[n++]}else{if((n=t.next()).done)break;i=n.value}var r=i;this.linkControls[r].off("click",this.binds[r])}delete this.linkControls,delete this.widgetControls;var o=this.getInputs(),a=Array.isArray(o),s=0;for(o=a?o:o[Symbol.iterator]();;){var c;if(a){if(s>=o.length)break;c=o[s++]}else{if((s=o.next()).done)break;c=s.value}var l=c;this.inputControls[l].off("keyup",this.binds[l])}delete this.inputControls;var h=this.getForms(),u=Array.isArray(h),d=0;for(h=u?h:h[Symbol.iterator]();;){var p;if(u){if(d>=h.length)break;p=h[d++]}else{if((d=h.next()).done)break;p=d.value}var f=p;this.formControls[f].off("submit",this.binds[f])}delete this.formControls,!this.templateObject.dispose||this.templateObject.dispose(),delete this.templateObject,this.isIOS&&(0,_libs.$)(this.parentContainer[0].ownerDocument.defaultView).off("resize",this.binds.onResize),this.parentContainer.html(""),delete this.frame},View.prototype.getContainer=function(){return this.container[0]},View.prototype.getParentContainer=function(){return this.parentContainer[0]},View.prototype.addHandler=function(t){this.handlers.push(t)},View.prototype.initView=function(){},View.setControlState=function(t,e,n,i){if(t){var r=_extends({},e,n);for(var o in r)r.hasOwnProperty(o)&&i[o]&&i[o](t,r[o])}},View.prototype.setLinkControlState=function(t,e){View.setControlState(this.linkControls[t],{visible:!0,active:!1,enable:!0},e,View.linkStateHandlers)},View.prototype.setWidgetControlState=function(t,e){View.setControlState(this.widgetControls[t],{visible:!0,active:!1,enable:!0},e,View.widgetStateHandlers)},View.prototype.setInputControlState=function(t,e){View.setControlState(this.inputControls[t],{visible:!0,enable:!0,value:""},e,View.inputStateHandlers)},View.prototype.setTextControlState=function(t,e){View.setControlState(this.textControls[t],{visible:!0,value:""},e,View.textStateHandlers)},View.prototype.onItemStateChanged=function(){},View.prototype.setState=function(t,e){var n=this.stateSetters,i=Array.isArray(n),r=0;for(n=i?n:n[Symbol.iterator]();;){var o;if(i){if(r>=n.length)break;o=n[r++]}else{if((r=n.next()).done)break;o=r.value}var a=o;if(a.map[t]){a.setter(t,e),this.onItemStateChanged(t,e);break}}},View}();View.linkStateHandlers={visible:function(t,e){return View.classProperty(t,"hidden",!e)},active:function(t,e){return View.classProperty(t,"active",e)},enable:function(t,e){return View.classProperty(t,"disabled",!e)}},View.widgetStateHandlers={visible:function(t,e){return View.classProperty(t,"hidden",!e)},active:function(t,e){return View.classProperty(t,"active",e)},enable:function(t,e){return View.classProperty(t,"disabled",!e)}},View.inputStateHandlers={visible:function(t,e){return View.classProperty(t,"hidden",!e)},value:function(t,e){return t[0].value=e},enable:function(t,e){return View.attributeProperty(t,"disabled",!e)}},View.textStateHandlers={visible:function(t,e){return View.classProperty(t,"hidden",!e)},value:function(t,e){return t.text(e)}},exports.default=View},function(t,e,n){e.__esModule=!0;var i=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},r=n(0),o=h(n(56)),a=h(n(61)),s=h(n(62)),c=h(n(48)),l=h(n(12));function h(t){return t&&t.__esModule?t:{default:t}}function u(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function d(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==(void 0===e?"undefined":_typeof2(e))&&"function"!=typeof e?t:e}var p=function(t){function e(n,h,p){var f=arguments.length>3&&void 0!==arguments[3]&&arguments[3];u(this,e);var m=d(this,t.call(this));m.wnd=n,m.doc=h,m.jContainer=p,m.renderCallbacks=[],m.clock=new r.THREE.Clock,m.raycaster=new r.THREE.Raycaster,m.scene=new r.THREE.Scene,m.cssScene=new r.THREE.Scene,m.camera=new r.THREE.PerspectiveCamera(30,m.width()/m.height(),.2,2e3);var g=1;m.camera.position.x=0,m.camera.position.y=5.5*g,m.camera.position.z=0,m.renderer=new r.THREE.WebGLRenderer({alpha:!0,antialias:!0}),m.renderer.setClearColor(0,0),m.renderer.setPixelRatio(m.wnd.devicePixelRatio),m.renderer.setSize(m.width(),m.height()),m.jContainer.append(m.renderer.domElement),m.cssRenderer=new l.default,m.cssRenderer.setSize(m.width(),m.height()),(0,r.$)(m.cssRenderer.domElement).css({position:"absolute",top:0,margin:0,padding:0}),m.jContainer.append(m.cssRenderer.domElement),m.element=m.cssRenderer.domElement,m.controls=new o.default(m.camera,m.element),m.controls.target.y=.5;var v=(0,r.$)(m.cssRenderer.domElement).find("div"),y=new r.THREE.Vector3;m.controls.addEventListener("change",(function(){m.camera.getWorldDirection(y),v.css("display",y.y-m.camera.position.y>0?"none":"block")})),m.textureLoader=new r.THREE.TextureLoader,m.scene.add(new r.THREE.AmbientLight(13684944)),m.light=new r.THREE.DirectionalLight(4210752,1),m.light.position.set(0,6*g,0),m.light.castShadow=!1,m.scene.add(m.light),f&&m.scene.add(new r.THREE.AxisHelper(5)),m.binds={onWindowResize:m.onWindowResize.bind(m),animate:m.animate.bind(m)},(0,r.$)(m.wnd).on("resize",m.binds.onWindowResize),m.mouseEvents=new a.default(m.wnd,m.doc,m),m.touchEvents=new s.default(m.wnd,m.doc,m);var b={type:"mousemove"};return m.mouseEvents.filter=function(t,e){var n=function(t,e){return t===e||r.$.contains(t,e)};return"mousemove"===e.type&&(b.pageX=e.pageX,b.pageY=e.pageY),e.relatedTarget&&~["mouseenter","mouseover","mouseleave","mouseout"].indexOf(e.type)&&n(t,e.target)&&n(t,e.relatedTarget)?i({},e,b):e},m.drag=new c.default(m.wnd,m.doc,m),m.animate(),m}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+(void 0===e?"undefined":_typeof2(e)));t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.dispose=function(){delete this.binds.animate,(0,r.$)(this.wnd).off("resize",this.binds.onWindowResize),this.mouseEvents.dispose(),this.touchEvents.dispose(),this.drag.dispose(),this.controls.dispose()},e.prototype.width=function(){return this.jContainer.width()},e.prototype.height=function(){return this.jContainer.height()},e.prototype.setExtraLighting=function(t){this.light.intensity=t},e.prototype.getOrbit=function(){return this.controls},e.prototype.setControlsState=function(t){this.controls.enabled=t},e.prototype.getControlsState=function(){return this.controls.enabled},e.prototype.onWindowResize=function(){var t,e=this,n=function(t){t.setSize(e.width(),e.height())};(t=this.camera).aspect=e.width()/e.height(),t.updateProjectionMatrix(),n(this.renderer),n(this.cssRenderer),this.dispatchEvent({type:"resize"})},e.prototype.addObject=function(t){this.scene.add(t)},e.prototype.addCssObject=function(t){this.cssScene.add(t)},e.prototype.removeCssObject=function(t){this.cssScene.remove(t)},e.prototype.removeObject=function(t){this.scene.remove(t)},e.prototype.animate=function(){this.binds.animate&&requestAnimationFrame(this.binds.animate),this.render()},e.prototype.addRenderCallback=function(t){this.renderCallbacks.push(t)},e.prototype.removeRenderCallback=function(t){var e=this.renderCallbacks.indexOf(t);~e&&this.renderCallbacks.splice(e,1)},e.prototype.render=function(){var t=this.clock.getDelta();this.controls.update(t);var e=this.renderCallbacks,n=Array.isArray(e),i=0;for(e=n?e:e[Symbol.iterator]();;){var r;if(n){if(i>=e.length)break;r=e[i++]}else{if((i=e.next()).done)break;r=i.value}r(t)}this.cssRenderer.render(this.cssScene,this.camera),this.renderer.render(this.scene,this.camera)},e.prototype.processGeometry=function(t,e){e.geometry=t;var n=(new r.THREE.Geometry).fromBufferGeometry(t);n.mergeVertices();var i=this.createIndexedBufferGeometryFromGeometry(n);return this.mapIndices(t,i)},e.prototype.createIndexedBufferGeometryFromGeometry=function(t){for(var e=t.vertices.length,n=t.faces.length,i=new r.THREE.BufferGeometry,o=new Float32Array(3*e),a=new(3*n>65535?Uint32Array:Uint16Array)(3*n),s=0;s<e;s++){var c=t.vertices[s],l=3*s;o[l]=c.x,o[l+1]=c.y,o[l+2]=c.z}for(var h=0;h<n;h++){var u=t.faces[h],d=3*h;a[d]=u.a,a[d+1]=u.b,a[d+2]=u.c}return i.setIndex(new r.THREE.BufferAttribute(a,1)),i.addAttribute("position",new r.THREE.BufferAttribute(o,3)),i},e.prototype.isEqual=function(t,e,n,i,r,o){return Math.abs(i-t)<1e-6&&Math.abs(r-e)<1e-6&&Math.abs(o-n)<1e-6},e.prototype.mapIndices=function(t,e){var n=t.attributes.position.array,i=e.attributes.position.array,r=e.index.array,o=i.length/3,a=n.length/3;t.mappedVertices=i,t.mappedIndices=r,t.mappedAssociation=[];for(var s=0;s<o;s++){var c=[];t.mappedAssociation.push(c);for(var l=3*s,h=0;h<a;h++){var u=3*h;this.isEqual(i[l],i[l+1],i[l+2],n[u],n[u+1],n[u+2])&&c.push(u)}}return{vertices:t.mappedVertices,indices:t.mappedIndices}},e.prototype.oneNodePositionCallback=function(t,e){this.position.set(t.x,t.y,t.z),this.quaternion.set(e.x,e.y,e.z,e.w)},e.prototype.multyNodePositionCallback=function(t,e,n){for(var i=this.geometry,r=i.attributes.position.array,o=i.attributes.normal.array,a=i.mappedAssociation[t],s=0;s<a.length;s++){var c=a[s];r[c]=e.x,o[c]=n.x,r[++c]=e.y,o[c]=n.y,r[++c]=e.z,o[c]=n.z}},e.prototype.multyNodePositionPostCallback=function(){var t=this.geometry;t.attributes.position.needsUpdate=!0,t.attributes.normal.needsUpdate=!0},e.prototype.pathPositionCallback=function(t,e){var n=this.geometry.attributes.position.array,i=3*t;n[i++]=e.x,n[i++]=e.y,n[i]=e.z},e.prototype.pathPositionPostCallback=function(){var t=this.geometry;t.computeVertexNormals(),t.attributes.position.needsUpdate=!0,t.attributes.normal.needsUpdate=!0},e}(r.THREE.EventDispatcher);e.default=p},function(t,e,n){e.__esModule=!0;var i,r=n(15);var o=function(t){function e(n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var i=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==(void 0===e?"undefined":_typeof2(e))&&"function"!=typeof e?t:e}(this,t.call(this));return i.view=n,i.visible=!1,i}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+(void 0===e?"undefined":_typeof2(e)));t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.togle=function(){this.visible=!this.visible,this.fireChange()},e.prototype.hide=function(){this.visible=!1,this.fireChange()},e.prototype.fireChange=function(){this.onChange&&this.onChange(),this.updateView()},e.prototype.updateView=function(){this.view&&this.view.setState("widFloatWnd",{enable:!0,visible:this.visible,active:!1})},e}(((i=r)&&i.__esModule?i:{default:i}).default);e.default=o},function(t,e,n){e.__esModule=!0;var i,r=n(21);var o=function(t){function e(n,i,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var o=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==(void 0===e?"undefined":_typeof2(e))&&"function"!=typeof e?t:e}(this,t.call(this));return o.p={x:n,y:i,r:r},o}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+(void 0===e?"undefined":_typeof2(e)));t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.testIntersection=function(t,e){var n=void 0,i=e.x,r=e.y,o=this.p;return(i-o.x)*(i-o.x)+(r-o.y)*(r-o.y)<=o.r*o.r&&(n={target:this,data:e}),n},e}(((i=r)&&i.__esModule?i:{default:i}).default);e.default=o},function(t,e,n){e.__esModule=!0;var i=o(n(21)),r=o(n(2));function o(t){return t&&t.__esModule?t:{default:t}}var a=function(t){function e(n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var i=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==(void 0===e?"undefined":_typeof2(e))&&"function"!=typeof e?t:e}(this,t.call(this));return i.poly=n,i}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+(void 0===e?"undefined":_typeof2(e)));t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.testIntersection=function(t,e){return r.default.isInsidePoly(this.poly,e)?{target:this,data:e}:void 0},e}(i.default);e.default=a},function(t,e,n){var i;t.exports=((i=function t(){function e(t){return r.appendChild(t.dom),t}function n(t){for(var e=0;e<r.children.length;e++)r.children[e].style.display=e===t?"block":"none";i=t}var i=0,r=document.createElement("div");r.style.cssText="position:fixed;top:0;left:0;cursor:pointer;opacity:0.9;z-index:10000",r.addEventListener("click",(function(t){t.preventDefault(),n(++i%r.children.length)}),!1);var o=(performance||Date).now(),a=o,s=0,c=e(new t.Panel("FPS","#0ff","#002")),l=e(new t.Panel("MS","#0f0","#020"));if(self.performance&&self.performance.memory)var h=e(new t.Panel("MB","#f08","#201"));return n(0),{REVISION:16,dom:r,addPanel:e,showPanel:n,begin:function(){o=(performance||Date).now()},end:function(){s++;var t=(performance||Date).now();if(l.update(t-o,200),t>a+1e3&&(c.update(1e3*s/(t-a),100),a=t,s=0,h)){var e=performance.memory;h.update(e.usedJSHeapSize/1048576,e.jsHeapSizeLimit/1048576)}return t},update:function(){o=this.end()},domElement:r,setMode:n}}).Panel=function(t,e,n){var i=1/0,r=0,o=Math.round,a=o(window.devicePixelRatio||1),s=80*a,c=48*a,l=3*a,h=2*a,u=3*a,d=15*a,p=74*a,f=30*a,m=document.createElement("canvas");m.width=s,m.height=c,m.style.cssText="width:80px;height:48px";var g=m.getContext("2d");return g.font="bold "+9*a+"px Helvetica,Arial,sans-serif",g.textBaseline="top",g.fillStyle=n,g.fillRect(0,0,s,c),g.fillStyle=e,g.fillText(t,l,h),g.fillRect(u,d,p,f),g.fillStyle=n,g.globalAlpha=.9,g.fillRect(u,d,p,f),{dom:m,update:function(c,v){i=Math.min(i,c),r=Math.max(r,c),g.fillStyle=n,g.globalAlpha=1,g.fillRect(0,0,s,d),g.fillStyle=e,g.fillText(o(c)+" "+t+" ("+o(i)+"-"+o(r)+")",l,h),g.drawImage(m,u+a,d,p-a,f,u,d,p-a,f),g.fillRect(u+p-a,d,a,f),g.fillStyle=n,g.globalAlpha=.9,g.fillRect(u+p-a,d,a,o((1-c/v)*f))}}},i)},function(t,e,n){var i;
/*!
   * jQuery Mousewheel 3.1.13
   *
   * Copyright jQuery Foundation and other contributors
   * Released under the MIT license
   * http://jquery.org/license
   */i=function(t){var e,n,i=["wheel","mousewheel","DOMMouseScroll","MozMousePixelScroll"],r="onwheel"in document||document.documentMode>=9?["wheel"]:["mousewheel","DomMouseScroll","MozMousePixelScroll"],o=Array.prototype.slice;if(t.event.fixHooks)for(var a=i.length;a;)t.event.fixHooks[i[--a]]=t.event.mouseHooks;var s=t.event.special.mousewheel={version:"3.1.12",setup:function(){if(this.addEventListener)for(var e=r.length;e;)this.addEventListener(r[--e],c,!1);else this.onmousewheel=c;t.data(this,"mousewheel-line-height",s.getLineHeight(this)),t.data(this,"mousewheel-page-height",s.getPageHeight(this))},teardown:function(){if(this.removeEventListener)for(var e=r.length;e;)this.removeEventListener(r[--e],c,!1);else this.onmousewheel=null;t.removeData(this,"mousewheel-line-height"),t.removeData(this,"mousewheel-page-height")},getLineHeight:function(e){var n=t(e),i=n["offsetParent"in t.fn?"offsetParent":"parent"]();return i.length||(i=t("body")),parseInt(i.css("fontSize"),10)||parseInt(n.css("fontSize"),10)||16},getPageHeight:function(e){return t(e).height()},settings:{adjustOldDeltas:!0,normalizeOffset:!0}};function c(i){var r=i||window.event,a=o.call(arguments,1),c=0,u=0,d=0,p=0,f=0,m=0;if((i=t.event.fix(r)).type="mousewheel","detail"in r&&(d=-1*r.detail),"wheelDelta"in r&&(d=r.wheelDelta),"wheelDeltaY"in r&&(d=r.wheelDeltaY),"wheelDeltaX"in r&&(u=-1*r.wheelDeltaX),"axis"in r&&r.axis===r.HORIZONTAL_AXIS&&(u=-1*d,d=0),c=0===d?u:d,"deltaY"in r&&(c=d=-1*r.deltaY),"deltaX"in r&&(u=r.deltaX,0===d&&(c=-1*u)),0!==d||0!==u){if(1===r.deltaMode){var g=t.data(this,"mousewheel-line-height");c*=g,d*=g,u*=g}else if(2===r.deltaMode){var v=t.data(this,"mousewheel-page-height");c*=v,d*=v,u*=v}if(p=Math.max(Math.abs(d),Math.abs(u)),(!n||p<n)&&(n=p,h(r,p)&&(n/=40)),h(r,p)&&(c/=40,u/=40,d/=40),c=Math[c>=1?"floor":"ceil"](c/n),u=Math[u>=1?"floor":"ceil"](u/n),d=Math[d>=1?"floor":"ceil"](d/n),s.settings.normalizeOffset&&this.getBoundingClientRect){var y=this.getBoundingClientRect();f=i.clientX-y.left,m=i.clientY-y.top}return i.deltaX=u,i.deltaY=d,i.deltaFactor=n,i.offsetX=f,i.offsetY=m,i.deltaMode=0,a.unshift(i,c,u,d),e&&clearTimeout(e),e=setTimeout(l,200),(t.event.dispatch||t.event.handle).apply(this,a)}}function l(){n=null}function h(t,e){return s.settings.adjustOldDeltas&&"mousewheel"===t.type&&e%120==0}t.fn.extend({mousewheel:function(t){return t?this.bind("mousewheel",t):this.trigger("mousewheel")},unmousewheel:function(t){return this.unbind("mousewheel",t)}})},t.exports=i},function(t,e,n){n(23),t.exports=n(22)}])},function(t,e,n){"use strict";e.__esModule=!0;var i=__webpack_provided_window_dot_jQuery,r=__webpack_provided_window_dot_html2canvas,o=__webpack_provided_window_dot_THREE,a=__webpack_provided_window_dot_PDFJS;e.$=i,e.html2canvas=r,e.THREE=o,e.PDFJS=a},function(t,e,n){t.exports=n(0)}])}).call(this,__webpack_require__(1),__webpack_require__(2),__webpack_require__(3),__webpack_require__(6),__webpack_require__(3))}]);